//v1.1.1
const $s365=function(){function e(e,t){return fetch(e,t).then(e=>e.text().then(t=>e.ok?t:Promise.reject("fetch error ("+e.status+")")))}function t(t,a){return e(t,a).then(e=>new DOMParser().parseFromString(e,"text/html"))}function a(e,t){const a=function(e){let t=[];for(let a=0;a<e.length-1;a+=2)t.push(parseInt(e.substr(a,2),16));return String.fromCharCode.apply(String,t)},n=new forge.util.ByteBuffer(a(e),"raw");let s=forge.cipher.createDecipher("AES-CBC",t.k);return s.start({iv:t.iv}),s.update(n),s.finish(),a(s.output.data.trim())}const r=["monchengladbach",null,"dortmund","bayern","fortuna","schalke","fckoln","paderborn","leverkusen","leipzig","frankfurt","freiburg","bremen","hertha","union","hoffenheim","wolfsburg","mainz","augsburg",null,null,"hamburg","stuttgart","stpauli","hannover","bochum","bielefeld","nurnberg","karlsruhe","erzgebirge","darmstadt","dresden","greuther","heidenheim","holstein","osnabruck","regensburg","sandhausen","wiesbaden",null,null,null,null,null,"liverpool","barcelona","saintgermain","realmadrid","manchestercity","juventus"],n=function(){let a=null,r=null;return{get:function(n){const s=r=Date.now();return new Promise(function(i,o){!0!==n&&null!==a?i(a):(console.log("Laden","http://www.sport365.live/de/home"),t("http://www.sport365.live/de/home").then(t=>{if(s===r){const a=[].map.call(t.querySelectorAll("script[src]"),e=>e.src).filter(e=>/medianetworkinternational\.com\/js\/[a-f0-9]{32}\.js$/.test(e)),n=t.querySelector("#captcha img");console.log(n.src),n&&30<n.src.length?function t(c){-1===c?o("Key nicht gefunden! [E13]"):(console.log("Laden",a[c]),e(a[c]).then(e=>{if(!(s===r))o(null);else if(-1===e.indexOf("new Image"))t(--c);else if(fnc=(e.match(/function\s+[a-z0-9]{43}\(_0x[a-f0-9]+\).+?break;/)||[])[0]||null,fnc){const t=((e.match(/}\(_0x[a-z0-9]+,\s*(0x[a-f0-9]+)\)\);/)||[])[1]||"x")-0;if(!isNaN(t)){const a=fnc.match(/=\s*_0x[a-z0-9]+\(\s*["'](0x[a-f0-9]+)["']\s*,\s*["'](.{4})["']\s*\)/i),r=(a?a[1]:"x")-0;if(!isNaN(r)){const s=function(){const t=e.match(/var\s+_0x[a-z0-9]+\s*=\s*\[\s*["']([^\]]+)["']/),a=t?t[1].split(/['",\s]+/):[],n=a.length;return 1<n&&n>=r?a:null}();if(s){let c=null;try{c=function(e,t){const r=t.length;let s=[...Array(256).keys()],o="";e=atob(e);for(var c=0,d=e.length;c<d;c++)o+="%"+("00"+e.charCodeAt(c).toString(16)).slice(-2);e=decodeURIComponent(o);for(var l,c=0,p=0;256>c;c++)p=(p+s[c]+t.charCodeAt(c%r))%256,l=s[c],s[c]=s[p],s[p]=l;o="";for(var l,p=0,c=0,u=0,d=e.length;c<d;c++)p=(p+1)%256,u=(u+s[p])%256,l=s[p],s[p]=s[u],s[u]=l,o+=String.fromCharCode(e.charCodeAt(c)^s[(s[p]+s[u])%256]);return o}(s[(r+t)%s.length],a[2]),c=/[^\d\|]/.test(c)?null:c.split("|").map(e=>parseInt(e))}catch(t){c=null}if(c){const e=fnc.split("case").slice(1);if(e.length===c.length){let t=[];if(c.forEach(a=>t.push(e[a])),t=t.map(e=>{const t=e.match(/\(\s*(0x[a-f0-9]+)\s*,\s*(0x[a-f0-9]+)\s*,\s*0x1\s*,\s*0x1\s*\).+?\[0x(1|2)\]/);return t?[t[1]-0,t[2]-0,t[3]-0]:null}).filter(e=>null!==e),0<t.length){let e,a="",r="",s=document.createElement("canvas"),c=s.getContext("2d"),d=new Image;d.onload=function(){try{s.width=50,s.height=50,c.drawImage(d,0,0),e=c.getImageData(0,0,50,50).data,t.forEach(t=>{1===t[2]?r+=e[4*(50*t[1]+t[0])+1].toString():a+=e[4*(50*t[1]+t[0])+2].toString()})}catch(t){a="",r=""}""===a?o("Key nicht gefunden! [E22]"):(console.log(a,r),i({k:a,iv:r}))},d.src=n.src}else o("Key nicht gefunden! [E21]")}else o("Key nicht gefunden! [E20]")}else o("Key nicht gefunden! [E19]")}else o("Key nicht gefunden! [E18]")}else o("Key nicht gefunden! [E17]")}else o("Key nicht gefunden! [E16]")}else o("Key nicht gefunden! [E15]")}).catch(a=>{s===r?(console.warn("[208]",a),t(--c)):o(null)}))}(a.length-1):o("Key nicht gefunden! [E14]")}else o(null)}).catch(t=>{console.warn("[209]",t),o(s===r?"Fehler beim Laden des Schl\xFCssels [209]":null)}))})},clear:()=>a=null}}(),s=function(){let s=null;return function(i,e,o,c){const d=s=Date.now(),l=function(o,c){n.get().then(l=>{if(d===s){const p="http://www.sport365.live/de/events/-/-/"+(i?"10":"-")+"/"+(e?"7":"-")+"/"+-1*new Date().getTimezoneOffset();console.log("Laden",p),t(p).then(t=>{if(d===s){const p=t.querySelectorAll("tr[onclick]"),u=function(t){let e;if(!!i)t.sport="Fu\xDFball",t.cat=5,e=t.sub.match(/([^-]+?)\s?-\s?(.+)/i);else if(e=t.sub.match(/([^\/]+?)\s?\/\s?(.+)/i),e)t.sport=e[1],i=/^(fu(ÃŸ|ss)ball|soccer)$/i.test(t.sport),t.cat=i?5:7,e=e[2].match(/([^-]+?)\s?-\s?(.+)/i);else return t.cat=9,t;if(e&&(t.region=e[1],t.league=e[2],t.nat=/germany|deutschland/i.test(t.region),i))if(e=t.league.toLowerCase(),t.nat){const a=e.indexOf("bundesliga");-1===a?-1!==e.indexOf("dfb pokal")&&(t.cat=2):0===a||-1!==e.indexOf("1.")?t.cat=0:-1!==e.indexOf("2.")&&(t.cat=1)}else-1===e.indexOf("uefa champions league")?-1!==e.indexOf("uefa europa league")&&(t.cat=4):t.cat=3;if(i){const e=t.title.toLowerCase().split(" - "),a=e.length;if(t.home=null,t.away=null,2===a){const a=r.length;for(let n=0,s=e[0].replace(/\s|-/g,"");n<a;n++)if(-1!==s.indexOf(r[n])){t.home=n;break}for(let n=0,s=e[1].replace(/\s|-/g,"");n<a;n++)if(-1!==s.indexOf(r[n])){t.away=n;break}null===t.home?t.home=[19,39,41,50,51,null][t.cat]:null===t.away&&(t.away=[19,39,50,50,51,null][t.cat])}else t.home=1===a&&(-1!==e[0].indexOf("konferenz")||-1!==e[0].indexOf("simulcast"))?[1,20,40,42,43,null][t.cat]:[19,39,41,50,51,null][t.cat]}return t};let g=[];for(let t,r,s,o=0,i=[];t=p[o],r=p[o+1];o+=2){const o=t.getAttribute("onclick").match(/['"][^"']+["']/g);if(s=null,3===o.length)try{s=a(o[1].slice(1,-1),l)}catch(t){return console.log("Fehler Decrypt",t),n.clear(),void c("Fehler bei Entschl\xFCsselung der URLs")}if(s){const a=t.getElementsByTagName("td"),o=a.length,n=3<o?a[3].firstChild.textContent.trim():"";if(""!==n){let t="?",c="?";r=r.getElementsByTagName("tr")[0],r&&(t=(r.children[1]||{}).innerText||"?",c=((r.children[0]||{}).innerText||"?").trim());const d=function(){const e=2<o?a[2].innerText:"";return /^\d\d:\d\d$/.test(e)?e:"??:??"}(),l=function(){const e=1<o?a[1].querySelector("img"):null;return e?e.src.includes("dot-green"):null}(),p=e||/deutsch|german/i.test(t),y=!e&&/englisc?h/i.test(t),h=(d+n+c).replace(/\s/g,""),f=i.indexOf(h);-1===f?(i.push(h),g.push(u({time:d,title:n,sub:c,i:g.length,online:l,de:p,en:y,id:h,langs:[{lang:t,online:l,url:s,de:p,en:y,id:0}]}))):(g[f].online=g[f].online||l,g[f].de=g[f].de||p,g[f].en=g[f].en||y,g[f].langs.push({lang:t,online:l,url:s,de:p,en:y,id:g[f].langs.length}))}}}g.forEach(t=>t.langs.sort((e,t)=>{const a=4*e.online+2*e.de+e.en,r=4*t.online+2*t.de+t.en;return a===r?0:a>r?-1:1})),d===s?(console.log("Gefundene Events",g),o(g)):c(null)}else c(null)}).catch(t=>c(d===s?t:null))}else c(null)}).catch(t=>c(d===s?t:null))};return"function"==typeof o?void l(o,c):new Promise(l)}}(),i=function(){let r=null;return function(e,s,i){const o=r=Date.now();if("undefined"!=typeof e&&null!==e){const c=function(s,i){console.log("Aufrufen [3]",e),n.get().then(n=>{r===o?t(e,{credentials:"include"}).then(e=>{if(r===o){const c=(e.querySelector("#area-middle iframe")||{}).src||null;c?(console.log("Aufrufen [5]",c),t(c).then(e=>{if(r===o){const c=[].map.call(e.querySelectorAll("input[type=\"hidden\"]"),e=>e.name+"="+e.value).join("&"),d=[].filter.call(e.querySelectorAll("script:not([src])"),e=>e.textContent.includes("action")).map(e=>{const t=e.textContent.match(/["']action["']\s*,\s*["']([^"']+)["']/i);return t?t[1]:null}).filter(e=>null!==e)[0]||null;""!==c&&d?(console.log("Aufrufen [6]",d,c),t(d,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:c}).then(e=>{if(r===o){const r=[].filter.call(e.querySelectorAll("script:not([src])"),e=>e.textContent.includes("vjs_options")).map(e=>e.textContent.match(/["']([^"']+)["']/g)).reduce((e,t)=>e.concat(t),[]).sort((e,t)=>e.length<t.length),o=([].filter.call(e.querySelectorAll("script[src]"),e=>e.src.includes("tags2.adshell.net/p"))[0]||{}).src||null;let c=null;for(let e,t=0;e=r[t];t++){try{c=a(e.slice(1,-1),n)}catch(t){c=null}if(null!==c&&/\/(i$|index\.m3u8?)/.test(c))break}c?s({url:c,banner:o}):i("Nichts gefunden [E5]")}else i(null)}).catch(t=>i(r===o?t:null))):i("Nichts gefunden [E7]")}else i(null)}).catch(t=>i(r===o?t:null))):i("Nichts gefunden [E81]")}else i(null)}).catch(t=>i(r===o?t:null)):i(null)}).catch(t=>i(r===o?t:null))};return"function"==typeof s?void c(s,i):new Promise(c)}}}(),o=function(){let a=null,r=0;const n=function(a,r){console.log("Lade adshell (1)",a),e(a).then(e=>{const a=e.match(/url\s*:\s*["']([^"']+)/i);a?(console.log("Lade adshell (2)",a[1]),t(a[1]).then(()=>r(i())).catch(()=>r(s(3)))):r(s(2))}).catch(()=>r(s(1)))},s=function(e){return r++,console.log("Banner-Error: "+e+" ("+r+")"),4<r&&null!==a&&(console.log("==> Remove Adshell"),clearTimeout(a),a=null),e},i=function(){return console.log("Banner OK"),r=0,0};return{remove:function(){null!==a&&(console.log("Remove Adshell"),clearTimeout(a),a=null)},attach:function(e,t){const s=function(t){console.log("Attach Adshell",e),null!==a&&clearTimeout(a),r=0,"string"==typeof e?(a=setInterval(n,9e5,e,()=>{}),n(e,t)):(a=null,t(-1))};return"function"==typeof t?void s(t):new Promise(s)}}}();return{resetKey:n.clear,getEvents:s,getLinks:function(e,r,s){const i=(r,s)=>{n.get().then(i=>{console.log("Aufrufen [2]","http://www.sport365.live"+e),t("http://www.sport365.live"+e).then(e=>{Z=[];for(let t,r,o=0,c=e.querySelectorAll("span#span_link_links");t=c[o];o++){r=t.getAttribute("onclick").match(/['"][^"']+["']/);try{Z.push(a(r[0].slice(1,-1),i))}catch(t){return console.log("Fehler Decrypt",t),n.clear(),void s("Fehler beim Entschl\xFCsseln der URLs")}}0<Z.length?r(Z):s("Nichts gefunden!")}).catch(t=>s(t))}).catch(t=>s(t))};return"function"==typeof r?void i(r,s):new Promise(i)},getStream:i,adshell:{remove:o.remove,attach:o.attach}}}();!function(a,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.forge=e():a.forge=e()}("undefined"==typeof self?this:self,function(){return function(s){function i(t){if(e[t])return e[t].exports;var a=e[t]={i:t,l:!1,exports:{}};return s[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}var e={};return i.m=s,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(a,e){return Object.prototype.hasOwnProperty.call(a,e)},i.p="",i(i.s=34)}([function(t){t.exports={options:{usePureJavaScript:!1}}},function(p,e,u){(function(e){function E(t){if(8!==t&&16!==t&&24!==t&&32!==t)throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}function a(n){if(this.data="",this.read=0,"string"==typeof n)this.data=n;else if(!(o.isArrayBuffer(n)||o.isArrayBufferView(n)))(n instanceof a||"object"==typeof n&&"string"==typeof n.data&&"number"==typeof n.read)&&(this.data=n.data,this.read=n.read);else if("undefined"!=typeof Buffer&&n instanceof Buffer)this.data=n.toString("binary");else{var e=new Uint8Array(n);try{this.data=String.fromCharCode.apply(null,e)}catch(a){for(var t=0;t<e.length;++t)this.putByte(e[t])}}this._constructedStringLength=0}function t(n,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var s=o.isArrayBuffer(n),r=o.isArrayBufferView(n);return s||r?(this.data=s?new DataView(n):new DataView(n.buffer,n.byteOffset,n.byteLength),void(this.write="writeOffset"in e?e.writeOffset:this.data.byteLength)):void(this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!==n&&void 0!==n&&this.putBytes(n),"writeOffset"in e&&(this.write=e.writeOffset))}var r=u(0),n=u(37),o=p.exports=r.util=r.util||{};!function(){function c(r){if(r.source===window&&r.data===d){r.stopPropagation();var e=t.slice();t.length=0,e.forEach(function(t){t()})}}if("undefined"!=typeof process&&process.nextTick&&!process.browser)return o.nextTick=process.nextTick,void("function"==typeof setImmediate?o.setImmediate=setImmediate:o.setImmediate=o.nextTick);if("function"==typeof setImmediate)return o.setImmediate=function(){return setImmediate.apply(void 0,arguments)},void(o.nextTick=function(t){return setImmediate(t)});if(o.setImmediate=function(t){setTimeout(t,0)},"undefined"!=typeof window&&"function"==typeof window.postMessage){var d="forge.setImmediate",t=[];o.setImmediate=function(a){t.push(a),1===t.length&&window.postMessage("forge.setImmediate","*")},window.addEventListener("message",c,!0)}if("undefined"!=typeof MutationObserver){var l=Date.now(),p=!0,u=document.createElement("div"),t=[];new MutationObserver(function(){var a=t.slice();t.length=0,a.forEach(function(t){t()})}).observe(u,{attributes:!0});var i=o.setImmediate;o.setImmediate=function(a){15<Date.now()-l?(l=Date.now(),i(a)):(t.push(a),1===t.length&&u.setAttribute("a",p=!p))}}o.nextTick=o.setImmediate}(),o.isNodejs="undefined"!=typeof process&&process.versions&&process.versions.node,o.globalScope=function(){return o.isNodejs?e:"undefined"==typeof self?window:self}(),o.isArray=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},o.isArrayBuffer=function(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer},o.isArrayBufferView=function(t){return t&&o.isArrayBuffer(t.buffer)&&void 0!==t.byteLength},o.ByteBuffer=a,o.ByteStringBuffer=a,o.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,4096<this._constructedStringLength&&(this.data.substr(0,1),this._constructedStringLength=0)},o.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},o.ByteStringBuffer.prototype.isEmpty=function(){return 0>=this.length()},o.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))},o.ByteStringBuffer.prototype.fillWithByte=function(a,n){a=String.fromCharCode(a);for(var s=this.data;0<n;)1&n&&(s+=a),0<(n>>>=1)&&(a+=a);return this.data=s,this._optimizeConstructedString(n),this},o.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this},o.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(o.encodeUtf8(t))},o.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(255&t>>8)+String.fromCharCode(255&t))},o.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(255&t>>16)+String.fromCharCode(255&t>>8)+String.fromCharCode(255&t))},o.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(255&t>>24)+String.fromCharCode(255&t>>16)+String.fromCharCode(255&t>>8)+String.fromCharCode(255&t))},o.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(255&t)+String.fromCharCode(255&t>>8))},o.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(255&t)+String.fromCharCode(255&t>>8)+String.fromCharCode(255&t>>16))},o.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(255&t)+String.fromCharCode(255&t>>8)+String.fromCharCode(255&t>>16)+String.fromCharCode(255&t>>24))},o.ByteStringBuffer.prototype.putInt=function(a,e){E(e);var n="";do e-=8,n+=String.fromCharCode(255&a>>e);while(0<e);return this.putBytes(n)},o.ByteStringBuffer.prototype.putSignedInt=function(a,r){return 0>a&&(a+=2<<r-1),this.putInt(a,r)},o.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())},o.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},o.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t},o.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t},o.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t},o.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t},o.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t},o.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t},o.ByteStringBuffer.prototype.getInt=function(a){E(a);var r=0;do r=(r<<8)+this.data.charCodeAt(this.read++),a-=8;while(0<a);return r},o.ByteStringBuffer.prototype.getSignedInt=function(a){var e=this.getInt(a),n=2<<a-2;return e>=n&&(e-=n<<1),e},o.ByteStringBuffer.prototype.getBytes=function(a){var r;return a?(a=Math.min(this.length(),a),r=this.data.slice(this.read,this.read+a),this.read+=a):0===a?r="":(r=0===this.read?this.data:this.data.slice(this.read),this.clear()),r},o.ByteStringBuffer.prototype.bytes=function(t){return void 0===t?this.data.slice(this.read):this.data.slice(this.read,this.read+t)},o.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)},o.ByteStringBuffer.prototype.setAt=function(a,e){return this.data=this.data.substr(0,this.read+a)+String.fromCharCode(e)+this.data.substr(this.read+a+1),this},o.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},o.ByteStringBuffer.prototype.copy=function(){var t=o.createBuffer(this.data);return t.read=this.read,t},o.ByteStringBuffer.prototype.compact=function(){return 0<this.read&&(this.data=this.data.slice(this.read),this.read=0),this},o.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},o.ByteStringBuffer.prototype.truncate=function(a){var e=Math.max(0,this.length()-a);return this.data=this.data.substr(this.read,e),this.read=0,this},o.ByteStringBuffer.prototype.toHex=function(){for(var a,n="",s=this.read;s<this.data.length;++s)a=this.data.charCodeAt(s),16>a&&(n+="0"),n+=a.toString(16);return n},o.ByteStringBuffer.prototype.toString=function(){return o.decodeUtf8(this.bytes())},o.DataBuffer=t,o.DataBuffer.prototype.length=function(){return this.write-this.read},o.DataBuffer.prototype.isEmpty=function(){return 0>=this.length()},o.DataBuffer.prototype.accommodate=function(n,e){if(this.length()>=n)return this;e=Math.max(e||this.growSize,n);var s=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),r=new Uint8Array(this.length()+e);return r.set(s),this.data=new DataView(r.buffer),this},o.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this},o.DataBuffer.prototype.fillWithByte=function(a,e){this.accommodate(e);for(var t=0;t<e;++t)this.data.setUint8(a);return this},o.DataBuffer.prototype.putBytes=function(s,c){if(o.isArrayBufferView(s)){var d=new Uint8Array(s.buffer,s.byteOffset,s.byteLength),l=d.byteLength-d.byteOffset;this.accommodate(l);var a=new Uint8Array(this.data.buffer,this.write);return a.set(d),this.write+=l,this}if(o.isArrayBuffer(s)){var d=new Uint8Array(s);this.accommodate(d.byteLength);var a=new Uint8Array(this.data.buffer);return a.set(d,this.write),this.write+=d.byteLength,this}if(s instanceof o.DataBuffer||"object"==typeof s&&"number"==typeof s.read&&"number"==typeof s.write&&o.isArrayBufferView(s.data)){var d=new Uint8Array(s.data.byteLength,s.read,s.length());this.accommodate(d.byteLength);var a=new Uint8Array(s.data.byteLength,this.write);return a.set(d),this.write+=d.byteLength,this}if(s instanceof o.ByteStringBuffer&&(s=s.data,c="binary"),c=c||"binary","string"==typeof s){var p;if("hex"===c)return this.accommodate(Math.ceil(s.length/2)),p=new Uint8Array(this.data.buffer,this.write),this.write+=o.binary.hex.decode(s,p,this.write),this;if("base64"===c)return this.accommodate(3*Math.ceil(s.length/4)),p=new Uint8Array(this.data.buffer,this.write),this.write+=o.binary.base64.decode(s,p,this.write),this;if("utf8"===c&&(s=o.encodeUtf8(s),c="binary"),"binary"===c||"raw"===c)return this.accommodate(s.length),p=new Uint8Array(this.data.buffer,this.write),this.write+=o.binary.raw.decode(p),this;if("utf16"===c)return this.accommodate(2*s.length),p=new Uint16Array(this.data.buffer,this.write),this.write+=o.text.utf16.encode(p),this;throw new Error("Invalid encoding: "+c)}throw Error("Invalid parameter: "+s)},o.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this},o.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")},o.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this},o.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,65535&t>>8),this.data.setInt8(this.write,255&t>>16),this.write+=3,this},o.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this},o.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this},o.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,255&t>>16),this.data.setInt16(this.write,65535&t>>8,!0),this.write+=3,this},o.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this},o.DataBuffer.prototype.putInt=function(a,e){E(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,255&a>>e);while(0<e);return this},o.DataBuffer.prototype.putSignedInt=function(a,r){return E(r),this.accommodate(r/8),0>a&&(a+=2<<r-1),this.putInt(a,r)},o.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},o.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t},o.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t},o.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t},o.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t},o.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t},o.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t},o.DataBuffer.prototype.getInt=function(a){E(a);var r=0;do r=(r<<8)+this.data.getInt8(this.read++),a-=8;while(0<a);return r},o.DataBuffer.prototype.getSignedInt=function(a){var e=this.getInt(a),n=2<<a-2;return e>=n&&(e-=n<<1),e},o.DataBuffer.prototype.getBytes=function(a){var r;return a?(a=Math.min(this.length(),a),r=this.data.slice(this.read,this.read+a),this.read+=a):0===a?r="":(r=0===this.read?this.data:this.data.slice(this.read),this.clear()),r},o.DataBuffer.prototype.bytes=function(t){return void 0===t?this.data.slice(this.read):this.data.slice(this.read,this.read+t)},o.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)},o.DataBuffer.prototype.setAt=function(a,e){return this.data.setUint8(a,e),this},o.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},o.DataBuffer.prototype.copy=function(){return new o.DataBuffer(this)},o.DataBuffer.prototype.compact=function(){if(0<this.read){var a=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(a.byteLength);e.set(a),this.data=new DataView(e),this.write-=this.read,this.read=0}return this},o.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},o.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this},o.DataBuffer.prototype.toHex=function(){for(var a,n="",s=this.read;s<this.data.byteLength;++s)a=this.data.getUint8(s),16>a&&(n+="0"),n+=a.toString(16);return n},o.DataBuffer.prototype.toString=function(a){var r=new Uint8Array(this.data,this.read,this.length());if("binary"===(a=a||"utf8")||"raw"===a)return o.binary.raw.encode(r);if("hex"===a)return o.binary.hex.encode(r);if("base64"===a)return o.binary.base64.encode(r);if("utf8"===a)return o.text.utf8.decode(r);if("utf16"===a)return o.text.utf16.decode(r);throw new Error("Invalid encoding: "+a)},o.createBuffer=function(a,r){return r=r||"raw",void 0!==a&&"utf8"===r&&(a=o.encodeUtf8(a)),new o.ByteBuffer(a)},o.fillString=function(a,n){for(var s="";0<n;)1&n&&(s+=a),0<(n>>>=1)&&(a+=a);return s},o.xorBytes=function(c,e,t){for(var d="",l="",p="",u=0,g=0;0<t;--t,++u)l=c.charCodeAt(u)^e.charCodeAt(u),10<=g&&(d+=p,p="",g=0),p+=String.fromCharCode(l),++g;return d+=p},o.hexToBytes=function(a){var e="",n=0;for(!0&a.length&&(n=1,e+=String.fromCharCode(parseInt(a[0],16)));n<a.length;n+=2)e+=String.fromCharCode(parseInt(a.substr(n,2),16));return e},o.bytesToHex=function(t){return o.createBuffer(t).toHex()},o.int32ToBytes=function(t){return String.fromCharCode(255&t>>24)+String.fromCharCode(255&t>>16)+String.fromCharCode(255&t>>8)+String.fromCharCode(255&t)};var S=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];o.encode64=function(c,e){for(var t,d,l,p="",u="",g=0;g<c.length;)t=c.charCodeAt(g++),d=c.charCodeAt(g++),l=c.charCodeAt(g++),p+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(t>>2),p+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt((3&t)<<4|d>>4),isNaN(d)?p+="==":(p+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt((15&d)<<2|l>>6),p+=isNaN(l)?"=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(63&l)),e&&p.length>e&&(u+=p.substr(0,e)+"\r\n",p=p.substr(e));return u+=p},o.decode64=function(o){o=o.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var c,d,l,p,u="",g=0;g<o.length;)c=S[o.charCodeAt(g++)-43],d=S[o.charCodeAt(g++)-43],l=S[o.charCodeAt(g++)-43],p=S[o.charCodeAt(g++)-43],u+=String.fromCharCode(c<<2|d>>4),64!==l&&(u+=String.fromCharCode((15&d)<<4|l>>2),64!==p&&(u+=String.fromCharCode((3&l)<<6|p)));return u},o.encodeUtf8=function(t){return unescape(encodeURIComponent(t))},o.decodeUtf8=function(t){return decodeURIComponent(escape(t))},o.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:n.encode,decode:n.decode}},o.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)},o.binary.raw.decode=function(s,e,t){var o=e;o||(o=new Uint8Array(s.length)),t=t||0;for(var c=t,d=0;d<s.length;++d)o[c++]=s.charCodeAt(d);return e?c-t:o},o.binary.hex.encode=o.bytesToHex,o.binary.hex.decode=function(s,e,t){var o=e;o||(o=new Uint8Array(Math.ceil(s.length/2))),t=t||0;var c=0,d=t;for(1&s.length&&(c=1,o[d++]=parseInt(s[0],16));c<s.length;c+=2)o[d++]=parseInt(s.substr(c,2),16);return e?d-t:o},o.binary.base64.encode=function(c,e){for(var t,d,l,p="",u="",g=0;g<c.byteLength;)t=c[g++],d=c[g++],l=c[g++],p+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(t>>2),p+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt((3&t)<<4|d>>4),isNaN(d)?p+="==":(p+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt((15&d)<<2|l>>6),p+=isNaN(l)?"=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(63&l)),e&&p.length>e&&(u+=p.substr(0,e)+"\r\n",p=p.substr(e));return u+=p},o.binary.base64.decode=function(d,l,t){var p=l;p||(p=new Uint8Array(3*Math.ceil(d.length/4))),d=d.replace(/[^A-Za-z0-9\+\/\=]/g,""),t=t||0;for(var g,y,h,f,m=0,C=t;m<d.length;)g=S[d.charCodeAt(m++)-43],y=S[d.charCodeAt(m++)-43],h=S[d.charCodeAt(m++)-43],f=S[d.charCodeAt(m++)-43],p[C++]=g<<2|y>>4,64!==h&&(p[C++]=(15&y)<<4|h>>2,64!==f&&(p[C++]=(3&h)<<6|f));return l?C-t:p.subarray(0,C)},o.binary.base58.encode=function(a,e){return o.binary.baseN.encode(a,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",e)},o.binary.base58.decode=function(a,e){return o.binary.baseN.decode(a,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",e)},o.text={utf8:{},utf16:{}},o.text.utf8.encode=function(s,c,t){s=o.encodeUtf8(s);var d=c;d||(d=new Uint8Array(s.length)),t=t||0;for(var l=t,p=0;p<s.length;++p)d[l++]=s.charCodeAt(p);return c?l-t:d},o.text.utf8.decode=function(t){return o.decodeUtf8(String.fromCharCode.apply(null,t))},o.text.utf16.encode=function(c,e,t){var d=e;d||(d=new Uint8Array(2*c.length));var l=new Uint16Array(d.buffer);t=t||0;for(var n=t,p=t,u=0;u<c.length;++u)l[p++]=c.charCodeAt(u),n+=2;return e?n-t:d},o.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))},o.deflate=function(n,e,s){if(e=o.decode64(n.deflate(o.encode64(e)).rval),s){var r=2;32&e.charCodeAt(1)&&(r=6),e=e.substring(r,e.length-4)}return e},o.inflate=function(r,e){var t=r.inflate(o.encode64(e)).rval;return null===t?null:o.decode64(t)};var s=function(s,e,t){if(!s)throw new Error("WebStorage not available.");var i;if(null===t?i=s.removeItem(e):(t=o.encode64(JSON.stringify(t)),i=s.setItem(e,t)),void 0!==i&&!0!==i.rval){var c=new Error(i.error.message);throw c.id=i.error.id,c.name=i.error.name,c}},c=function(n,e){if(!n)throw new Error("WebStorage not available.");var t=n.getItem(e);if(n.init)if(null===t.rval){if(t.error){var s=new Error(t.error.message);throw s.id=t.error.id,s.name=t.error.name,s}t=null}else t=t.rval;return null!==t&&(t=JSON.parse(o.decode64(t))),t},i=function(i,e,t,r){var a=c(i,e);null===a&&(a={}),a[t]=r,s(i,e,a)},d=function(n,e,t){var r=c(n,e);return null!==r&&(r=t in r?r[t]:null),r},l=function(o,e,t){var r=c(o,e);if(null!==r&&t in r){delete r[t];var d=!0;for(var l in r){d=!1;break}d&&(r=null),s(o,e,r)}},g=function(a,e){s(a,e,null)},y=function(c,e,t){var d=null;void 0===t&&(t=["web","flash"]);var l,p=!1,u=null;for(var g in t){l=t[g];try{if("flash"===l||"both"===l){if(null===e[0])throw new Error("Flash local storage not available.");d=c.apply(this,e),p="flash"===l}"web"!==l&&"both"!==l||(e[0]=localStorage,d=c.apply(this,e),p=!0)}catch(t){u=t}if(p)break}if(!p)throw u;return d};o.setItem=function(s,e,t,r,a){y(i,arguments,a)},o.getItem=function(n,e,t,r){return y(d,arguments,r)},o.removeItem=function(n,e,t,r){y(l,arguments,r)},o.clearItems=function(a,e,t){y(g,arguments,t)},o.parseUrl=function(n){var e=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;e.lastIndex=0;var t=e.exec(n),r=null===t?null:{full:n,scheme:t[1],host:t[2],port:t[3],path:t[4]};return r&&(r.fullHost=r.host,r.port?80!==r.port&&"http"===r.scheme?r.fullHost+=":"+r.port:443!==r.port&&"https"===r.scheme&&(r.fullHost+=":"+r.port):"http"===r.scheme?r.port=80:"https"===r.scheme&&(r.port=443),r.full=r.scheme+"://"+r.fullHost),r};var h=null;o.getQueryVariables=function(a){var e,n=function(o){for(var e={},t=o.split("&"),r=0;r<t.length;r++){var c,d,l=t[r].indexOf("=");0<l?(c=t[r].substring(0,l),d=t[r].substring(l+1)):(c=t[r],d=null),c in e||(e[c]=[]),c in Object.prototype||null===d||e[c].push(unescape(d))}return e};return void 0===a?(null===h&&(h="undefined"!=typeof window&&window.location&&window.location.search?n(window.location.search.substring(1)):{}),e=h):e=n(a),e},o.parseFragment=function(s){var e=s,i="",c=s.indexOf("?");0<c&&(e=s.substring(0,c),i=s.substring(c+1));var a=e.split("/");return 0<a.length&&""===a[0]&&a.shift(),{pathString:e,queryString:i,path:a,query:""===i?{}:o.getQueryVariables(i)}},o.makeRequest=function(a){var n=o.parseFragment(a),s={path:n.pathString,query:n.queryString,getPath:function(t){return void 0===t?n.path:n.path[t]},getQuery:function(t,e){var r;return void 0===t?r=n.query:(r=n.query[t])&&void 0!==e&&(r=r[e]),r},getQueryLast:function(r,e){var t=s.getQuery(r);return t?t[t.length-1]:e}};return s},o.makeLink=function(n,s,t){n=jQuery.isArray(n)?n.join("/"):n;var i=jQuery.param(s||{});return t=t||"",n+(0<i.length?"?"+i:"")+(0<t.length?"#"+t:"")},o.setPath=function(o,c,t){if("object"==typeof o&&null!==o)for(var r,d=0,l=c.length;d<l;)if(r=c[d++],d==l)o[r]=t;else{var n=r in o;(!n||n&&"object"!=typeof o[r]||n&&null===o[r])&&(o[r]={}),o=o[r]}},o.getPath=function(o,c,t){for(var r,d=0,l=c.length,n=!0;n&&d<l&&"object"==typeof o&&null!==o;)r=c[d++],n=r in o,n&&(o=o[r]);return n?o:t},o.deletePath=function(s,i){if("object"==typeof s&&null!==s)for(var t,o=0,c=i.length;o<c;)if(t=i[o++],o==c)delete s[t];else{if(!(t in s)||"object"!=typeof s[t]||null===s[t])break;s=s[t]}},o.isEmpty=function(a){for(var e in a)if(a.hasOwnProperty(e))return!1;return!0},o.format=function(c){for(var e,d,l=/%./g,a=0,p=[],i=0;e=l.exec(c);){d=c.substring(i,l.lastIndex-2),0<d.length&&p.push(d),i=l.lastIndex;var u=e[0][1];"s"===u||"o"===u?a<arguments.length?p.push(arguments[1+a++]):p.push("<?>"):"%"===u?p.push("%"):p.push("<%"+u+"?>")}return p.push(c.substring(i)),p.join("")},o.formatNumber=function(d,e,p,r){var a=d,g=isNaN(e=Math.abs(e))?2:e,i=void 0===p?",":p,s=void 0===r?".":r,o=0>a?"-":"",c=parseInt(a=Math.abs(+a||0).toFixed(g),10)+"",u=3<c.length?c.length%3:0;return o+(u?c.substr(0,u)+s:"")+c.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+s)+(g?i+Math.abs(a-c).toFixed(g).slice(2):"")},o.formatSize=function(t){return t=1073741824<=t?o.formatNumber(t/1073741824,2,".","")+" GiB":1048576<=t?o.formatNumber(t/1048576,2,".","")+" MiB":1024<=t?o.formatNumber(t/1024,0)+" KiB":o.formatNumber(t,0)+" bytes"},o.bytesFromIP=function(t){return-1===t.indexOf(".")?-1===t.indexOf(":")?null:o.bytesFromIPv6(t):o.bytesFromIPv4(t)},o.bytesFromIPv4=function(n){if(n=n.split("."),4!==n.length)return null;for(var s,i=o.createBuffer(),t=0;t<n.length;++t){if(s=parseInt(n[t],10),isNaN(s))return null;i.putByte(s)}return i.getBytes()},o.bytesFromIPv6=function(s){var c=0;s=s.split(":").filter(function(t){return 0===t.length&&++c,!0});for(var d=2*(8-s.length+c),l=o.createBuffer(),a=0;8>a;++a)if(s[a]&&0!==s[a].length){var p=o.hexToBytes(s[a]);2>p.length&&l.putByte(0),l.putBytes(p)}else l.fillWithByte(0,d),d=0;return l.getBytes()},o.bytesToIP=function(t){return 4===t.length?o.bytesToIPv4(t):16===t.length?o.bytesToIPv6(t):null},o.bytesToIPv4=function(a){if(4!==a.length)return null;for(var e=[],t=0;t<a.length;++t)e.push(a.charCodeAt(t));return e.join(".")},o.bytesToIPv6=function(c){if(16!==c.length)return null;for(var e=[],t=[],r=0,d=0;d<c.length;d+=2){for(var l=o.bytesToHex(c[d]+c[d+1]);"0"===l[0]&&"0"!==l;)l=l.substr(1);if("0"===l){var p=t[t.length-1],s=e.length;p&&s===p.end+1?(p.end=s,p.end-p.start>t[r].end-t[r].start&&(r=t.length-1)):t.push({start:s,end:s})}e.push(l)}if(0<t.length){var g=t[r];0<g.end-g.start&&(e.splice(g.start,g.end-g.start+1,""),0===g.start&&e.unshift(""),7===g.end&&e.push(""))}return e.join(":")},o.estimateCores=function(s,c){function d(n,e,s){if(0===e){var t=Math.floor(n.reduce(function(a,e){return a+e},0)/n.length);return o.cores=Math.max(1,t),URL.revokeObjectURL(p),c(null,o.cores)}r(s,function(r,t){n.push(l(s,t)),d(n,e-1,s)})}function r(o,e){for(var t,c=[],r=[],a=0;a<o;++a)t=new Worker(p),t.addEventListener("message",function(t){if(r.push(t.data),r.length===o){for(var a=0;a<o;++a)c[a].terminate();e(null,r)}}),c.push(t);for(var a=0;a<o;++a)c[a].postMessage(a)}function l(c,e){for(var t=[],r=0;r<c;++r)for(var d=e[r],n=t[r]=[],i=0;i<c;++i)if(r!==i){var l=e[i];(d.st>l.st&&d.st<l.et||l.st>d.st&&l.st<d.et)&&n.push(i)}return t.reduce(function(a,e){return Math.max(a,e.length)},0)}if("function"==typeof s&&(c=s,s={}),s=s||{},"cores"in o&&!s.update)return c(null,o.cores);if("undefined"!=typeof navigator&&"hardwareConcurrency"in navigator&&0<navigator.hardwareConcurrency)return o.cores=navigator.hardwareConcurrency,c(null,o.cores);if("undefined"==typeof Worker)return o.cores=1,c(null,o.cores);if("undefined"==typeof Blob)return o.cores=2,c(null,o.cores);var p=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(){for(var e=Date.now(),t=e+4;Date.now()<t;);self.postMessage({st:e,et:t})})}.toString(),")()"],{type:"application/javascript"}));d([],5,16)}}).call(e,u(36))},function(d,e,t){var g=t(0);t(5),t(23),t(24),t(1),function(){return g.random&&g.random.getBytes?void(d.exports=g.random):void!function(e){function t(){var n=g.prng.create(a);return n.getBytes=function(e,t){return n.generate(e,t)},n.getBytesSync=function(e){return n.generate(e)},n}var a={},r=[,,,,],n=g.util.createBuffer();a.formatKey=function(a){var r=g.util.createBuffer(a);return a=[,,,,],a[0]=r.getInt32(),a[1]=r.getInt32(),a[2]=r.getInt32(),a[3]=r.getInt32(),g.aes._expandKey(a,!1)},a.formatSeed=function(a){var r=g.util.createBuffer(a);return a=[,,,,],a[0]=r.getInt32(),a[1]=r.getInt32(),a[2]=r.getInt32(),a[3]=r.getInt32(),a},a.cipher=function(a,e){return g.aes._updateBlock(a,e,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},a.increment=function(t){return++t[3],t},a.md=g.md.sha256;var s=t(),i=null,o=g.util.globalScope,u=o.crypto||o.msCrypto;if(u&&u.getRandomValues&&(i=function(t){return u.getRandomValues(t)}),g.options.usePureJavaScript||!g.util.isNodejs&&!i){if("undefined"==typeof window||window.document,s.collectInt(+new Date,32),"undefined"!=typeof navigator){var l="";for(var y in navigator)try{"string"==typeof navigator[y]&&(l+=navigator[y])}catch(t){}s.collect(l),l=null}e&&(e().mousemove(function(t){s.collectInt(t.clientX,16),s.collectInt(t.clientY,16)}),e().keypress(function(t){s.collectInt(t.charCode,8)}))}if(g.random)for(var y in s)g.random[y]=s[y];else g.random=s;g.random.createInstance=t,d.exports=g.random}("undefined"==typeof jQuery?null:jQuery)}()},function(d,e,t){function B(n,e,t){if(t>e){var r=new Error("Too few bytes to parse DER.");throw r.available=n.length(),r.remaining=e,r.requested=t,r}}function a(s,e,o,r){var i;B(s,e,2);var N=s.getByte();e--;var u=192&N,l=31&N;i=s.length();var p=n(s,e);if(e-=i-s.length(),void 0!==p&&p>e){if(r.strict){var R=new Error("Too few bytes to read ASN.1 value.");throw R.available=s.length(),R.remaining=e,R.requested=p,R}p=e}var h,L,_=32==(32&N);if(_)if(h=[],void 0===p)for(;;){if(B(s,e,2),s.bytes(2)===String.fromCharCode(0,0)){s.getBytes(2),e-=2;break}i=s.length(),h.push(a(s,e,o+1,r)),e-=i-s.length()}else for(;0<p;)i=s.length(),h.push(a(s,p,o+1,r)),e-=i-s.length(),p-=i-s.length();if(void 0===h&&u===A.Class.UNIVERSAL&&l===A.Type.BITSTRING&&(L=s.bytes(p)),void 0===h&&r.decodeBitStrings&&u===A.Class.UNIVERSAL&&l===A.Type.BITSTRING&&1<p){var g=s.read,v=e,m=0;if(l===A.Type.BITSTRING&&(B(s,e,1),m=s.getByte(),e--),0===m)try{i=s.length();var k={verbose:r.verbose,strict:!0,decodeBitStrings:!0},E=a(s,e,o+1,k),S=i-s.length();e-=S,l==A.Type.BITSTRING&&S++;var U=E.tagClass;S!==p||U!==A.Class.UNIVERSAL&&U!==A.Class.CONTEXT_SPECIFIC||(h=[E])}catch(t){}void 0===h&&(s.read=g,e=v)}if(void 0===h){if(void 0===p){if(r.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");p=e}if(l===A.Type.BMPSTRING)for(h="";0<p;p-=2)B(s,e,2),h+=String.fromCharCode(s.getInt16()),e-=2;else h=s.getBytes(p)}var I=void 0===L?null:{bitStringContents:L};return A.create(u,l,_,h,I)}var l=t(0);t(1),t(6);var A=d.exports=l.asn1=l.asn1||{};A.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},A.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},A.create=function(s,e,t,r,i){if(l.util.isArray(r)){for(var n=[],o=0;o<r.length;++o)void 0!==r[o]&&n.push(r[o]);r=n}var d={tagClass:s,type:e,constructed:t,composed:t||l.util.isArray(r),value:r};return i&&"bitStringContents"in i&&(d.bitStringContents=i.bitStringContents,d.original=A.copy(d)),d},A.copy=function(n,e){var t;if(l.util.isArray(n)){t=[];for(var s=0;s<n.length;++s)t.push(A.copy(n[s],e));return t}return"string"==typeof n?n:(t={tagClass:n.tagClass,type:n.type,constructed:n.constructed,composed:n.composed,value:A.copy(n.value,e)},e&&!e.excludeBitStringContents&&(t.bitStringContents=n.bitStringContents),t)},A.equals=function(s,e,t){if(l.util.isArray(s)){if(!l.util.isArray(e))return!1;if(s.length!==e.length)return!1;for(var r=0;r<s.length;++r)if(!A.equals(s[r],e[r]))return!1;return!0}if(typeof s!=typeof e)return!1;if("string"==typeof s)return s===e;var i=s.tagClass===e.tagClass&&s.type===e.type&&s.constructed===e.constructed&&s.composed===e.composed&&A.equals(s.value,e.value);return t&&t.includeBitStringContents&&(i=i&&s.bitStringContents===e.bitStringContents),i},A.getBerValueLength=function(a){var e=a.getByte();if(128!==e)return 128&e?a.getInt((127&e)<<3):e};var n=function(a,e){var s=a.getByte();if(e--,128!==s){var r;if(128&s){var o=127&s;B(a,e,o),r=a.getInt(o<<3)}else r=s;if(0>r)throw new Error("Negative length: "+r);return r}};A.fromDer=function(r,n){return void 0===n&&(n={strict:!0,decodeBitStrings:!0}),"boolean"==typeof n&&(n={strict:n,decodeBitStrings:!0}),"strict"in n||(n.strict=!0),"decodeBitStrings"in n||(n.decodeBitStrings=!0),"string"==typeof r&&(r=l.util.createBuffer(r)),a(r,r.length(),0,n)},A.toDer=function(s){var e=l.util.createBuffer(),t=s.tagClass|s.type,i=l.util.createBuffer(),a=!1;if("bitStringContents"in s&&(a=!0,s.original&&(a=A.equals(s,s.original))),a)i.putBytes(s.bitStringContents);else if(s.composed){s.constructed?t|=32:i.putByte(0);for(var d=0;d<s.value.length;++d)void 0!==s.value[d]&&i.putBuffer(A.toDer(s.value[d]))}else if(s.type===A.Type.BMPSTRING)for(var d=0;d<s.value.length;++d)i.putInt16(s.value.charCodeAt(d));else s.type===A.Type.INTEGER&&1<s.value.length&&(0===s.value.charCodeAt(0)&&0==(128&s.value.charCodeAt(1))||255===s.value.charCodeAt(0)&&128==(128&s.value.charCodeAt(1)))?i.putBytes(s.value.substr(1)):i.putBytes(s.value);if(e.putByte(t),127>=i.length())e.putByte(127&i.length());else{var p=i.length(),g="";do g+=String.fromCharCode(255&p),p>>>=8;while(0<p);e.putByte(128|g.length);for(var d=g.length-1;0<=d;--d)e.putByte(g.charCodeAt(d))}return e.putBuffer(i),e},A.oidToDer=function(i){var e=i.split("."),t=l.util.createBuffer();t.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var r,d,p,g,y=2;y<e.length;++y){r=!0,d=[],p=parseInt(e[y],10);do g=127&p,p>>>=7,r||(g|=128),d.push(g),r=!1;while(0<p);for(var h=d.length-1;0<=h;--h)t.putByte(d[h])}return t},A.derToOid=function(n){var s;"string"==typeof n&&(n=l.util.createBuffer(n));var i=n.getByte();s=Math.floor(i/40)+"."+i%40;for(var o=0;0<n.length();)i=n.getByte(),o<<=7,128&i?o+=127&i:(s+="."+(o+i),o=0);return s},A.utcTimeToDate=function(d){var e=new Date,t=parseInt(d.substr(0,2),10);t=50<=t?1900+t:2e3+t;var g=parseInt(d.substr(2,2),10)-1,a=parseInt(d.substr(4,2),10),n=parseInt(d.substr(6,2),10),i=parseInt(d.substr(8,2),10),s=0;if(11<d.length){var y=d.charAt(10),h=10;"+"!==y&&"-"!==y&&(s=parseInt(d.substr(10,2),10),h+=2)}if(e.setUTCFullYear(t,g,a),e.setUTCHours(n,i,s,0),h&&("+"===(y=d.charAt(h))||"-"===y)){var m=parseInt(d.substr(h+1,2),10),l=parseInt(d.substr(h+4,2),10),p=60*m+l;p*=6e4,"+"===y?e.setTime(+e-p):e.setTime(+e+p)}return e},A.generalizedTimeToDate=function(d){var e=new Date,t=parseInt(d.substr(0,4),10),r=parseInt(d.substr(4,2),10)-1,a=parseInt(d.substr(6,2),10),n=parseInt(d.substr(8,2),10),i=parseInt(d.substr(10,2),10),s=parseInt(d.substr(12,2),10),o=0,g=0,y=!1;"Z"===d.charAt(d.length-1)&&(y=!0);var h=d.length-5,p=d.charAt(h);return("+"===p||"-"===p)&&(g=60*parseInt(d.substr(h+1,2),10)+parseInt(d.substr(h+4,2),10),g*=6e4,"+"===p&&(g*=-1),y=!0),"."===d.charAt(14)&&(o=1e3*parseFloat(d.substr(14),10)),y?(e.setUTCFullYear(t,r,a),e.setUTCHours(n,i,s,o),e.setTime(+e+g)):(e.setFullYear(t,r,a),e.setHours(n,i,s,o)),e},A.dateToUtcTime=function(n){if("string"==typeof n)return n;var e="",s=[];s.push((""+n.getUTCFullYear()).substr(2)),s.push(""+(n.getUTCMonth()+1)),s.push(""+n.getUTCDate()),s.push(""+n.getUTCHours()),s.push(""+n.getUTCMinutes()),s.push(""+n.getUTCSeconds());for(var r=0;r<s.length;++r)2>s[r].length&&(e+="0"),e+=s[r];return e+="Z"},A.dateToGeneralizedTime=function(n){if("string"==typeof n)return n;var e="",s=[];s.push(""+n.getUTCFullYear()),s.push(""+(n.getUTCMonth()+1)),s.push(""+n.getUTCDate()),s.push(""+n.getUTCHours()),s.push(""+n.getUTCMinutes()),s.push(""+n.getUTCSeconds());for(var r=0;r<s.length;++r)2>s[r].length&&(e+="0"),e+=s[r];return e+="Z"},A.integerToDer=function(a){var e=l.util.createBuffer();if(-128<=a&&128>a)return e.putSignedInt(a,8);if(-32768<=a&&32768>a)return e.putSignedInt(a,16);if(-8388608<=a&&8388608>a)return e.putSignedInt(a,24);if(-2147483648<=a&&2147483648>a)return e.putSignedInt(a,32);var t=new Error("Integer too large; max is 32-bits.");throw t.integer=a,t},A.derToInteger=function(a){"string"==typeof a&&(a=l.util.createBuffer(a));var r=8*a.length();if(32<r)throw new Error("Integer too large; max is 32-bits.");return a.getSignedInt(r)},A.validate=function(s,e,t,r){var a=!1;if(s.tagClass!==e.tagClass&&void 0!==e.tagClass||s.type!==e.type&&void 0!==e.type)r&&(s.tagClass!==e.tagClass&&r.push("["+e.name+"] Expected tag class \""+e.tagClass+"\", got \""+s.tagClass+"\""),s.type!==e.type&&r.push("["+e.name+"] Expected type \""+e.type+"\", got \""+s.type+"\""));else if(s.constructed===e.constructed||void 0===e.constructed){if(a=!0,e.value&&l.util.isArray(e.value))for(var i=0,d=0;a&&d<e.value.length;++d)a=e.value[d].optional||!1,s.value[i]&&(a=A.validate(s.value[i],e.value[d],t,r),a?++i:e.value[d].optional&&(a=!0)),!a&&r&&r.push("["+e.name+"] Tag class \""+e.tagClass+"\", type \""+e.type+"\" expected value length \""+e.value.length+"\", got \""+s.value.length+"\"");if(a&&t&&(e.capture&&(t[e.capture]=s.value),e.captureAsn1&&(t[e.captureAsn1]=s),e.captureBitStringContents&&"bitStringContents"in s&&(t[e.captureBitStringContents]=s.bitStringContents),e.captureBitStringValue&&"bitStringContents"in s))if(2>s.bitStringContents.length)t[e.captureBitStringValue]="";else{var p=s.bitStringContents.charCodeAt(0);if(0!==p)throw new Error("captureBitStringValue only supported for zero unused bits");t[e.captureBitStringValue]=s.bitStringContents.slice(1)}}else r&&r.push("["+e.name+"] Expected constructed \""+e.constructed+"\", got \""+s.constructed+"\"");return a};var r=/[^\\u0000-\\u00ff]/;A.prettyPrint=function(s,e,i){var c="";e=e||0,i=i||2,0<e&&(c+="\n");for(var d="",g=0;g<e*i;++g)d+=" ";switch(c+=d+"Tag: ",s.tagClass){case A.Class.UNIVERSAL:c+="Universal:";break;case A.Class.APPLICATION:c+="Application:";break;case A.Class.CONTEXT_SPECIFIC:c+="Context-Specific:";break;case A.Class.PRIVATE:c+="Private:";}if(s.tagClass===A.Class.UNIVERSAL)switch(c+=s.type,s.type){case A.Type.NONE:c+=" (None)";break;case A.Type.BOOLEAN:c+=" (Boolean)";break;case A.Type.INTEGER:c+=" (Integer)";break;case A.Type.BITSTRING:c+=" (Bit string)";break;case A.Type.OCTETSTRING:c+=" (Octet string)";break;case A.Type.NULL:c+=" (Null)";break;case A.Type.OID:c+=" (Object Identifier)";break;case A.Type.ODESC:c+=" (Object Descriptor)";break;case A.Type.EXTERNAL:c+=" (External or Instance of)";break;case A.Type.REAL:c+=" (Real)";break;case A.Type.ENUMERATED:c+=" (Enumerated)";break;case A.Type.EMBEDDED:c+=" (Embedded PDV)";break;case A.Type.UTF8:c+=" (UTF8)";break;case A.Type.ROID:c+=" (Relative Object Identifier)";break;case A.Type.SEQUENCE:c+=" (Sequence)";break;case A.Type.SET:c+=" (Set)";break;case A.Type.PRINTABLESTRING:c+=" (Printable String)";break;case A.Type.IA5String:c+=" (IA5String (ASCII))";break;case A.Type.UTCTIME:c+=" (UTC time)";break;case A.Type.GENERALIZEDTIME:c+=" (Generalized time)";break;case A.Type.BMPSTRING:c+=" (BMP String)";}else c+=s.type;if(c+="\n",c+=d+"Constructed: "+s.constructed+"\n",s.composed){for(var y=0,h="",g=0;g<s.value.length;++g)void 0!==s.value[g]&&(y+=1,h+=A.prettyPrint(s.value[g],e+1,i),g+1<s.value.length&&(h+=","));c+=d+"Sub values: "+y+h}else{if(c+=d+"Value: ",s.type===A.Type.OID){var m=A.derToOid(s.value);c+=m,l.pki&&l.pki.oids&&m in l.pki.oids&&(c+=" ("+l.pki.oids[m]+") ")}if(s.type===A.Type.INTEGER)try{c+=A.derToInteger(s.value)}catch(e){c+="0x"+l.util.bytesToHex(s.value)}else if(s.type!==A.Type.BITSTRING)s.type===A.Type.OCTETSTRING?(r.test(s.value)||(c+="("+s.value+") "),c+="0x"+l.util.bytesToHex(s.value)):s.type===A.Type.UTF8?c+=l.util.decodeUtf8(s.value):s.type===A.Type.PRINTABLESTRING||s.type===A.Type.IA5String?c+=s.value:r.test(s.value)?c+="0x"+l.util.bytesToHex(s.value):0===s.value.length?c+="[null]":c+=s.value;else if(c+=1<s.value.length?"0x"+l.util.bytesToHex(s.value.slice(1)):"(none)",0<s.value.length){var p=s.value.charCodeAt(0);1==p?c+=" (1 unused bit shown)":1<p&&(c+=" ("+p+" unused bits shown)")}}return c}},function(n,e,t){var r=t(0);n.exports=r.md=r.md||{},r.md.algorithms=r.md.algorithms||{}},function(g,e,t){function r(a,e){i.cipher.registerAlgorithm(a,function(){return new i.aes.Algorithm(a,e)})}function a(){E=!0,C=[0,1,2,4,8,16,32,64,128,27,54];for(var d=Array(256),e=0;128>e;++e)d[e]=e<<1,d[e+128]=283^e+128<<1;I=Array(256),B=Array(256),A=[,,,,],b=[,,,,];for(var e=0;4>e;++e)A[e]=Array(256),b[e]=Array(256);for(var l,p,u,h,f,m,S,T=0,N=0,e=0;256>e;++e){h=N^N<<1^N<<2^N<<3^N<<4,h=99^(h>>8^255&h),I[T]=h,B[h]=T,f=d[h],l=d[T],p=d[l],u=d[p],m=f<<24^h<<16^h<<8^h^f,S=(l^p^u)<<24^(T^u)<<16^(T^p^u)<<8^T^l^u;for(var R=0;4>R;++R)A[R][T]=m,b[R][h]=S,m=m<<24|m>>>8,S=S<<24|S>>>8;0==T?T=N=1:(T=l^d[d[d[l^u]]],N^=d[d[N]])}}function m(s,e){for(var t,p=s.slice(0),u=1,y=p.length,i=S*(y+6+1),h=y;h<i;++h)t=p[h-1],0==h%y?(t=I[255&t>>>16]<<24^I[255&t>>>8]<<16^I[255&t]<<8^I[t>>>24]^C[u]<<24,u++):6<y&&4==h%y&&(t=I[t>>>24]<<24^I[255&t>>>16]<<16^I[255&t>>>8]<<8^I[255&t]),p[h]=p[h-y]^t;if(e){var T,B=b[0],f=b[1],d=b[2],g=b[3],A=p.slice(0);i=p.length;for(var h=0,m=i-S;h<i;h+=S,m-=S)if(0===h||h===i-S)A[h]=p[m],A[h+1]=p[m+3],A[h+2]=p[m+2],A[h+3]=p[m+1];else for(var v=0;v<S;++v)T=p[m+v],A[h+(3&-v)]=B[I[T>>>24]]^f[I[255&T>>>16]]^d[I[255&T>>>8]]^g[I[255&T]];p=A}return p}function n(l,e,t,r){var a,u,h,f,N,R=l.length/4-1;r?(a=b[0],u=b[1],h=b[2],f=b[3],N=B):(a=A[0],u=A[1],h=A[2],f=A[3],N=I);var p,L,_,k,U,D,P;p=e[0]^l[0],L=e[r?3:1]^l[1],_=e[2]^l[2],k=e[r?1:3]^l[3];for(var V=3,O=1;O<R;++O)U=a[p>>>24]^u[255&L>>>16]^h[255&_>>>8]^f[255&k]^l[++V],D=a[L>>>24]^u[255&_>>>16]^h[255&k>>>8]^f[255&p]^l[++V],P=a[_>>>24]^u[255&k>>>16]^h[255&p>>>8]^f[255&L]^l[++V],k=a[k>>>24]^u[255&p>>>16]^h[255&L>>>8]^f[255&_]^l[++V],p=U,L=D,_=P;t[0]=N[p>>>24]<<24^N[255&L>>>16]<<16^N[255&_>>>8]<<8^N[255&k]^l[++V],t[r?3:1]=N[L>>>24]<<24^N[255&_>>>16]<<16^N[255&k>>>8]<<8^N[255&p]^l[++V],t[2]=N[_>>>24]<<24^N[255&k>>>16]<<16^N[255&p>>>8]<<8^N[255&L]^l[++V],t[r?1:3]=N[k>>>24]<<24^N[255&p>>>16]<<16^N[255&L>>>8]<<8^N[255&_]^l[++V]}function s(s){s=s||{};var o,c=(s.mode||"CBC").toUpperCase(),r="AES-"+c;o=s.decrypt?i.cipher.createDecipher(r,s.key):i.cipher.createCipher(r,s.key);var d=o.start;return o.start=function(t,e){var n=null;e instanceof i.util.ByteBuffer&&(n=e,e={}),e=e||{},e.output=n,e.iv=t,d.call(o,e)},o}var i=t(0);t(13),t(19),t(1),g.exports=i.aes=i.aes||{},i.aes.startEncrypting=function(i,e,t,r){var a=s({key:i,output:t,decrypt:!1,mode:r});return a.start(e),a},i.aes.createEncryptionCipher=function(a,e){return s({key:a,output:null,decrypt:!1,mode:e})},i.aes.startDecrypting=function(i,e,t,r){var a=s({key:i,output:t,decrypt:!0,mode:r});return a.start(e),a},i.aes.createDecryptionCipher=function(a,e){return s({key:a,output:null,decrypt:!0,mode:e})},i.aes.Algorithm=function(s,e){E||a();var i=this;i.name=s,i.mode=new e({blockSize:16,cipher:{encrypt:function(a,e){return n(i._w,a,e,!1)},decrypt:function(a,e){return n(i._w,a,e,!0)}}}),i._init=!1},i.aes.Algorithm.prototype.initialize=function(c){if(!this._init){var e,d=c.key;if(!("string"!=typeof d||16!==d.length&&24!==d.length&&32!==d.length))d=i.util.createBuffer(d);else if(i.util.isArray(d)&&(16===d.length||24===d.length||32===d.length)){e=d,d=i.util.createBuffer();for(var l=0;l<e.length;++l)d.putByte(e[l])}if(!i.util.isArray(d)){e=d,d=[];var p=e.length();if(16===p||24===p||32===p){p>>>=2;for(var l=0;l<p;++l)d.push(e.getInt32())}}if(!i.util.isArray(d)||4!==d.length&&6!==d.length&&8!==d.length)throw new Error("Invalid key parameter.");var u=this.mode.name,s=-1!==["CFB","OFB","CTR","GCM"].indexOf(u);this._w=m(d,c.decrypt&&!s),this._init=!0}},i.aes._expandKey=function(r,e){return E||a(),m(r,e)},i.aes._updateBlock=n,r("AES-ECB",i.cipher.modes.ecb),r("AES-CBC",i.cipher.modes.cbc),r("AES-CFB",i.cipher.modes.cfb),r("AES-OFB",i.cipher.modes.ofb),r("AES-CTR",i.cipher.modes.ctr),r("AES-GCM",i.cipher.modes.gcm);var I,B,C,A,b,E=!1,S=4},function(o,e,t){function r(a,e){i[a]=e,i[e]=a}function a(a,e){i[a]=e}var n=t(0);n.pki=n.pki||{};var i=o.exports=n.pki.oids=n.oids=n.oids||{};r("1.2.840.113549.1.1.1","rsaEncryption"),r("1.2.840.113549.1.1.4","md5WithRSAEncryption"),r("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),r("1.2.840.113549.1.1.7","RSAES-OAEP"),r("1.2.840.113549.1.1.8","mgf1"),r("1.2.840.113549.1.1.9","pSpecified"),r("1.2.840.113549.1.1.10","RSASSA-PSS"),r("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),r("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),r("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),r("1.3.101.112","EdDSA25519"),r("1.2.840.10040.4.3","dsa-with-sha1"),r("1.3.14.3.2.7","desCBC"),r("1.3.14.3.2.26","sha1"),r("2.16.840.1.101.3.4.2.1","sha256"),r("2.16.840.1.101.3.4.2.2","sha384"),r("2.16.840.1.101.3.4.2.3","sha512"),r("1.2.840.113549.2.5","md5"),r("1.2.840.113549.1.7.1","data"),r("1.2.840.113549.1.7.2","signedData"),r("1.2.840.113549.1.7.3","envelopedData"),r("1.2.840.113549.1.7.4","signedAndEnvelopedData"),r("1.2.840.113549.1.7.5","digestedData"),r("1.2.840.113549.1.7.6","encryptedData"),r("1.2.840.113549.1.9.1","emailAddress"),r("1.2.840.113549.1.9.2","unstructuredName"),r("1.2.840.113549.1.9.3","contentType"),r("1.2.840.113549.1.9.4","messageDigest"),r("1.2.840.113549.1.9.5","signingTime"),r("1.2.840.113549.1.9.6","counterSignature"),r("1.2.840.113549.1.9.7","challengePassword"),r("1.2.840.113549.1.9.8","unstructuredAddress"),r("1.2.840.113549.1.9.14","extensionRequest"),r("1.2.840.113549.1.9.20","friendlyName"),r("1.2.840.113549.1.9.21","localKeyId"),r("1.2.840.113549.1.9.22.1","x509Certificate"),r("1.2.840.113549.1.12.10.1.1","keyBag"),r("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),r("1.2.840.113549.1.12.10.1.3","certBag"),r("1.2.840.113549.1.12.10.1.4","crlBag"),r("1.2.840.113549.1.12.10.1.5","secretBag"),r("1.2.840.113549.1.12.10.1.6","safeContentsBag"),r("1.2.840.113549.1.5.13","pkcs5PBES2"),r("1.2.840.113549.1.5.12","pkcs5PBKDF2"),r("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),r("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),r("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),r("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),r("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),r("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),r("1.2.840.113549.2.7","hmacWithSHA1"),r("1.2.840.113549.2.8","hmacWithSHA224"),r("1.2.840.113549.2.9","hmacWithSHA256"),r("1.2.840.113549.2.10","hmacWithSHA384"),r("1.2.840.113549.2.11","hmacWithSHA512"),r("1.2.840.113549.3.7","des-EDE3-CBC"),r("2.16.840.1.101.3.4.1.2","aes128-CBC"),r("2.16.840.1.101.3.4.1.22","aes192-CBC"),r("2.16.840.1.101.3.4.1.42","aes256-CBC"),r("2.5.4.3","commonName"),r("2.5.4.5","serialName"),r("2.5.4.6","countryName"),r("2.5.4.7","localityName"),r("2.5.4.8","stateOrProvinceName"),r("2.5.4.9","streetAddress"),r("2.5.4.10","organizationName"),r("2.5.4.11","organizationalUnitName"),r("2.5.4.13","description"),r("2.5.4.15","businessCategory"),r("2.5.4.17","postalCode"),r("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),r("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),r("2.16.840.1.113730.1.1","nsCertType"),r("2.16.840.1.113730.1.13","nsComment"),a("2.5.29.1","authorityKeyIdentifier"),a("2.5.29.2","keyAttributes"),a("2.5.29.3","certificatePolicies"),a("2.5.29.4","keyUsageRestriction"),a("2.5.29.5","policyMapping"),a("2.5.29.6","subtreesConstraint"),a("2.5.29.7","subjectAltName"),a("2.5.29.8","issuerAltName"),a("2.5.29.9","subjectDirectoryAttributes"),a("2.5.29.10","basicConstraints"),a("2.5.29.11","nameConstraints"),a("2.5.29.12","policyConstraints"),a("2.5.29.13","basicConstraints"),r("2.5.29.14","subjectKeyIdentifier"),r("2.5.29.15","keyUsage"),a("2.5.29.16","privateKeyUsagePeriod"),r("2.5.29.17","subjectAltName"),r("2.5.29.18","issuerAltName"),r("2.5.29.19","basicConstraints"),a("2.5.29.20","cRLNumber"),a("2.5.29.21","cRLReason"),a("2.5.29.22","expirationDate"),a("2.5.29.23","instructionCode"),a("2.5.29.24","invalidityDate"),a("2.5.29.25","cRLDistributionPoints"),a("2.5.29.26","issuingDistributionPoint"),a("2.5.29.27","deltaCRLIndicator"),a("2.5.29.28","issuingDistributionPoint"),a("2.5.29.29","certificateIssuer"),a("2.5.29.30","nameConstraints"),r("2.5.29.31","cRLDistributionPoints"),r("2.5.29.32","certificatePolicies"),a("2.5.29.33","policyMappings"),a("2.5.29.34","policyConstraints"),r("2.5.29.35","authorityKeyIdentifier"),a("2.5.29.36","policyConstraints"),r("2.5.29.37","extKeyUsage"),a("2.5.29.46","freshestCRL"),a("2.5.29.54","inhibitAnyPolicy"),r("1.3.6.1.4.1.11129.2.4.2","timestampList"),r("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),r("1.3.6.1.5.5.7.3.1","serverAuth"),r("1.3.6.1.5.5.7.3.2","clientAuth"),r("1.3.6.1.5.5.7.3.3","codeSigning"),r("1.3.6.1.5.5.7.3.4","emailProtection"),r("1.3.6.1.5.5.7.3.8","timeStamping")},function(o,e,t){function c(c){for(var e=c.name+": ",d=[],r=function(a,e){return" "+e},a=0;a<c.values.length;++a)d.push(c.values[a].replace(/^(\S+\r\n)/,r));e+=d.join(",")+"\r\n";for(var l=0,p=-1,a=0;a<e.length;++a,++l)if(65<l&&-1!==p){var u=e[p];","===u?(++p,e=e.substr(0,p)+"\r\n "+e.substr(p)):e=e.substr(0,p)+"\r\n"+u+e.substr(p+1),l=a-p-1,p=-1,++a}else" "!==e[a]&&"\t"!==e[a]&&","!==e[a]||(p=a);return e}function a(t){return t.replace(/^\s+/,"")}var m=t(0);t(1);var r=o.exports=m.pem=m.pem||{};r.encode=function(a,e){e=e||{};var i,o="-----BEGIN "+a.type+"-----\r\n";if(a.procType&&(i={name:"Proc-Type",values:[a.procType.version+"",a.procType.type]},o+=c(i)),a.contentDomain&&(i={name:"Content-Domain",values:[a.contentDomain]},o+=c(i)),a.dekInfo&&(i={name:"DEK-Info",values:[a.dekInfo.algorithm]},a.dekInfo.parameters&&i.values.push(a.dekInfo.parameters),o+=c(i)),a.headers)for(var d=0;d<a.headers.length;++d)o+=c(a.headers[d]);return a.procType&&(o+="\r\n"),o+=m.util.encode64(a.body,e.maxline||64)+"\r\n",o+="-----END "+a.type+"-----\r\n"},r.decode=function(n){for(var e,i=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,C=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,s=/\r?\n/;;){if(!(e=r.exec(n)))break;var o={type:e[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:m.util.decode64(e[3])};if(i.push(o),e[2]){for(var c=e[2].split(s),u=0;e&&u<c.length;){for(var E,S=c[u].replace(/\s+$/,""),T=u+1;T<c.length&&(E=c[T],!!/\s/.test(E[0]));++T)S+=E,u=T;if(e=S.match(C)){for(var I={name:e[1],values:[]},d=e[2].split(","),y=0;y<d.length;++y)I.values.push(a(d[y]));if(!o.procType){if("Proc-Type"!==I.name)throw new Error("Invalid PEM formatted message. The first encapsulated header must be \"Proc-Type\".");if(2!==I.values.length)throw new Error("Invalid PEM formatted message. The \"Proc-Type\" header must have two subfields.");o.procType={version:d[0],type:d[1]}}else if(!(o.contentDomain||"Content-Domain"!==I.name))o.contentDomain=d[0]||"";else if(o.dekInfo||"DEK-Info"!==I.name)o.headers.push(I);else{if(0===I.values.length)throw new Error("Invalid PEM formatted message. The \"DEK-Info\" header must have at least one subfield.");o.dekInfo={algorithm:d[0],parameters:d[1]||null}}}++u}if("ENCRYPTED"===o.procType&&!o.dekInfo)throw new Error("Invalid PEM formatted message. The \"DEK-Info\" header must be present if \"Proc-Type\" is \"ENCRYPTED\".")}}if(0===i.length)throw new Error("Invalid PEM formatted message.");return i}},function(n,e,t){var d=t(0);t(4),t(1),(n.exports=d.hmac=d.hmac||{}).create=function(){var a=null,l=null,p=null,g=null,s={};return s.start=function(e,t){if(null!==e)if("string"==typeof e){if(!((e=e.toLowerCase())in d.md.algorithms))throw new Error("Unknown hash algorithm \""+e+"\"");l=d.md.algorithms[e].create()}else l=e;if(null===t)t=a;else{if("string"==typeof t)t=d.util.createBuffer(t);else if(d.util.isArray(t)){var r=t;t=d.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}var y=t.length();y>l.blockLength&&(l.start(),l.update(t.bytes()),t=l.digest()),p=d.util.createBuffer(),g=d.util.createBuffer(),y=t.length();for(var r,n=0;n<y;++n)r=t.at(n),p.putByte(54^r),g.putByte(92^r);if(y<l.blockLength)for(var r=l.blockLength-y,n=0;n<r;++n)p.putByte(54),g.putByte(92);a=t,p=p.bytes(),g=g.bytes()}l.start(),l.update(p)},s.update=function(t){l.update(t)},s.getMac=function(){var t=l.digest().bytes();return l.start(),l.update(g),l.update(t),l.digest()},s.digest=s.getMac,s}},function(d,e,t){function l(){i=String.fromCharCode(128),i+=n.util.fillString(String.fromCharCode(0),64),p=!0}function g(d,e,t){for(var r,g,y,h,f,m,C,E,S=t.length();64<=S;){for(g=d.h0,y=d.h1,h=d.h2,f=d.h3,m=d.h4,E=0;16>E;++E)r=t.getInt32(),e[E]=r,C=f^y&(h^f),r=(g<<5|g>>>27)+C+m+1518500249+r,m=f,f=h,h=(y<<30|y>>>2)>>>0,y=g,g=r;for(;20>E;++E)r=e[E-3]^e[E-8]^e[E-14]^e[E-16],r=r<<1|r>>>31,e[E]=r,C=f^y&(h^f),r=(g<<5|g>>>27)+C+m+1518500249+r,m=f,f=h,h=(y<<30|y>>>2)>>>0,y=g,g=r;for(;32>E;++E)r=e[E-3]^e[E-8]^e[E-14]^e[E-16],r=r<<1|r>>>31,e[E]=r,C=y^h^f,r=(g<<5|g>>>27)+C+m+1859775393+r,m=f,f=h,h=(y<<30|y>>>2)>>>0,y=g,g=r;for(;40>E;++E)r=e[E-6]^e[E-16]^e[E-28]^e[E-32],r=r<<2|r>>>30,e[E]=r,C=y^h^f,r=(g<<5|g>>>27)+C+m+1859775393+r,m=f,f=h,h=(y<<30|y>>>2)>>>0,y=g,g=r;for(;60>E;++E)r=e[E-6]^e[E-16]^e[E-28]^e[E-32],r=r<<2|r>>>30,e[E]=r,C=y&h|f&(y^h),r=(g<<5|g>>>27)+C+m+2400959708+r,m=f,f=h,h=(y<<30|y>>>2)>>>0,y=g,g=r;for(;80>E;++E)r=e[E-6]^e[E-16]^e[E-28]^e[E-32],r=r<<2|r>>>30,e[E]=r,C=y^h^f,r=(g<<5|g>>>27)+C+m+3395469782+r,m=f,f=h,h=(y<<30|y>>>2)>>>0,y=g,g=r;d.h0=0|d.h0+g,d.h1=0|d.h1+y,d.h2=0|d.h2+h,d.h3=0|d.h3+f,d.h4=0|d.h4+m,S-=64}}var n=t(0);t(4),t(1);var a=d.exports=n.sha1=n.sha1||{};n.md.sha1=n.md.algorithms.sha1=a,a.create=function(){p||l();var m=null,C=n.util.createBuffer(),E=Array(80),S={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return S.start=function(){S.messageLength=0,S.fullMessageLength=S.messageLength64=[];for(var e=S.messageLengthSize/4,t=0;t<e;++t)S.fullMessageLength.push(0);return C=n.util.createBuffer(),m={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},S},S.start(),S.update=function(e,t){"utf8"===t&&(e=n.util.encodeUtf8(e));var r=e.length;S.messageLength+=r,r=[r/4294967296>>>0,r>>>0];for(var s=S.fullMessageLength.length-1;0<=s;--s)S.fullMessageLength[s]+=r[1],r[1]=r[0]+(S.fullMessageLength[s]/4294967296>>>0),S.fullMessageLength[s]>>>=0,r[0]=r[1]/4294967296>>>0;return C.putBytes(e),g(m,E,C),(2048<C.read||0===C.length())&&C.compact(),S},S.digest=function(){var e=n.util.createBuffer();e.putBytes(C.bytes());var t=S.fullMessageLength[S.fullMessageLength.length-1]+S.messageLengthSize,a=t&S.blockLength-1;e.putBytes(i.substr(0,S.blockLength-a));for(var r,s,o=8*S.fullMessageLength[0],c=0;c<S.fullMessageLength.length-1;++c)r=8*S.fullMessageLength[c+1],s=r/4294967296>>>0,o+=s,e.putInt32(o>>>0),o=r>>>0;e.putInt32(o);var u={h0:m.h0,h1:m.h1,h2:m.h2,h3:m.h3,h4:m.h4};g(u,E,e);var d=n.util.createBuffer();return d.putInt32(u.h0),d.putInt32(u.h1),d.putInt32(u.h2),d.putInt32(u.h3),d.putInt32(u.h4),d},S};var i=null,p=!1},function(g,e,t){function r(a,e){s.cipher.registerAlgorithm(a,function(){return new s.des.Algorithm(a,e)})}function a(B){for(var e,N=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],a=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],n=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],i=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],l=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],p=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],f=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],h=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],d=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],y=8<B.length()?3:1,g=[],v=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],m=0,R=0;R<y;R++){var L=B.getInt32(),_=B.getInt32();e=252645135&(L>>>4^_),_^=e,L^=e<<4,e=65535&(_>>>-16^L),L^=e,_^=e<<-16,e=858993459&(L>>>2^_),_^=e,L^=e<<2,e=65535&(_>>>-16^L),L^=e,_^=e<<-16,e=1431655765&(L>>>1^_),_^=e,L^=e<<1,e=16711935&(_>>>8^L),L^=e,_^=e<<8,e=1431655765&(L>>>1^_),_^=e,L^=e<<1,e=L<<8|240&_>>>20,L=_<<24|16711680&_<<8|65280&_>>>8|240&_>>>24,_=e;for(var k=0;k<v.length;++k){v[k]?(L=L<<2|L>>>26,_=_<<2|_>>>26):(L=L<<1|L>>>27,_=_<<1|_>>>27),L&=-15,_&=-15;var U=N[L>>>28]|r[15&L>>>24]|a[15&L>>>20]|n[15&L>>>16]|i[15&L>>>12]|s[15&L>>>8]|o[15&L>>>4],b=c[_>>>28]|u[15&_>>>24]|l[15&_>>>20]|p[15&_>>>16]|f[15&_>>>12]|h[15&_>>>8]|d[15&_>>>4];e=65535&(b>>>16^U),g[m++]=U^e,g[m++]=b^e<<16}}return g}function n(y,e,t,r){var a,I=32===y.length?3:9;a=3==I?r?[30,-2,-2]:[0,32,2]:r?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var i,B=e[0],A=e[1];i=252645135&(B>>>4^A),A^=i,B^=i<<4,i=65535&(B>>>16^A),A^=i,B^=i<<16,i=858993459&(A>>>2^B),B^=i,A^=i<<2,i=16711935&(A>>>8^B),B^=i,A^=i<<8,i=1431655765&(B>>>1^A),A^=i,B^=i<<1,B=B<<1|B>>>31,A=A<<1|A>>>31;for(var b=0;b<I;b+=3){for(var N=a[b+1],R=a[b+2],C=a[b];C!=N;C+=R){var L=A^y[C],S=(A>>>4|A<<28)^y[C+1];i=B,B=A,A=i^(c[63&L>>>24]|l[63&L>>>16]|f[63&L>>>8]|d[63&L]|m[63&S>>>24]|u[63&S>>>16]|p[63&S>>>8]|h[63&S])}i=B,B=A,A=i}B=B>>>1|B<<31,A=A>>>1|A<<31,i=1431655765&(B>>>1^A),A^=i,B^=i<<1,i=16711935&(A>>>8^B),B^=i,A^=i<<8,i=858993459&(A>>>2^B),B^=i,A^=i<<2,i=65535&(B>>>16^A),A^=i,B^=i<<16,i=252645135&(B>>>4^A),A^=i,B^=i<<4,t[0]=B,t[1]=A}function i(i){i=i||{};var o,c=(i.mode||"CBC").toUpperCase(),r="DES-"+c;o=i.decrypt?s.cipher.createDecipher(r,i.key):s.cipher.createCipher(r,i.key);var d=o.start;return o.start=function(t,e){var n=null;e instanceof s.util.ByteBuffer&&(n=e,e={}),e=e||{},e.output=n,e.iv=t,d.call(o,e)},o}var s=t(0);t(13),t(19),t(1),g.exports=s.des=s.des||{},s.des.startEncrypting=function(s,e,t,r){var a=i({key:s,output:t,decrypt:!1,mode:r||(null===e?"ECB":"CBC")});return a.start(e),a},s.des.createEncryptionCipher=function(a,e){return i({key:a,output:null,decrypt:!1,mode:e})},s.des.startDecrypting=function(s,e,t,r){var a=i({key:s,output:t,decrypt:!0,mode:r||(null===e?"ECB":"CBC")});return a.start(e),a},s.des.createDecryptionCipher=function(a,e){return i({key:a,output:null,decrypt:!0,mode:e})},s.des.Algorithm=function(a,e){var s=this;s.name=a,s.mode=new e({blockSize:8,cipher:{encrypt:function(a,e){return n(s._keys,a,e,!1)},decrypt:function(a,e){return n(s._keys,a,e,!0)}}}),s._init=!1},s.des.Algorithm.prototype.initialize=function(r){if(!this._init){var e=s.util.createBuffer(r.key);if(0===this.name.indexOf("3DES")&&24!==e.length())throw new Error("Invalid Triple-DES key size: "+8*e.length());this._keys=a(e),this._init=!0}},r("DES-ECB",s.cipher.modes.ecb),r("DES-CBC",s.cipher.modes.cbc),r("DES-CFB",s.cipher.modes.cfb),r("DES-OFB",s.cipher.modes.ofb),r("DES-CTR",s.cipher.modes.ctr),r("3DES-ECB",s.cipher.modes.ecb),r("3DES-CBC",s.cipher.modes.cbc),r("3DES-CFB",s.cipher.modes.cfb),r("3DES-OFB",s.cipher.modes.ofb),r("3DES-CTR",s.cipher.modes.ctr);var m=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],c=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],u=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],l=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],p=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],f=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],h=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],d=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696]},function(B,e,t){function A(d,e,t){var r=L.util.createBuffer(),a=Math.ceil(e.n.bitLength()/8);if(d.length>a-11){var n=new Error("Message is too long for PKCS#1 v1.5 padding.");throw n.length=d.length,n.max=a-11,n}r.putByte(0),r.putByte(t);var i,p=a-3-d.length;if(0===t||1===t){i=0===t?0:255;for(var g=0;g<p;++g)r.putByte(i)}else for(;0<p;){for(var y=0,h=L.random.getBytes(p),g=0;g<p;++g)i=h.charCodeAt(g),0===i?++y:r.putByte(i);p=y}return r.putByte(0),r.putBytes(d),r}function N(d,e,t,r){var a=Math.ceil(e.n.bitLength()/8),n=L.util.createBuffer(d),i=n.getByte(),s=n.getByte();if(0!==i||t&&0!==s&&1!==s||!t&&2!=s||t&&0===s&&void 0===r)throw new Error("Encryption block is invalid.");var o=0;if(0===s){o=a-3-r;for(var l=0;l<o;++l)if(0!==n.getByte())throw new Error("Encryption block is invalid.")}else if(1===s)for(o=0;1<n.length();){if(255!==n.getByte()){--n.read;break}++o}else if(2===s)for(o=0;1<n.length();){if(0===n.getByte()){--n.read;break}++o}if(0!==n.getByte()||o!==a-3-n.length())throw new Error("Encryption block is invalid.");return n.getBytes()}function R(d,e,l){function p(){u(d.pBits,function(e,t){return e?l(e):(d.p=t,null===d.q?void u(d.qBits,n):n(e,d.q))})}function u(r,e){L.prime.generateProbablePrime(r,a,e)}function n(e,t){if(e)return l(e);if(d.q=t,0>d.p.compareTo(d.q)){var a=d.p;d.p=d.q,d.q=a}if(0!==d.p.subtract(f.ONE).gcd(d.e).compareTo(f.ONE))return d.p=null,void p();if(0!==d.q.subtract(f.ONE).gcd(d.e).compareTo(f.ONE))return d.q=null,void u(d.qBits,n);if(d.p1=d.p.subtract(f.ONE),d.q1=d.q.subtract(f.ONE),d.phi=d.p1.multiply(d.q1),0!==d.phi.gcd(d.e).compareTo(f.ONE))return d.p=d.q=null,void p();if(d.n=d.p.multiply(d.q),d.n.bitLength()!==d.bits)return d.q=null,void u(d.qBits,n);var r=d.e.modInverse(d.phi);d.keys={privateKey:g.rsa.setPrivateKey(d.n,d.e,r,d.p,d.q,r.mod(d.p1),r.mod(d.q1),d.q.modInverse(d.p)),publicKey:g.rsa.setPublicKey(d.n,d.e)},l(null,d.keys)}"function"==typeof e&&(l=e,e={}),e=e||{};var a={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(a.prng=e.prng),p()}function a(a){var e=a.toString(16);"8"<=e[0]&&(e="00"+e);var n=L.util.hexToBytes(e);return 1<n.length&&(0===n.charCodeAt(0)&&0==(128&n.charCodeAt(1))||255===n.charCodeAt(0)&&128==(128&n.charCodeAt(1)))?n.substr(1):n}function s(t){return 100>=t?27:150>=t?18:200>=t?15:250>=t?12:300>=t?9:350>=t?8:400>=t?7:500>=t?6:600>=t?5:800>=t?4:1250>=t?3:2}function i(t){return L.util.isNodejs&&"function"==typeof l[t]}function r(t){return void 0!==p.globalScope&&"object"==typeof p.globalScope.crypto&&"object"==typeof p.globalScope.crypto.subtle&&"function"==typeof p.globalScope.crypto.subtle[t]}function o(t){return void 0!==p.globalScope&&"object"==typeof p.globalScope.msCrypto&&"object"==typeof p.globalScope.msCrypto.subtle&&"function"==typeof p.globalScope.msCrypto.subtle[t]}function c(n){for(var e=L.util.hexToBytes(n.toString(16)),t=new Uint8Array(e.length),r=0;r<e.length;++r)t[r]=e.charCodeAt(r);return t}var L=t(0);if(t(3),t(12),t(6),t(26),t(27),t(2),t(1),void 0===f)var f=L.jsbn.BigInteger;var l=L.util.isNodejs?t(16):null,d=L.asn1,p=L.util;L.pki=L.pki||{},B.exports=L.pki.rsa=L.rsa=L.rsa||{};var g=L.pki,y=[6,4,2,4,2,4,6,2],h={name:"PrivateKeyInfo",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:d.Class.UNIVERSAL,type:d.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},m={name:"RSAPrivateKey",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},u={name:"RSAPublicKey",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},C=L.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:d.Class.UNIVERSAL,type:d.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},n=function(o){var e;if(!(o.algorithm in g.oids)){var c=new Error("Unknown message digest algorithm.");throw c.algorithm=o.algorithm,c}e=g.oids[o.algorithm];var r=d.oidToDer(e).getBytes(),a=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[]),n=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[]);n.value.push(d.create(d.Class.UNIVERSAL,d.Type.OID,!1,r)),n.value.push(d.create(d.Class.UNIVERSAL,d.Type.NULL,!1,""));var i=d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,o.digest().getBytes());return a.value.push(n),a.value.push(i),d.toDer(a).getBytes()},E=function(o,c,t){if(t)return o.modPow(c.e,c.n);if(!c.p||!c.q)return o.modPow(c.d,c.n);c.dP||(c.dP=c.d.mod(c.p.subtract(f.ONE))),c.dQ||(c.dQ=c.d.mod(c.q.subtract(f.ONE))),c.qInv||(c.qInv=c.q.modInverse(c.p));var r;do r=new f(L.util.bytesToHex(L.random.getBytes(c.n.bitLength()/8)),16);while(0<=r.compareTo(c.n)||!r.gcd(c.n).equals(f.ONE));o=o.multiply(r.modPow(c.e,c.n)).mod(c.n);for(var d=o.mod(c.p).modPow(c.dP,c.p),l=o.mod(c.q).modPow(c.dQ,c.q);0>d.compareTo(l);)d=d.add(c.p);var i=d.subtract(l).multiply(c.qInv).mod(c.p).multiply(c.q).add(l);return i=i.multiply(r.modInverse(c.n)).mod(c.n)};g.rsa.encrypt=function(a,e,t){var r,d=t,g=Math.ceil(e.n.bitLength()/8);!1!==t&&!0!==t?(d=2===t,r=A(a,e,t)):(r=L.util.createBuffer(),r.putBytes(a));for(var s=new f(r.toHex(),16),o=E(s,e,d),c=o.toString(16),u=L.util.createBuffer(),l=g-Math.ceil(c.length/2);0<l;)u.putByte(0),--l;return u.putBytes(L.util.hexToBytes(c)),u.getBytes()},g.rsa.decrypt=function(n,e,t,r){var a=Math.ceil(e.n.bitLength()/8);if(n.length!==a){var i=new Error("Encrypted message length is invalid.");throw i.length=n.length,i.expected=a,i}var s=new f(L.util.createBuffer(n).toHex(),16);if(0<=s.compareTo(e.n))throw new Error("Encrypted message is invalid.");for(var o=E(s,e,t),c=o.toString(16),d=L.util.createBuffer(),l=a-Math.ceil(c.length/2);0<l;)d.putByte(0),--l;return d.putBytes(L.util.hexToBytes(c)),!1===r?d.getBytes():N(d.getBytes(),e,t)},g.rsa.createKeyPairGenerationState=function(i,o,t){"string"==typeof i&&(i=parseInt(i,10)),i=i||2048,t=t||{};var c,d=t.prng||L.random,n=t.algorithm||"PRIMEINC";if("PRIMEINC"!==n)throw new Error("Invalid key generation algorithm: "+n);return c={algorithm:n,state:0,bits:i,rng:{nextBytes:function(a){for(var e=d.getBytesSync(a.length),t=0;t<a.length;++t)a[t]=e.charCodeAt(t)}},eInt:o||65537,e:new f(null),p:null,q:null,qBits:i>>1,pBits:i-(i>>1),pqState:0,num:null,keys:null},c.e.fromInt(c.eInt),c},g.rsa.stepKeyPairGenerationState=function(o,e){"algorithm"in o||(o.algorithm="PRIMEINC");var t=new f(null);t.fromInt(30);for(var r,d=0,h=function(a,e){return a|e},i=+new Date,m=0;null===o.keys&&(0>=e||m<e);){if(0===o.state){var C=null===o.p?o.pBits:o.qBits,u=C-1;0===o.pqState?(o.num=new f(C,o.rng),o.num.testBit(u)||o.num.bitwiseTo(f.ONE.shiftLeft(u),h,o.num),o.num.dAddOffset(31-o.num.mod(t).byteValue(),0),d=0,++o.pqState):1===o.pqState?o.num.bitLength()>C?o.pqState=0:o.num.isProbablePrime(s(o.num.bitLength()))?++o.pqState:o.num.dAddOffset(y[d++%8],0):2===o.pqState?o.pqState=0===o.num.subtract(f.ONE).gcd(o.e).compareTo(f.ONE)?3:0:3===o.pqState&&(o.pqState=0,null===o.p?o.p=o.num:o.q=o.num,null!==o.p&&null!==o.q&&++o.state,o.num=null)}else if(1===o.state)0>o.p.compareTo(o.q)&&(o.num=o.p,o.p=o.q,o.q=o.num),++o.state;else if(2===o.state)o.p1=o.p.subtract(f.ONE),o.q1=o.q.subtract(f.ONE),o.phi=o.p1.multiply(o.q1),++o.state;else if(3===o.state)0===o.phi.gcd(o.e).compareTo(f.ONE)?++o.state:(o.p=null,o.q=null,o.state=0);else if(4===o.state)o.n=o.p.multiply(o.q),o.n.bitLength()===o.bits?++o.state:(o.q=null,o.state=0);else if(5===o.state){var l=o.e.modInverse(o.phi);o.keys={privateKey:g.rsa.setPrivateKey(o.n,o.e,l,o.p,o.q,l.mod(o.p1),l.mod(o.q1),o.q.modInverse(o.p)),publicKey:g.rsa.setPublicKey(o.n,o.e)}}r=+new Date,m+=r-i,i=r}return null!==o.keys},g.rsa.generateKeyPair=function(u,y,h,f){if(1===arguments.length?"object"==typeof u?(h=u,u=void 0):"function"==typeof u&&(f=u,u=void 0):2===arguments.length?"number"==typeof u?"function"==typeof y?(f=y,y=void 0):"number"!=typeof y&&(h=y,y=void 0):(h=u,f=y,u=void 0,y=void 0):3===arguments.length&&("number"==typeof y?"function"==typeof h&&(f=h,h=void 0):(f=h,h=y,y=void 0)),h=h||{},void 0===u&&(u=h.bits||2048),void 0===y&&(y=h.e||65537),!L.options.usePureJavaScript&&!h.prng&&256<=u&&16384>=u&&(65537===y||3===y))if(f){if(i("generateKeyPair"))return l.generateKeyPair("rsa",{modulusLength:u,publicExponent:y,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,e,t){return a?f(a):void f(null,{privateKey:g.privateKeyFromPem(t),publicKey:g.publicKeyFromPem(e)})});if(r("generateKey")&&r("exportKey"))return p.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:u,publicExponent:c(y),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(t){return p.globalScope.crypto.subtle.exportKey("pkcs8",t.privateKey)}).then(void 0,function(t){f(t)}).then(function(a){if(a){var e=g.privateKeyFromAsn1(d.fromDer(L.util.createBuffer(a)));f(null,{privateKey:e,publicKey:g.setRsaPublicKey(e.n,e.e)})}});if(o("generateKey")&&o("exportKey")){var m=p.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:u,publicExponent:c(y),hash:{name:"SHA-256"}},!0,["sign","verify"]);return m.oncomplete=function(a){var e=a.target.result,t=p.globalScope.msCrypto.subtle.exportKey("pkcs8",e.privateKey);t.oncomplete=function(a){var e=a.target.result,t=g.privateKeyFromAsn1(d.fromDer(L.util.createBuffer(e)));f(null,{privateKey:t,publicKey:g.setRsaPublicKey(t.n,t.e)})},t.onerror=function(t){f(t)}},void(m.onerror=function(t){f(t)})}}else if(i("generateKeyPairSync")){var n=l.generateKeyPairSync("rsa",{modulusLength:u,publicExponent:y,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:g.privateKeyFromPem(n.privateKey),publicKey:g.publicKeyFromPem(n.publicKey)}}var s=g.rsa.createKeyPairGenerationState(u,y,h);return f?void R(s,h,f):(g.rsa.stepKeyPairGenerationState(s,0),s.keys)},g.setRsaPublicKey=g.rsa.setPublicKey=function(a,e){var s={n:a,e:e};return s.encrypt=function(a,e,r){if("string"==typeof e?e=e.toUpperCase():void 0===e&&(e="RSAES-PKCS1-V1_5"),"RSAES-PKCS1-V1_5"===e)e={encode:function(a,e){return A(a,e,2).getBytes()}};else if("RSA-OAEP"===e||"RSAES-OAEP"===e)e={encode:function(a,e){return L.pkcs1.encode_rsa_oaep(e,a,r)}};else if(-1!==["RAW","NONE","NULL",null].indexOf(e))e={encode:function(t){return t}};else if("string"==typeof e)throw new Error("Unsupported encryption scheme: \""+e+"\".");var n=e.encode(a,s,!0);return g.rsa.encrypt(n,s,!0)},s.verify=function(r,e,t){"string"==typeof t?t=t.toUpperCase():void 0===t&&(t="RSASSA-PKCS1-V1_5"),"RSASSA-PKCS1-V1_5"===t?t={verify:function(a,e){return e=N(e,s,!0),a===d.fromDer(e).value[1].value}}:"NONE"!==t&&"NULL"!==t&&null!==t||(t={verify:function(a,e){return e=N(e,s,!0),a===e}});var n=g.rsa.decrypt(e,s,!0,!1);return t.verify(r,n,s.n.bitLength())},s},g.setRsaPrivateKey=g.rsa.setPrivateKey=function(d,e,t,r,a,i,s,o){var c={n:d,e:e,d:t,p:r,q:a,dP:i,dQ:s,qInv:o};return c.decrypt=function(n,e,s){"string"==typeof e?e=e.toUpperCase():void 0===e&&(e="RSAES-PKCS1-V1_5");var r=g.rsa.decrypt(n,c,!1,!1);if("RSAES-PKCS1-V1_5"===e)e={decode:N};else if("RSA-OAEP"===e||"RSAES-OAEP"===e)e={decode:function(a,e){return L.pkcs1.decode_rsa_oaep(e,a,s)}};else{if(-1===["RAW","NONE","NULL",null].indexOf(e))throw new Error("Unsupported encryption scheme: \""+e+"\".");e={decode:function(t){return t}}}return e.decode(r,c,!1)},c.sign=function(s,e){var i=!1;"string"==typeof e&&(e=e.toUpperCase()),void 0===e||"RSASSA-PKCS1-V1_5"===e?(e={encode:n},i=1):"NONE"!==e&&"NULL"!==e&&null!==e||(e={encode:function(){return s}},i=1);var o=e.encode(s,c.n.bitLength());return g.rsa.encrypt(o,c,i)},c},g.wrapRsaPrivateKey=function(t){return d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,d.integerToDer(0).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(g.oids.rsaEncryption).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.NULL,!1,"")]),d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,d.toDer(t).getBytes())])},g.privateKeyFromAsn1=function(y){var C={},E=[];if(d.validate(y,h,C,E)&&(y=d.fromDer(L.util.createBuffer(C.privateKey))),C={},E=[],!d.validate(y,m,C,E)){var S=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw S.errors=E,S}var a,T,I,B,A,b,v,N;return a=L.util.createBuffer(C.privateKeyModulus).toHex(),T=L.util.createBuffer(C.privateKeyPublicExponent).toHex(),I=L.util.createBuffer(C.privateKeyPrivateExponent).toHex(),B=L.util.createBuffer(C.privateKeyPrime1).toHex(),A=L.util.createBuffer(C.privateKeyPrime2).toHex(),b=L.util.createBuffer(C.privateKeyExponent1).toHex(),v=L.util.createBuffer(C.privateKeyExponent2).toHex(),N=L.util.createBuffer(C.privateKeyCoefficient).toHex(),g.setRsaPrivateKey(new f(a,16),new f(T,16),new f(I,16),new f(B,16),new f(A,16),new f(b,16),new f(v,16),new f(N,16))},g.privateKeyToAsn1=g.privateKeyToRSAPrivateKey=function(t){return d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,d.integerToDer(0).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,a(t.n)),d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,a(t.e)),d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,a(t.d)),d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,a(t.p)),d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,a(t.q)),d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,a(t.dP)),d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,a(t.dQ)),d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,a(t.qInv))])},g.publicKeyFromAsn1=function(o){var c={},t=[];if(d.validate(o,C,c,t)){var l=d.derToOid(c.publicKeyOid);if(l!==g.oids.rsaEncryption){var a=new Error("Cannot read public key. Unknown OID.");throw a.oid=l,a}o=c.rsaPublicKey}if(t=[],!d.validate(o,u,c,t)){var a=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw a.errors=t,a}var p=L.util.createBuffer(c.publicKeyModulus).toHex(),i=L.util.createBuffer(c.publicKeyExponent).toHex();return g.setRsaPublicKey(new f(p,16),new f(i,16))},g.publicKeyToAsn1=g.publicKeyToSubjectPublicKeyInfo=function(t){return d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(g.oids.rsaEncryption).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.NULL,!1,"")]),d.create(d.Class.UNIVERSAL,d.Type.BITSTRING,!1,[g.publicKeyToRSAPublicKey(t)])])},g.publicKeyToRSAPublicKey=function(t){return d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,a(t.n)),d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,a(t.e))])}},function(d,e,t){function T(a,e,t){this.data=[],null!=a&&("number"==typeof a?this.fromNumber(a,e,t):null==e&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,e))}function I(){return new T(null)}function a(o,c,t,r,d,l){for(;0<=--l;){var p=c*this.data[o++]+t.data[r]+d;d=Math.floor(p/67108864),t.data[r++]=67108863&p}return d}function r(d,p,t,r,g,y){for(var h=32767&p,s=p>>15;0<=--y;){var o=32767&this.data[d],f=this.data[d++]>>15,u=s*o+f*h;o=h*o+((32767&u)<<15)+t.data[r]+(1073741823&g),g=(o>>>30)+(u>>>15)+s*f+(g>>>30),t.data[r++]=1073741823&o}return g}function n(d,p,t,r,g,y){for(var h=16383&p,s=p>>14;0<=--y;){var o=16383&this.data[d],f=this.data[d++]>>14,u=s*o+f*h;o=h*o+((16383&u)<<14)+t.data[r]+g,g=(o>>28)+(u>>14)+s*f,t.data[r++]=268435455&o}return g}function i(t){return R.charAt(t)}function p(a,e){var t=L[a.charCodeAt(e)];return null==t?-1:t}function m(a){var e=I();return e.fromInt(a),e}function B(a){var n,s=1;return 0!=(n=a>>>16)&&(a=n,s+=16),0!=(n=a>>8)&&(a=n,s+=8),0!=(n=a>>4)&&(a=n,s+=4),0!=(n=a>>2)&&(a=n,s+=2),0!=(n=a>>1)&&(a=n,s+=1),s}function f(t){this.m=t}function C(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function s(a,e){return a&e}function o(a,e){return a|e}function c(a,e){return a^e}function l(a,e){return a&~e}function u(a){if(0==a)return-1;var r=0;return 0==(65535&a)&&(a>>=16,r+=16),0==(255&a)&&(a>>=8,r+=8),0==(15&a)&&(a>>=4,r+=4),0==(3&a)&&(a>>=2,r+=2),0==(1&a)&&++r,r}function g(a){for(var r=0;0!=a;)a&=a-1,++r;return r}function y(){}function h(t){return t}function E(t){this.r2=I(),this.q3=I(),T.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function S(){return{nextBytes:function(a){for(var e=0;e<a.length;++e)a[e]=Math.floor(256*Math.random())}}}var A=t(0);d.exports=A.jsbn=A.jsbn||{};var b;A.jsbn.BigInteger=T,"undefined"==typeof navigator?(T.prototype.am=n,b=28):"Microsoft Internet Explorer"==navigator.appName?(T.prototype.am=r,b=30):"Netscape"==navigator.appName?(T.prototype.am=n,b=28):(T.prototype.am=a,b=26),T.prototype.DB=b,T.prototype.DM=(1<<b)-1,T.prototype.DV=1<<b,T.prototype.FV=Math.pow(2,52),T.prototype.F1=52-b,T.prototype.F2=2*b-52;var v,N,R="0123456789abcdefghijklmnopqrstuvwxyz",L=[];for(v=48,N=0;9>=N;++N)L[v++]=N;for(v=97,N=10;36>N;++N)L[v++]=N;for(v=65,N=10;36>N;++N)L[v++]=N;f.prototype.convert=function(t){return 0>t.s||0<=t.compareTo(this.m)?t.mod(this.m):t},f.prototype.revert=function(t){return t},f.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},f.prototype.mulTo=function(a,e,t){a.multiplyTo(e,t),this.reduce(t)},f.prototype.sqrTo=function(a,e){a.squareTo(e),this.reduce(e)},C.prototype.convert=function(a){var e=I();return a.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),0>a.s&&0<e.compareTo(T.ZERO)&&this.m.subTo(e,e),e},C.prototype.revert=function(a){var e=I();return a.copyTo(e),this.reduce(e),e},C.prototype.reduce=function(n){for(;n.t<=this.mt2;)n.data[n.t++]=0;for(var e=0;e<this.m.t;++e){var s=32767&n.data[e],i=s*this.mpl+((s*this.mph+(n.data[e]>>15)*this.mpl&this.um)<<15)&n.DM;for(s=e+this.m.t,n.data[s]+=this.m.am(0,i,n,e,0,this.m.t);n.data[s]>=n.DV;)n.data[s]-=n.DV,n.data[++s]++}n.clamp(),n.drShiftTo(this.m.t,n),0<=n.compareTo(this.m)&&n.subTo(this.m,n)},C.prototype.mulTo=function(a,e,t){a.multiplyTo(e,t),this.reduce(t)},C.prototype.sqrTo=function(a,e){a.squareTo(e),this.reduce(e)},T.prototype.copyTo=function(a){for(var e=this.t-1;0<=e;--e)a.data[e]=this.data[e];a.t=this.t,a.s=this.s},T.prototype.fromInt=function(t){this.t=1,this.s=0>t?-1:0,0<t?this.data[0]=t:-1>t?this.data[0]=t+this.DV:this.t=0},T.prototype.fromString=function(a,e){var t;if(16==e)t=4;else if(8==e)t=3;else if(256==e)t=8;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return void this.fromRadix(a,e);t=2}this.t=0,this.s=0;for(var c,d=a.length,l=!1,u=0;0<=--d;)c=8==t?255&a[d]:p(a,d),0>c?"-"==a.charAt(d)&&(l=!0):(l=!1,0==u?this.data[this.t++]=c:u+t>this.DB?(this.data[this.t-1]|=(c&(1<<this.DB-u)-1)<<u,this.data[this.t++]=c>>this.DB-u):this.data[this.t-1]|=c<<u,(u+=t)>=this.DB&&(u-=this.DB));8==t&&0!=(128&a[0])&&(this.s=-1,0<u&&(this.data[this.t-1]|=(1<<this.DB-u)-1<<u)),this.clamp(),l&&T.ZERO.subTo(this,this)},T.prototype.clamp=function(){for(var t=this.s&this.DM;0<this.t&&this.data[this.t-1]==t;)--this.t},T.prototype.dlShiftTo=function(a,e){var t;for(t=this.t-1;0<=t;--t)e.data[t+a]=this.data[t];for(t=a-1;0<=t;--t)e.data[t]=0;e.t=this.t+a,e.s=this.s},T.prototype.drShiftTo=function(a,e){for(var t=a;t<this.t;++t)e.data[t-a]=this.data[t];e.t=Math.max(this.t-a,0),e.s=this.s},T.prototype.lShiftTo=function(i,e){var t,c=i%this.DB,a=this.DB-c,n=Math.floor(i/this.DB),s=this.s<<c&this.DM;for(t=this.t-1;0<=t;--t)e.data[t+n+1]=this.data[t]>>a|s,s=(this.data[t]&(1<<a)-1)<<c;for(t=n-1;0<=t;--t)e.data[t]=0;e.data[n]=s,e.t=this.t+n+1,e.s=this.s,e.clamp()},T.prototype.rShiftTo=function(o,e){e.s=this.s;var t=Math.floor(o/this.DB);if(t>=this.t)return void(e.t=0);var r=o%this.DB,a=this.DB-r,n=(1<<r)-1;e.data[0]=this.data[t]>>r;for(var i=t+1;i<this.t;++i)e.data[i-t-1]|=(this.data[i]&n)<<a,e.data[i-t]=this.data[i]>>r;0<r&&(e.data[this.t-t-1]|=(this.s&n)<<a),e.t=this.t-t,e.clamp()},T.prototype.subTo=function(s,e){for(var t=0,i=0,o=Math.min(s.t,this.t);t<o;)i+=this.data[t]-s.data[t],e.data[t++]=i&this.DM,i>>=this.DB;if(s.t<this.t){for(i-=s.s;t<this.t;)i+=this.data[t],e.data[t++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;t<s.t;)i-=s.data[t],e.data[t++]=i&this.DM,i>>=this.DB;i-=s.s}e.s=0>i?-1:0,-1>i?e.data[t++]=this.DV+i:0<i&&(e.data[t++]=i),e.t=t,e.clamp()},T.prototype.multiplyTo=function(a,e){var t=this.abs(),r=a.abs(),n=t.t;for(e.t=n+r.t;0<=--n;)e.data[n]=0;for(n=0;n<r.t;++n)e.data[n+t.t]=t.am(0,r.data[n],e,n,0,t.t);e.s=0,e.clamp(),this.s!=a.s&&T.ZERO.subTo(e,e)},T.prototype.squareTo=function(n){for(var e=this.abs(),t=n.t=2*e.t;0<=--t;)n.data[t]=0;for(t=0;t<e.t-1;++t){var s=e.am(t,e.data[t],n,2*t,0,1);(n.data[t+e.t]+=e.am(t+1,2*e.data[t],n,2*t+1,s,e.t-t-1))>=e.DV&&(n.data[t+e.t]-=e.DV,n.data[t+e.t+1]=1)}0<n.t&&(n.data[n.t-1]+=e.am(t,e.data[t],n,2*t,0,1)),n.s=0,n.clamp()},T.prototype.divRemTo=function(a,e,t){var n=a.abs();if(!(0>=n.t)){var i=this.abs();if(i.t<n.t)return null!=e&&e.fromInt(0),void(null!=t&&this.copyTo(t));null==t&&(t=I());var s=I(),o=this.s,c=a.s,u=this.DB-B(n.data[n.t-1]);0<u?(n.lShiftTo(u,s),i.lShiftTo(u,t)):(n.copyTo(s),i.copyTo(t));var l=s.t,p=s.data[l-1];if(0!=p){var f=p*(1<<this.F1)+(1<l?s.data[l-2]>>this.F2:0),h=this.FV/f,d=(1<<this.F1)/f,y=1<<this.F2,g=t.t,C=g-l,A=null==e?I():e;for(s.dlShiftTo(C,A),0<=t.compareTo(A)&&(t.data[t.t++]=1,t.subTo(A,t)),T.ONE.dlShiftTo(l,A),A.subTo(s,s);s.t<l;)s.data[s.t++]=0;for(;0<=--C;){var E=t.data[--g]==p?this.DM:Math.floor(t.data[g]*h+(t.data[g-1]+y)*d);if((t.data[g]+=s.am(0,E,t,C,0,l))<E)for(s.dlShiftTo(C,A),t.subTo(A,t);t.data[g]<--E;)t.subTo(A,t)}null!=e&&(t.drShiftTo(l,e),o!=c&&T.ZERO.subTo(e,e)),t.t=l,t.clamp(),0<u&&t.rShiftTo(u,t),0>o&&T.ZERO.subTo(t,t)}}},T.prototype.invDigit=function(){if(1>this.t)return 0;var a=this.data[0];if(0==(1&a))return 0;var e=3&a;return e=15&e*(2-(15&a)*e),e=255&e*(2-(255&a)*e),e=65535&e*(2-(65535&(65535&a)*e)),e=e*(2-a*e%this.DV)%this.DV,0<e?this.DV-e:-e},T.prototype.isEven=function(){return 0==(0<this.t?1&this.data[0]:this.s)},T.prototype.exp=function(a,e){if(4294967295<a||1>a)return T.ONE;var t=I(),n=I(),d=e.convert(this),s=B(a)-1;for(d.copyTo(t);0<=--s;)if(e.sqrTo(t,n),0<(a&1<<s))e.mulTo(n,d,t);else{var l=t;t=n,n=l}return e.revert(t)},T.prototype.toString=function(c){if(0>this.s)return"-"+this.negate().toString(c);var e;if(16==c)e=4;else if(8==c)e=3;else if(2==c)e=1;else if(32==c)e=5;else{if(4!=c)return this.toRadix(c);e=2}var d,l=(1<<e)-1,a=!1,p="",u=this.t,g=this.DB-u*this.DB%e;if(0<u--)for(g<this.DB&&0<(d=this.data[u]>>g)&&(a=!0,p=i(d));0<=u;)g<e?(d=(this.data[u]&(1<<g)-1)<<e-g,d|=this.data[--u]>>(g+=this.DB-e)):(d=this.data[u]>>(g-=e)&l,0>=g&&(g+=this.DB,--u)),0<d&&(a=!0),a&&(p+=i(d));return a?p:"0"},T.prototype.negate=function(){var t=I();return T.ZERO.subTo(this,t),t},T.prototype.abs=function(){return 0>this.s?this.negate():this},T.prototype.compareTo=function(a){var e=this.s-a.s;if(0!=e)return e;var n=this.t;if(0!=(e=n-a.t))return 0>this.s?-e:e;for(;0<=--n;)if(0!=(e=this.data[n]-a.data[n]))return e;return 0},T.prototype.bitLength=function(){return 0>=this.t?0:this.DB*(this.t-1)+B(this.data[this.t-1]^this.s&this.DM)},T.prototype.mod=function(a){var e=I();return this.abs().divRemTo(a,null,e),0>this.s&&0<e.compareTo(T.ZERO)&&a.subTo(e,e),e},T.prototype.modPowInt=function(a,e){var t;return t=256>a||e.isEven()?new f(e):new C(e),this.exp(a,t)},T.ZERO=m(0),T.ONE=m(1),y.prototype.convert=h,y.prototype.revert=h,y.prototype.mulTo=function(a,e,t){a.multiplyTo(e,t)},y.prototype.sqrTo=function(a,e){a.squareTo(e)},E.prototype.convert=function(a){if(0>a.s||a.t>2*this.m.t)return a.mod(this.m);if(0>a.compareTo(this.m))return a;var e=I();return a.copyTo(e),this.reduce(e),e},E.prototype.revert=function(t){return t},E.prototype.reduce=function(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>t.compareTo(this.r2);)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);0<=t.compareTo(this.m);)t.subTo(this.m,t)},E.prototype.mulTo=function(a,e,t){a.multiplyTo(e,t),this.reduce(t)},E.prototype.sqrTo=function(a,e){a.squareTo(e),this.reduce(e)};var _=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],k=67108864/_[_.length-1];T.prototype.chunkSize=function(t){return Math.floor(Math.LN2*this.DB/Math.log(t))},T.prototype.toRadix=function(n){if(null==n&&(n=10),0==this.signum()||2>n||36<n)return"0";var c=this.chunkSize(n),t=Math.pow(n,c),r=m(t),a=I(),i=I(),s="";for(this.divRemTo(r,a,i);0<a.signum();)s=(t+i.intValue()).toString(n).substr(1)+s,a.divRemTo(r,a,i);return i.intValue().toString(n)+s},T.prototype.fromRadix=function(a,e){this.fromInt(0),null==e&&(e=10);for(var d,u=this.chunkSize(e),r=Math.pow(e,u),n=!1,g=0,y=0,h=0;h<a.length;++h)d=p(a,h),0>d?"-"==a.charAt(h)&&0==this.signum()&&(n=!0):(y=e*y+d,++g>=u&&(this.dMultiply(r),this.dAddOffset(y,0),g=0,y=0));0<g&&(this.dMultiply(Math.pow(e,g)),this.dAddOffset(y,0)),n&&T.ZERO.subTo(this,this)},T.prototype.fromNumber=function(a,e,t){if(!("number"==typeof e)){var r=[],n=7&a;r.length=1+(a>>3),e.nextBytes(r),0<n?r[0]&=(1<<n)-1:r[0]=0,this.fromString(r,256)}else if(2>a)this.fromInt(1);else for(this.fromNumber(a,t),this.testBit(a-1)||this.bitwiseTo(T.ONE.shiftLeft(a-1),o,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>a&&this.subTo(T.ONE.shiftLeft(a-1),this)},T.prototype.bitwiseTo=function(s,e,t){var r,o,c=Math.min(s.t,this.t);for(r=0;r<c;++r)t.data[r]=e(this.data[r],s.data[r]);if(s.t<this.t){for(o=s.s&this.DM,r=c;r<this.t;++r)t.data[r]=e(this.data[r],o);t.t=this.t}else{for(o=this.s&this.DM,r=c;r<s.t;++r)t.data[r]=e(o,s.data[r]);t.t=s.t}t.s=e(this.s,s.s),t.clamp()},T.prototype.changeBit=function(a,e){var t=T.ONE.shiftLeft(a);return this.bitwiseTo(t,e,t),t},T.prototype.addTo=function(s,e){for(var t=0,i=0,o=Math.min(s.t,this.t);t<o;)i+=this.data[t]+s.data[t],e.data[t++]=i&this.DM,i>>=this.DB;if(s.t<this.t){for(i+=s.s;t<this.t;)i+=this.data[t],e.data[t++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;t<s.t;)i+=s.data[t],e.data[t++]=i&this.DM,i>>=this.DB;i+=s.s}e.s=0>i?-1:0,0<i?e.data[t++]=i:-1>i&&(e.data[t++]=this.DV+i),e.t=t,e.clamp()},T.prototype.dMultiply=function(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()},T.prototype.dAddOffset=function(a,e){if(0!=a){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=a;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}},T.prototype.multiplyLowerTo=function(s,e,t){var r=Math.min(this.t+s.t,e);for(t.s=0,t.t=r;0<r;)t.data[--r]=0;var i;for(i=t.t-this.t;r<i;++r)t.data[r+this.t]=this.am(0,s.data[r],t,r,0,this.t);for(i=Math.min(s.t,e);r<i;++r)this.am(0,s.data[r],t,r,0,e-r);t.clamp()},T.prototype.multiplyUpperTo=function(n,e,s){--e;var r=s.t=this.t+n.t-e;for(s.s=0;0<=--r;)s.data[r]=0;for(r=Math.max(e-this.t,0);r<n.t;++r)s.data[this.t+r-e]=this.am(e-r,n.data[r],s,0,0,this.t+r-e);s.clamp(),s.drShiftTo(1,s)},T.prototype.modInt=function(n){if(0>=n)return 0;var e=this.DV%n,t=0>this.s?n-1:0;if(0<this.t)if(0==e)t=this.data[0]%n;else for(var s=this.t-1;0<=s;--s)t=(e*t+this.data[s])%n;return t},T.prototype.millerRabin=function(a){var e=this.subtract(T.ONE),t=e.getLowestSetBit();if(0>=t)return!1;for(var r,d=e.shiftRight(t),i=S(),s=0;s<a;++s){do r=new T(this.bitLength(),i);while(0>=r.compareTo(T.ONE)||0<=r.compareTo(e));var l=r.modPow(d,this);if(0!=l.compareTo(T.ONE)&&0!=l.compareTo(e)){for(var p=1;p++<t&&0!=l.compareTo(e);)if(l=l.modPowInt(2,this),0==l.compareTo(T.ONE))return!1;if(0!=l.compareTo(e))return!1}}return!0},T.prototype.clone=function(){var t=I();return this.copyTo(t),t},T.prototype.intValue=function(){if(0>this.s){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]},T.prototype.byteValue=function(){return 0==this.t?this.s:this.data[0]<<24>>24},T.prototype.shortValue=function(){return 0==this.t?this.s:this.data[0]<<16>>16},T.prototype.signum=function(){return 0>this.s?-1:0>=this.t||1==this.t&&0>=this.data[0]?0:1},T.prototype.toByteArray=function(){var s=this.t,i=[];i[0]=this.s;var t,o=this.DB-s*this.DB%8,c=0;if(0<s--)for(o<this.DB&&(t=this.data[s]>>o)!=(this.s&this.DM)>>o&&(i[c++]=t|this.s<<this.DB-o);0<=s;)8>o?(t=(this.data[s]&(1<<o)-1)<<8-o,t|=this.data[--s]>>(o+=this.DB-8)):(t=255&this.data[s]>>(o-=8),0>=o&&(o+=this.DB,--s)),0!=(128&t)&&(t|=-256),0==c&&(128&this.s)!=(128&t)&&++c,(0<c||t!=this.s)&&(i[c++]=t);return i},T.prototype.equals=function(t){return 0==this.compareTo(t)},T.prototype.min=function(t){return 0>this.compareTo(t)?this:t},T.prototype.max=function(t){return 0<this.compareTo(t)?this:t},T.prototype.and=function(a){var e=I();return this.bitwiseTo(a,s,e),e},T.prototype.or=function(a){var e=I();return this.bitwiseTo(a,o,e),e},T.prototype.xor=function(a){var e=I();return this.bitwiseTo(a,c,e),e},T.prototype.andNot=function(a){var e=I();return this.bitwiseTo(a,l,e),e},T.prototype.not=function(){for(var a=I(),e=0;e<this.t;++e)a.data[e]=this.DM&~this.data[e];return a.t=this.t,a.s=~this.s,a},T.prototype.shiftLeft=function(a){var e=I();return 0>a?this.rShiftTo(-a,e):this.lShiftTo(a,e),e},T.prototype.shiftRight=function(a){var e=I();return 0>a?this.lShiftTo(-a,e):this.rShiftTo(a,e),e},T.prototype.getLowestSetBit=function(){for(var t=0;t<this.t;++t)if(0!=this.data[t])return t*this.DB+u(this.data[t]);return 0>this.s?this.t*this.DB:-1},T.prototype.bitCount=function(){for(var a=0,n=this.s&this.DM,t=0;t<this.t;++t)a+=g(this.data[t]^n);return a},T.prototype.testBit=function(a){var e=Math.floor(a/this.DB);return e>=this.t?0!=this.s:0!=(this.data[e]&1<<a%this.DB)},T.prototype.setBit=function(t){return this.changeBit(t,o)},T.prototype.clearBit=function(t){return this.changeBit(t,l)},T.prototype.flipBit=function(t){return this.changeBit(t,c)},T.prototype.add=function(a){var e=I();return this.addTo(a,e),e},T.prototype.subtract=function(a){var e=I();return this.subTo(a,e),e},T.prototype.multiply=function(a){var e=I();return this.multiplyTo(a,e),e},T.prototype.divide=function(a){var e=I();return this.divRemTo(a,e,null),e},T.prototype.remainder=function(a){var e=I();return this.divRemTo(a,null,e),e},T.prototype.divideAndRemainder=function(a){var e=I(),t=I();return this.divRemTo(a,e,t),[e,t]},T.prototype.modPow=function(n,e){var t,S,T=n.bitLength(),A=m(1);if(0>=T)return A;t=18>T?1:48>T?3:144>T?4:768>T?5:6,S=8>T?new f(e):e.isEven()?new E(e):new C(e);var b=[],o=3,N=t-1,u=(1<<t)-1;if(b[1]=S.convert(this),1<t){var l=I();for(S.sqrTo(b[1],l);o<=u;)b[o]=I(),S.mulTo(l,b[o-2],b[o]),o+=2}var p,R,L=n.t-1,_=!0,k=I();for(T=B(n.data[L])-1;0<=L;){for(T>=N?p=n.data[L]>>T-N&u:(p=(n.data[L]&(1<<T+1)-1)<<N-T,0<L&&(p|=n.data[L-1]>>this.DB+T-N)),o=t;0==(1&p);)p>>=1,--o;if(0>(T-=o)&&(T+=this.DB,--L),_)b[p].copyTo(A),_=!1;else{for(;1<o;)S.sqrTo(A,k),S.sqrTo(k,A),o-=2;0<o?S.sqrTo(A,k):(R=A,A=k,k=R),S.mulTo(k,b[p],A)}for(;0<=L&&0==(n.data[L]&1<<T);)S.sqrTo(A,k),R=A,A=k,k=R,0>--T&&(T=this.DB-1,--L)}return S.revert(A)},T.prototype.modInverse=function(a){var e=a.isEven();if(this.isEven()&&e||0==a.signum())return T.ZERO;for(var t=a.clone(),r=this.clone(),n=m(1),i=m(0),s=m(0),o=m(1);0!=t.signum();){for(;t.isEven();)t.rShiftTo(1,t),e?(n.isEven()&&i.isEven()||(n.addTo(this,n),i.subTo(a,i)),n.rShiftTo(1,n)):i.isEven()||i.subTo(a,i),i.rShiftTo(1,i);for(;r.isEven();)r.rShiftTo(1,r),e?(s.isEven()&&o.isEven()||(s.addTo(this,s),o.subTo(a,o)),s.rShiftTo(1,s)):o.isEven()||o.subTo(a,o),o.rShiftTo(1,o);0<=t.compareTo(r)?(t.subTo(r,t),e&&n.subTo(s,n),i.subTo(o,i)):(r.subTo(t,r),e&&s.subTo(n,s),o.subTo(i,o))}return 0==r.compareTo(T.ONE)?0<=o.compareTo(a)?o.subtract(a):0>o.signum()?(o.addTo(a,o),0>o.signum()?o.add(a):o):o:T.ZERO},T.prototype.pow=function(t){return this.exp(t,new y)},T.prototype.gcd=function(s){var e=0>this.s?this.negate():this.clone(),o=0>s.s?s.negate():s.clone();if(0>e.compareTo(o)){var c=e;e=o,o=c}var a=e.getLowestSetBit(),d=o.getLowestSetBit();if(0>d)return e;for(a<d&&(d=a),0<d&&(e.rShiftTo(d,e),o.rShiftTo(d,o));0<e.signum();)0<(a=e.getLowestSetBit())&&e.rShiftTo(a,e),0<(a=o.getLowestSetBit())&&o.rShiftTo(a,o),0<=e.compareTo(o)?(e.subTo(o,e),e.rShiftTo(1,e)):(o.subTo(e,o),o.rShiftTo(1,o));return 0<d&&o.lShiftTo(d,o),o},T.prototype.isProbablePrime=function(s){var e,i=this.abs();if(1==i.t&&i.data[0]<=_[_.length-1]){for(e=0;e<_.length;++e)if(i.data[0]==_[e])return!0;return!1}if(i.isEven())return!1;for(e=1;e<_.length;){for(var r=_[e],o=e+1;o<_.length&&r<k;)r*=_[o++];for(r=i.modInt(r);e<o;)if(0==r%_[e++])return!1}return i.millerRabin(s)}},function(s,e,t){var i=t(0);t(1),s.exports=i.cipher=i.cipher||{},i.cipher.algorithms=i.cipher.algorithms||{},i.cipher.createCipher=function(a,e){var t=a;if("string"==typeof t&&(t=i.cipher.getAlgorithm(t))&&(t=t()),!t)throw new Error("Unsupported algorithm: "+a);return new i.cipher.BlockCipher({algorithm:t,key:e,decrypt:!1})},i.cipher.createDecipher=function(a,e){var t=a;if("string"==typeof t&&(t=i.cipher.getAlgorithm(t))&&(t=t()),!t)throw new Error("Unsupported algorithm: "+a);return new i.cipher.BlockCipher({algorithm:t,key:e,decrypt:!0})},i.cipher.registerAlgorithm=function(a,r){a=a.toUpperCase(),i.cipher.algorithms[a]=r},i.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in i.cipher.algorithms?i.cipher.algorithms[t]:null};var a=i.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};a.prototype.start=function(a){a=a||{};var n={};for(var t in a)n[t]=a[t];n.decrypt=this._decrypt,this._finish=!1,this._input=i.util.createBuffer(),this.output=a.output||i.util.createBuffer(),this.mode.start(n)},a.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},a.prototype.finish=function(a){a&&("ECB"===this.mode.name||"CBC"===this.mode.name)&&(this.mode.pad=function(e){return a(this.blockSize,e,!1)},this.mode.unpad=function(e){return a(this.blockSize,e,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,(this._decrypt||!this.mode.pad||this.mode.pad(this._input,e))&&(this._finish=!0,this.update(),!(this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))&&(!this.mode.afterFinish||this.mode.afterFinish(this.output,e)))}},function(d,e,t){function g(){i=String.fromCharCode(128),i+=n.util.fillString(String.fromCharCode(0),64),r=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],m=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],C=Array(64);for(var t=0;64>t;++t)C[t]=Math.floor(4294967296*Math.abs(Math.sin(t+1)));h=!0}function y(c,e,t){for(var l,u,g,y,E,S,T,I,B=t.length();64<=B;){for(u=c.h0,g=c.h1,y=c.h2,E=c.h3,I=0;16>I;++I)e[I]=t.getInt32Le(),S=E^g&(y^E),l=u+S+C[I]+e[I],T=m[I],u=E,E=y,y=g,g+=l<<T|l>>>32-T;for(;32>I;++I)S=y^E&(g^y),l=u+S+C[I]+e[r[I]],T=m[I],u=E,E=y,y=g,g+=l<<T|l>>>32-T;for(;48>I;++I)S=g^y^E,l=u+S+C[I]+e[r[I]],T=m[I],u=E,E=y,y=g,g+=l<<T|l>>>32-T;for(;64>I;++I)S=y^(g|~E),l=u+S+C[I]+e[r[I]],T=m[I],u=E,E=y,y=g,g+=l<<T|l>>>32-T;c.h0=0|c.h0+u,c.h1=0|c.h1+g,c.h2=0|c.h2+y,c.h3=0|c.h3+E,B-=64}}var n=t(0);t(4),t(1);var a=d.exports=n.md5=n.md5||{};n.md.md5=n.md.algorithms.md5=a,a.create=function(){h||g();var m=null,C=n.util.createBuffer(),E=Array(16),S={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return S.start=function(){S.messageLength=0,S.fullMessageLength=S.messageLength64=[];for(var e=S.messageLengthSize/4,t=0;t<e;++t)S.fullMessageLength.push(0);return C=n.util.createBuffer(),m={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},S},S.start(),S.update=function(e,t){"utf8"===t&&(e=n.util.encodeUtf8(e));var r=e.length;S.messageLength+=r,r=[r/4294967296>>>0,r>>>0];for(var s=S.fullMessageLength.length-1;0<=s;--s)S.fullMessageLength[s]+=r[1],r[1]=r[0]+(S.fullMessageLength[s]/4294967296>>>0),S.fullMessageLength[s]>>>=0,r[0]=r[1]/4294967296>>>0;return C.putBytes(e),y(m,E,C),(2048<C.read||0===C.length())&&C.compact(),S},S.digest=function(){var e=n.util.createBuffer();e.putBytes(C.bytes());var t=S.fullMessageLength[S.fullMessageLength.length-1]+S.messageLengthSize,a=t&S.blockLength-1;e.putBytes(i.substr(0,S.blockLength-a));for(var r,s=0,o=S.fullMessageLength.length-1;0<=o;--o)r=8*S.fullMessageLength[o]+s,s=r/4294967296>>>0,e.putInt32Le(r>>>0);var c={h0:m.h0,h1:m.h1,h2:m.h2,h3:m.h3};y(c,E,e);var u=n.util.createBuffer();return u.putInt32Le(c.h0),u.putInt32Le(c.h1),u.putInt32Le(c.h2),u.putInt32Le(c.h3),u},S};var i=null,r=null,m=null,C=null,h=!1},function(s,e,t){var S=t(0);t(8),t(4),t(1);var a,r=S.pkcs5=S.pkcs5||{};S.util.isNodejs&&!S.options.usePureJavaScript&&(a=t(16)),s.exports=S.pbkdf2=r.pbkdf2=function(n,T,I,r,i,B){function A(){return L>p?B(null,R):void(h.start(null,null),h.update(T),h.update(S.util.int32ToBytes(L)),d=N=h.digest().getBytes(),_=2,c())}function c(){return _<=I?(h.start(null,null),h.update(N),b=h.digest().getBytes(),d=S.util.xorBytes(d,b,u),N=b,++_,S.util.setImmediate(c)):void(R+=L<p?d:d.substr(0,f),++L,A())}if("function"==typeof i&&(B=i,i=null),S.util.isNodejs&&!S.options.usePureJavaScript&&a.pbkdf2&&(null===i||"object"!=typeof i)&&(4<a.pbkdf2Sync.length||!i||"sha1"===i))return"string"!=typeof i&&(i="sha1"),n=Buffer.from(n,"binary"),T=Buffer.from(T,"binary"),B?4===a.pbkdf2Sync.length?a.pbkdf2(n,T,I,r,function(a,e){return a?B(a):void B(null,e.toString("binary"))}):a.pbkdf2(n,T,I,r,i,function(a,e){return a?B(a):void B(null,e.toString("binary"))}):4===a.pbkdf2Sync.length?a.pbkdf2Sync(n,T,I,r).toString("binary"):a.pbkdf2Sync(n,T,I,r,i).toString("binary");if(void 0!==i&&null!==i||(i="sha1"),"string"==typeof i){if(!(i in S.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=S.md[i].create()}var u=i.digestLength;if(r>4294967295*u){var l=new Error("Derived key is too long.");if(B)return B(l);throw l}var p=Math.ceil(r/u),f=r-(p-1)*u,h=S.hmac.create();h.start(i,n);var d,b,N,R="";if(!B){for(var L=1;L<=p;++L){h.start(null,null),h.update(T),h.update(S.util.int32ToBytes(L)),d=N=h.digest().getBytes();for(var _=2;_<=I;++_)h.start(null,null),h.update(N),b=h.digest().getBytes(),d=S.util.xorBytes(d,b,u),N=b;R+=L<p?d:d.substr(0,f)}return R}var _,L=1;A()}},function(){},function(I,e,t){function r(s,e){"string"==typeof e&&(e={shortName:e});for(var i,o=null,c=0;null===o&&c<s.attributes.length;++c)i=s.attributes[c],e.type&&e.type===i.type?o=i:e.name&&e.name===i.name?o=i:e.shortName&&e.shortName===i.shortName&&(o=i);return o}function B(c){for(var e,d,p=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[]),a=c.attributes,n=0;n<a.length;++n){e=a[n];var u=e.value,g=l.Type.PRINTABLESTRING;"valueTagClass"in e&&(g=e.valueTagClass)===l.Type.UTF8&&(u=A.util.encodeUtf8(u)),d=l.create(l.Class.UNIVERSAL,l.Type.SET,!0,[l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(e.type).getBytes()),l.create(l.Class.UNIVERSAL,g,!1,u)])]),p.value.push(d)}return p}function a(s){for(var e,o=0;o<s.length;++o){if(e=s[o],void 0===e.name&&(e.type&&e.type in b.oids?e.name=b.oids[e.type]:e.shortName&&e.shortName in u&&(e.name=b.oids[u[e.shortName]])),void 0===e.type){if(!(e.name&&e.name in b.oids)){var c=new Error("Attribute type not specified.");throw c.attribute=e,c}e.type=b.oids[e.name]}if(void 0===e.shortName&&e.name&&e.name in u&&(e.shortName=u[e.name]),e.type===p.extensionRequest&&(e.valueConstructed=!0,e.valueTagClass=l.Type.SEQUENCE,!e.value&&e.extensions)){e.value=[];for(var d=0;d<e.extensions.length;++d)e.value.push(b.certificateExtensionToAsn1(i(e.extensions[d])))}if(void 0===e.value){var c=new Error("Attribute value not specified.");throw c.attribute=e,c}}}function i(n,e){if(e=e||{},void 0===n.name&&n.id&&n.id in b.oids&&(n.name=b.oids[n.id]),void 0===n.id){if(!(n.name&&n.name in b.oids)){var h=new Error("Extension ID not specified.");throw h.extension=n,h}n.id=b.oids[n.name]}if(void 0!==n.value)return n;if("keyUsage"===n.name){var f=0,T=0,I=0;n.digitalSignature&&(T|=128,f=7),n.nonRepudiation&&(T|=64,f=6),n.keyEncipherment&&(T|=32,f=5),n.dataEncipherment&&(T|=16,f=4),n.keyAgreement&&(T|=8,f=3),n.keyCertSign&&(T|=4,f=2),n.cRLSign&&(T|=2,f=1),n.encipherOnly&&(T|=1,f=0),n.decipherOnly&&(I|=128,f=7);var N=String.fromCharCode(f);0==I?0!==T&&(N+=String.fromCharCode(T)):N+=String.fromCharCode(T)+String.fromCharCode(I),n.value=l.create(l.Class.UNIVERSAL,l.Type.BITSTRING,!1,N)}else if("basicConstraints"===n.name)n.value=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[]),n.cA&&n.value.value.push(l.create(l.Class.UNIVERSAL,l.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in n&&n.value.value.push(l.create(l.Class.UNIVERSAL,l.Type.INTEGER,!1,l.integerToDer(n.pathLenConstraint).getBytes()));else if("extKeyUsage"===n.name){n.value=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[]);var R=n.value.value;for(var L in n)!0===n[L]&&(L in p?R.push(l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(p[L]).getBytes())):-1!==L.indexOf(".")&&R.push(l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(L).getBytes())))}else if("nsCertType"===n.name){var f=0,T=0;n.client&&(T|=128,f=7),n.server&&(T|=64,f=6),n.email&&(T|=32,f=5),n.objsign&&(T|=16,f=4),n.reserved&&(T|=8,f=3),n.sslCA&&(T|=4,f=2),n.emailCA&&(T|=2,f=1),n.objCA&&(T|=1,f=0);var N=String.fromCharCode(f);0!=T&&(N+=String.fromCharCode(T)),n.value=l.create(l.Class.UNIVERSAL,l.Type.BITSTRING,!1,N)}else if("subjectAltName"===n.name||"issuerAltName"===n.name){n.value=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[]);for(var u,_=0;_<n.altNames.length;++_){u=n.altNames[_];var N=u.value;if(!(7===u.type&&u.ip))8===u.type&&(N=u.oid?l.oidToDer(l.oidToDer(u.oid)):l.oidToDer(N));else if(null===(N=A.util.bytesFromIP(u.ip))){var h=new Error("Extension \"ip\" value is not a valid IPv4 or IPv6 address.");throw h.extension=n,h}n.value.value.push(l.create(l.Class.CONTEXT_SPECIFIC,u.type,!1,N))}}else if("nsComment"===n.name&&e.cert){if(!/^[\x00-\x7F]*$/.test(n.comment)||1>n.comment.length||128<n.comment.length)throw new Error("Invalid \"nsComment\" content.");n.value=l.create(l.Class.UNIVERSAL,l.Type.IA5STRING,!1,n.comment)}else if("subjectKeyIdentifier"===n.name&&e.cert){var k=e.cert.generateSubjectKeyIdentifier();n.subjectKeyIdentifier=k.toHex(),n.value=l.create(l.Class.UNIVERSAL,l.Type.OCTETSTRING,!1,k.getBytes())}else if("authorityKeyIdentifier"===n.name&&e.cert){n.value=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[]);var R=n.value.value;if(n.keyIdentifier){var g=!0===n.keyIdentifier?e.cert.generateSubjectKeyIdentifier().getBytes():n.keyIdentifier;R.push(l.create(l.Class.CONTEXT_SPECIFIC,0,!1,g))}if(n.authorityCertIssuer){var v=[l.create(l.Class.CONTEXT_SPECIFIC,4,!0,[B(!0===n.authorityCertIssuer?e.cert.issuer:n.authorityCertIssuer)])];R.push(l.create(l.Class.CONTEXT_SPECIFIC,1,!0,v))}if(n.serialNumber){var m=A.util.hexToBytes(!0===n.serialNumber?e.cert.serialNumber:n.serialNumber);R.push(l.create(l.Class.CONTEXT_SPECIFIC,2,!1,m))}}else if("cRLDistributionPoints"===n.name){n.value=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[]);for(var u,R=n.value.value,C=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[]),E=l.create(l.Class.CONTEXT_SPECIFIC,0,!0,[]),_=0;_<n.altNames.length;++_){u=n.altNames[_];var N=u.value;if(!(7===u.type&&u.ip))8===u.type&&(N=u.oid?l.oidToDer(l.oidToDer(u.oid)):l.oidToDer(N));else if(null===(N=A.util.bytesFromIP(u.ip))){var h=new Error("Extension \"ip\" value is not a valid IPv4 or IPv6 address.");throw h.extension=n,h}E.value.push(l.create(l.Class.CONTEXT_SPECIFIC,u.type,!1,N))}C.value.push(l.create(l.Class.CONTEXT_SPECIFIC,0,!0,[E])),R.push(C)}if(void 0===n.value){var h=new Error("Extension value not specified.");throw h.extension=n,h}return n}function n(a,e){switch(a){case p["RSASSA-PSS"]:var t=[];return void 0!==e.hash.algorithmOid&&t.push(l.create(l.Class.CONTEXT_SPECIFIC,0,!0,[l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(e.hash.algorithmOid).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.NULL,!1,"")])])),void 0!==e.mgf.algorithmOid&&t.push(l.create(l.Class.CONTEXT_SPECIFIC,1,!0,[l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(e.mgf.algorithmOid).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(e.mgf.hash.algorithmOid).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.NULL,!1,"")])])])),void 0!==e.saltLength&&t.push(l.create(l.Class.CONTEXT_SPECIFIC,2,!0,[l.create(l.Class.UNIVERSAL,l.Type.INTEGER,!1,l.integerToDer(e.saltLength).getBytes())])),l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,t);default:return l.create(l.Class.UNIVERSAL,l.Type.NULL,!1,"");}}function s(d){var e=l.create(l.Class.CONTEXT_SPECIFIC,0,!0,[]);if(0===d.attributes.length)return e;for(var t=d.attributes,r=0;r<t.length;++r){var p=t[r],n=p.value,u=l.Type.UTF8;"valueTagClass"in p&&(u=p.valueTagClass),u===l.Type.UTF8&&(n=A.util.encodeUtf8(n));var g=!1;"valueConstructed"in p&&(g=p.valueConstructed);var y=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(p.type).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.SET,!0,[l.create(l.Class.UNIVERSAL,u,g,n)])]);e.value.push(y)}return e}function o(t){return t>=m&&t<C?l.create(l.Class.UNIVERSAL,l.Type.UTCTIME,!1,l.dateToUtcTime(t)):l.create(l.Class.UNIVERSAL,l.Type.GENERALIZEDTIME,!1,l.dateToGeneralizedTime(t))}var A=t(0);t(5),t(3),t(10),t(4),t(39),t(6),t(7),t(18),t(11),t(1);var l=A.asn1,b=I.exports=A.pki=A.pki||{},p=b.oids,u={};u.CN=p.commonName,u.commonName="CN",u.C=p.countryName,u.countryName="C",u.L=p.localityName,u.localityName="L",u.ST=p.stateOrProvinceName,u.stateOrProvinceName="ST",u.O=p.organizationName,u.organizationName="O",u.OU=p.organizationalUnitName,u.organizationalUnitName="OU",u.E=p.emailAddress,u.emailAddress="E";var c=A.pki.rsa.publicKeyValidator,h={name:"Certificate",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:l.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:l.Class.UNIVERSAL,type:l.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:l.Class.UNIVERSAL,type:l.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:l.Class.UNIVERSAL,type:l.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:l.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:l.Class.UNIVERSAL,type:l.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:l.Class.UNIVERSAL,type:l.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:l.Class.UNIVERSAL,type:l.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:l.Class.UNIVERSAL,type:l.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},c,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:l.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:l.Class.UNIVERSAL,type:l.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:l.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:l.Class.UNIVERSAL,type:l.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:l.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:l.Class.UNIVERSAL,type:l.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:l.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:l.Class.UNIVERSAL,type:l.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},d={name:"rsapss",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:l.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:l.Class.UNIVERSAL,type:l.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:l.Class.UNIVERSAL,type:l.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:l.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:l.Class.UNIVERSAL,type:l.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:l.Class.UNIVERSAL,type:l.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:l.Class.UNIVERSAL,type:l.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:l.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:l.Class.UNIVERSAL,type:l.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:l.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:l.Class.UNIVERSAL,type:l.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},g={name:"CertificationRequestInfo",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:l.Class.UNIVERSAL,type:l.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},c,{name:"CertificationRequestInfo.attributes",tagClass:l.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:l.Class.UNIVERSAL,type:l.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:l.Class.UNIVERSAL,type:l.Type.SET,constructed:!0}]}]}]},y={name:"CertificationRequest",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[g,{name:"CertificationRequest.signatureAlgorithm",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:l.Class.UNIVERSAL,type:l.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:l.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:l.Class.UNIVERSAL,type:l.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};b.RDNAttributesAsArray=function(c,e){for(var t,d,g,y=[],i=0;i<c.value.length;++i){t=c.value[i];for(var h=0;h<t.value.length;++h)g={},d=t.value[h],g.type=l.derToOid(d.value[0].value),g.value=d.value[1].value,g.valueTagClass=d.value[1].type,g.type in p&&(g.name=p[g.type],g.name in u&&(g.shortName=u[g.name])),e&&(e.update(g.type),e.update(g.value)),y.push(g)}return y},b.CRIAttributesAsArray=function(d){for(var e=[],t=0;t<d.length;++t)for(var g,y=d[t],a=l.derToOid(y.value[0].value),n=y.value[1].value,i=0;i<n.length;++i){if(g={},g.type=a,g.value=n[i].value,g.valueTagClass=n[i].type,g.type in p&&(g.name=p[g.type],g.name in u&&(g.shortName=u[g.name])),g.type===p.extensionRequest){g.extensions=[];for(var h=0;h<g.value.length;++h)g.extensions.push(b.certificateExtensionFromAsn1(g.value[h]))}e.push(g)}return e};var f=function(o,e,t){var r={};if(o!==p["RSASSA-PSS"])return r;t&&(r={hash:{algorithmOid:p.sha1},mgf:{algorithmOid:p.mgf1,hash:{algorithmOid:p.sha1}},saltLength:20});var c={},n=[];if(!l.validate(e,d,c,n)){var i=new Error("Cannot read RSASSA-PSS parameter block.");throw i.errors=n,i}return void 0!==c.hashOid&&(r.hash=r.hash||{},r.hash.algorithmOid=l.derToOid(c.hashOid)),void 0!==c.maskGenOid&&(r.mgf=r.mgf||{},r.mgf.algorithmOid=l.derToOid(c.maskGenOid),r.mgf.hash=r.mgf.hash||{},r.mgf.hash.algorithmOid=l.derToOid(c.maskGenHashOid)),void 0!==c.saltLength&&(r.saltLength=c.saltLength.charCodeAt(0)),r};b.certificateFromPem=function(s,e,t){var r=A.pem.decode(s)[0];if("CERTIFICATE"!==r.type&&"X509 CERTIFICATE"!==r.type&&"TRUSTED CERTIFICATE"!==r.type){var a=new Error("Could not convert certificate from PEM; PEM header type is not \"CERTIFICATE\", \"X509 CERTIFICATE\", or \"TRUSTED CERTIFICATE\".");throw a.headerType=r.type,a}if(r.procType&&"ENCRYPTED"===r.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var n=l.fromDer(r.body,t);return b.certificateFromAsn1(n,e)},b.certificateToPem=function(a,e){var t={type:"CERTIFICATE",body:l.toDer(b.certificateToAsn1(a)).getBytes()};return A.pem.encode(t,{maxline:e})},b.publicKeyFromPem=function(n){var e=A.pem.decode(n)[0];if("PUBLIC KEY"!==e.type&&"RSA PUBLIC KEY"!==e.type){var t=new Error("Could not convert public key from PEM; PEM header type is not \"PUBLIC KEY\" or \"RSA PUBLIC KEY\".");throw t.headerType=e.type,t}if(e.procType&&"ENCRYPTED"===e.procType.type)throw new Error("Could not convert public key from PEM; PEM is encrypted.");var r=l.fromDer(e.body);return b.publicKeyFromAsn1(r)},b.publicKeyToPem=function(a,e){var t={type:"PUBLIC KEY",body:l.toDer(b.publicKeyToAsn1(a)).getBytes()};return A.pem.encode(t,{maxline:e})},b.publicKeyToRSAPublicKeyPem=function(a,e){var t={type:"RSA PUBLIC KEY",body:l.toDer(b.publicKeyToRSAPublicKey(a)).getBytes()};return A.pem.encode(t,{maxline:e})},b.getPublicKeyFingerprint=function(o,e){e=e||{};var c,d=e.md||A.md.sha1.create(),a=e.type||"RSAPublicKey";switch(a){case"RSAPublicKey":c=l.toDer(b.publicKeyToRSAPublicKey(o)).getBytes();break;case"SubjectPublicKeyInfo":c=l.toDer(b.publicKeyToAsn1(o)).getBytes();break;default:throw new Error("Unknown fingerprint type \""+e.type+"\".");}d.start(),d.update(c);var n=d.digest();if("hex"===e.encoding){var i=n.toHex();return e.delimiter?i.match(/.{2}/g).join(e.delimiter):i}if("binary"===e.encoding)return n.getBytes();if(e.encoding)throw new Error("Unknown encoding \""+e.encoding+"\".");return n},b.certificationRequestFromPem=function(s,e,t){var r=A.pem.decode(s)[0];if("CERTIFICATE REQUEST"!==r.type){var a=new Error("Could not convert certification request from PEM; PEM header type is not \"CERTIFICATE REQUEST\".");throw a.headerType=r.type,a}if(r.procType&&"ENCRYPTED"===r.procType.type)throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var n=l.fromDer(r.body,t);return b.certificationRequestFromAsn1(n,e)},b.certificationRequestToPem=function(a,e){var t={type:"CERTIFICATE REQUEST",body:l.toDer(b.certificationRequestToAsn1(a)).getBytes()};return A.pem.encode(t,{maxline:e})},b.createCertificate=function(){var g={};return g.version=2,g.serialNumber="00",g.signatureOid=null,g.signature=null,g.siginfo={},g.siginfo.algorithmOid=null,g.validity={},g.validity.notBefore=new Date,g.validity.notAfter=new Date,g.issuer={},g.issuer.getField=function(e){return r(g.issuer,e)},g.issuer.addField=function(e){a([e]),g.issuer.attributes.push(e)},g.issuer.attributes=[],g.issuer.hash=null,g.subject={},g.subject.getField=function(e){return r(g.subject,e)},g.subject.addField=function(e){a([e]),g.subject.attributes.push(e)},g.subject.attributes=[],g.subject.hash=null,g.extensions=[],g.publicKey=null,g.md=null,g.setSubject=function(e,t){a(e),g.subject.attributes=e,delete g.subject.uniqueId,t&&(g.subject.uniqueId=t),g.subject.hash=null},g.setIssuer=function(e,t){a(e),g.issuer.attributes=e,delete g.issuer.uniqueId,t&&(g.issuer.uniqueId=t),g.issuer.hash=null},g.setExtensions=function(e){for(var t=0;t<e.length;++t)i(e[t],{cert:g});g.extensions=e},g.getExtension=function(e){"string"==typeof e&&(e={name:e});for(var s,i=null,o=0;null===i&&o<g.extensions.length;++o)s=g.extensions[o],e.id&&s.id===e.id?i=s:e.name&&s.name===e.name&&(i=s);return i},g.sign=function(e,t){g.md=t||A.md.sha1.create();var r=p[g.md.algorithm+"WithRSAEncryption"];if(!r){var a=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw a.algorithm=g.md.algorithm,a}g.signatureOid=g.siginfo.algorithmOid=r,g.tbsCertificate=b.getTBSCertificate(g);var n=l.toDer(g.tbsCertificate);g.md.update(n.getBytes()),g.signature=e.sign(g.md)},g.verify=function(e){var t=!1;if(!g.issued(e)){var h=e.issuer,a=g.subject,n=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw n.expectedIssuer=h.attributes,n.actualIssuer=a.attributes,n}var f=e.md;if(null===f){if(e.signatureOid in p)switch(p[e.signatureOid]){case"sha1WithRSAEncryption":f=A.md.sha1.create();break;case"md5WithRSAEncryption":f=A.md.md5.create();break;case"sha256WithRSAEncryption":f=A.md.sha256.create();break;case"sha384WithRSAEncryption":f=A.md.sha384.create();break;case"sha512WithRSAEncryption":f=A.md.sha512.create();break;case"RSASSA-PSS":f=A.md.sha256.create();}if(null===f){var n=new Error("Could not compute certificate digest. Unknown signature OID.");throw n.signatureOid=e.signatureOid,n}var m=e.tbsCertificate||b.getTBSCertificate(e),o=l.toDer(m);f.update(o.getBytes())}if(null!==f){var c;switch(e.signatureOid){case p.sha1WithRSAEncryption:c=void 0;break;case p["RSASSA-PSS"]:var C,E;if(void 0===(C=p[e.signatureParameters.mgf.hash.algorithmOid])||void 0===A.md[C]){var n=new Error("Unsupported MGF hash function.");throw n.oid=e.signatureParameters.mgf.hash.algorithmOid,n.name=C,n}if(void 0===(E=p[e.signatureParameters.mgf.algorithmOid])||void 0===A.mgf[E]){var n=new Error("Unsupported MGF function.");throw n.oid=e.signatureParameters.mgf.algorithmOid,n.name=E,n}if(E=A.mgf[E].create(A.md[C].create()),void 0===(C=p[e.signatureParameters.hash.algorithmOid])||void 0===A.md[C])throw{message:"Unsupported RSASSA-PSS hash function.",oid:e.signatureParameters.hash.algorithmOid,name:C};c=A.pss.create(A.md[C].create(),E,e.signatureParameters.saltLength);}t=g.publicKey.verify(f.digest().getBytes(),e.signature,c)}return t},g.isIssuer=function(e){var t=!1,c=g.issuer,a=e.subject;if(c.hash&&a.hash)t=c.hash===a.hash;else if(c.attributes.length===a.attributes.length){t=!0;for(var n,d,l=0;t&&l<c.attributes.length;++l)n=c.attributes[l],d=a.attributes[l],n.type===d.type&&n.value===d.value||(t=!1)}return t},g.issued=function(e){return e.isIssuer(g)},g.generateSubjectKeyIdentifier=function(){return b.getPublicKeyFingerprint(g.publicKey,{type:"RSAPublicKey"})},g.verifySubjectKeyIdentifier=function(){for(var e,s=p.subjectKeyIdentifier,t=0;t<g.extensions.length;++t)if(e=g.extensions[t],e.id===s){var i=g.generateSubjectKeyIdentifier().getBytes();return A.util.hexToBytes(e.subjectKeyIdentifier)===i}return!1},g},b.certificateFromAsn1=function(i,e){var t={},g=[];if(!l.validate(i,h,t,g)){var n=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw n.errors=g,n}var C=l.derToOid(t.publicKeyOid);if(C!==b.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var E=b.createCertificate();E.version=t.certVersion?t.certVersion.charCodeAt(0):0;var c=A.util.createBuffer(t.certSerialNumber);E.serialNumber=c.toHex(),E.signatureOid=A.asn1.derToOid(t.certSignatureOid),E.signatureParameters=f(E.signatureOid,t.certSignatureParams,!0),E.siginfo.algorithmOid=A.asn1.derToOid(t.certinfoSignatureOid),E.siginfo.parameters=f(E.siginfo.algorithmOid,t.certinfoSignatureParams,!1),E.signature=t.certSignature;var u=[];if(void 0!==t.certValidity1UTCTime&&u.push(l.utcTimeToDate(t.certValidity1UTCTime)),void 0!==t.certValidity2GeneralizedTime&&u.push(l.generalizedTimeToDate(t.certValidity2GeneralizedTime)),void 0!==t.certValidity3UTCTime&&u.push(l.utcTimeToDate(t.certValidity3UTCTime)),void 0!==t.certValidity4GeneralizedTime&&u.push(l.generalizedTimeToDate(t.certValidity4GeneralizedTime)),2<u.length)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(2>u.length)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(E.validity.notBefore=u[0],E.validity.notAfter=u[1],E.tbsCertificate=t.tbsCertificate,e){if(E.md=null,E.signatureOid in p){var C=p[E.signatureOid];"sha1WithRSAEncryption"===C?E.md=A.md.sha1.create():"md5WithRSAEncryption"===C?E.md=A.md.md5.create():"sha256WithRSAEncryption"===C?E.md=A.md.sha256.create():"sha384WithRSAEncryption"===C?E.md=A.md.sha384.create():"sha512WithRSAEncryption"===C?E.md=A.md.sha512.create():"RSASSA-PSS"===C?E.md=A.md.sha256.create():void 0}if(null===E.md){var n=new Error("Could not compute certificate digest. Unknown signature OID.");throw n.signatureOid=E.signatureOid,n}var d=l.toDer(E.tbsCertificate);E.md.update(d.getBytes())}var y=A.md.sha1.create();E.issuer.getField=function(t){return r(E.issuer,t)},E.issuer.addField=function(t){a([t]),E.issuer.attributes.push(t)},E.issuer.attributes=b.RDNAttributesAsArray(t.certIssuer,y),t.certIssuerUniqueId&&(E.issuer.uniqueId=t.certIssuerUniqueId),E.issuer.hash=y.digest().toHex();var S=A.md.sha1.create();return E.subject.getField=function(t){return r(E.subject,t)},E.subject.addField=function(t){a([t]),E.subject.attributes.push(t)},E.subject.attributes=b.RDNAttributesAsArray(t.certSubject,S),t.certSubjectUniqueId&&(E.subject.uniqueId=t.certSubjectUniqueId),E.subject.hash=S.digest().toHex(),E.extensions=t.certExtensions?b.certificateExtensionsFromAsn1(t.certExtensions):[],E.publicKey=b.publicKeyFromAsn1(t.subjectPublicKeyInfo),E},b.certificateExtensionsFromAsn1=function(s){for(var e=[],t=0;t<s.value.length;++t)for(var i=s.value[t],a=0;a<i.value.length;++a)e.push(b.certificateExtensionFromAsn1(i.value[a]));return e},b.certificateExtensionFromAsn1=function(d){var e={};if(e.id=l.derToOid(d.value[0].value),e.critical=!1,d.value[1].type===l.Type.BOOLEAN?(e.critical=0!==d.value[1].value.charCodeAt(0),e.value=d.value[2].value):e.value=d.value[1].value,e.id in p)if(e.name=p[e.id],"keyUsage"===e.name){var t=l.fromDer(e.value),g=0,y=0;1<t.value.length&&(g=t.value.charCodeAt(1),y=2<t.value.length?t.value.charCodeAt(2):0),e.digitalSignature=128==(128&g),e.nonRepudiation=64==(64&g),e.keyEncipherment=32==(32&g),e.dataEncipherment=16==(16&g),e.keyAgreement=8==(8&g),e.keyCertSign=4==(4&g),e.cRLSign=2==(2&g),e.encipherOnly=1==(1&g),e.decipherOnly=128==(128&y)}else if("basicConstraints"===e.name){var t=l.fromDer(e.value);e.cA=!!(0<t.value.length&&t.value[0].type===l.Type.BOOLEAN)&&0!==t.value[0].value.charCodeAt(0);var h=null;0<t.value.length&&t.value[0].type===l.Type.INTEGER?h=t.value[0].value:1<t.value.length&&(h=t.value[1].value),null!==h&&(e.pathLenConstraint=l.derToInteger(h))}else if("extKeyUsage"===e.name)for(var m,t=l.fromDer(e.value),C=0;C<t.value.length;++C)m=l.derToOid(t.value[C].value),m in p?e[p[m]]=!0:e[m]=!0;else if("nsCertType"===e.name){var t=l.fromDer(e.value),g=0;1<t.value.length&&(g=t.value.charCodeAt(1)),e.client=128==(128&g),e.server=64==(64&g),e.email=32==(32&g),e.objsign=16==(16&g),e.reserved=8==(8&g),e.sslCA=4==(4&g),e.emailCA=2==(2&g),e.objCA=1==(1&g)}else if("subjectAltName"===e.name||"issuerAltName"===e.name){e.altNames=[];for(var E,t=l.fromDer(e.value),S=0;S<t.value.length;++S){E=t.value[S];var T={type:E.type,value:E.value};switch(e.altNames.push(T),E.type){case 1:case 2:case 6:break;case 7:T.ip=A.util.bytesToIP(E.value);break;case 8:T.oid=l.derToOid(E.value);}}}else if("subjectKeyIdentifier"===e.name){var t=l.fromDer(e.value);e.subjectKeyIdentifier=A.util.bytesToHex(t.value)}return e},b.certificationRequestFromAsn1=function(i,e){var t={},g=[];if(!l.validate(i,y,t,g)){var n=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw n.errors=g,n}var h=l.derToOid(t.publicKeyOid);if(h!==b.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var m=b.createCertificationRequest();if(m.version=t.csrVersion?t.csrVersion.charCodeAt(0):0,m.signatureOid=A.asn1.derToOid(t.csrSignatureOid),m.signatureParameters=f(m.signatureOid,t.csrSignatureParams,!0),m.siginfo.algorithmOid=A.asn1.derToOid(t.csrSignatureOid),m.siginfo.parameters=f(m.siginfo.algorithmOid,t.csrSignatureParams,!1),m.signature=t.csrSignature,m.certificationRequestInfo=t.certificationRequestInfo,e){if(m.md=null,m.signatureOid in p){var h=p[m.signatureOid];"sha1WithRSAEncryption"===h?m.md=A.md.sha1.create():"md5WithRSAEncryption"===h?m.md=A.md.md5.create():"sha256WithRSAEncryption"===h?m.md=A.md.sha256.create():"sha384WithRSAEncryption"===h?m.md=A.md.sha384.create():"sha512WithRSAEncryption"===h?m.md=A.md.sha512.create():"RSASSA-PSS"===h?m.md=A.md.sha256.create():void 0}if(null===m.md){var n=new Error("Could not compute certification request digest. Unknown signature OID.");throw n.signatureOid=m.signatureOid,n}var c=l.toDer(m.certificationRequestInfo);m.md.update(c.getBytes())}var u=A.md.sha1.create();return m.subject.getField=function(t){return r(m.subject,t)},m.subject.addField=function(t){a([t]),m.subject.attributes.push(t)},m.subject.attributes=b.RDNAttributesAsArray(t.certificationRequestInfoSubject,u),m.subject.hash=u.digest().toHex(),m.publicKey=b.publicKeyFromAsn1(t.subjectPublicKeyInfo),m.getAttribute=function(t){return r(m,t)},m.addAttribute=function(t){a([t]),m.attributes.push(t)},m.attributes=b.CRIAttributesAsArray(t.certificationRequestInfoAttributes||[]),m},b.createCertificationRequest=function(){var d={};return d.version=0,d.signatureOid=null,d.signature=null,d.siginfo={},d.siginfo.algorithmOid=null,d.subject={},d.subject.getField=function(e){return r(d.subject,e)},d.subject.addField=function(e){a([e]),d.subject.attributes.push(e)},d.subject.attributes=[],d.subject.hash=null,d.publicKey=null,d.attributes=[],d.getAttribute=function(e){return r(d,e)},d.addAttribute=function(e){a([e]),d.attributes.push(e)},d.md=null,d.setSubject=function(e){a(e),d.subject.attributes=e,d.subject.hash=null},d.setAttributes=function(e){a(e),d.attributes=e},d.sign=function(e,t){d.md=t||A.md.sha1.create();var r=p[d.md.algorithm+"WithRSAEncryption"];if(!r){var a=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw a.algorithm=d.md.algorithm,a}d.signatureOid=d.siginfo.algorithmOid=r,d.certificationRequestInfo=b.getCertificationRequestInfo(d);var n=l.toDer(d.certificationRequestInfo);d.md.update(n.getBytes()),d.signature=e.sign(d.md)},d.verify=function(){var e=!1,u=d.md;if(null===u){if(d.signatureOid in p)switch(p[d.signatureOid]){case"sha1WithRSAEncryption":u=A.md.sha1.create();break;case"md5WithRSAEncryption":u=A.md.md5.create();break;case"sha256WithRSAEncryption":u=A.md.sha256.create();break;case"sha384WithRSAEncryption":u=A.md.sha384.create();break;case"sha512WithRSAEncryption":u=A.md.sha512.create();break;case"RSASSA-PSS":u=A.md.sha256.create();}if(null===u){var g=new Error("Could not compute certification request digest. Unknown signature OID.");throw g.signatureOid=d.signatureOid,g}var y=d.certificationRequestInfo||b.getCertificationRequestInfo(d),n=l.toDer(y);u.update(n.getBytes())}if(null!==u){var i;switch(d.signatureOid){case p.sha1WithRSAEncryption:break;case p["RSASSA-PSS"]:var h,f;if(void 0===(h=p[d.signatureParameters.mgf.hash.algorithmOid])||void 0===A.md[h]){var g=new Error("Unsupported MGF hash function.");throw g.oid=d.signatureParameters.mgf.hash.algorithmOid,g.name=h,g}if(void 0===(f=p[d.signatureParameters.mgf.algorithmOid])||void 0===A.mgf[f]){var g=new Error("Unsupported MGF function.");throw g.oid=d.signatureParameters.mgf.algorithmOid,g.name=f,g}if(f=A.mgf[f].create(A.md[h].create()),void 0===(h=p[d.signatureParameters.hash.algorithmOid])||void 0===A.md[h]){var g=new Error("Unsupported RSASSA-PSS hash function.");throw g.oid=d.signatureParameters.hash.algorithmOid,g.name=h,g}i=A.pss.create(A.md[h].create(),f,d.signatureParameters.saltLength);}e=d.publicKey.verify(u.digest().getBytes(),d.signature,i)}return e},d};var m=new Date("1950-01-01T00:00:00Z"),C=new Date("2050-01-01T00:00:00Z");b.getTBSCertificate=function(s){var e=o(s.validity.notBefore),t=o(s.validity.notAfter),r=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.CONTEXT_SPECIFIC,0,!0,[l.create(l.Class.UNIVERSAL,l.Type.INTEGER,!1,l.integerToDer(s.version).getBytes())]),l.create(l.Class.UNIVERSAL,l.Type.INTEGER,!1,A.util.hexToBytes(s.serialNumber)),l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(s.siginfo.algorithmOid).getBytes()),n(s.siginfo.algorithmOid,s.siginfo.parameters)]),B(s.issuer),l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[e,t]),B(s.subject),b.publicKeyToAsn1(s.publicKey)]);return s.issuer.uniqueId&&r.value.push(l.create(l.Class.CONTEXT_SPECIFIC,1,!0,[l.create(l.Class.UNIVERSAL,l.Type.BITSTRING,!1,String.fromCharCode(0)+s.issuer.uniqueId)])),s.subject.uniqueId&&r.value.push(l.create(l.Class.CONTEXT_SPECIFIC,2,!0,[l.create(l.Class.UNIVERSAL,l.Type.BITSTRING,!1,String.fromCharCode(0)+s.subject.uniqueId)])),0<s.extensions.length&&r.value.push(b.certificateExtensionsToAsn1(s.extensions)),r},b.getCertificationRequestInfo=function(t){return l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.INTEGER,!1,l.integerToDer(t.version).getBytes()),B(t.subject),b.publicKeyToAsn1(t.publicKey),s(t)])},b.distinguishedNameToAsn1=function(t){return B(t)},b.certificateToAsn1=function(a){var e=a.tbsCertificate||b.getTBSCertificate(a);return l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[e,l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(a.signatureOid).getBytes()),n(a.signatureOid,a.signatureParameters)]),l.create(l.Class.UNIVERSAL,l.Type.BITSTRING,!1,String.fromCharCode(0)+a.signature)])},b.certificateExtensionsToAsn1=function(n){var e=l.create(l.Class.CONTEXT_SPECIFIC,3,!0,[]),t=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[]);e.value.push(t);for(var r=0;r<n.length;++r)t.value.push(b.certificateExtensionToAsn1(n[r]));return e},b.certificateExtensionToAsn1=function(a){var e=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[]);e.value.push(l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(a.id).getBytes())),a.critical&&e.value.push(l.create(l.Class.UNIVERSAL,l.Type.BOOLEAN,!1,String.fromCharCode(255)));var t=a.value;return"string"!=typeof a.value&&(t=l.toDer(t).getBytes()),e.value.push(l.create(l.Class.UNIVERSAL,l.Type.OCTETSTRING,!1,t)),e},b.certificationRequestToAsn1=function(a){var e=a.certificationRequestInfo||b.getCertificationRequestInfo(a);return l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[e,l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(a.signatureOid).getBytes()),n(a.signatureOid,a.signatureParameters)]),l.create(l.Class.UNIVERSAL,l.Type.BITSTRING,!1,String.fromCharCode(0)+a.signature)])},b.createCaStore=function(n){function c(t){return d(t),p.certs[t.hash]||null}function d(a){if(!a.hash){var e=A.md.sha1.create();a.attributes=b.RDNAttributesAsArray(B(a),e),a.hash=e.digest().toHex()}}var p={certs:{}};if(p.getIssuer=function(t){return c(t.issuer)},p.addCertificate=function(a){if("string"==typeof a&&(a=A.pki.certificateFromPem(a)),d(a.subject),!p.hasCertificate(a))if(a.subject.hash in p.certs){var r=p.certs[a.subject.hash];A.util.isArray(r)||(r=[r]),r.push(a),p.certs[a.subject.hash]=r}else p.certs[a.subject.hash]=a},p.hasCertificate=function(t){"string"==typeof t&&(t=A.pki.certificateFromPem(t));var s=c(t.subject);if(!s)return!1;A.util.isArray(s)||(s=[s]);for(var i=l.toDer(b.certificateToAsn1(t)).getBytes(),a=0;a<s.length;++a)if(i===l.toDer(b.certificateToAsn1(s[a])).getBytes())return!0;return!1},p.listAllCertificates=function(){var a=[];for(var e in p.certs)if(p.certs.hasOwnProperty(e)){var t=p.certs[e];if(A.util.isArray(t))for(var r=0;r<t.length;++r)a.push(t[r]);else a.push(t)}return a},p.removeCertificate=function(t){var a;if("string"==typeof t&&(t=A.pki.certificateFromPem(t)),d(t.subject),!p.hasCertificate(t))return null;var r=c(t.subject);if(!A.util.isArray(r))return a=p.certs[t.subject.hash],delete p.certs[t.subject.hash],a;for(var i=l.toDer(b.certificateToAsn1(t)).getBytes(),s=0;s<r.length;++s)i===l.toDer(b.certificateToAsn1(r[s])).getBytes()&&(a=r[s],r.splice(s,1));return 0===r.length&&delete p.certs[t.subject.hash],a},n)for(var e,t=0;t<n.length;++t)e=n[t],p.addCertificate(e);return p},b.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},b.verifyCertificateChain=function(l,e,f){"function"==typeof f&&(f={verify:f}),f=f||{},e=e.slice(0);var T=e.slice(0),a=f.validityCheckDate;void 0===a&&(a=new Date);var I=!0,B=null,N=0;do{var R=e.shift(),c=null,L=!1;if(a&&(a<R.validity.notBefore||a>R.validity.notAfter)&&(B={message:"Certificate is not valid yet or has expired.",error:b.certificateError.certificate_expired,notBefore:R.validity.notBefore,notAfter:R.validity.notAfter,now:a}),null===B){if(c=e[0]||l.getIssuer(R),null===c&&R.isIssuer(R)&&(L=!0,c=R),c){var _=c;A.util.isArray(_)||(_=[_]);for(var k=!1;!k&&0<_.length;){c=_.shift();try{k=c.verify(R)}catch(t){}}k||(B={message:"Certificate signature is invalid.",error:b.certificateError.bad_certificate})}null!==B||c&&!L||l.hasCertificate(R)||(B={message:"Certificate is not trusted.",error:b.certificateError.unknown_ca})}if(null===B&&c&&!R.isIssuer(c)&&(B={message:"Certificate issuer is invalid.",error:b.certificateError.bad_certificate}),null===B)for(var U,D={keyUsage:!0,basicConstraints:!0},y=0;null===B&&y<R.extensions.length;++y)U=R.extensions[y],!U.critical||U.name in D||(B={message:"Certificate has an unsupported critical extension.",error:b.certificateError.unsupported_certificate});if(null===B&&(!I||0===e.length&&(!c||L))){var P=R.getExtension("basicConstraints"),m=R.getExtension("keyUsage");(null!==m&&(m.keyCertSign&&null!==P||(B={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:b.certificateError.bad_certificate})),null!=B||null===P||P.cA||(B={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:b.certificateError.bad_certificate}),null==B&&null!==m&&"pathLenConstraint"in P)&&N-1>P.pathLenConstraint&&(B={message:"Certificate basicConstraints pathLenConstraint violated.",error:b.certificateError.bad_certificate})}var C=null===B||B.error,E=f.verify?f.verify(C,N,T):C;if(!0!==E)throw!0===C&&(B={message:"The application rejected the certificate.",error:b.certificateError.bad_certificate}),(E||0===E)&&("object"!=typeof E||A.util.isArray(E)?"string"==typeof E&&(B.error=E):(E.message&&(B.message=E.message),E.error&&(B.error=E.error))),B;B=null,I=!1,++N}while(0<e.length);return!0}},function(n,e,t){var S=t(0);t(2),t(1),(n.exports=S.pss=S.pss||{}).create=function(a){3===arguments.length&&(a={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var T=a.md,t=a.mgf,r=T.digestLength,n=a.salt||null;"string"==typeof n&&(n=S.util.createBuffer(n));var I;if("saltLength"in a)I=a.saltLength;else{if(null===n)throw new Error("Salt length not specified or specific salt not given.");I=n.length()}if(null!==n&&n.length()!==I)throw new Error("Given salt length does not match length of given salt.");var B=a.prng||S.random,o={};return o.encode=function(a,e){var s,i=e-1,o=Math.ceil(i/8),c=a.digest().getBytes();if(o<r+I+2)throw new Error("Message is too long to encrypt.");var l=null===n?B.getBytesSync(I):n.bytes();var p=new S.util.ByteBuffer;p.fillWithByte(0,8),p.putBytes(c),p.putBytes(l),T.start(),T.update(p.getBytes());var d=T.digest().getBytes(),y=new S.util.ByteBuffer;y.fillWithByte(0,o-I-r-2),y.putByte(1),y.putBytes(l);var g=y.getBytes(),h=o-r-1,f=t.generate(d,h),m="";for(s=0;s<h;s++)m+=String.fromCharCode(g.charCodeAt(s)^f.charCodeAt(s));return(m=String.fromCharCode(m.charCodeAt(0)&~(255&65280>>8*o-i))+m.substr(1))+d+String.fromCharCode(188)},o.verify=function(a,e,n){var s,o=n-1,u=Math.ceil(o/8);if(e=e.substr(-u),u<r+I+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(188!==e.charCodeAt(u-1))throw new Error("Encoded message does not end in 0xBC.");var l=u-r-1,p=e.substr(0,l),f=e.substr(l,r),h=255&65280>>8*u-o;if(0!=(p.charCodeAt(0)&h))throw new Error("Bits beyond keysize not zero as expected.");var d=t.generate(f,l),y="";for(s=0;s<l;s++)y+=String.fromCharCode(p.charCodeAt(s)^d.charCodeAt(s));y=String.fromCharCode(y.charCodeAt(0)&~h)+y.substr(1);var E=u-r-I-2;for(s=0;s<E;s++)if(0!==y.charCodeAt(s))throw new Error("Leftmost octets not zero as expected");if(1!==y.charCodeAt(E))throw new Error("Inconsistent PSS signature, 0x01 marker not found");var B=y.substr(-I),m=new S.util.ByteBuffer;return m.fillWithByte(0,8),m.putBytes(a),m.putBytes(B),T.start(),T.update(m.getBytes()),f===T.digest().getBytes()},o}},function(c,e,t){function r(s,o){if("string"==typeof s&&(s=i.util.createBuffer(s)),i.util.isArray(s)&&4<s.length){var t=s;s=i.util.createBuffer();for(var r=0;r<t.length;++r)s.putByte(t[r])}if(s.length()<o)throw new Error("Invalid IV length; got "+s.length()+" bytes and expected "+o+" bytes.");if(!i.util.isArray(s)){for(var c=[],r=0;r<o/4;++r)c.push(s.getInt32());s=c}return s}function d(t){t[t.length-1]=4294967295&t[t.length-1]+1}function l(t){return[0|t/4294967296,4294967295&t]}var i=t(0);t(1),i.cipher=i.cipher||{};var a=c.exports=i.cipher.modes=i.cipher.modes||{};a.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=Array(this._ints),this._outBlock=Array(this._ints)},a.ecb.prototype.start=function(){},a.ecb.prototype.encrypt=function(n,e,t){if(n.length()<this.blockSize&&!(t&&0<n.length()))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=n.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)e.putInt32(this._outBlock[r])},a.ecb.prototype.decrypt=function(n,e,t){if(n.length()<this.blockSize&&!(t&&0<n.length()))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=n.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)e.putInt32(this._outBlock[r])},a.ecb.prototype.pad=function(t){var e=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(e,e),!0},a.ecb.prototype.unpad=function(n,e){if(0<e.overflow)return!1;var t=n.length(),r=n.at(t-1);return!(r>this.blockSize<<2)&&(n.truncate(r),!0)},a.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=Array(this._ints),this._outBlock=Array(this._ints)},a.cbc.prototype.start=function(t){if(null===t.iv){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else{if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=r(t.iv,this.blockSize),this._prev=this._iv.slice(0)}},a.cbc.prototype.encrypt=function(n,e,t){if(n.length()<this.blockSize&&!(t&&0<n.length()))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=this._prev[r]^n.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)e.putInt32(this._outBlock[r]);this._prev=this._outBlock},a.cbc.prototype.decrypt=function(n,e,t){if(n.length()<this.blockSize&&!(t&&0<n.length()))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=n.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)e.putInt32(this._prev[r]^this._outBlock[r]);this._prev=this._inBlock.slice(0)},a.cbc.prototype.pad=function(t){var e=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(e,e),!0},a.cbc.prototype.unpad=function(n,e){if(0<e.overflow)return!1;var t=n.length(),r=n.at(t-1);return!(r>this.blockSize<<2)&&(n.truncate(r),!0)},a.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=Array(this._ints),this._partialBlock=Array(this._ints),this._partialOutput=i.util.createBuffer(),this._partialBytes=0},a.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=r(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},a.cfb.prototype.encrypt=function(s,e,t){var r=s.length();if(0===r)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&r>=this.blockSize)for(var a=0;a<this._ints;++a)this._inBlock[a]=s.getInt32()^this._outBlock[a],e.putInt32(this._inBlock[a]);else{var o=(this.blockSize-r)%this.blockSize;0<o&&(o=this.blockSize-o),this._partialOutput.clear();for(var a=0;a<this._ints;++a)this._partialBlock[a]=s.getInt32()^this._outBlock[a],this._partialOutput.putInt32(this._partialBlock[a]);if(0<o)s.read-=this.blockSize;else for(var a=0;a<this._ints;++a)this._inBlock[a]=this._partialBlock[a];if(0<this._partialBytes&&this._partialOutput.getBytes(this._partialBytes),0<o&&!t)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}},a.cfb.prototype.decrypt=function(s,e,t){var r=s.length();if(0===r)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&r>=this.blockSize)for(var a=0;a<this._ints;++a)this._inBlock[a]=s.getInt32(),e.putInt32(this._inBlock[a]^this._outBlock[a]);else{var o=(this.blockSize-r)%this.blockSize;0<o&&(o=this.blockSize-o),this._partialOutput.clear();for(var a=0;a<this._ints;++a)this._partialBlock[a]=s.getInt32(),this._partialOutput.putInt32(this._partialBlock[a]^this._outBlock[a]);if(0<o)s.read-=this.blockSize;else for(var a=0;a<this._ints;++a)this._inBlock[a]=this._partialBlock[a];if(0<this._partialBytes&&this._partialOutput.getBytes(this._partialBytes),0<o&&!t)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}},a.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=Array(this._ints),this._partialOutput=i.util.createBuffer(),this._partialBytes=0},a.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=r(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},a.ofb.prototype.encrypt=function(s,e,t){var r=s.length();if(0===s.length())return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&r>=this.blockSize)for(var a=0;a<this._ints;++a)e.putInt32(s.getInt32()^this._outBlock[a]),this._inBlock[a]=this._outBlock[a];else{var o=(this.blockSize-r)%this.blockSize;0<o&&(o=this.blockSize-o),this._partialOutput.clear();for(var a=0;a<this._ints;++a)this._partialOutput.putInt32(s.getInt32()^this._outBlock[a]);if(0<o)s.read-=this.blockSize;else for(var a=0;a<this._ints;++a)this._inBlock[a]=this._outBlock[a];if(0<this._partialBytes&&this._partialOutput.getBytes(this._partialBytes),0<o&&!t)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}},a.ofb.prototype.decrypt=a.ofb.prototype.encrypt,a.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=Array(this._ints),this._partialOutput=i.util.createBuffer(),this._partialBytes=0},a.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=r(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},a.ctr.prototype.encrypt=function(n,e,t){var r=n.length();if(0===r)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&r>=this.blockSize)for(var a=0;a<this._ints;++a)e.putInt32(n.getInt32()^this._outBlock[a]);else{var o=(this.blockSize-r)%this.blockSize;0<o&&(o=this.blockSize-o),this._partialOutput.clear();for(var a=0;a<this._ints;++a)this._partialOutput.putInt32(n.getInt32()^this._outBlock[a]);if(0<o&&(n.read-=this.blockSize),0<this._partialBytes&&this._partialOutput.getBytes(this._partialBytes),0<o&&!t)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}d(this._inBlock)},a.ctr.prototype.decrypt=a.ctr.prototype.encrypt,a.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=Array(this._ints),this._outBlock=Array(this._ints),this._partialOutput=i.util.createBuffer(),this._partialBytes=0,this._R=3774873600},a.gcm.prototype.start=function(n){if(!("iv"in n))throw new Error("Invalid IV parameter.");var e=i.util.createBuffer(n.iv);this._cipherLength=0;var t;if(t="additionalData"in n?i.util.createBuffer(n.additionalData):i.util.createBuffer(),this._tagLength="tagLength"in n?n.tagLength:128,this._tag=null,n.decrypt&&(this._tag=i.util.createBuffer(n.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=Array(this._ints),this.tag=null,this._hashSubkey=Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var s=e.length();if(12===s)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];0<e.length();)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(l(8*s)))}this._inBlock=this._j0.slice(0),d(this._inBlock),this._partialBytes=0,t=i.util.createBuffer(t),this._aDataLength=l(8*t.length());var a=t.length()%this.blockSize;for(a&&t.fillWithByte(0,this.blockSize-a),this._s=[0,0,0,0];0<t.length();)this._s=this.ghash(this._hashSubkey,this._s,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()])},a.gcm.prototype.encrypt=function(n,e,t){var r=n.length();if(0===r)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&r>=this.blockSize){for(var a=0;a<this._ints;++a)e.putInt32(this._outBlock[a]^=n.getInt32());this._cipherLength+=this.blockSize}else{var c=(this.blockSize-r)%this.blockSize;0<c&&(c=this.blockSize-c),this._partialOutput.clear();for(var a=0;a<this._ints;++a)this._partialOutput.putInt32(n.getInt32()^this._outBlock[a]);if(0>=c||t){if(t){var l=r%this.blockSize;this._cipherLength+=l,this._partialOutput.truncate(this.blockSize-l)}else this._cipherLength+=this.blockSize;for(var a=0;a<this._ints;++a)this._outBlock[a]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(0<this._partialBytes&&this._partialOutput.getBytes(this._partialBytes),0<c&&!t)return n.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(c-this._partialBytes)),this._partialBytes=c,!0;e.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),d(this._inBlock)},a.gcm.prototype.decrypt=function(n,e,t){var r=n.length();if(r<this.blockSize&&!(t&&0<r))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),d(this._inBlock),this._hashBlock[0]=n.getInt32(),this._hashBlock[1]=n.getInt32(),this._hashBlock[2]=n.getInt32(),this._hashBlock[3]=n.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var a=0;a<this._ints;++a)e.putInt32(this._outBlock[a]^this._hashBlock[a]);this._cipherLength+=r<this.blockSize?r%this.blockSize:this.blockSize},a.gcm.prototype.afterFinish=function(s,e){var t=!0;e.decrypt&&e.overflow&&s.truncate(this.blockSize-e.overflow),this.tag=i.util.createBuffer();var c=this._aDataLength.concat(l(8*this._cipherLength));this._s=this.ghash(this._hashSubkey,this._s,c);var a=[];this.cipher.encrypt(this._j0,a);for(var n=0;n<this._ints;++n)this.tag.putInt32(this._s[n]^a[n]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(t=!1),t},a.gcm.prototype.multiply=function(s,e){for(var t=[0,0,0,0],r=e.slice(0),a=0;128>a;++a)s[0|a/32]&1<<31-a%32&&(t[0]^=r[0],t[1]^=r[1],t[2]^=r[2],t[3]^=r[3]),this.pow(r,r);return t},a.gcm.prototype.pow=function(n,e){for(var t=1&n[3],r=3;0<r;--r)e[r]=n[r]>>>1|(1&n[r-1])<<31;e[0]=n[0]>>>1,t&&(e[0]^=this._R)},a.gcm.prototype.tableMultiply=function(s){for(var e=[0,0,0,0],t=0;32>t;++t){var o=0|t/8,a=15&s[o]>>>4*(7-t%8),n=this._m[t][a];e[0]^=n[0],e[1]^=n[1],e[2]^=n[2],e[3]^=n[3]}return e},a.gcm.prototype.ghash=function(a,e,t){return e[0]^=t[0],e[1]^=t[1],e[2]^=t[2],e[3]^=t[3],this.tableMultiply(e)},a.gcm.prototype.generateHashTable=function(d,e){for(var t=8/e,r=4*t,a=16*t,n=Array(a),i=0;i<a;++i){var l=[0,0,0,0],o=0|i/r,c=(r-1-i%r)*e;l[o]=1<<e-1<<c,n[i]=this.generateSubHashTable(this.multiply(l,d),e)}return n},a.gcm.prototype.generateSubHashTable=function(d,e){var t=1<<e,r=t>>>1,a=Array(t);a[r]=d.slice(0);for(var n=r>>>1;0<n;)this.pow(a[2*n],a[n]=[]),n>>=1;for(n=2;n<r;){for(var l=1;l<n;++l){var p=a[n],o=a[l];a[n+l]=[p[0]^o[0],p[1]^o[1],p[2]^o[2],p[3]^o[3]]}n*=2}for(a[0]=[0,0,0,0],n=r+1;n<t;++n){var c=a[n^r];a[n]=[d[0]^c[0],d[1]^c[1],d[2]^c[2],d[3]^c[3]]}return a}},function(i,e,t){var Q=t(0);t(3),t(8),t(14),t(7),t(21),t(2),t(9),t(1);var z=function(a,e,t,m){var n=Q.util.createBuffer(),i=a.length>>1,s=i+(1&a.length),o=a.substr(0,s),c=a.substr(i,s),u=Q.util.createBuffer(),l=Q.hmac.create();t=e+t;var p=Math.ceil(m/16),f=Math.ceil(m/20);l.start("MD5",o);var h=Q.util.createBuffer();u.putBytes(t);for(var d=0;d<p;++d)l.start(null,null),l.update(u.getBytes()),u.putBuffer(l.digest()),l.start(null,null),l.update(u.bytes()+t),h.putBuffer(l.digest());l.start("SHA1",c);var C=Q.util.createBuffer();u.clear(),u.putBytes(t);for(var d=0;d<f;++d)l.start(null,null),l.update(u.getBytes()),u.putBuffer(l.digest()),l.start(null,null),l.update(u.bytes()+t),C.putBuffer(l.digest());return n.putBytes(Q.util.xorBytes(h.getBytes(),C.getBytes(),m)),n},r=function(a,e){var t=!1;try{var r=a.deflate(e.fragment.getBytes());e.fragment=Q.util.createBuffer(r),e.length=r.length,t=!0}catch(t){}return t},s=function(a,e){var t=!1;try{var r=a.inflate(e.fragment.getBytes());e.fragment=Q.util.createBuffer(r),e.length=r.length,t=!0}catch(t){}return t},Y=function(a,e){var t=0;return 1===e?t=a.getByte():2===e?t=a.getInt16():3===e?t=a.getInt24():4===e?t=a.getInt32():void 0,Q.util.createBuffer(a.getBytes(t))},a=function(a,e,t){a.putInt(t.length(),e<<3),a.putBuffer(t)},W={};W.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}},W.SupportedVersions=[W.Versions.TLS_1_1,W.Versions.TLS_1_0],W.Version=W.SupportedVersions[0],W.MaxFragment=15360,W.ConnectionEnd={server:0,client:1},W.PRFAlgorithm={tls_prf_sha256:0},W.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2},W.CipherType={stream:0,block:1,aead:2},W.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4},W.CompressionMethod={none:0,deflate:1},W.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24},W.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20},W.Alert={},W.Alert.Level={warning:1,fatal:2},W.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100},W.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2},W.CipherSuites={},W.getCipherSuite=function(n){var e=null;for(var s in W.CipherSuites){var r=W.CipherSuites[s];if(r.id[0]===n.charCodeAt(0)&&r.id[1]===n.charCodeAt(1)){e=r;break}}return e},W.handleUnexpected=function(t){(t.open||t.entity!==W.ConnectionEnd.client)&&t.error(t,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:W.Alert.Level.fatal,description:W.Alert.Description.unexpected_message}})},W.handleHelloRequest=function(t){!t.handshaking&&0<t.handshakes&&(W.queue(t,W.createAlert(t,{level:W.Alert.Level.warning,description:W.Alert.Description.no_renegotiation})),W.flush(t)),t.process()},W.parseHelloMessage=function(a,e,t){var r=null,c=a.entity===W.ConnectionEnd.client;if(38>t)a.error(a,{message:c?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:W.Alert.Level.fatal,description:W.Alert.Description.illegal_parameter}});else{var i=e.fragment,s=i.length();if(r={version:{major:i.getByte(),minor:i.getByte()},random:Q.util.createBuffer(i.getBytes(32)),session_id:Y(i,1),extensions:[]},c?(r.cipher_suite=i.getBytes(2),r.compression_method=i.getByte()):(r.cipher_suites=Y(i,2),r.compression_methods=Y(i,1)),0<(s=t-(s-i.length()))){for(var l=Y(i,2);0<l.length();)r.extensions.push({type:[l.getByte(),l.getByte()],data:Y(l,2)});if(!c)for(var u,g=0;g<r.extensions.length;++g)if(u=r.extensions[g],0===u.type[0]&&0===u.type[1])for(var m,C=Y(u.data,2);0<C.length()&&(m=C.getByte(),0===m);)a.session.extensions.server_name.serverNameList.push(Y(C,2).getBytes())}if(a.session.version&&(r.version.major!==a.session.version.major||r.version.minor!==a.session.version.minor))return a.error(a,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:W.Alert.Level.fatal,description:W.Alert.Description.protocol_version}});if(c)a.session.cipherSuite=W.getCipherSuite(r.cipher_suite);else for(var h=Q.util.createBuffer(r.cipher_suites.bytes());0<h.length()&&(a.session.cipherSuite=W.getCipherSuite(h.getBytes(2)),null===a.session.cipherSuite););if(null===a.session.cipherSuite)return a.error(a,{message:"No cipher suites in common.",send:!0,alert:{level:W.Alert.Level.fatal,description:W.Alert.Description.handshake_failure},cipherSuite:Q.util.bytesToHex(r.cipher_suite)});a.session.compressionMethod=c?r.compression_method:W.CompressionMethod.none}return r},W.createSecurityParameters=function(s,e){var t=s.entity===W.ConnectionEnd.client,r=e.random.bytes(),a=t?s.session.sp.client_random:r,n=t?r:W.createRandom().getBytes();s.session.sp={entity:s.entity,prf_algorithm:W.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:s.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:a,server_random:n}},W.handleServerHello=function(s,e,t){var r=W.parseHelloMessage(s,e,t);if(!s.fail){if(!(r.version.minor<=s.version.minor))return s.error(s,{message:"Incompatible TLS version.",send:!0,alert:{level:W.Alert.Level.fatal,description:W.Alert.Description.protocol_version}});s.version.minor=r.version.minor,s.session.version=s.version;var a=r.session_id.bytes();0<a.length&&a===s.session.id?(s.expect=d,s.session.resuming=!0,s.session.sp.server_random=r.random.bytes()):(s.expect=o,s.session.resuming=!1,W.createSecurityParameters(s,r)),s.session.id=a,s.process()}},W.handleClientHello=function(a,e,t){var r=W.parseHelloMessage(a,e,t);if(!a.fail){var n=r.session_id.bytes(),d=null;if(a.sessionCache&&(d=a.sessionCache.getSession(n),null===d?n="":(d.version.major!==r.version.major||d.version.minor>r.version.minor)&&(d=null,n="")),0===n.length&&(n=Q.random.getBytes(32)),a.session.id=n,a.session.clientHelloVersion=r.version,a.session.sp={},d)a.version=a.session.version=d.version,a.session.sp=d.sp;else{for(var l,p=1;p<W.SupportedVersions.length&&(l=W.SupportedVersions[p],!(l.minor<=r.version.minor));++p);a.version={major:l.major,minor:l.minor},a.session.version=a.version}null===d?(a.expect=!1===a.verifyClient?h:y,a.session.resuming=!1,W.createSecurityParameters(a,r)):(a.expect=m,a.session.resuming=!0,a.session.sp.client_random=r.random.bytes()),a.open=!0,W.queue(a,W.createRecord(a,{type:W.ContentType.handshake,data:W.createServerHello(a)})),a.session.resuming?(W.queue(a,W.createRecord(a,{type:W.ContentType.change_cipher_spec,data:W.createChangeCipherSpec()})),a.state.pending=W.createConnectionState(a),a.state.current.write=a.state.pending.write,W.queue(a,W.createRecord(a,{type:W.ContentType.handshake,data:W.createFinished(a)}))):(W.queue(a,W.createRecord(a,{type:W.ContentType.handshake,data:W.createCertificate(a)})),a.fail||(W.queue(a,W.createRecord(a,{type:W.ContentType.handshake,data:W.createServerKeyExchange(a)})),!1!==a.verifyClient&&W.queue(a,W.createRecord(a,{type:W.ContentType.handshake,data:W.createCertificateRequest(a)})),W.queue(a,W.createRecord(a,{type:W.ContentType.handshake,data:W.createServerHelloDone(a)})))),W.flush(a),a.process()}},W.handleCertificate=function(a,e,t){if(3>t)return a.error(a,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:W.Alert.Level.fatal,description:W.Alert.Description.illegal_parameter}});var r,d,l=e.fragment,s={certificate_list:Y(l,3)},o=[];try{for(;0<s.certificate_list.length();)r=Y(s.certificate_list,3),d=Q.asn1.fromDer(r),r=Q.pki.certificateFromAsn1(d,!0),o.push(r)}catch(e){return a.error(a,{message:"Could not parse certificate list.",cause:e,send:!0,alert:{level:W.Alert.Level.fatal,description:W.Alert.Description.bad_certificate}})}var u=a.entity===W.ConnectionEnd.client;(u||!0===a.verifyClient)&&0===o.length?a.error(a,{message:u?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:W.Alert.Level.fatal,description:W.Alert.Description.illegal_parameter}}):0===o.length?a.expect=u?c:h:(u?a.session.serverCertificate=o[0]:a.session.clientCertificate=o[0],W.verifyCertificateChain(a,o)&&(a.expect=u?c:h)),a.process()},W.handleServerKeyExchange=function(a,e,t){return 0<t?a.error(a,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:W.Alert.Level.fatal,description:W.Alert.Description.unsupported_certificate}}):void(a.expect=n,a.process())},W.handleClientKeyExchange=function(a,e,t){if(48>t)return a.error(a,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:W.Alert.Level.fatal,description:W.Alert.Description.unsupported_certificate}});var r=e.fragment,n={enc_pre_master_secret:Y(r,2).getBytes()},i=null;if(a.getPrivateKey)try{i=a.getPrivateKey(a,a.session.serverCertificate),i=Q.pki.privateKeyFromPem(i)}catch(e){a.error(a,{message:"Could not get private key.",cause:e,send:!0,alert:{level:W.Alert.Level.fatal,description:W.Alert.Description.internal_error}})}if(null===i)return a.error(a,{message:"No private key set.",send:!0,alert:{level:W.Alert.Level.fatal,description:W.Alert.Description.internal_error}});try{var c=a.session.sp;c.pre_master_secret=i.decrypt(n.enc_pre_master_secret);var o=a.session.clientHelloVersion;if(o.major!==c.pre_master_secret.charCodeAt(0)||o.minor!==c.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch(t){c.pre_master_secret=Q.random.getBytes(48)}a.expect=m,null!==a.session.clientCertificate&&(a.expect=f),a.process()},W.handleCertificateRequest=function(s,e,t){if(3>t)return s.error(s,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:W.Alert.Level.fatal,description:W.Alert.Description.illegal_parameter}});var r=e.fragment,a={certificate_types:Y(r,1),certificate_authorities:Y(r,2)};s.session.certificateRequest=a,s.expect=l,s.process()},W.handleCertificateVerify=function(a,e,t){if(2>t)return a.error(a,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:W.Alert.Level.fatal,description:W.Alert.Description.illegal_parameter}});var r=e.fragment;r.read-=4;var n=r.bytes();r.read+=4;var i={signature:Y(r,2).getBytes()},s=Q.util.createBuffer();s.putBuffer(a.session.md5.digest()),s.putBuffer(a.session.sha1.digest()),s=s.getBytes();try{if(!a.session.clientCertificate.publicKey.verify(s,i.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");a.session.md5.update(n),a.session.sha1.update(n)}catch(e){return a.error(a,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:W.Alert.Level.fatal,description:W.Alert.Description.handshake_failure}})}a.expect=m,a.process()},W.handleServerHelloDone=function(a,e,o){if(0<o)return a.error(a,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:W.Alert.Level.fatal,description:W.Alert.Description.record_overflow}});if(null===a.serverCertificate){var r={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:W.Alert.Level.fatal,description:W.Alert.Description.insufficient_security}},n=a.verify(a,r.alert.description,0,[]);if(!0!==n)return(n||0===n)&&("object"!=typeof n||Q.util.isArray(n)?"number"==typeof n&&(r.alert.description=n):(n.message&&(r.message=n.message),n.alert&&(r.alert.description=n.alert))),a.error(a,r)}null!==a.session.certificateRequest&&(e=W.createRecord(a,{type:W.ContentType.handshake,data:W.createCertificate(a)}),W.queue(a,e)),e=W.createRecord(a,{type:W.ContentType.handshake,data:W.createClientKeyExchange(a)}),W.queue(a,e),a.expect=u;var i=function(a,e){null!==a.session.certificateRequest&&null!==a.session.clientCertificate&&W.queue(a,W.createRecord(a,{type:W.ContentType.handshake,data:W.createCertificateVerify(a,e)})),W.queue(a,W.createRecord(a,{type:W.ContentType.change_cipher_spec,data:W.createChangeCipherSpec()})),a.state.pending=W.createConnectionState(a),a.state.current.write=a.state.pending.write,W.queue(a,W.createRecord(a,{type:W.ContentType.handshake,data:W.createFinished(a)})),a.expect=d,W.flush(a),a.process()};return null===a.session.certificateRequest||null===a.session.clientCertificate?i(a,null):void W.getClientSignature(a,i)},W.handleChangeCipherSpec=function(a,e){if(1!==e.fragment.getByte())return a.error(a,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:W.Alert.Level.fatal,description:W.Alert.Description.illegal_parameter}});var t=a.entity===W.ConnectionEnd.client;(a.session.resuming&&t||!a.session.resuming&&!t)&&(a.state.pending=W.createConnectionState(a)),a.state.current.read=a.state.pending.read,(!a.session.resuming&&t||a.session.resuming&&!t)&&(a.state.pending=null),a.expect=t?p:C,a.process()},W.handleFinished=function(a,e){var t=e.fragment;t.read-=4;var r=t.bytes();t.read+=4;var n=e.fragment.getBytes();t=Q.util.createBuffer(),t.putBuffer(a.session.md5.digest()),t.putBuffer(a.session.sha1.digest());var s=a.entity===W.ConnectionEnd.client,o=s?"server finished":"client finished",c=a.session.sp;return(t=z(c.master_secret,o,t.getBytes(),12),t.getBytes()!==n)?a.error(a,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:W.Alert.Level.fatal,description:W.Alert.Description.decrypt_error}}):void(a.session.md5.update(r),a.session.sha1.update(r),(a.session.resuming&&s||!a.session.resuming&&!s)&&(W.queue(a,W.createRecord(a,{type:W.ContentType.change_cipher_spec,data:W.createChangeCipherSpec()})),a.state.current.write=a.state.pending.write,a.state.pending=null,W.queue(a,W.createRecord(a,{type:W.ContentType.handshake,data:W.createFinished(a)}))),a.expect=s?g:E,a.handshaking=!1,++a.handshakes,a.peerCertificate=s?a.session.serverCertificate:a.session.clientCertificate,W.flush(a),a.isConnected=!0,a.connected(a),a.process())},W.handleAlert=function(s,e){var t,i=e.fragment,a={level:i.getByte(),description:i.getByte()};switch(a.description){case W.Alert.Description.close_notify:t="Connection closed.";break;case W.Alert.Description.unexpected_message:t="Unexpected message.";break;case W.Alert.Description.bad_record_mac:t="Bad record MAC.";break;case W.Alert.Description.decryption_failed:t="Decryption failed.";break;case W.Alert.Description.record_overflow:t="Record overflow.";break;case W.Alert.Description.decompression_failure:t="Decompression failed.";break;case W.Alert.Description.handshake_failure:t="Handshake failure.";break;case W.Alert.Description.bad_certificate:t="Bad certificate.";break;case W.Alert.Description.unsupported_certificate:t="Unsupported certificate.";break;case W.Alert.Description.certificate_revoked:t="Certificate revoked.";break;case W.Alert.Description.certificate_expired:t="Certificate expired.";break;case W.Alert.Description.certificate_unknown:t="Certificate unknown.";break;case W.Alert.Description.illegal_parameter:t="Illegal parameter.";break;case W.Alert.Description.unknown_ca:t="Unknown certificate authority.";break;case W.Alert.Description.access_denied:t="Access denied.";break;case W.Alert.Description.decode_error:t="Decode error.";break;case W.Alert.Description.decrypt_error:t="Decrypt error.";break;case W.Alert.Description.export_restriction:t="Export restriction.";break;case W.Alert.Description.protocol_version:t="Unsupported protocol version.";break;case W.Alert.Description.insufficient_security:t="Insufficient security.";break;case W.Alert.Description.internal_error:t="Internal error.";break;case W.Alert.Description.user_canceled:t="User canceled.";break;case W.Alert.Description.no_renegotiation:t="Renegotiation not supported.";break;default:t="Unknown error.";}return a.description===W.Alert.Description.close_notify?s.close():void(s.error(s,{message:t,send:!1,origin:s.entity===W.ConnectionEnd.client?"server":"client",alert:a}),s.process())},W.handleHandshake=function(a,e){var t=e.fragment,r=t.getByte(),n=t.getInt24();if(n>t.length())return a.fragmented=e,e.fragment=Q.util.createBuffer(),t.read-=4,a.process();a.fragmented=null,t.read-=4;var i=t.bytes(n+4);t.read+=4,r in P[a.entity][a.expect]?(a.entity!==W.ConnectionEnd.server||a.open||a.fail||(a.handshaking=!0,a.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:Q.md.md5.create(),sha1:Q.md.sha1.create()}),r!==W.HandshakeType.hello_request&&r!==W.HandshakeType.certificate_verify&&r!==W.HandshakeType.finished&&(a.session.md5.update(i),a.session.sha1.update(i)),P[a.entity][a.expect][r](a,e,n)):W.handleUnexpected(a,e)},W.handleApplicationData=function(a,e){a.data.putBuffer(e.fragment),a.dataReady(a),a.process()},W.handleHeartbeat=function(a,e){var t=e.fragment,r=t.getByte(),n=t.getInt16(),i=t.getBytes(n);if(r===W.HeartbeatMessageType.heartbeat_request){if(a.handshaking||n>i.length)return a.process();W.queue(a,W.createRecord(a,{type:W.ContentType.heartbeat,data:W.createHeartbeat(W.HeartbeatMessageType.heartbeat_response,i)})),W.flush(a)}else if(r===W.HeartbeatMessageType.heartbeat_response){if(i!==a.expectedHeartbeatPayload)return a.process();a.heartbeatReceived&&a.heartbeatReceived(a,Q.util.createBuffer(i))}a.process()};var o=1,c=2,n=3,l=4,d=5,p=6,g=7,u=8,y=1,h=2,f=3,m=4,C=5,E=6,S=W.handleUnexpected,T=W.handleChangeCipherSpec,I=W.handleAlert,B=W.handleHandshake,A=W.handleApplicationData,b=W.handleHeartbeat,v=[];v[W.ConnectionEnd.client]=[[S,I,B,S,b],[S,I,B,S,b],[S,I,B,S,b],[S,I,B,S,b],[S,I,B,S,b],[T,I,S,S,b],[S,I,B,S,b],[S,I,B,A,b],[S,I,B,S,b]],v[W.ConnectionEnd.server]=[[S,I,B,S,b],[S,I,B,S,b],[S,I,B,S,b],[S,I,B,S,b],[T,I,S,S,b],[S,I,B,S,b],[S,I,B,A,b],[S,I,B,S,b]];var N=W.handleHelloRequest,R=W.handleServerHello,L=W.handleCertificate,_=W.handleServerKeyExchange,k=W.handleCertificateRequest,U=W.handleServerHelloDone,D=W.handleFinished,P=[];P[W.ConnectionEnd.client]=[[S,S,R,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S],[N,S,S,S,S,S,S,S,S,S,S,L,_,k,U,S,S,S,S,S,S],[N,S,S,S,S,S,S,S,S,S,S,S,_,k,U,S,S,S,S,S,S],[N,S,S,S,S,S,S,S,S,S,S,S,S,k,U,S,S,S,S,S,S],[N,S,S,S,S,S,S,S,S,S,S,S,S,S,U,S,S,S,S,S,S],[N,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S],[N,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,D],[N,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S],[N,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S]];var V=W.handleClientHello,O=W.handleClientKeyExchange,K=W.handleCertificateVerify;P[W.ConnectionEnd.server]=[[S,V,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S],[S,S,S,S,S,S,S,S,S,S,S,L,S,S,S,S,S,S,S,S,S],[S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,O,S,S,S,S],[S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,K,S,S,S,S,S],[S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S],[S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,D],[S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S],[S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S]],W.generateKeys=function(n,e){var t=z,r=e.client_random+e.server_random;n.session.resuming||(e.master_secret=t(e.pre_master_secret,"master secret",r,48).bytes(),e.pre_master_secret=null),r=e.server_random+e.client_random;var d=2*e.mac_key_length+2*e.enc_key_length,l=n.version.major===W.Versions.TLS_1_0.major&&n.version.minor===W.Versions.TLS_1_0.minor;l&&(d+=2*e.fixed_iv_length);var s=t(e.master_secret,"key expansion",r,d),o={client_write_MAC_key:s.getBytes(e.mac_key_length),server_write_MAC_key:s.getBytes(e.mac_key_length),client_write_key:s.getBytes(e.enc_key_length),server_write_key:s.getBytes(e.enc_key_length)};return l&&(o.client_write_IV=s.getBytes(e.fixed_iv_length),o.server_write_IV=s.getBytes(e.fixed_iv_length)),o},W.createConnectionState=function(i){var e=i.entity===W.ConnectionEnd.client,t=function(){var t={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(){return!0},compressionState:null,compressFunction:function(){return!0},updateSequenceNumber:function(){4294967295===t.sequenceNumber[1]?(t.sequenceNumber[1]=0,++t.sequenceNumber[0]):++t.sequenceNumber[1]}};return t},o={read:t(),write:t()};if(o.read.update=function(a,e){return o.read.cipherFunction(e,o.read)?o.read.compressFunction(a,e,o.read)||a.error(a,{message:"Could not decompress record.",send:!0,alert:{level:W.Alert.Level.fatal,description:W.Alert.Description.decompression_failure}}):a.error(a,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:W.Alert.Level.fatal,description:W.Alert.Description.bad_record_mac}}),!a.fail},o.write.update=function(a,e){return o.write.compressFunction(a,e,o.write)?o.write.cipherFunction(e,o.write)||a.error(a,{message:"Could not encrypt record.",send:!1,alert:{level:W.Alert.Level.fatal,description:W.Alert.Description.internal_error}}):a.error(a,{message:"Could not compress record.",send:!1,alert:{level:W.Alert.Level.fatal,description:W.Alert.Description.internal_error}}),!a.fail},i.session){var a=i.session.sp;switch(i.session.cipherSuite.initSecurityParameters(a),a.keys=W.generateKeys(i,a),o.read.macKey=e?a.keys.server_write_MAC_key:a.keys.client_write_MAC_key,o.write.macKey=e?a.keys.client_write_MAC_key:a.keys.server_write_MAC_key,i.session.cipherSuite.initConnectionState(o,i,a),a.compression_algorithm){case W.CompressionMethod.none:break;case W.CompressionMethod.deflate:o.read.compressFunction=s,o.write.compressFunction=r;break;default:throw new Error("Unsupported compression algorithm.");}}return o},W.createRandom=function(){var a=new Date,e=+a+6e4*a.getTimezoneOffset(),t=Q.util.createBuffer();return t.putInt32(e),t.putBytes(Q.random.getBytes(28)),t},W.createRecord=function(a,e){return e.data?{type:e.type,version:{major:a.version.major,minor:a.version.minor},length:e.data.length(),fragment:e.data}:null},W.createAlert=function(a,e){var t=Q.util.createBuffer();return t.putByte(e.level),t.putByte(e.description),W.createRecord(a,{type:W.ContentType.alert,data:t})},W.createClientHello=function(l){l.session.clientHelloVersion={major:l.version.major,minor:l.version.minor};for(var e,u=Q.util.createBuffer(),t=0;t<l.cipherSuites.length;++t)e=l.cipherSuites[t],u.putByte(e.id[0]),u.putByte(e.id[1]);var m=u.length(),i=Q.util.createBuffer();i.putByte(W.CompressionMethod.none);var s=i.length(),o=Q.util.createBuffer();if(l.virtualHost){var c=Q.util.createBuffer();c.putByte(0),c.putByte(0);var p=Q.util.createBuffer();p.putByte(0),a(p,2,Q.util.createBuffer(l.virtualHost));var f=Q.util.createBuffer();a(f,2,p),a(c,2,f),o.putBuffer(c)}var h=o.length();0<h&&(h+=2);var C=l.session.id,y=C.length+1+2+4+28+2+m+1+s+h,g=Q.util.createBuffer();return g.putByte(W.HandshakeType.client_hello),g.putInt24(y),g.putByte(l.version.major),g.putByte(l.version.minor),g.putBytes(l.session.sp.client_random),a(g,1,Q.util.createBuffer(C)),a(g,2,u),a(g,1,i),0<h&&a(g,2,o),g},W.createServerHello=function(s){var e=s.session.id,t=e.length+1+2+4+28+2+1,r=Q.util.createBuffer();return r.putByte(W.HandshakeType.server_hello),r.putInt24(t),r.putByte(s.version.major),r.putByte(s.version.minor),r.putBytes(s.session.sp.server_random),a(r,1,Q.util.createBuffer(e)),r.putByte(s.session.cipherSuite.id[0]),r.putByte(s.session.cipherSuite.id[1]),r.putByte(s.session.compressionMethod),r},W.createCertificate=function(l){var e=l.entity===W.ConnectionEnd.client,t=null;if(l.getCertificate){var u;u=e?l.session.certificateRequest:l.session.extensions.server_name.serverNameList,t=l.getCertificate(l,u)}var g=Q.util.createBuffer();if(null!==t)try{Q.util.isArray(t)||(t=[t]);for(var i,m=null,C=0;C<t.length;++C){if(i=Q.pem.decode(t[C])[0],"CERTIFICATE"!==i.type&&"X509 CERTIFICATE"!==i.type&&"TRUSTED CERTIFICATE"!==i.type){var E=new Error("Could not convert certificate from PEM; PEM header type is not \"CERTIFICATE\", \"X509 CERTIFICATE\", or \"TRUSTED CERTIFICATE\".");throw E.headerType=i.type,E}if(i.procType&&"ENCRYPTED"===i.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var p=Q.util.createBuffer(i.body);null===m&&(m=Q.asn1.fromDer(p.bytes(),!1));var f=Q.util.createBuffer();a(f,3,p),g.putBuffer(f)}t=Q.pki.certificateFromAsn1(m),e?l.session.clientCertificate=t:l.session.serverCertificate=t}catch(e){return l.error(l,{message:"Could not send certificate list.",cause:e,send:!0,alert:{level:W.Alert.Level.fatal,description:W.Alert.Description.bad_certificate}})}var h=3+g.length(),d=Q.util.createBuffer();return d.putByte(W.HandshakeType.certificate),d.putInt24(h),a(d,3,g),d},W.createClientKeyExchange=function(a){var e=Q.util.createBuffer();e.putByte(a.session.clientHelloVersion.major),e.putByte(a.session.clientHelloVersion.minor),e.putBytes(Q.random.getBytes(46));var s=a.session.sp;s.pre_master_secret=e.getBytes(),e=a.session.serverCertificate.publicKey.encrypt(s.pre_master_secret);var r=e.length+2,n=Q.util.createBuffer();return n.putByte(W.HandshakeType.client_key_exchange),n.putInt24(r),n.putInt16(e.length),n.putBytes(e),n},W.createServerKeyExchange=function(){var e=Q.util.createBuffer();return e},W.getClientSignature=function(a,e){var t=Q.util.createBuffer();t.putBuffer(a.session.md5.digest()),t.putBuffer(a.session.sha1.digest()),t=t.getBytes(),a.getSignature=a.getSignature||function(a,e,s){var r=null;if(a.getPrivateKey)try{r=a.getPrivateKey(a,a.session.clientCertificate),r=Q.pki.privateKeyFromPem(r)}catch(e){a.error(a,{message:"Could not get private key.",cause:e,send:!0,alert:{level:W.Alert.Level.fatal,description:W.Alert.Description.internal_error}})}null===r?a.error(a,{message:"No private key set.",send:!0,alert:{level:W.Alert.Level.fatal,description:W.Alert.Description.internal_error}}):e=r.sign(e,null),s(a,e)},a.getSignature(a,t,e)},W.createCertificateVerify=function(a,e){var t=e.length+2,r=Q.util.createBuffer();return r.putByte(W.HandshakeType.certificate_verify),r.putInt24(t),r.putInt16(e.length),r.putBytes(e),r},W.createCertificateRequest=function(d){var e=Q.util.createBuffer();e.putByte(1);var t=Q.util.createBuffer();for(var r in d.caStore.certs){var n=d.caStore.certs[r],i=Q.pki.distinguishedNameToAsn1(n.subject),s=Q.asn1.toDer(i);t.putInt16(s.length()),t.putBuffer(s)}var o=1+e.length()+2+t.length(),c=Q.util.createBuffer();return c.putByte(W.HandshakeType.certificate_request),c.putInt24(o),a(c,1,e),a(c,2,t),c},W.createServerHelloDone=function(){var e=Q.util.createBuffer();return e.putByte(W.HandshakeType.server_hello_done),e.putInt24(0),e},W.createChangeCipherSpec=function(){var t=Q.util.createBuffer();return t.putByte(1),t},W.createFinished=function(a){var e=Q.util.createBuffer();e.putBuffer(a.session.md5.digest()),e.putBuffer(a.session.sha1.digest());var n=a.entity===W.ConnectionEnd.client,r=a.session.sp,s=n?"client finished":"server finished";e=z(r.master_secret,s,e.getBytes(),12);var i=Q.util.createBuffer();return i.putByte(W.HandshakeType.finished),i.putInt24(e.length()),i.putBuffer(e),i},W.createHeartbeat=function(a,e,t){void 0===t&&(t=e.length);var o=Q.util.createBuffer();o.putByte(a),o.putInt16(t),o.putBytes(e);var n=o.length(),i=Math.max(16,n-t-3);return o.putBytes(Q.random.getBytes(i)),o},W.queue=function(a,e){if(e&&(0!==e.fragment.length()||e.type!==W.ContentType.handshake&&e.type!==W.ContentType.alert&&e.type!==W.ContentType.change_cipher_spec)){if(e.type===W.ContentType.handshake){var t=e.fragment.bytes();a.session.md5.update(t),a.session.sha1.update(t),t=null}var c;if(e.fragment.length()<=W.MaxFragment)c=[e];else{c=[];for(var d=e.fragment.bytes();d.length>W.MaxFragment;)c.push(W.createRecord(a,{type:e.type,data:Q.util.createBuffer(d.slice(0,W.MaxFragment))})),d=d.slice(W.MaxFragment);0<d.length&&c.push(W.createRecord(a,{type:e.type,data:Q.util.createBuffer(d)}))}for(var l,p=0;p<c.length&&!a.fail;++p)l=c[p],a.state.current.write.update(a,l)&&a.records.push(l)}},W.flush=function(a){for(var e,n=0;n<a.records.length;++n)e=a.records[n],a.tlsData.putByte(e.type),a.tlsData.putByte(e.version.major),a.tlsData.putByte(e.version.minor),a.tlsData.putInt16(e.fragment.length()),a.tlsData.putBuffer(a.records[n].fragment);return a.records=[],a.tlsDataReady(a)};var x=function(t){return!0===t||(t===Q.pki.certificateError.bad_certificate?W.Alert.Description.bad_certificate:t===Q.pki.certificateError.unsupported_certificate?W.Alert.Description.unsupported_certificate:t===Q.pki.certificateError.certificate_revoked?W.Alert.Description.certificate_revoked:t===Q.pki.certificateError.certificate_expired?W.Alert.Description.certificate_expired:t===Q.pki.certificateError.certificate_unknown?W.Alert.Description.certificate_unknown:t===Q.pki.certificateError.unknown_ca?W.Alert.Description.unknown_ca:W.Alert.Description.bad_certificate)},w=function(t){return!0===t||(t===W.Alert.Description.bad_certificate?Q.pki.certificateError.bad_certificate:t===W.Alert.Description.unsupported_certificate?Q.pki.certificateError.unsupported_certificate:t===W.Alert.Description.certificate_revoked?Q.pki.certificateError.certificate_revoked:t===W.Alert.Description.certificate_expired?Q.pki.certificateError.certificate_expired:t===W.Alert.Description.certificate_unknown?Q.pki.certificateError.certificate_unknown:t===W.Alert.Description.unknown_ca?Q.pki.certificateError.unknown_ca:Q.pki.certificateError.bad_certificate)};for(var F in W.verifyCertificateChain=function(a,e){try{var t={};for(var r in a.verifyOptions)t[r]=a.verifyOptions[r];t.verify=function(e,t,r){var n=(x(e),a.verify(a,e,t,r));if(!0!==n){if("object"==typeof n&&!Q.util.isArray(n)){var o=new Error("The application rejected the certificate.");throw o.send=!0,o.alert={level:W.Alert.Level.fatal,description:W.Alert.Description.bad_certificate},n.message&&(o.message=n.message),n.alert&&(o.alert.description=n.alert),o}n!==e&&(n=w(n))}return n},Q.pki.verifyCertificateChain(a.caStore,e,t)}catch(e){var n=e;("object"!=typeof n||Q.util.isArray(n))&&(n={send:!0,alert:{level:W.Alert.Level.fatal,description:x(e)}}),"send"in n||(n.send=!0),"alert"in n||(n.alert={level:W.Alert.Level.fatal,description:x(n.error)}),a.error(a,n)}return!a.fail},W.createSessionCache=function(a,e){var s=null;if(a&&a.getSession&&a.setSession&&a.order)s=a;else{for(var t in s={},s.cache=a||{},s.capacity=Math.max(e||100,1),s.order=[],a)s.order.length<=e?s.order.push(t):delete a[t];s.getSession=function(a){var e=null,r=null;if(a?r=Q.util.bytesToHex(a):0<s.order.length&&(r=s.order[0]),null!==r&&r in s.cache)for(var o in e=s.cache[r],delete s.cache[r],s.order)if(s.order[o]===r){s.order.splice(o,1);break}return e},s.setSession=function(a,e){if(s.order.length===s.capacity){var t=s.order.shift();delete s.cache[t]}var t=Q.util.bytesToHex(a);s.order.push(t),s.cache[t]=e}}return s},W.createConnection=function(d){var e=null;e=d.caStore?Q.util.isArray(d.caStore)?Q.pki.createCaStore(d.caStore):d.caStore:Q.pki.createCaStore();var a=d.cipherSuites||null;if(null===a)for(var l in a=[],W.CipherSuites)a.push(W.CipherSuites[l]);var n=d.server?W.ConnectionEnd.server:W.ConnectionEnd.client,i=d.sessionCache?W.createSessionCache(d.sessionCache):null,s={version:{major:W.Version.major,minor:W.Version.minor},entity:n,sessionId:d.sessionId,caStore:e,sessionCache:i,cipherSuites:a,connected:d.connected,virtualHost:d.virtualHost||null,verifyClient:d.verifyClient||!1,verify:d.verify||function(a,e){return e},verifyOptions:d.verifyOptions||{},getCertificate:d.getCertificate||null,getPrivateKey:d.getPrivateKey||null,getSignature:d.getSignature||null,input:Q.util.createBuffer(),tlsData:Q.util.createBuffer(),data:Q.util.createBuffer(),tlsDataReady:d.tlsDataReady,dataReady:d.dataReady,heartbeatReceived:d.heartbeatReceived,closed:d.closed,error:function(e,t){t.origin=t.origin||(e.entity===W.ConnectionEnd.client?"client":"server"),t.send&&(W.queue(e,W.createAlert(e,t.alert)),W.flush(e));var r=!1!==t.fatal;r&&(e.fail=!0),d.error(e,t),r&&e.close(!1)},deflate:d.deflate||null,inflate:d.inflate||null};s.reset=function(t){s.version={major:W.Version.major,minor:W.Version.minor},s.record=null,s.session=null,s.peerCertificate=null,s.state={pending:null,current:null},s.expect=(s.entity,W.ConnectionEnd.client,0),s.fragmented=null,s.records=[],s.open=!1,s.handshakes=0,s.handshaking=!1,s.isConnected=!1,s.fail=!(t||void 0===t),s.input.clear(),s.tlsData.clear(),s.data.clear(),s.state.current=W.createConnectionState(s)},s.reset();var o=function(n,e){var t=e.type-W.ContentType.change_cipher_spec,r=v[n.entity][n.expect];t in r?r[t](n,e):W.handleUnexpected(n,e)},c=function(a){var e=0,s=a.input,r=s.length();if(5>r)e=5-r;else{a.record={type:s.getByte(),version:{major:s.getByte(),minor:s.getByte()},length:s.getInt16(),fragment:Q.util.createBuffer(),ready:!1};var n=a.record.version.major===a.version.major;n&&a.session&&a.session.version&&(n=a.record.version.minor===a.version.minor),n||a.error(a,{message:"Incompatible TLS version.",send:!0,alert:{level:W.Alert.Level.fatal,description:W.Alert.Description.protocol_version}})}return e},u=function(n){var e=0,s=n.input,r=s.length();return r<n.record.length?e=n.record.length-r:(n.record.fragment.putBytes(s.getBytes(n.record.length)),s.compact(),n.state.current.read.update(n,n.record)&&(null!==n.fragmented&&(n.fragmented.type===n.record.type?(n.fragmented.fragment.putBuffer(n.record.fragment),n.record=n.fragmented):n.error(n,{message:"Invalid fragmented record.",send:!0,alert:{level:W.Alert.Level.fatal,description:W.Alert.Description.unexpected_message}})),n.record.ready=!0)),e};return s.handshake=function(a){if(s.entity!==W.ConnectionEnd.client)s.error(s,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(s.handshaking)s.error(s,{message:"Handshake already in progress.",fatal:!1});else{s.fail&&!s.open&&0===s.handshakes&&(s.fail=!1),s.handshaking=!0,a=a||"";var r=null;0<a.length&&(s.sessionCache&&(r=s.sessionCache.getSession(a)),null===r&&(a="")),0===a.length&&s.sessionCache&&null!==(r=s.sessionCache.getSession())&&(a=r.id),s.session={id:a,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:Q.md.md5.create(),sha1:Q.md.sha1.create()},r&&(s.version=r.version,s.session.sp=r.sp),s.session.sp.client_random=W.createRandom().getBytes(),s.open=!0,W.queue(s,W.createRecord(s,{type:W.ContentType.handshake,data:W.createClientHello(s)})),W.flush(s)}},s.process=function(a){var e=0;return a&&s.input.putBytes(a),s.fail||(null!==s.record&&s.record.ready&&s.record.fragment.isEmpty()&&(s.record=null),null===s.record&&(e=c(s)),s.fail||null===s.record||s.record.ready||(e=u(s)),!s.fail&&null!==s.record&&s.record.ready&&o(s,s.record)),e},s.prepare=function(t){return W.queue(s,W.createRecord(s,{type:W.ContentType.application_data,data:Q.util.createBuffer(t)})),W.flush(s)},s.prepareHeartbeatRequest=function(a,r){return a instanceof Q.util.ByteBuffer&&(a=a.bytes()),void 0===r&&(r=a.length),s.expectedHeartbeatPayload=a,W.queue(s,W.createRecord(s,{type:W.ContentType.heartbeat,data:W.createHeartbeat(W.HeartbeatMessageType.heartbeat_request,a,r)})),W.flush(s)},s.close=function(a){if(!s.fail&&s.sessionCache&&s.session){var e={id:s.session.id,version:s.session.version,sp:s.session.sp};e.sp.keys=null,s.sessionCache.setSession(e.id,e)}s.open&&(s.open=!1,s.input.clear(),(s.isConnected||s.handshaking)&&(s.isConnected=s.handshaking=!1,W.queue(s,W.createAlert(s,{level:W.Alert.Level.warning,description:W.Alert.Description.close_notify})),W.flush(s)),s.closed(s)),s.reset(a)},s},i.exports=Q.tls=Q.tls||{},W)"function"!=typeof W[F]&&(Q.tls[F]=W[F]);Q.tls.prf_tls1=z,Q.tls.hmac_sha1=function(a,e,t){var r=Q.hmac.create();r.start("SHA1",a);var n=Q.util.createBuffer();return n.putInt32(e[0]),n.putInt32(e[1]),n.putByte(t.type),n.putByte(t.version.major),n.putByte(t.version.minor),n.putInt16(t.length),n.putBytes(t.fragment.bytes()),r.update(n.getBytes()),r.digest().getBytes()},Q.tls.createSessionCache=W.createSessionCache,Q.tls.createConnection=W.createConnection},function(s,e,t){var o=t(0);t(3),t(6),t(22),t(7),t(15),t(28),t(18),t(11),t(1),t(17);var a=o.asn1,n=s.exports=o.pki=o.pki||{};n.pemToDer=function(a){var e=o.pem.decode(a)[0];if(e.procType&&"ENCRYPTED"===e.procType.type)throw new Error("Could not convert PEM to DER; PEM is encrypted.");return o.util.createBuffer(e.body)},n.privateKeyFromPem=function(i){var e=o.pem.decode(i)[0];if("PRIVATE KEY"!==e.type&&"RSA PRIVATE KEY"!==e.type){var t=new Error("Could not convert private key from PEM; PEM header type is not \"PRIVATE KEY\" or \"RSA PRIVATE KEY\".");throw t.headerType=e.type,t}if(e.procType&&"ENCRYPTED"===e.procType.type)throw new Error("Could not convert private key from PEM; PEM is encrypted.");var r=a.fromDer(e.body);return n.privateKeyFromAsn1(r)},n.privateKeyToPem=function(s,e){var t={type:"RSA PRIVATE KEY",body:a.toDer(n.privateKeyToAsn1(s)).getBytes()};return o.pem.encode(t,{maxline:e})},n.privateKeyInfoToPem=function(n,e){var t={type:"PRIVATE KEY",body:a.toDer(n).getBytes()};return o.pem.encode(t,{maxline:e})}},function(g,e,t){function y(a,e){return a.start().update(e).digest().getBytes()}function C(a){var e;if(!a)e="hmacWithSHA1";else if(!(e=u.oids[o.derToOid(a)])){var s=new Error("Unsupported PRF OID.");throw s.oid=a,s.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],s}return n(e)}function n(a){var n=R.md;switch(a){case"hmacWithSHA224":n=R.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":a=a.substr(8).toLowerCase();break;default:var s=new Error("Unsupported PRF algorithm.");throw s.algorithm=a,s.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],s;}if(!(n&&a in n))throw new Error("Unknown hash algorithm: "+a);return n[a].create()}function i(s,e,t,r){var a=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,s),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,e.getBytes())]);return"hmacWithSHA1"!==r&&a.value.push(o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,R.util.hexToBytes(t.toString(16))),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(u.oids[r]).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")])),a}var R=t(0);if(t(5),t(3),t(10),t(4),t(6),t(15),t(7),t(2),t(25),t(11),t(1),void 0===a)var a=R.jsbn.BigInteger;var o=R.asn1,u=R.pki=R.pki||{};g.exports=u.pbe=R.pbe=R.pbe||{};var s=u.oids,l={name:"EncryptedPrivateKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},E={name:"PBES2Algorithms",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},m={name:"pkcs-12PbeParams",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"iterations"}]};u.encryptPrivateKeyInfo=function(l,e,t){t=t||{},t.saltSize=t.saltSize||8,t.count=t.count||2048,t.algorithm=t.algorithm||"aes128",t.prfAlgorithm=t.prfAlgorithm||"sha1";var p,B,N,L=R.random.getBytesSync(t.saltSize),f=t.count,h=o.integerToDer(f);if(0===t.algorithm.indexOf("aes")||"des"===t.algorithm){var d,_,k;switch(t.algorithm){case"aes128":p=16,d=16,_=s["aes128-CBC"],k=R.aes.createEncryptionCipher;break;case"aes192":p=24,d=16,_=s["aes192-CBC"],k=R.aes.createEncryptionCipher;break;case"aes256":p=32,d=16,_=s["aes256-CBC"],k=R.aes.createEncryptionCipher;break;case"des":p=8,d=8,_=s.desCBC,k=R.des.createEncryptionCipher;break;default:var U=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw U.algorithm=t.algorithm,U;}var D="hmacWith"+t.prfAlgorithm.toUpperCase(),C=n(D),E=R.pkcs5.pbkdf2(e,L,f,p,C),P=R.random.getBytesSync(d),V=k(E);V.start(P),V.update(o.toDer(l)),V.finish(),N=V.output.getBytes();var O=i(L,h,p,D);B=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(s.pkcs5PBES2).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(s.pkcs5PBKDF2).getBytes()),O]),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(_).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,P)])])])}else{if("3des"!==t.algorithm){var U=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw U.algorithm=t.algorithm,U}p=24;var b=new R.util.ByteBuffer(L),E=u.pbe.generatePkcs12Key(e,b,1,f,p),P=u.pbe.generatePkcs12Key(e,b,2,f,p),V=R.des.createEncryptionCipher(E);V.start(P),V.update(o.toDer(l)),V.finish(),N=V.output.getBytes(),B=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(s["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,L),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,h.getBytes())])])}return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[B,o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,N)])},u.decryptPrivateKeyInfo=function(d,e){var t=null,g={},a=[];if(!o.validate(d,l,g,a)){var n=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw n.errors=a,n}var i=o.derToOid(g.encryptionOid),s=u.pbe.getCipher(i,g.encryptionParams,e),c=R.util.createBuffer(g.encryptedData);return s.update(c),s.finish()&&(t=o.fromDer(s.output)),t},u.encryptedPrivateKeyToPem=function(a,e){var t={type:"ENCRYPTED PRIVATE KEY",body:o.toDer(a).getBytes()};return R.pem.encode(t,{maxline:e})},u.encryptedPrivateKeyFromPem=function(a){var e=R.pem.decode(a)[0];if("ENCRYPTED PRIVATE KEY"!==e.type){var t=new Error("Could not convert encrypted private key from PEM; PEM header type is \"ENCRYPTED PRIVATE KEY\".");throw t.headerType=e.type,t}if(e.procType&&"ENCRYPTED"===e.procType.type)throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return o.fromDer(e.body)},u.encryptRsaPrivateKey=function(l,e,t){if(t=t||{},!t.legacy){var g=u.wrapRsaPrivateKey(u.privateKeyToAsn1(l));return g=u.encryptPrivateKeyInfo(g,e,t),u.encryptedPrivateKeyToPem(g)}var y,m,C,E;switch(t.algorithm){case"aes128":y="AES-128-CBC",C=16,m=R.random.getBytesSync(16),E=R.aes.createEncryptionCipher;break;case"aes192":y="AES-192-CBC",C=24,m=R.random.getBytesSync(16),E=R.aes.createEncryptionCipher;break;case"aes256":y="AES-256-CBC",C=32,m=R.random.getBytesSync(16),E=R.aes.createEncryptionCipher;break;case"3des":y="DES-EDE3-CBC",C=24,m=R.random.getBytesSync(8),E=R.des.createEncryptionCipher;break;case"des":y="DES-CBC",C=8,m=R.random.getBytesSync(8),E=R.des.createEncryptionCipher;break;default:var S=new Error("Could not encrypt RSA private key; unsupported encryption algorithm \""+t.algorithm+"\".");throw S.algorithm=t.algorithm,S;}var p=R.pbe.opensslDeriveBytes(e,m.substr(0,8),C),f=E(p);f.start(m),f.update(o.toDer(u.privateKeyToAsn1(l))),f.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:y,parameters:R.util.bytesToHex(m).toUpperCase()},body:f.output.getBytes()};return R.pem.encode(h)},u.decryptRsaPrivateKey=function(d,e){var t=null,l=R.pem.decode(d)[0];if("ENCRYPTED PRIVATE KEY"!==l.type&&"PRIVATE KEY"!==l.type&&"RSA PRIVATE KEY"!==l.type){var a=new Error("Could not convert private key from PEM; PEM header type is not \"ENCRYPTED PRIVATE KEY\", \"PRIVATE KEY\", or \"RSA PRIVATE KEY\".");throw a.headerType=a,a}if(l.procType&&"ENCRYPTED"===l.procType.type){var g,y;switch(l.dekInfo.algorithm){case"DES-CBC":g=8,y=R.des.createDecryptionCipher;break;case"DES-EDE3-CBC":g=24,y=R.des.createDecryptionCipher;break;case"AES-128-CBC":g=16,y=R.aes.createDecryptionCipher;break;case"AES-192-CBC":g=24,y=R.aes.createDecryptionCipher;break;case"AES-256-CBC":g=32,y=R.aes.createDecryptionCipher;break;case"RC2-40-CBC":g=5,y=function(t){return R.rc2.createDecryptionCipher(t,40)};break;case"RC2-64-CBC":g=8,y=function(t){return R.rc2.createDecryptionCipher(t,64)};break;case"RC2-128-CBC":g=16,y=function(t){return R.rc2.createDecryptionCipher(t,128)};break;default:var a=new Error("Could not decrypt private key; unsupported encryption algorithm \""+l.dekInfo.algorithm+"\".");throw a.algorithm=l.dekInfo.algorithm,a;}var h=R.util.hexToBytes(l.dekInfo.parameters),c=R.pbe.opensslDeriveBytes(e,h.substr(0,8),g),p=y(c);if(p.start(h),p.update(R.util.createBuffer(l.body)),!p.finish())return t;t=p.output.getBytes()}else t=l.body;return t="ENCRYPTED PRIVATE KEY"===l.type?u.decryptPrivateKeyInfo(o.fromDer(t),e):o.fromDer(t),null!==t&&(t=u.privateKeyFromAsn1(t)),t},u.pbe.generatePkcs12Key=function(o,e,t,r,a,n){var L,_;if(void 0===n||null===n){if(!("sha1"in R.md))throw new Error("\"sha1\" hash algorithm unavailable.");n=R.md.sha1.create()}var U=n.digestLength,u=n.blockLength,l=new R.util.ByteBuffer,p=new R.util.ByteBuffer;if(null!==o&&void 0!==o){for(_=0;_<o.length;_++)p.putInt16(o.charCodeAt(_));p.putInt16(0)}var f=p.length(),h=e.length(),d=new R.util.ByteBuffer;d.fillWithByte(t,u);var y=u*Math.ceil(h/u),g=new R.util.ByteBuffer;for(_=0;_<y;_++)g.putByte(e.at(_%h));var v=u*Math.ceil(f/u),m=new R.util.ByteBuffer;for(_=0;_<v;_++)m.putByte(p.at(_%f));var C=g;C.putBuffer(m);for(var D,P=Math.ceil(a/U),S=1;S<=P;S++){D=new R.util.ByteBuffer,D.putBytes(d.bytes()),D.putBytes(C.bytes());for(var V=0;V<r;V++)n.start(),n.update(D.getBytes()),D=n.digest();var O=new R.util.ByteBuffer;for(_=0;_<u;_++)O.putByte(D.at(_%U));var A=Math.ceil(h/u)+Math.ceil(f/u),B=new R.util.ByteBuffer;for(L=0;L<A;L++){var N=new R.util.ByteBuffer(C.getBytes(u)),k=511;for(_=O.length()-1;0<=_;_--)k>>=8,k+=O.at(_)+N.at(_),N.setAt(_,255&k);B.putBuffer(N)}C=B,l.putBuffer(D)}return l.truncate(l.length()-a),l},u.pbe.getCipher=function(n,e,t){switch(n){case u.oids.pkcs5PBES2:return u.pbe.getCipherForPBES2(n,e,t);case u.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case u.oids["pbewithSHAAnd40BitRC2-CBC"]:return u.pbe.getCipherForPKCS12PBE(n,e,t);default:var r=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw r.oid=n,r.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],r;}},u.pbe.getCipherForPBES2=function(n,l,t){var r={},a=[];if(!o.validate(l,E,r,a)){var i=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw i.errors=a,i}if((n=o.derToOid(r.kdfOid))!==u.oids.pkcs5PBKDF2){var i=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw i.oid=n,i.supportedOids=["pkcs5PBKDF2"],i}if((n=o.derToOid(r.encOid))!==u.oids["aes128-CBC"]&&n!==u.oids["aes192-CBC"]&&n!==u.oids["aes256-CBC"]&&n!==u.oids["des-EDE3-CBC"]&&n!==u.oids.desCBC){var i=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw i.oid=n,i.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],i}var h=r.kdfSalt,c=R.util.createBuffer(r.kdfIterationCount);c=c.getInt(c.length()<<3);var S,T;switch(u.oids[n]){case"aes128-CBC":S=16,T=R.aes.createDecryptionCipher;break;case"aes192-CBC":S=24,T=R.aes.createDecryptionCipher;break;case"aes256-CBC":S=32,T=R.aes.createDecryptionCipher;break;case"des-EDE3-CBC":S=24,T=R.des.createDecryptionCipher;break;case"desCBC":S=8,T=R.des.createDecryptionCipher;}var I=C(r.prfOid),y=R.pkcs5.pbkdf2(t,h,c,S,I),g=r.encIv,B=T(y);return B.start(g),B},u.pbe.getCipherForPKCS12PBE=function(n,e,t){var r={},a=[];if(!o.validate(e,m,r,a)){var i=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw i.errors=a,i}var d=R.util.createBuffer(r.salt),c=R.util.createBuffer(r.iterations);c=c.getInt(c.length()<<3);var l,E,S;switch(n){case u.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:l=24,E=8,S=R.des.startDecrypting;break;case u.oids["pbewithSHAAnd40BitRC2-CBC"]:l=5,E=8,S=function(a,e){var t=R.rc2.createDecryptionCipher(a,40);return t.start(e,null),t};break;default:var i=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw i.oid=n,i;}var T=C(r.prfOid),g=u.pbe.generatePkcs12Key(t,d,1,c,l,T);return T.start(),S(g,u.pbe.generatePkcs12Key(t,d,2,c,E,T))},u.pbe.opensslDeriveBytes=function(a,e,o,r){if(void 0===r||null===r){if(!("md5"in R.md))throw new Error("\"md5\" hash algorithm unavailable.");r=R.md.md5.create()}null===e&&(e="");for(var d=[y(r,a+e)],i=16,l=1;i<o;++l,i+=16)d.push(y(r,d[l-1]+a+e));return d.join("").substr(0,o)}},function(d,e,t){function l(){i=String.fromCharCode(128),i+=n.util.fillString(String.fromCharCode(0),64),r=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],p=!0}function g(u,e,t){for(var E,S,T,I,B,A,b,N,R,L,_,k,U,D,P,V=t.length();64<=V;){for(b=0;16>b;++b)e[b]=t.getInt32();for(;64>b;++b)E=e[b-2],E=(E>>>17|E<<15)^(E>>>19|E<<13)^E>>>10,S=e[b-15],S=(S>>>7|S<<25)^(S>>>18|S<<14)^S>>>3,e[b]=0|E+e[b-7]+S+e[b-16];for(N=u.h0,R=u.h1,L=u.h2,_=u.h3,k=u.h4,U=u.h5,D=u.h6,P=u.h7,b=0;64>b;++b)I=(k>>>6|k<<26)^(k>>>11|k<<21)^(k>>>25|k<<7),B=D^k&(U^D),T=(N>>>2|N<<30)^(N>>>13|N<<19)^(N>>>22|N<<10),A=N&R|L&(N^R),E=P+I+B+r[b]+e[b],S=T+A,P=D,D=U,U=k,k=_+E>>>0,_=L,L=R,R=N,N=E+S>>>0;u.h0=0|u.h0+N,u.h1=0|u.h1+R,u.h2=0|u.h2+L,u.h3=0|u.h3+_,u.h4=0|u.h4+k,u.h5=0|u.h5+U,u.h6=0|u.h6+D,u.h7=0|u.h7+P,V-=64}}var n=t(0);t(4),t(1);var a=d.exports=n.sha256=n.sha256||{};n.md.sha256=n.md.algorithms.sha256=a,a.create=function(){p||l();var m=null,C=n.util.createBuffer(),E=Array(64),S={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return S.start=function(){S.messageLength=0,S.fullMessageLength=S.messageLength64=[];for(var e=S.messageLengthSize/4,t=0;t<e;++t)S.fullMessageLength.push(0);return C=n.util.createBuffer(),m={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},S},S.start(),S.update=function(e,t){"utf8"===t&&(e=n.util.encodeUtf8(e));var r=e.length;S.messageLength+=r,r=[r/4294967296>>>0,r>>>0];for(var s=S.fullMessageLength.length-1;0<=s;--s)S.fullMessageLength[s]+=r[1],r[1]=r[0]+(S.fullMessageLength[s]/4294967296>>>0),S.fullMessageLength[s]>>>=0,r[0]=r[1]/4294967296>>>0;return C.putBytes(e),g(m,E,C),(2048<C.read||0===C.length())&&C.compact(),S},S.digest=function(){var e=n.util.createBuffer();e.putBytes(C.bytes());var t=S.fullMessageLength[S.fullMessageLength.length-1]+S.messageLengthSize,a=t&S.blockLength-1;e.putBytes(i.substr(0,S.blockLength-a));for(var r,s,o=8*S.fullMessageLength[0],c=0;c<S.fullMessageLength.length-1;++c)r=8*S.fullMessageLength[c+1],s=r/4294967296>>>0,o+=s,e.putInt32(o>>>0),o=r>>>0;e.putInt32(o);var u={h0:m.h0,h1:m.h1,h2:m.h2,h3:m.h3,h4:m.h4,h5:m.h5,h6:m.h6,h7:m.h7};g(u,E,e);var d=n.util.createBuffer();return d.putInt32(u.h0),d.putInt32(u.h1),d.putInt32(u.h2),d.putInt32(u.h3),d.putInt32(u.h4),d.putInt32(u.h5),d.putInt32(u.h6),d.putInt32(u.h7),d},S};var i=null,p=!1,r=null},function(s,e,t){var d=t(0);t(1);var a=null;!d.util.isNodejs||d.options.usePureJavaScript||process.versions["node-webkit"]||(a=t(16)),(s.exports=d.prng=d.prng||{}).create=function(n){function e(a){if(32<=y.pools[0].messageLength)return g(),a();var e=32-y.pools[0].messageLength<<5;y.seedFile(e,function(e,t){return e?a(e):void(y.collect(t),g(),a())})}function p(){if(32<=y.pools[0].messageLength)return g();var t=32-y.pools[0].messageLength<<5;y.collect(y.seedFileSync(t)),g()}function g(){y.reseeds=4294967295===y.reseeds?0:y.reseeds+1;var n=y.plugin.md.create();n.update(y.keyBytes);for(var e=1,s=0;32>s;++s)0==y.reseeds%e&&(n.update(y.pools[s].digest().getBytes()),y.pools[s].start()),e<<=1;y.keyBytes=n.digest().getBytes(),n.start(),n.update(y.keyBytes);var i=n.digest().getBytes();y.key=y.plugin.formatKey(y.keyBytes),y.seed=y.plugin.formatSeed(i),y.generated=0}function r(a){var e=null,g=d.util.globalScope,r=g.crypto||g.msCrypto;r&&r.getRandomValues&&(e=function(t){return r.getRandomValues(t)});var n=d.util.createBuffer();if(e)for(;n.length()<a;){var i=Math.max(1,Math.min(a-n.length(),65536)/4),s=new Uint32Array(Math.floor(i));try{e(s);for(var o=0;o<s.length;++o)n.putInt32(s[o])}catch(t){if(!("undefined"!=typeof QuotaExceededError&&t instanceof QuotaExceededError))throw t}}if(n.length()<a)for(var y,h,m,C=Math.floor(65536*Math.random());n.length()<a;){h=16807*(65535&C),y=16807*(C>>16),h+=(32767&y)<<16,h+=y>>15,h=(2147483647&h)+(h>>31),C=4294967295&h;for(var o=0;3>o;++o)m=C>>>(o<<3),m^=Math.floor(256*Math.random()),n.putByte(String.fromCharCode(255&m))}return n.getBytes(a)}for(var y={plugin:n,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},t=n.md,s=Array(32),i=0;32>i;++i)s[i]=t.create();return y.pools=s,y.pool=0,y.generate=function(t,a){function r(l){if(l)return a(l);if(c.length()>=t)return a(null,c.getBytes(t));if(1048575<y.generated&&(y.key=null),null===y.key)return d.util.nextTick(function(){e(r)});var p=n(y.key,y.seed);y.generated+=p.length,c.putBytes(p),y.key=s(n(y.key,i(y.seed))),y.seed=o(n(y.key,y.seed)),d.util.setImmediate(r)}if(!a)return y.generateSync(t);var n=y.plugin.cipher,i=y.plugin.increment,s=y.plugin.formatKey,o=y.plugin.formatSeed,c=d.util.createBuffer();y.key=null,r()},y.generateSync=function(a){var e=y.plugin.cipher,t=y.plugin.increment,r=y.plugin.formatKey,n=y.plugin.formatSeed;y.key=null;for(var s=d.util.createBuffer();s.length()<a;){1048575<y.generated&&(y.key=null),null===y.key&&p();var i=e(y.key,y.seed);y.generated+=i.length,s.putBytes(i),y.key=r(e(y.key,t(y.seed))),y.seed=n(e(y.key,y.seed))}return s.getBytes(a)},a?(y.seedFile=function(r,n){a.randomBytes(r,function(t,e){return t?n(t):void n(null,e.toString())})},y.seedFileSync=function(t){return a.randomBytes(t).toString()}):(y.seedFile=function(a,n){try{n(null,r(a))}catch(t){n(t)}},y.seedFileSync=r),y.collect=function(a){for(var e=a.length,t=0;t<e;++t)y.pools[y.pool].update(a.substr(t,1)),y.pool=31===y.pool?0:y.pool+1},y.collectInt=function(n,e){for(var t="",s=0;s<e;s+=8)t+=String.fromCharCode(255&n>>s);y.collect(t)},y.registerWorker=function(a){if(a===self)y.seedFile=function(a,n){function t(r){var e=r.data;e.forge&&e.forge.prng&&(self.removeEventListener("message",t),n(e.forge.prng.err,e.forge.prng.bytes))}self.addEventListener("message",t),self.postMessage({forge:{prng:{needed:a}}})};else{var e=function(e){var t=e.data;t.forge&&t.forge.prng&&y.seedFile(t.forge.prng.needed,function(e,t){a.postMessage({forge:{prng:{err:e,bytes:t}}})})};a.addEventListener("message",e)}},y}},function(d,e,t){var l=t(0);t(1);var a=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],r=[1,2,3,5],n=function(a,e){return 65535&a<<e|(65535&a)>>16-e},s=function(a,e){return(65535&a)>>e|65535&a<<16-e};d.exports=l.rc2=l.rc2||{},l.rc2.expandKey=function(n,d){"string"==typeof n&&(n=l.util.createBuffer(n)),d=d||128;var p,u=n,i=n.length(),s=d,o=Math.ceil(s/8);for(p=i;128>p;p++)u.putByte(a[255&u.at(p-1)+u.at(p-i)]);for(u.setAt(128-o,a[u.at(128-o)&255>>(7&s)]),p=127-o;0<=p;p--)u.setAt(p,a[u.at(p+1)^u.at(p+o)]);return u};var i=function(a,i,o){var t,m,C,E,S=!1,T=null,I=null,B=null,A=[];for(a=l.rc2.expandKey(a,i),C=0;64>C;C++)A.push(a.getInt16Le());o?(t=function(t){for(C=0;4>C;C++)t[C]+=A[E]+(t[(C+3)%4]&t[(C+2)%4])+(~t[(C+3)%4]&t[(C+1)%4]),t[C]=n(t[C],r[C]),E++},m=function(t){for(C=0;4>C;C++)t[C]+=A[63&t[(C+3)%4]]}):(t=function(t){for(C=3;0<=C;C--)t[C]=s(t[C],r[C]),t[C]-=A[E]+(t[(C+3)%4]&t[(C+2)%4])+(~t[(C+3)%4]&t[(C+1)%4]),E--},m=function(t){for(C=3;0<=C;C--)t[C]-=A[63&t[(C+3)%4]]});var y=function(r){var e=[];for(C=0;4>C;C++){var t=T.getInt16Le();null!==B&&(o?t^=B.getInt16Le():B.putInt16Le(t)),e.push(65535&t)}E=o?0:63;for(var s=0;s<r.length;s++)for(var c=0;c<r[s][0];c++)r[s][1](e);for(C=0;4>C;C++)null!==B&&(o?B.putInt16Le(e[C]):e[C]^=B.getInt16Le()),I.putInt16Le(e[C])},g=null;return g={start:function(a,r){a&&"string"==typeof a&&(a=l.util.createBuffer(a)),S=!1,T=l.util.createBuffer(),I=r||new l.util.createBuffer,B=a,g.output=I},update:function(a){for(S||T.putBuffer(a);8<=T.length();)y([[5,t],[1,m],[6,t],[1,m],[5,t]])},finish:function(r){var e=!0;if(o)if(r)e=r(8,T,!o);else{var s=8===T.length()?8:8-T.length();T.fillWithByte(s,s)}if(e&&(S=!0,g.update()),!o&&(e=0===T.length()))if(r)e=r(8,I,!o);else{var a=I.length(),n=I.at(a-1);n>a?e=!1:I.truncate(n)}return e}}};l.rc2.startEncrypting=function(a,e,t){var r=l.rc2.createEncryptionCipher(a,128);return r.start(e,t),r},l.rc2.createEncryptionCipher=function(a,e){return i(a,e,!0)},l.rc2.startDecrypting=function(a,e,t){var r=l.rc2.createDecryptionCipher(a,128);return r.start(e,t),r},l.rc2.createDecryptionCipher=function(a,e){return i(a,e,!1)}},function(s,e,t){function E(n,e,t){t||(t=B.md.sha1.create());for(var c,d="",l=Math.ceil(e/t.digestLength),i=0;i<l;++i)c=String.fromCharCode(255&i>>24,255&i>>16,255&i>>8,255&i),t.start(),t.update(n+c),d+=t.digest().getBytes();return d.substring(0,e)}var B=t(0);t(1),t(2),t(9);var a=s.exports=B.pkcs1=B.pkcs1||{};a.encode_rsa_oaep=function(a,e,t){var r,n,S,T;"string"==typeof t?(r=t,n=arguments[3]||void 0,S=arguments[4]||void 0):t&&(r=t.label||void 0,n=t.seed||void 0,S=t.md||void 0,t.mgf1&&t.mgf1.md&&(T=t.mgf1.md)),S?S.start():S=B.md.sha1.create(),T||(T=S);var I=Math.ceil(a.n.bitLength()/8),u=I-2*S.digestLength-2;if(e.length>u){var l=new Error("RSAES-OAEP input message length is too long.");throw l.length=e.length,l.maxLength=u,l}r||(r=""),S.update(r,"raw");for(var A=S.digest(),f="",b=u-e.length,d=0;d<b;d++)f+="\0";var N=A.getBytes()+f+"\x01"+e;if(!n)n=B.random.getBytes(S.digestLength);else if(n.length!==S.digestLength){var l=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw l.seedLength=n.length,l.digestLength=S.digestLength,l}var g=E(n,I-S.digestLength-1,T),v=B.util.xorBytes(N,g,N.length),m=E(v,S.digestLength,T);return"\0"+B.util.xorBytes(n,m,n.length)+v},a.decode_rsa_oaep=function(a,e,t){var r,n,A;"string"==typeof t?(r=t,n=arguments[3]||void 0):t&&(r=t.label||void 0,n=t.md||void 0,t.mgf1&&t.mgf1.md&&(A=t.mgf1.md));var b=Math.ceil(a.n.bitLength()/8);if(e.length!==b){var c=new Error("RSAES-OAEP encoded message length is invalid.");throw c.length=e.length,c.expectedLength=b,c}if(void 0===n?n=B.md.sha1.create():n.start(),A||(A=n),b<2*n.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");r||(r=""),n.update(r,"raw");for(var N=n.digest().getBytes(),l=e.charAt(0),p=e.substring(1,n.digestLength+1),f=e.substring(1+n.digestLength),h=E(f,n.digestLength,A),d=B.util.xorBytes(p,h,p.length),y=E(d,b-n.digestLength-1,A),g=B.util.xorBytes(f,y,f.length),v=g.substring(0,n.digestLength),c="\0"!==l,m=0;m<n.digestLength;++m)c|=N.charAt(m)!==v.charAt(m);for(var R=1,L=n.digestLength,_=n.digestLength;_<g.length;_++){var k=g.charCodeAt(_);c|=k&(R?65534:0),R&=1^1&k,L+=R}if(c||1!==g.charCodeAt(L))throw new Error("Invalid RSAES-OAEP padding.");return g.substring(L+1)}},function(d,e,t){var g=t(0);t(1),t(12),t(2),function(){function a(s,e,t,a){return"workers"in t?r(s,e,t,a):y(s,e,t,a)}function y(s,e,t,r){var a=m(s,e),i=n(a.bitLength());"millerRabinTests"in t&&(i=t.millerRabinTests);var o=10;"maxBlockTime"in t&&(o=t.maxBlockTime),h(a,s,e,0,i,o,r)}function h(a,n,t,r,s,o,d){var l=+new Date;do{if(a.bitLength()>n&&(a=m(n,t)),a.isProbablePrime(s))return d(null,a);a.dAddOffset(c[r++%8],0)}while(0>o||+new Date-l<o);g.util.setImmediate(function(){h(a,n,t,r,s,o,d)})}function r(d,e,t,r){function a(){function t(t){if(!y){--g;var a=t.data;if(a.found){for(var n=0;n<c.length;++n)c[n].terminate();return y=!0,r(null,new s(a.prime,16))}i.bitLength()>d&&(i=m(d,e));var o=i.toString(16);t.target.postMessage({hex:o,workLoad:C}),i.dAddOffset(p,0)}}u=Math.max(1,u);for(var c=[],a=0;a<u;++a)c[a]=new Worker(o);for(var g=u,a=0;a<u;++a)c[a].addEventListener("message",t);var y=!1}if("undefined"==typeof Worker)return y(d,e,t,r);var i=m(d,e),u=t.workers,C=t.workLoad||100,p=30*C/8,o=t.workerScript||"forge/prime.worker.js";return-1===u?g.util.estimateCores(function(r,e){r&&(e=2),u=e-1,a()}):void a()}function m(n,e){var t=new s(n,e),r=n-1;return t.testBit(r)||t.bitwiseTo(s.ONE.shiftLeft(r),o,t),t.dAddOffset(31-t.mod(i).byteValue(),0),t}function n(t){return 100>=t?27:150>=t?18:200>=t?15:250>=t?12:300>=t?9:350>=t?8:400>=t?7:500>=t?6:600>=t?5:800>=t?4:1250>=t?3:2}if(g.prime)return void(d.exports=g.prime);var e=d.exports=g.prime=g.prime||{},s=g.jsbn.BigInteger,c=[6,4,2,4,2,4,6,2],i=new s(null);i.fromInt(30);var o=function(a,e){return a|e};e.generateProbablePrime=function(t,e,o){"function"==typeof e&&(o=e,e={}),e=e||{};var c=e.algorithm||"PRIMEINC";"string"==typeof c&&(c={name:c}),c.options=c.options||{};var d=e.prng||g.random;if("PRIMEINC"===c.name)return a(t,{nextBytes:function(a){for(var e=d.getBytesSync(a.length),t=0;t<a.length;++t)a[t]=e.charCodeAt(t)}},c.options,o);throw new Error("Invalid prime generation algorithm: "+c.name)}}()},function(m,e,t){function C(c,e,t,r){for(var a=[],n=0;n<c.length;n++)for(var d,l=0;l<c[n].safeBags.length;l++)d=c[n].safeBags[l],void 0!==r&&d.type!==r||(null===e?a.push(d):void 0!==d.attributes[e]&&0<=d.attributes[e].indexOf(t)&&a.push(d));return a}function I(a){if(a.composed||a.constructed){for(var e=L.util.createBuffer(),t=0;t<a.value.length;++t)e.putBytes(a.value[t].value);a.composed=a.constructed=!1,a.value=e.getBytes()}return a}function a(o,e,p,h){if(e=U.fromDer(e,p),e.tagClass!==U.Class.UNIVERSAL||e.type!==U.Type.SEQUENCE||!0!==e.constructed)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var a=0;a<e.value.length;a++){var m=e.value[a],c={},u=[];if(!U.validate(m,s,c,u)){var f=new Error("Cannot read ContentInfo.");throw f.errors=u,f}var C={encrypted:!1},y=null,E=c.content.value[0];switch(U.derToOid(c.contentType)){case l.oids.data:if(E.tagClass!==U.Class.UNIVERSAL||E.type!==U.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");y=I(E).value;break;case l.oids.encryptedData:y=r(E,h),C.encrypted=!0;break;default:var f=new Error("Unsupported PKCS#12 contentType.");throw f.contentType=U.derToOid(c.contentType),f;}C.safeBags=n(y,p,h),o.safeContents.push(C)}}function r(n,e){var t={},r=[];if(!U.validate(n,L.pkcs7.asn1.encryptedDataValidator,t,r)){var a=new Error("Cannot read EncryptedContentInfo.");throw a.errors=r,a}var d=U.derToOid(t.contentType);if(d!==l.oids.data){var a=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw a.oid=d,a}d=U.derToOid(t.encAlgorithm);var p=l.pbe.getCipher(d,t.encParameter,e),o=I(t.encryptedContentAsn1),c=L.util.createBuffer(o.value);if(p.update(c),!p.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return p.output.getBytes()}function n(y,m,t){if(!m&&0===y.length)return[];if(y=U.fromDer(y,m),y.tagClass!==U.Class.UNIVERSAL||y.type!==U.Type.SEQUENCE||!0!==y.constructed)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var r=[],a=0;a<y.value.length;a++){var C=y.value[a],i={},s=[];if(!U.validate(C,c,i,s)){var o=new Error("Cannot read SafeBag.");throw o.errors=s,o}var S={type:U.derToOid(i.bagId),attributes:E(i.bagAttributes)};r.push(S);var f,T,I=i.bagValue.value[0];switch(S.type){case l.oids.pkcs8ShroudedKeyBag:if(null===(I=l.decryptPrivateKeyInfo(I,t)))throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case l.oids.keyBag:try{S.key=l.privateKeyFromAsn1(I)}catch(t){S.key=null,S.asn1=I}continue;case l.oids.certBag:f=p,T=function(){if(U.derToOid(i.certId)!==l.oids.x509Certificate){var t=new Error("Unsupported certificate type, only X.509 supported.");throw t.oid=U.derToOid(i.certId),t}var a=U.fromDer(i.cert,m);try{S.cert=l.certificateFromAsn1(a,!0)}catch(t){S.cert=null,S.asn1=a}};break;default:var o=new Error("Unsupported PKCS#12 SafeBag type.");throw o.oid=S.type,o;}if(void 0!==f&&!U.validate(I,f,i,s)){var o=new Error("Cannot read PKCS#12 "+f.name);throw o.errors=s,o}T()}return r}function E(c){var e={};if(void 0!==c)for(var t=0;t<c.length;++t){var p={},a=[];if(!U.validate(c[t],d,p,a)){var n=new Error("Cannot read PKCS#12 BagAttribute.");throw n.errors=a,n}var i=U.derToOid(p.oid);if(void 0!==l.oids[i]){e[l.oids[i]]=[];for(var s=0;s<p.values.length;++s)e[l.oids[i]].push(p.values[s].value)}}return e}var L=t(0);t(3),t(8),t(6),t(29),t(22),t(2),t(11),t(9),t(1),t(17);var U=L.asn1,l=L.pki,i=m.exports=L.pkcs12=L.pkcs12||{},s={name:"ContentInfo",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:U.Class.UNIVERSAL,type:U.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:U.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},o={name:"PFX",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:U.Class.UNIVERSAL,type:U.Type.INTEGER,constructed:!1,capture:"version"},s,{name:"PFX.macData",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:U.Class.UNIVERSAL,type:U.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:U.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:U.Class.UNIVERSAL,type:U.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:U.Class.UNIVERSAL,type:U.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:U.Class.UNIVERSAL,type:U.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},c={name:"SafeBag",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:U.Class.UNIVERSAL,type:U.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:U.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:U.Class.UNIVERSAL,type:U.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},d={name:"Attribute",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:U.Class.UNIVERSAL,type:U.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:U.Class.UNIVERSAL,type:U.Type.SET,constructed:!0,capture:"values"}]},p={name:"CertBag",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:U.Class.UNIVERSAL,type:U.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:U.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:U.Class.UNIVERSAL,type:U.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};i.pkcs12FromAsn1=function(n,e,d){"string"==typeof e?(d=e,e=!0):void 0===e&&(e=!0);var p={};if(!U.validate(n,o,p,[])){var s=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw s.errors=s,s}var u={version:p.version.charCodeAt(0),safeContents:[],getBags:function(a){var e,n={};return"localKeyId"in a?e=a.localKeyId:"localKeyIdHex"in a&&(e=L.util.hexToBytes(a.localKeyIdHex)),void 0===e&&!("friendlyName"in a)&&"bagType"in a&&(n[a.bagType]=C(u.safeContents,null,null,a.bagType)),void 0!==e&&(n.localKeyId=C(u.safeContents,"localKeyId",e,a.bagType)),"friendlyName"in a&&(n.friendlyName=C(u.safeContents,"friendlyName",a.friendlyName,a.bagType)),n},getBagsByFriendlyName:function(a,e){return C(u.safeContents,"friendlyName",a,e)},getBagsByLocalKeyId:function(a,e){return C(u.safeContents,"localKeyId",a,e)}};if(3!==p.version.charCodeAt(0)){var s=new Error("PKCS#12 PFX of version other than 3 not supported.");throw s.version=p.version.charCodeAt(0),s}if(U.derToOid(p.contentType)!==l.oids.data){var s=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw s.oid=U.derToOid(p.contentType),s}var h=p.content.value[0];if(h.tagClass!==U.Class.UNIVERSAL||h.type!==U.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(h=I(h),p.mac){var f=null,B=0,A=U.derToOid(p.macAlgorithm);if(A===l.oids.sha1?(f=L.md.sha1.create(),B=20):A===l.oids.sha256?(f=L.md.sha256.create(),B=32):A===l.oids.sha384?(f=L.md.sha384.create(),B=48):A===l.oids.sha512?(f=L.md.sha512.create(),B=64):A===l.oids.md5?(f=L.md.md5.create(),B=16):void 0,null===f)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+A);var m=new L.util.ByteBuffer(p.macSalt),b="macIterations"in p?parseInt(L.util.bytesToHex(p.macIterations),16):1,E=i.generateKey(d,m,3,b,B,f),S=L.hmac.create();if(S.start(f,E),S.update(h.value),S.getMac().getBytes()!==p.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return a(u,h.value,e,d),u},i.toPkcs12Asn1=function(p,u,f,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||r.encAlgorithm||"aes128","useMac"in r||(r.useMac=!0),"localKeyId"in r||(r.localKeyId=null),"generateLocalKeyId"in r||(r.generateLocalKeyId=!0);var D,P=r.localKeyId;if(null!==P)P=L.util.hexToBytes(P);else if(r.generateLocalKeyId)if(u){var V=L.util.isArray(u)?u[0]:u;"string"==typeof V&&(V=l.certificateFromPem(V));var O=L.md.sha1.create();O.update(U.toDer(l.certificateToAsn1(V)).getBytes()),P=O.digest().getBytes()}else P=L.random.getBytes(20);var K=[];null!==P&&K.push(U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(l.oids.localKeyId).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.SET,!0,[U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,P)])])),"friendlyName"in r&&K.push(U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(l.oids.friendlyName).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.SET,!0,[U.create(U.Class.UNIVERSAL,U.Type.BMPSTRING,!1,r.friendlyName)])])),0<K.length&&(D=U.create(U.Class.UNIVERSAL,U.Type.SET,!0,K));var c=[],h=[];null!==u&&(h=L.util.isArray(u)?u:[u]);for(var x=[],y=0;y<h.length;++y){u=h[y],"string"==typeof u&&(u=l.certificateFromPem(u));var F=0==y?D:void 0,v=l.certificateToAsn1(u),m=U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(l.oids.certBag).getBytes()),U.create(U.Class.CONTEXT_SPECIFIC,0,!0,[U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(l.oids.x509Certificate).getBytes()),U.create(U.Class.CONTEXT_SPECIFIC,0,!0,[U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,U.toDer(v).getBytes())])])]),F]);x.push(m)}if(0<x.length){var C=U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,x),E=U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(l.oids.data).getBytes()),U.create(U.Class.CONTEXT_SPECIFIC,0,!0,[U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,U.toDer(C).getBytes())])]);c.push(E)}var S=null;if(null!==p){var q=l.wrapRsaPrivateKey(l.privateKeyToAsn1(p));S=null===f?U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(l.oids.keyBag).getBytes()),U.create(U.Class.CONTEXT_SPECIFIC,0,!0,[q]),D]):U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(l.oids.pkcs8ShroudedKeyBag).getBytes()),U.create(U.Class.CONTEXT_SPECIFIC,0,!0,[l.encryptPrivateKeyInfo(q,f,r)]),D]);var I=U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[S]),b=U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(l.oids.data).getBytes()),U.create(U.Class.CONTEXT_SPECIFIC,0,!0,[U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,U.toDer(I).getBytes())])]);c.push(b)}var A,j=U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,c);if(r.useMac){var O=L.md.sha1.create(),N=new L.util.ByteBuffer(L.random.getBytes(r.saltSize)),k=r.count,p=i.generateKey(f,N,3,k,20),w=L.hmac.create();w.start(O,p),w.update(U.toDer(j).getBytes());var R=w.getMac();A=U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(l.oids.sha1).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.NULL,!1,"")]),U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,R.getBytes())]),U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,N.getBytes()),U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,U.integerToDer(k).getBytes())])}return U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,U.integerToDer(3).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(l.oids.data).getBytes()),U.create(U.Class.CONTEXT_SPECIFIC,0,!0,[U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,U.toDer(j).getBytes())])]),A])},i.generateKey=L.pbe.generatePkcs12Key},function(d,e,t){var r=t(0);t(3),t(1);var a=r.asn1,n=d.exports=r.pkcs7asn1=r.pkcs7asn1||{};r.pkcs7=r.pkcs7||{},r.pkcs7.asn1=n;var i={name:"ContentInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:a.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};n.contentInfoValidator=i;var s={name:"EncryptedContentInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:a.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:a.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};n.envelopedDataValidator={name:"EnvelopedData",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:a.Class.UNIVERSAL,type:a.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(s)},n.encryptedDataValidator={name:"EncryptedData",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"version"}].concat(s)};var o={name:"SignerInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:a.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:a.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:a.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};n.signedDataValidator={name:"SignedData",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:a.Class.UNIVERSAL,type:a.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},i,{name:"SignedData.Certificates",tagClass:a.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:a.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:a.Class.UNIVERSAL,type:a.Type.SET,capture:"signerInfos",optional:!0,value:[o]}]},n.recipientInfoValidator={name:"RecipientInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:a.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}},function(n,e,t){var c=t(0);t(1),c.mgf=c.mgf||{},(n.exports=c.mgf.mgf1=c.mgf1=c.mgf1||{}).create=function(a){return{generate:function(e,t){for(var r,d=new c.util.ByteBuffer,n=Math.ceil(t/a.digestLength),i=0;i<n;i++)r=new c.util.ByteBuffer,r.putInt32(i),a.start(),a.update(e+r.getBytes()),d.putBuffer(a.digest());return d.truncate(d.length()-t),d.getBytes()}}}},function(n,e,t){var s=t(0);n.exports=s.debug=s.debug||{},s.debug.storage={},s.debug.get=function(a,e){var t;return void 0===a?t=s.debug.storage:a in s.debug.storage&&(t=void 0===e?s.debug.storage[a]:s.debug.storage[a][e]),t},s.debug.set=function(a,e,t){a in s.debug.storage||(s.debug.storage[a]={}),s.debug.storage[a][e]=t},s.debug.clear=function(a,e){void 0===a?s.debug.storage={}:a in s.debug.storage&&(void 0===e?delete s.debug.storage[a]:delete s.debug.storage[a][e])}},function(d,e,t){function g(){i=String.fromCharCode(128),i+=n.util.fillString(String.fromCharCode(0),128),U=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],C={},C["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],C["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],C["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],C["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],y=!0}function m(l,e,t){for(var r,F,q,j,G,H,M,Q,z,Y,W,X,J,$,ee,te,ae,re,ne,se,ie,oe,ce,de,le,pe,ue,ge,ye,he,fe,me,Ce,Ee,Se,Te=t.length();128<=Te;){for(ye=0;16>ye;++ye)e[ye][0]=t.getInt32()>>>0,e[ye][1]=t.getInt32()>>>0;for(;80>ye;++ye)me=e[ye-2],he=me[0],fe=me[1],r=((he>>>19|fe<<13)^(fe>>>29|he<<3)^he>>>6)>>>0,F=((he<<13|fe>>>19)^(fe<<3|he>>>29)^(he<<26|fe>>>6))>>>0,Ee=e[ye-15],he=Ee[0],fe=Ee[1],q=((he>>>1|fe<<31)^(he>>>8|fe<<24)^he>>>7)>>>0,j=((he<<31|fe>>>1)^(he<<24|fe>>>8)^(he<<25|fe>>>7))>>>0,Ce=e[ye-7],Se=e[ye-16],fe=F+Ce[1]+j+Se[1],e[ye][0]=r+Ce[0]+q+Se[0]+(fe/4294967296>>>0)>>>0,e[ye][1]=fe>>>0;for(J=l[0][0],$=l[0][1],ee=l[1][0],te=l[1][1],ae=l[2][0],re=l[2][1],ne=l[3][0],se=l[3][1],ie=l[4][0],oe=l[4][1],ce=l[5][0],de=l[5][1],le=l[6][0],pe=l[6][1],ue=l[7][0],ge=l[7][1],ye=0;80>ye;++ye)M=((ie>>>14|oe<<18)^(ie>>>18|oe<<14)^(oe>>>9|ie<<23))>>>0,Q=((ie<<18|oe>>>14)^(ie<<14|oe>>>18)^(oe<<23|ie>>>9))>>>0,z=(le^ie&(ce^le))>>>0,Y=(pe^oe&(de^pe))>>>0,G=((J>>>28|$<<4)^($>>>2|J<<30)^($>>>7|J<<25))>>>0,H=((J<<4|$>>>28)^($<<30|J>>>2)^($<<25|J>>>7))>>>0,W=(J&ee|ae&(J^ee))>>>0,X=($&te|re&($^te))>>>0,fe=ge+Q+Y+U[ye][1]+e[ye][1],r=ue+M+z+U[ye][0]+e[ye][0]+(fe/4294967296>>>0)>>>0,F=fe>>>0,fe=H+X,q=G+W+(fe/4294967296>>>0)>>>0,j=fe>>>0,ue=le,ge=pe,le=ce,pe=de,ce=ie,de=oe,fe=se+F,ie=ne+r+(fe/4294967296>>>0)>>>0,oe=fe>>>0,ne=ae,se=re,ae=ee,re=te,ee=J,te=$,fe=F+j,J=r+q+(fe/4294967296>>>0)>>>0,$=fe>>>0;fe=l[0][1]+$,l[0][0]=l[0][0]+J+(fe/4294967296>>>0)>>>0,l[0][1]=fe>>>0,fe=l[1][1]+te,l[1][0]=l[1][0]+ee+(fe/4294967296>>>0)>>>0,l[1][1]=fe>>>0,fe=l[2][1]+re,l[2][0]=l[2][0]+ae+(fe/4294967296>>>0)>>>0,l[2][1]=fe>>>0,fe=l[3][1]+se,l[3][0]=l[3][0]+ne+(fe/4294967296>>>0)>>>0,l[3][1]=fe>>>0,fe=l[4][1]+oe,l[4][0]=l[4][0]+ie+(fe/4294967296>>>0)>>>0,l[4][1]=fe>>>0,fe=l[5][1]+de,l[5][0]=l[5][0]+ce+(fe/4294967296>>>0)>>>0,l[5][1]=fe>>>0,fe=l[6][1]+pe,l[6][0]=l[6][0]+le+(fe/4294967296>>>0)>>>0,l[6][1]=fe>>>0,fe=l[7][1]+ge,l[7][0]=l[7][0]+ue+(fe/4294967296>>>0)>>>0,l[7][1]=fe>>>0,Te-=128}}var n=t(0);t(4),t(1);var a=d.exports=n.sha512=n.sha512||{};n.md.sha512=n.md.algorithms.sha512=a;var r=n.sha384=n.sha512.sha384=n.sha512.sha384||{};r.create=function(){return a.create("SHA-384")},n.md.sha384=n.md.algorithms.sha384=r,n.sha512.sha256=n.sha512.sha256||{create:function(){return a.create("SHA-512/256")}},n.md["sha512/256"]=n.md.algorithms["sha512/256"]=n.sha512.sha256,n.sha512.sha224=n.sha512.sha224||{create:function(){return a.create("SHA-512/224")}},n.md["sha512/224"]=n.md.algorithms["sha512/224"]=n.sha512.sha224,a.create=function(c){if(y||g(),void 0===c&&(c="SHA-512"),!(c in C))throw new Error("Invalid SHA-512 algorithm: "+c);for(var d=C[c],p=null,E=n.util.createBuffer(),S=Array(80),t=0;80>t;++t)S[t]=[,,];var a=64;"SHA-384"===c?a=48:"SHA-512/256"===c?a=32:"SHA-512/224"===c?a=28:void 0;var o={algorithm:c.replace("-","").toLowerCase(),blockLength:128,digestLength:a,messageLength:0,fullMessageLength:null,messageLengthSize:16};return o.start=function(){o.messageLength=0,o.fullMessageLength=o.messageLength128=[];for(var t=o.messageLengthSize/4,e=0;e<t;++e)o.fullMessageLength.push(0);E=n.util.createBuffer(),p=Array(d.length);for(var e=0;e<d.length;++e)p[e]=d[e].slice(0);return o},o.start(),o.update=function(r,s){"utf8"===s&&(r=n.util.encodeUtf8(r));var t=r.length;o.messageLength+=t,t=[t/4294967296>>>0,t>>>0];for(var i=o.fullMessageLength.length-1;0<=i;--i)o.fullMessageLength[i]+=t[1],t[1]=t[0]+(o.fullMessageLength[i]/4294967296>>>0),o.fullMessageLength[i]>>>=0,t[0]=t[1]/4294967296>>>0;return E.putBytes(r),m(p,S,E),(2048<E.read||0===E.length())&&E.compact(),o},o.digest=function(){var e=n.util.createBuffer();e.putBytes(E.bytes());var t=o.fullMessageLength[o.fullMessageLength.length-1]+o.messageLengthSize,a=t&o.blockLength-1;e.putBytes(i.substr(0,o.blockLength-a));for(var r,s,u=8*o.fullMessageLength[0],h=0;h<o.fullMessageLength.length-1;++h)r=8*o.fullMessageLength[h+1],s=r/4294967296>>>0,u+=s,e.putInt32(u>>>0),u=r>>>0;e.putInt32(u);for(var C=Array(p.length),h=0;h<p.length;++h)C[h]=p[h].slice(0);m(C,S,e);var y,T=n.util.createBuffer();y="SHA-512"===c?C.length:"SHA-384"===c?C.length-2:C.length-4;for(var h=0;h<y;++h)T.putInt32(C[h][0]),h==y-1&&"SHA-512/224"===c||T.putInt32(C[h][1]);return T},o};var i=null,y=!1,U=null,C=null},function(d,e,t){var g=t(0);t(1),d.exports=g.log=g.log||{},g.log.levels=["none","error","warning","info","debug","verbose","max"];var a={},n=[],r=null;g.log.LEVEL_LOCKED=2,g.log.NO_LEVEL_CHECK=4,g.log.INTERPOLATE=8;for(var i,y=0;y<g.log.levels.length;++y)i=g.log.levels[y],a[i]={index:y,name:i.toUpperCase()};g.log.logMessage=function(i){for(var e,o=a[i.level].index,t=0;t<n.length;++t)e=n[t],e.flags&g.log.NO_LEVEL_CHECK?e.f(i):o<=a[e.level].index&&e.f(e,i)},g.log.prepareStandard=function(t){"standard"in t||(t.standard=a[t.level].name+" ["+t.category+"] "+t.message)},g.log.prepareFull=function(a){if(!("full"in a)){var e=[a.message];e=e.concat([]),a.full=g.util.format.apply(this,e)}},g.log.prepareStandardFull=function(t){"standardFull"in t||(g.log.prepareStandard(t),t.standardFull=t.standard)};for(var m=["error","warning","info","debug","verbose"],y=0;y<m.length;++y)!function(a){g.log[a]=function(e,t){var r=Array.prototype.slice.call(arguments).slice(2),n={timestamp:new Date,level:a,category:e,message:t,arguments:r};g.log.logMessage(n)}}(m[y]);if(g.log.makeLogger=function(a){var e={flags:0,f:a};return g.log.setLevel(e,"none"),e},g.log.setLevel=function(a,e){var t=!1;if(a&&!(a.flags&g.log.LEVEL_LOCKED))for(var s,o=0;o<g.log.levels.length;++o)if(s=g.log.levels[o],e==s){a.level=e,t=!0;break}return t},g.log.lock=function(a,e){void 0===e||e?a.flags|=g.log.LEVEL_LOCKED:a.flags&=~g.log.LEVEL_LOCKED},g.log.addLogger=function(t){n.push(t)},"undefined"!=typeof console&&"log"in console){var u;if(console.error&&console.warn&&console.info&&console.debug){var C={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},p=function(a,e){g.log.prepareStandard(e);var t=C[e.level],r=[e.standard];r=r.concat(e.arguments.slice()),t.apply(console,r)};u=g.log.makeLogger(p)}else{var p=function(a,e){g.log.prepareStandardFull(e),console.log(e.standardFull)};u=g.log.makeLogger(p)}g.log.setLevel(u,"debug"),g.log.addLogger(u),r=u}else console={log:function(){}};if(null!==r){var E=g.util.getQueryVariables();("console.level"in E&&g.log.setLevel(r,E["console.level"].slice(-1)[0]),"console.lock"in E)&&"true"==E["console.lock"].slice(-1)[0]&&g.log.lock(r)}g.log.consoleLogger=r},function(a,e,t){a.exports=t(35)},function(a,e,t){a.exports=t(0),t(5),t(38),t(3),t(13),t(31),t(10),t(40),t(8),t(42),t(33),t(43),t(30),t(15),t(7),t(26),t(28),t(44),t(21),t(27),t(24),t(18),t(2),t(25),t(45),t(46),t(20),t(1)},function(t){var a=function(){return this}();try{a=a||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(a=window)}t.exports=a},function(t){function d(d,e){var t=0,l=e.length,a=e.charAt(0),n=[0];for(t=0;t<d.length();++t){for(var i=0,p=d.at(t);i<n.length;++i)p+=n[i]<<8,n[i]=p%l,p=0|p/l;for(;0<p;)n.push(p%l),p=0|p/l}var u="";for(t=0;0===d.at(t)&&t<d.length()-1;++t)u+=a;for(t=n.length-1;0<=t;--t)u+=e[n[t]];return u}var e={};t.exports=e;var g={};e.encode=function(r,e,t){if("string"!=typeof e)throw new TypeError("\"alphabet\" must be a string.");if(void 0!==t&&"number"!=typeof t)throw new TypeError("\"maxline\" must be a number.");var a="";if(r instanceof Uint8Array){var g=0,y=e.length,s=e.charAt(0),o=[0];for(g=0;g<r.length;++g){for(var c=0,h=r[g];c<o.length;++c)h+=o[c]<<8,o[c]=h%y,h=0|h/y;for(;0<h;)o.push(h%y),h=0|h/y}for(g=0;0===r[g]&&g<r.length-1;++g)a+=s;for(g=o.length-1;0<=g;--g)a+=e[o[g]]}else a=d(r,e);if(t){var f=new RegExp(".{1,"+t+"}","g");a=a.match(f).join("\r\n")}return a},e.decode=function(n,d){if("string"!=typeof n)throw new TypeError("\"input\" must be a string.");if("string"!=typeof d)throw new TypeError("\"alphabet\" must be a string.");var t=g[d];if(!t){t=g[d]=[];for(var y=0;y<d.length;++y)t[d.charCodeAt(y)]=y}n=n.replace(/\s/g,"");for(var h,f=d.length,i=d.charAt(0),s=[0],y=0;y<n.length;y++){if(h=t[n.charCodeAt(y)],void 0===h)return;for(var o=0,m=h;o<s.length;++o)m+=s[o]*f,s[o]=255&m,m>>=8;for(;0<m;)s.push(255&m),m>>=8}for(var C=0;n[C]===i&&C<n.length-1;++C)s.push(0);return"undefined"==typeof Buffer?new Uint8Array(s.reverse()):Buffer.from(s.reverse())}},function(d,e,t){function r(s,e,t){var r=e.entity===c.tls.ConnectionEnd.client;s.read.cipherState={init:!1,cipher:c.cipher.createDecipher("AES-CBC",r?t.keys.server_write_key:t.keys.client_write_key),iv:r?t.keys.server_write_IV:t.keys.client_write_IV},s.write.cipherState={init:!1,cipher:c.cipher.createCipher("AES-CBC",r?t.keys.client_write_key:t.keys.server_write_key),iv:r?t.keys.client_write_IV:t.keys.server_write_IV},s.read.cipherFunction=n,s.write.cipherFunction=p,s.read.macLength=s.write.macLength=t.mac_length,s.read.macFunction=s.write.macFunction=u.hmac_sha1}function p(i,e){var t=!1,o=e.macFunction(e.macKey,e.sequenceNumber,i);i.fragment.putBytes(o),e.updateSequenceNumber();var a;a=i.version.minor===u.Versions.TLS_1_0.minor?e.cipherState.init?null:e.cipherState.iv:c.random.getBytesSync(16),e.cipherState.init=!0;var d=e.cipherState.cipher;return d.start({iv:a}),i.version.minor>=u.Versions.TLS_1_1.minor&&d.output.putBytes(a),d.update(i.fragment),d.finish(g)&&(i.fragment=d.output,i.length=i.fragment.length(),t=!0),t}function g(n,e,t){if(!t){var r=n-e.length()%n;e.fillWithByte(r-1,r)}return!0}function y(o,e,t){var r=!0;if(t){for(var c=e.length(),n=e.last(),i=c-1-n;i<c-1;++i)r=r&&e.at(i)==n;r&&e.truncate(n+1)}return r}function n(d,e){var t,l=!1;t=d.version.minor===u.Versions.TLS_1_0.minor?e.cipherState.init?null:e.cipherState.iv:d.fragment.getBytes(16),e.cipherState.init=!0;var g=e.cipherState.cipher;g.start({iv:t}),g.update(d.fragment),l=g.finish(y);var n=e.macLength,i=c.random.getBytesSync(n),h=g.output.length();h>=n?(d.fragment=g.output.getBytes(h-n),i=g.output.getBytes(n)):d.fragment=g.output.getBytes(),d.fragment=c.util.createBuffer(d.fragment),d.length=d.fragment.length();var p=e.macFunction(e.macKey,e.sequenceNumber,d);return e.updateSequenceNumber(),l=s(e.macKey,i,p)&&l}function s(n,e,s){var i=c.hmac.create();return i.start("SHA1",n),i.update(e),e=i.digest().getBytes(),i.start(null,null),i.update(s),s=i.digest().getBytes(),e===s}var c=t(0);t(5),t(20);var u=d.exports=c.tls;u.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(t){t.bulk_cipher_algorithm=u.BulkCipherAlgorithm.aes,t.cipher_type=u.CipherType.block,t.enc_key_length=16,t.block_length=16,t.fixed_iv_length=16,t.record_iv_length=16,t.mac_algorithm=u.MACAlgorithm.hmac_sha1,t.mac_length=20,t.mac_key_length=20},initConnectionState:r},u.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(t){t.bulk_cipher_algorithm=u.BulkCipherAlgorithm.aes,t.cipher_type=u.CipherType.block,t.enc_key_length=32,t.block_length=16,t.fixed_iv_length=16,t.record_iv_length=16,t.mac_algorithm=u.MACAlgorithm.hmac_sha1,t.mac_length=20,t.mac_key_length=20},initConnectionState:r}},function(n,e,t){var r=t(0);t(30),n.exports=r.mgf=r.mgf||{},r.mgf.mgf1=r.mgf1},function(Y,e,t){function W(s){var e=s.message;if(e instanceof Uint8Array||e instanceof k)return e;var i=s.encoding;if(void 0===e){if(!s.md)throw new TypeError("\"options.message\" or \"options.md\" not specified.");e=s.md.digest().getBytes(),i="binary"}if("string"==typeof e&&!i)throw new TypeError("\"options.encoding\" must be \"binary\" or \"utf8\".");if("string"==typeof e){if("undefined"!=typeof Buffer)return Buffer.from(e,i);e=new _(e,i)}else if(!(e instanceof _))throw new TypeError("\"options.message\" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with \"options.encoding\" specifying its encoding.");for(var o=new k(e.length()),a=0;a<o.length;++a)o[a]=e.at(a);return o}function X(o,e){var t=v.md.sha512.create(),r=new _(o);t.update(r.getBytes(e),"binary");var a=t.digest().getBytes();if("undefined"!=typeof Buffer)return Buffer.from(a,"binary");for(var n=new k(U.constants.HASH_BYTE_LENGTH),i=0;64>i;++i)n[i]=a.charCodeAt(i);return n}function a(n,e){var t,s=[T(),T(),T(),T()],a=X(e,32);for(a[0]&=248,a[31]&=127,a[31]|=64,m(s,a),te(n,s),t=0;32>t;++t)e[t+32]=n[t];return 0}function J(c,e,t,r){var a,u,g=new Float64Array(64),o=[T(),T(),T(),T()],l=X(r,32);l[0]&=248,l[31]&=127,l[31]|=64;for(a=0;a<t;++a)c[64+a]=e[a];for(a=0;32>a;++a)c[32+a]=l[32+a];var p=X(c.subarray(32),t+32);for(ee(p),m(o,p),te(c,o),a=32;64>a;++a)c[a]=r[a];var d=X(c,t+64);for(ee(d),a=32;64>a;++a)g[a]=0;for(a=0;32>a;++a)g[a]=p[a];for(a=0;32>a;++a)for(u=0;32>u;u++)g[a+u]+=d[a]*l[u];return n(c.subarray(32),g),t+64}function $(n,e,t,d){var a,g=new k(32),s=[T(),T(),T(),T()],o=[T(),T(),T(),T()];if(-1,64>t)return-1;if(l(o,d))return-1;for(a=0;a<t;++a)n[a]=e[a];for(a=0;32>a;++a)n[a+32]=d[a];var c=X(n,t);if(ee(c),f(s,o,c),m(o,e.subarray(32)),u(s,o),te(g,s),t-=64,y(e,0,g,0)){for(a=0;a<t;++a)n[a]=0;return-1}for(a=0;a<t;++a)n[a]=e[a+64];return t}function n(s,e){var t,o,c,d;for(o=63;32<=o;--o){for(t=0,c=o-32,d=o-12;c<d;++c)e[c]+=t-16*e[o]*w[c-(o-32)],t=e[c]+128>>8,e[c]-=256*t;e[c]+=t,e[o]=0}for(t=0,c=0;32>c;++c)e[c]+=t-(e[31]>>4)*w[c],t=e[c]>>8,e[c]&=255;for(c=0;32>c;++c)e[c]-=t*w[c];for(o=0;32>o;++o)e[o+1]+=e[o]>>8,s[o]=255&e[o]}function ee(a){for(var e=new Float64Array(64),t=0;64>t;++t)e[t]=a[t],a[t]=0;n(a,e)}function u(d,e){var t=T(),r=T(),a=T(),n=T(),i=T(),s=T(),o=T(),c=T(),p=T();B(t,d[1],d[0]),B(p,e[1],e[0]),b(t,t,p),I(r,d[0],d[1]),I(p,e[0],e[1]),b(r,r,p),b(a,d[3],e[3]),b(a,a,O),b(n,d[2],e[2]),I(n,n,n),B(i,r,t),B(s,n,a),I(o,n,a),I(c,r,t),b(d[0],i,s),b(d[1],c,o),b(d[2],o,s),b(d[3],i,c)}function s(n,e,t){for(var r=0;4>r;++r)S(n[r],e[r],t)}function te(s,e){var t=T(),r=T(),a=T();c(a,e[2]),b(t,e[0],a),b(r,e[1],a),i(s,r),s[31]^=h(t)<<7}function i(o,e){var t,c,d,l=T(),i=T();for(t=0;16>t;++t)i[t]=e[t];for(E(i),E(i),E(i),c=0;2>c;++c){for(l[0]=i[0]-65517,t=1;15>t;++t)l[t]=i[t]-65535-(1&l[t-1]>>16),l[t-1]&=65535;l[15]=i[15]-32767-(1&l[14]>>16),d=1&l[15]>>16,l[14]&=65535,S(i,l,1-d)}for(t=0;16>t;t++)o[2*t]=255&i[t],o[2*t+1]=i[t]>>8}function l(l,e){var t=T(),r=T(),a=T(),n=T(),i=T(),s=T(),o=T();return C(l[2],P),d(l[1],e),A(a,l[1]),b(n,a,V),B(a,a,l[2]),I(n,l[2],n),A(i,n),A(s,i),b(o,s,i),b(t,o,a),b(t,t,n),p(t,t),b(t,t,a),b(t,t,n),b(t,t,n),b(l[0],t,n),A(r,l[0]),b(r,r,n),g(r,a)&&b(l[0],l[0],F),A(r,l[0]),b(r,r,n),g(r,a)?-1:(h(l[0])===e[31]>>7&&B(l[0],D,l[0]),b(l[3],l[0],l[1]),0)}function d(a,e){var t;for(t=0;16>t;++t)a[t]=e[2*t]+(e[2*t+1]<<8);a[15]&=32767}function p(n,e){var t,s=T();for(t=0;16>t;++t)s[t]=e[t];for(t=250;0<=t;--t)A(s,s),1!==t&&b(s,s,e);for(t=0;16>t;++t)n[t]=s[t]}function g(n,e){var t=new k(32),r=new k(32);return i(t,n),i(r,e),y(t,0,r,0)}function y(n,e,t,r){return o(n,e,t,r,32)}function o(o,e,t,r,a){var n,c=0;for(n=0;n<a;++n)c|=o[e+n]^t[r+n];return(1&c-1>>>8)-1}function h(a){var e=new k(32);return i(e,a),1&e[0]}function f(i,e,t){var r,o;for(C(i[0],D),C(i[1],P),C(i[2],P),C(i[3],D),o=255;0<=o;--o)r=1&t[0|o/8]>>(7&o),s(i,e,r),u(e,i),u(i,i),s(i,e,r)}function m(a,e){var t=[T(),T(),T(),T()];C(t[0],K),C(t[1],x),C(t[2],P),b(t[3],K,x),f(a,t,e)}function C(a,e){var t;for(t=0;16>t;t++)a[t]=0|e[t]}function c(n,e){var t,s=T();for(t=0;16>t;++t)s[t]=e[t];for(t=253;0<=t;--t)A(s,s),2!==t&&4!==t&&b(s,s,e);for(t=0;16>t;++t)n[t]=s[t]}function E(n){var e,s,i=1;for(e=0;16>e;++e)s=n[e]+i+65535,i=Math.floor(s/65536),n[e]=s-65536*i;n[0]+=i-1+37*(i-1)}function S(n,e,t){for(var r,s=0;16>s;++s)r=~(t-1)&(n[s]^e[s]),n[s]^=r,e[s]^=r}function T(a){var e,n=new Float64Array(16);if(a)for(e=0;e<a.length;++e)n[e]=a[e];return n}function I(n,e,t){for(var r=0;16>r;++r)n[r]=e[r]+t[r]}function B(n,e,t){for(var r=0;16>r;++r)n[r]=e[r]-t[r]}function A(a,e){b(a,e,e)}function b(J,e,t){var r,$,ee=0,te=0,ae=0,re=0,ne=0,se=0,ie=0,oe=0,ce=0,de=0,le=0,pe=0,ue=0,ge=0,ye=0,he=0,fe=0,me=0,Ce=0,Ee=0,Se=0,Te=0,Ie=0,Be=0,Ae=0,be=0,ve=0,Ne=0,Re=0,Le=0,_e=0,ke=t[0],V=t[1],O=t[2],K=t[3],x=t[4],M=t[5],F=t[6],j=t[7],q=t[8],G=t[9],H=t[10],Q=t[11],z=t[12],Y=t[13],W=t[14],X=t[15];r=e[0],ee+=r*ke,te+=r*V,ae+=r*O,re+=r*K,ne+=r*x,se+=r*M,ie+=r*F,oe+=r*j,ce+=r*q,de+=r*G,le+=r*H,pe+=r*Q,ue+=r*z,ge+=r*Y,ye+=r*W,he+=r*X,r=e[1],te+=r*ke,ae+=r*V,re+=r*O,ne+=r*K,se+=r*x,ie+=r*M,oe+=r*F,ce+=r*j,de+=r*q,le+=r*G,pe+=r*H,ue+=r*Q,ge+=r*z,ye+=r*Y,he+=r*W,fe+=r*X,r=e[2],ae+=r*ke,re+=r*V,ne+=r*O,se+=r*K,ie+=r*x,oe+=r*M,ce+=r*F,de+=r*j,le+=r*q,pe+=r*G,ue+=r*H,ge+=r*Q,ye+=r*z,he+=r*Y,fe+=r*W,me+=r*X,r=e[3],re+=r*ke,ne+=r*V,se+=r*O,ie+=r*K,oe+=r*x,ce+=r*M,de+=r*F,le+=r*j,pe+=r*q,ue+=r*G,ge+=r*H,ye+=r*Q,he+=r*z,fe+=r*Y,me+=r*W,Ce+=r*X,r=e[4],ne+=r*ke,se+=r*V,ie+=r*O,oe+=r*K,ce+=r*x,de+=r*M,le+=r*F,pe+=r*j,ue+=r*q,ge+=r*G,ye+=r*H,he+=r*Q,fe+=r*z,me+=r*Y,Ce+=r*W,Ee+=r*X,r=e[5],se+=r*ke,ie+=r*V,oe+=r*O,ce+=r*K,de+=r*x,le+=r*M,pe+=r*F,ue+=r*j,ge+=r*q,ye+=r*G,he+=r*H,fe+=r*Q,me+=r*z,Ce+=r*Y,Ee+=r*W,Se+=r*X,r=e[6],ie+=r*ke,oe+=r*V,ce+=r*O,de+=r*K,le+=r*x,pe+=r*M,ue+=r*F,ge+=r*j,ye+=r*q,he+=r*G,fe+=r*H,me+=r*Q,Ce+=r*z,Ee+=r*Y,Se+=r*W,Te+=r*X,r=e[7],oe+=r*ke,ce+=r*V,de+=r*O,le+=r*K,pe+=r*x,ue+=r*M,ge+=r*F,ye+=r*j,he+=r*q,fe+=r*G,me+=r*H,Ce+=r*Q,Ee+=r*z,Se+=r*Y,Te+=r*W,Ie+=r*X,r=e[8],ce+=r*ke,de+=r*V,le+=r*O,pe+=r*K,ue+=r*x,ge+=r*M,ye+=r*F,he+=r*j,fe+=r*q,me+=r*G,Ce+=r*H,Ee+=r*Q,Se+=r*z,Te+=r*Y,Ie+=r*W,Be+=r*X,r=e[9],de+=r*ke,le+=r*V,pe+=r*O,ue+=r*K,ge+=r*x,ye+=r*M,he+=r*F,fe+=r*j,me+=r*q,Ce+=r*G,Ee+=r*H,Se+=r*Q,Te+=r*z,Ie+=r*Y,Be+=r*W,Ae+=r*X,r=e[10],le+=r*ke,pe+=r*V,ue+=r*O,ge+=r*K,ye+=r*x,he+=r*M,fe+=r*F,me+=r*j,Ce+=r*q,Ee+=r*G,Se+=r*H,Te+=r*Q,Ie+=r*z,Be+=r*Y,Ae+=r*W,be+=r*X,r=e[11],pe+=r*ke,ue+=r*V,ge+=r*O,ye+=r*K,he+=r*x,fe+=r*M,me+=r*F,Ce+=r*j,Ee+=r*q,Se+=r*G,Te+=r*H,Ie+=r*Q,Be+=r*z,Ae+=r*Y,be+=r*W,ve+=r*X,r=e[12],ue+=r*ke,ge+=r*V,ye+=r*O,he+=r*K,fe+=r*x,me+=r*M,Ce+=r*F,Ee+=r*j,Se+=r*q,Te+=r*G,Ie+=r*H,Be+=r*Q,Ae+=r*z,be+=r*Y,ve+=r*W,Ne+=r*X,r=e[13],ge+=r*ke,ye+=r*V,he+=r*O,fe+=r*K,me+=r*x,Ce+=r*M,Ee+=r*F,Se+=r*j,Te+=r*q,Ie+=r*G,Be+=r*H,Ae+=r*Q,be+=r*z,ve+=r*Y,Ne+=r*W,Re+=r*X,r=e[14],ye+=r*ke,he+=r*V,fe+=r*O,me+=r*K,Ce+=r*x,Ee+=r*M,Se+=r*F,Te+=r*j,Ie+=r*q,Be+=r*G,Ae+=r*H,be+=r*Q,ve+=r*z,Ne+=r*Y,Re+=r*W,Le+=r*X,r=e[15],he+=r*ke,fe+=r*V,me+=r*O,Ce+=r*K,Ee+=r*x,Se+=r*M,Te+=r*F,Ie+=r*j,Be+=r*q,Ae+=r*G,be+=r*H,ve+=r*Q,Ne+=r*z,Re+=r*Y,Le+=r*W,_e+=r*X,ee+=38*fe,te+=38*me,ae+=38*Ce,re+=38*Ee,ne+=38*Se,se+=38*Te,ie+=38*Ie,oe+=38*Be,ce+=38*Ae,de+=38*be,le+=38*ve,pe+=38*Ne,ue+=38*Re,ge+=38*Le,ye+=38*_e,$=1,r=ee+$+65535,$=Math.floor(r/65536),ee=r-65536*$,r=te+$+65535,$=Math.floor(r/65536),te=r-65536*$,r=ae+$+65535,$=Math.floor(r/65536),ae=r-65536*$,r=re+$+65535,$=Math.floor(r/65536),re=r-65536*$,r=ne+$+65535,$=Math.floor(r/65536),ne=r-65536*$,r=se+$+65535,$=Math.floor(r/65536),se=r-65536*$,r=ie+$+65535,$=Math.floor(r/65536),ie=r-65536*$,r=oe+$+65535,$=Math.floor(r/65536),oe=r-65536*$,r=ce+$+65535,$=Math.floor(r/65536),ce=r-65536*$,r=de+$+65535,$=Math.floor(r/65536),de=r-65536*$,r=le+$+65535,$=Math.floor(r/65536),le=r-65536*$,r=pe+$+65535,$=Math.floor(r/65536),pe=r-65536*$,r=ue+$+65535,$=Math.floor(r/65536),ue=r-65536*$,r=ge+$+65535,$=Math.floor(r/65536),ge=r-65536*$,r=ye+$+65535,$=Math.floor(r/65536),ye=r-65536*$,r=he+$+65535,$=Math.floor(r/65536),he=r-65536*$,ee+=$-1+37*($-1),$=1,r=ee+$+65535,$=Math.floor(r/65536),ee=r-65536*$,r=te+$+65535,$=Math.floor(r/65536),te=r-65536*$,r=ae+$+65535,$=Math.floor(r/65536),ae=r-65536*$,r=re+$+65535,$=Math.floor(r/65536),re=r-65536*$,r=ne+$+65535,$=Math.floor(r/65536),ne=r-65536*$,r=se+$+65535,$=Math.floor(r/65536),se=r-65536*$,r=ie+$+65535,$=Math.floor(r/65536),ie=r-65536*$,r=oe+$+65535,$=Math.floor(r/65536),oe=r-65536*$,r=ce+$+65535,$=Math.floor(r/65536),ce=r-65536*$,r=de+$+65535,$=Math.floor(r/65536),de=r-65536*$,r=le+$+65535,$=Math.floor(r/65536),le=r-65536*$,r=pe+$+65535,$=Math.floor(r/65536),pe=r-65536*$,r=ue+$+65535,$=Math.floor(r/65536),ue=r-65536*$,r=ge+$+65535,$=Math.floor(r/65536),ge=r-65536*$,r=ye+$+65535,$=Math.floor(r/65536),ye=r-65536*$,r=he+$+65535,$=Math.floor(r/65536),he=r-65536*$,ee+=$-1+37*($-1),J[0]=ee,J[1]=te,J[2]=ae,J[3]=re,J[4]=ne,J[5]=se,J[6]=ie,J[7]=oe,J[8]=ce,J[9]=de,J[10]=le,J[11]=pe,J[12]=ue,J[13]=ge,J[14]=ye,J[15]=he}var v=t(0);t(12),t(2),t(32),t(1);var r=t(41),N=r.publicKeyValidator,R=r.privateKeyValidator;if(void 0===L)var L=v.jsbn.BigInteger;var _=v.util.ByteBuffer,k="undefined"==typeof Buffer?Uint8Array:Buffer;v.pki=v.pki||{},Y.exports=v.pki.ed25519=v.ed25519=v.ed25519||{};var U=v.ed25519;U.constants={},U.constants.PUBLIC_KEY_BYTE_LENGTH=32,U.constants.PRIVATE_KEY_BYTE_LENGTH=64,U.constants.SEED_BYTE_LENGTH=32,U.constants.SIGN_BYTE_LENGTH=64,U.constants.HASH_BYTE_LENGTH=64,U.generateKeyPair=function(i){i=i||{};var o=i.seed;if(void 0===o)o=v.random.getBytesSync(U.constants.SEED_BYTE_LENGTH);else if("string"==typeof o){if(o.length!==U.constants.SEED_BYTE_LENGTH)throw new TypeError("\"seed\" must be "+U.constants.SEED_BYTE_LENGTH+" bytes in length.");}else if(!(o instanceof Uint8Array))throw new TypeError("\"seed\" must be a node.js Buffer, Uint8Array, or a binary string.");o=W({message:o,encoding:"binary"});for(var c=new k(U.constants.PUBLIC_KEY_BYTE_LENGTH),r=new k(U.constants.PRIVATE_KEY_BYTE_LENGTH),n=0;32>n;++n)r[n]=o[n];return a(c,r),{publicKey:c,privateKey:r}},U.privateKeyFromAsn1=function(a){var e={},t=[];if(!v.asn1.validate(a,R,e,t)){var r=new Error("Invalid Key.");throw r.errors=t,r}var n=v.asn1.derToOid(e.privateKeyOid),i=v.oids.EdDSA25519;if(n!==i)throw new Error("Invalid OID \""+n+"\"; OID must be \""+i+"\".");var s=e.privateKey;return{privateKeyBytes:W({message:v.asn1.fromDer(s).value,encoding:"binary"})}},U.publicKeyFromAsn1=function(a){var e={},t=[];if(!v.asn1.validate(a,N,e,t)){var r=new Error("Invalid Key.");throw r.errors=t,r}var n=v.asn1.derToOid(e.publicKeyOid),i=v.oids.EdDSA25519;if(n!==i)throw new Error("Invalid OID \""+n+"\"; OID must be \""+i+"\".");var s=e.ed25519PublicKey;if(s.length!==U.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return W({message:s,encoding:"binary"})},U.publicKeyFromPrivateKey=function(a){a=a||{};var s=W({message:a.privateKey,encoding:"binary"});if(s.length!==U.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError("\"options.privateKey\" must have a byte length of "+U.constants.PRIVATE_KEY_BYTE_LENGTH);for(var t=new k(U.constants.PUBLIC_KEY_BYTE_LENGTH),r=0;r<t.length;++r)t[r]=s[32+r];return t},U.sign=function(a){a=a||{};var s=W(a),t=W({message:a.privateKey,encoding:"binary"});if(t.length===U.constants.SEED_BYTE_LENGTH)t=U.generateKeyPair({seed:t}).privateKey;else if(t.length!==U.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError("\"options.privateKey\" must have a byte length of "+U.constants.SEED_BYTE_LENGTH+" or "+U.constants.PRIVATE_KEY_BYTE_LENGTH);var c=new k(U.constants.SIGN_BYTE_LENGTH+s.length);J(c,s,s.length,t);for(var n=new k(U.constants.SIGN_BYTE_LENGTH),i=0;i<n.length;++i)n[i]=c[i];return n},U.verify=function(a){a=a||{};var o=W(a);if(void 0===a.signature)throw new TypeError("\"options.signature\" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.");var t=W({message:a.signature,encoding:"binary"});if(t.length!==U.constants.SIGN_BYTE_LENGTH)throw new TypeError("\"options.signature\" must have a byte length of "+U.constants.SIGN_BYTE_LENGTH);var r=W({message:a.publicKey,encoding:"binary"});if(r.length!==U.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError("\"options.publicKey\" must have a byte length of "+U.constants.PUBLIC_KEY_BYTE_LENGTH);var n,d=new k(U.constants.SIGN_BYTE_LENGTH+o.length),s=new k(U.constants.SIGN_BYTE_LENGTH+o.length);for(n=0;n<U.constants.SIGN_BYTE_LENGTH;++n)d[n]=t[n];for(n=0;n<o.length;++n)d[n+U.constants.SIGN_BYTE_LENGTH]=o[n];return 0<=$(s,d,d.length,r)};var D=T(),P=T([1]),V=T([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),O=T([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),K=T([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),x=T([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),w=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),F=T([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139])},function(s,e,t){var r=t(0);t(3);var a=r.asn1;e.privateKeyValidator={name:"PrivateKeyInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},e.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:a.Class.UNIVERSAL,type:a.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]}},function(s,e,t){function r(n,i,t,r){n.generate=function(a,e){for(var n=new d.util.ByteBuffer,s=Math.ceil(e/r)+t,o=new d.util.ByteBuffer,c=t;c<s;++c){o.putInt32(c),i.start(),i.update(a+o.getBytes());var p=i.digest();n.putBytes(p.getBytes(r))}return n.truncate(n.length()-e),n.getBytes()}}var d=t(0);t(1),t(2),t(12),s.exports=d.kem=d.kem||{};var a=d.jsbn.BigInteger;d.kem.rsa={},d.kem.rsa.create=function(i,e){e=e||{};var n=e.prng||d.random,r={};return r.encrypt=function(e,t){var r,l=Math.ceil(e.n.bitLength()/8);do r=new a(d.util.bytesToHex(n.getBytesSync(l)),16).mod(e.n);while(0>=r.compareTo(a.ONE));r=d.util.hexToBytes(r.toString(16));var o=l-r.length;return 0<o&&(r=d.util.fillString(String.fromCharCode(0),o)+r),{encapsulation:e.encrypt(r,"NONE"),key:i.generate(r,t)}},r.decrypt=function(e,t,r){var a=e.decrypt(t,"NONE");return i.generate(a,r)},r},d.kem.kdf1=function(a,e){r(this,a,0,e||a.digestLength)},d.kem.kdf2=function(a,e){r(this,a,1,e||a.digestLength)}},function(a,e,t){a.exports=t(4),t(14),t(9),t(23),t(32)},function(g,e,t){function m(n){var e={},t=[];if(!u.validate(n,d.asn1.recipientInfoValidator,e,t)){var r=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw r.errors=t,r}return{version:e.version.charCodeAt(0),issuer:E.pki.RDNAttributesAsArray(e.issuer),serialNumber:E.util.createBuffer(e.serial).toHex(),encryptedContent:{algorithm:u.derToOid(e.encAlgorithm),parameter:e.encParameter.value,content:e.encKey}}}function a(t){return u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,u.integerToDer(t.version).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[E.pki.distinguishedNameToAsn1({attributes:t.issuer}),u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,E.util.hexToBytes(t.serialNumber))]),u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.OID,!1,u.oidToDer(t.encryptedContent.algorithm).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.NULL,!1,"")]),u.create(u.Class.UNIVERSAL,u.Type.OCTETSTRING,!1,t.encryptedContent.content)])}function n(a){for(var e=[],t=0;t<a.length;++t)e.push(m(a[t]));return e}function r(n){for(var e=[],t=0;t<n.length;++t)e.push(a(n[t]));return e}function s(s){var e=u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,u.integerToDer(s.version).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[E.pki.distinguishedNameToAsn1({attributes:s.issuer}),u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,E.util.hexToBytes(s.serialNumber))]),u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.OID,!1,u.oidToDer(s.digestAlgorithm).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.NULL,!1,"")])]);if(s.authenticatedAttributesAsn1&&e.value.push(s.authenticatedAttributesAsn1),e.value.push(u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.OID,!1,u.oidToDer(s.signatureAlgorithm).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.NULL,!1,"")])),e.value.push(u.create(u.Class.UNIVERSAL,u.Type.OCTETSTRING,!1,s.signature)),0<s.unauthenticatedAttributes.length){for(var t,o=u.create(u.Class.CONTEXT_SPECIFIC,1,!0,[]),r=0;r<s.unauthenticatedAttributes.length;++r)t=s.unauthenticatedAttributes[r],o.values.push(i(t));e.value.push(o)}return e}function C(a){for(var e=[],t=0;t<a.length;++t)e.push(s(a[t]));return e}function i(s){var e;if(s.type===E.pki.oids.contentType)e=u.create(u.Class.UNIVERSAL,u.Type.OID,!1,u.oidToDer(s.value).getBytes());else if(s.type===E.pki.oids.messageDigest)e=u.create(u.Class.UNIVERSAL,u.Type.OCTETSTRING,!1,s.value.bytes());else if(s.type===E.pki.oids.signingTime){var o=new Date("1950-01-01T00:00:00Z"),r=new Date("2050-01-01T00:00:00Z"),a=s.value;if("string"==typeof a){var c=Date.parse(a);a=isNaN(c)?13===a.length?u.utcTimeToDate(a):u.generalizedTimeToDate(a):new Date(c)}e=a>=o&&a<r?u.create(u.Class.UNIVERSAL,u.Type.UTCTIME,!1,u.dateToUtcTime(a)):u.create(u.Class.UNIVERSAL,u.Type.GENERALIZEDTIME,!1,u.dateToGeneralizedTime(a))}return u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.OID,!1,u.oidToDer(s.type).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.SET,!0,[e])])}function o(t){return[u.create(u.Class.UNIVERSAL,u.Type.OID,!1,u.oidToDer(E.pki.oids.data).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.OID,!1,u.oidToDer(t.algorithm).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.OCTETSTRING,!1,t.parameter.getBytes())]),u.create(u.Class.CONTEXT_SPECIFIC,0,!0,[u.create(u.Class.UNIVERSAL,u.Type.OCTETSTRING,!1,t.content.getBytes())])]}function c(n,e,t){var r={};if(!u.validate(e,t,r,[])){var a=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw a.errors=a,a}if(u.derToOid(r.contentType)!==E.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(r.encryptedContent){var i="";if(E.util.isArray(r.encryptedContent))for(var c=0;c<r.encryptedContent.length;++c){if(r.encryptedContent[c].type!==u.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");i+=r.encryptedContent[c].value}else i=r.encryptedContent;n.encryptedContent={algorithm:u.derToOid(r.encAlgorithm),parameter:E.util.createBuffer(r.encParameter.value),content:E.util.createBuffer(i)}}if(r.content){var i="";if(E.util.isArray(r.content))for(var c=0;c<r.content.length;++c){if(r.content[c].type!==u.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");i+=r.content[c].value}else i=r.content;n.content=E.util.createBuffer(i)}return n.version=r.version.charCodeAt(0),n.rawCapture=r,r}function l(a){if(void 0===a.encryptedContent.key)throw new Error("Symmetric key not available.");if(void 0===a.content){var e;switch(a.encryptedContent.algorithm){case E.pki.oids["aes128-CBC"]:case E.pki.oids["aes192-CBC"]:case E.pki.oids["aes256-CBC"]:e=E.aes.createDecryptionCipher(a.encryptedContent.key);break;case E.pki.oids.desCBC:case E.pki.oids["des-EDE3-CBC"]:e=E.des.createDecryptionCipher(a.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+a.encryptedContent.algorithm);}if(e.start(a.encryptedContent.parameter),e.update(a.encryptedContent.content),!e.finish())throw new Error("Symmetric decryption failed.");a.content=e.output}}var E=t(0);t(5),t(3),t(10),t(6),t(7),t(29),t(2),t(1),t(17);var u=E.asn1,d=g.exports=E.pkcs7=E.pkcs7||{};d.messageFromPem=function(n){var e=E.pem.decode(n)[0];if("PKCS7"!==e.type){var t=new Error("Could not convert PKCS#7 message from PEM; PEM header type is not \"PKCS#7\".");throw t.headerType=e.type,t}if(e.procType&&"ENCRYPTED"===e.procType.type)throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var r=u.fromDer(e.body);return d.messageFromAsn1(r)},d.messageToPem=function(a,e){var t={type:"PKCS7",body:u.toDer(a.toAsn1()).getBytes()};return E.pem.encode(t,{maxline:e})},d.messageFromAsn1=function(s){var e={},t=[];if(!u.validate(s,d.asn1.contentInfoValidator,e,t)){var r=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw r.errors=t,r}var a,o=u.derToOid(e.contentType);switch(o){case E.pki.oids.envelopedData:a=d.createEnvelopedData();break;case E.pki.oids.encryptedData:a=d.createEncryptedData();break;case E.pki.oids.signedData:a=d.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+o+" is not (yet) supported.");}return a.fromAsn1(e.content.value[0]),a},d.createSignedData=function(){function s(){for(var r={},e=0;e<g.signers.length;++e){var s=g.signers[e],a=s.digestAlgorithm;a in r||(r[a]=E.md[E.pki.oids[a]].create()),s.md=0===s.authenticatedAttributes.length?r[a]:E.md[E.pki.oids[a]].create()}for(var a in g.digestAlgorithmIdentifiers=[],r)g.digestAlgorithmIdentifiers.push(u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.OID,!1,u.oidToDer(a).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.NULL,!1,"")]));return r}function e(r){var e;if(g.detachedContent?e=g.detachedContent:(e=g.contentInfo.value[1],e=e.value[0]),!e)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var c=u.derToOid(g.contentInfo.value[0].value),a=u.toDer(e);for(var d in a.getByte(),u.getBerValueLength(a),a=a.getBytes(),r)r[d].start().update(a);for(var h,m=new Date,s=0;s<g.signers.length;++s){if(h=g.signers[s],0!==h.authenticatedAttributes.length){h.authenticatedAttributesAsn1=u.create(u.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var S,T=u.create(u.Class.UNIVERSAL,u.Type.SET,!0,[]),p=0;p<h.authenticatedAttributes.length;++p)S=h.authenticatedAttributes[p],S.type===E.pki.oids.messageDigest?S.value=r[h.digestAlgorithm].digest():S.type===E.pki.oids.signingTime&&(S.value||(S.value=m)),T.value.push(i(S)),h.authenticatedAttributesAsn1.value.push(i(S));a=u.toDer(T).getBytes(),h.md.start().update(a)}else if(c!==E.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.");h.signature=h.key.sign(h.md,"RSASSA-PKCS1-V1_5")}g.signerInfos=C(g.signers)}var g=null;return g={type:E.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(r){if(c(g,r,d.asn1.signedDataValidator),g.certificates=[],g.crls=[],g.digestAlgorithmIdentifiers=[],g.contentInfo=null,g.signerInfos=[],g.rawCapture.certificates)for(var e=g.rawCapture.certificates.value,t=0;t<e.length;++t)g.certificates.push(E.pki.certificateFromAsn1(e[t]))},toAsn1:function(){g.contentInfo||g.sign();for(var r=[],e=0;e<g.certificates.length;++e)r.push(E.pki.certificateToAsn1(g.certificates[e]));var s=[],a=u.create(u.Class.CONTEXT_SPECIFIC,0,!0,[u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,u.integerToDer(g.version).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.SET,!0,g.digestAlgorithmIdentifiers),g.contentInfo])]);return 0<r.length&&a.value[0].value.push(u.create(u.Class.CONTEXT_SPECIFIC,0,!0,r)),0<s.length&&a.value[0].value.push(u.create(u.Class.CONTEXT_SPECIFIC,1,!0,s)),a.value[0].value.push(u.create(u.Class.UNIVERSAL,u.Type.SET,!0,g.signerInfos)),u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.OID,!1,u.oidToDer(g.type).getBytes()),a])},addSigner:function(r){var e=r.issuer,d=r.serialNumber;if(r.certificate){var y=r.certificate;"string"==typeof y&&(y=E.pki.certificateFromPem(y)),e=y.issuer.attributes,d=y.serialNumber}var h=r.key;if(!h)throw new Error("Could not add PKCS#7 signer; no private key specified.");"string"==typeof h&&(h=E.pki.privateKeyFromPem(h));var f=r.digestAlgorithm||E.pki.oids.sha1;switch(f){case E.pki.oids.sha1:case E.pki.oids.sha256:case E.pki.oids.sha384:case E.pki.oids.sha512:case E.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+f);}var s=r.authenticatedAttributes||[];if(0<s.length){for(var o,m=!1,C=!1,S=0;S<s.length;++S)if(o=s[S],m||o.type!==E.pki.oids.contentType){if(C||o.type!==E.pki.oids.messageDigest);else if(C=!0,m)break;}else if(m=!0,C)break;if(!m||!C)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}g.signers.push({key:h,version:1,issuer:e,serialNumber:d,digestAlgorithm:f,signatureAlgorithm:E.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:s,unauthenticatedAttributes:[]})},sign:function(t){if(t=t||{},("object"!=typeof g.content||null===g.contentInfo)&&(g.contentInfo=u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.OID,!1,u.oidToDer(E.pki.oids.data).getBytes())]),"content"in g)){var r;g.content instanceof E.util.ByteBuffer?r=g.content.bytes():"string"==typeof g.content&&(r=E.util.encodeUtf8(g.content)),t.detached?g.detachedContent=u.create(u.Class.UNIVERSAL,u.Type.OCTETSTRING,!1,r):g.contentInfo.value.push(u.create(u.Class.CONTEXT_SPECIFIC,0,!0,[u.create(u.Class.UNIVERSAL,u.Type.OCTETSTRING,!1,r)]))}0!==g.signers.length&&e(s())},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(t){"string"==typeof t&&(t=E.pki.certificateFromPem(t)),g.certificates.push(t)},addCertificateRevokationList:function(){throw new Error("PKCS#7 CRL support not yet implemented.")}}},d.createEncryptedData=function(){var a=null;return a={type:E.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:E.pki.oids["aes256-CBC"]},fromAsn1:function(e){c(a,e,d.asn1.encryptedDataValidator)},decrypt:function(e){void 0!==e&&(a.encryptedContent.key=e),l(a)}}},d.createEnvelopedData=function(){var p=null;return p={type:E.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:E.pki.oids["aes256-CBC"]},fromAsn1:function(e){var t=c(p,e,d.asn1.envelopedDataValidator);p.recipients=n(t.recipientInfos.value)},toAsn1:function(){return u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.OID,!1,u.oidToDer(p.type).getBytes()),u.create(u.Class.CONTEXT_SPECIFIC,0,!0,[u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,[u.create(u.Class.UNIVERSAL,u.Type.INTEGER,!1,u.integerToDer(p.version).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.SET,!0,r(p.recipients)),u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,!0,o(p.encryptedContent))])])])},findRecipient:function(e){for(var t=e.issuer.attributes,r=0;r<p.recipients.length;++r){var c=p.recipients[r],n=c.issuer;if(c.serialNumber===e.serialNumber&&n.length===t.length){for(var i=!0,d=0;d<t.length;++d)if(n[d].type!==t[d].type||n[d].value!==t[d].value){i=!1;break}if(i)return c}}return null},decrypt:function(e,t){if(void 0===p.encryptedContent.key&&void 0!==e&&void 0!==t)switch(e.encryptedContent.algorithm){case E.pki.oids.rsaEncryption:case E.pki.oids.desCBC:var r=t.decrypt(e.encryptedContent.content);p.encryptedContent.key=E.util.createBuffer(r);break;default:throw new Error("Unsupported asymmetric cipher, OID "+e.encryptedContent.algorithm);}l(p)},addRecipient:function(e){p.recipients.push({version:0,issuer:e.issuer.attributes,serialNumber:e.serialNumber,encryptedContent:{algorithm:E.pki.oids.rsaEncryption,key:e.publicKey}})},encrypt:function(e,d){if(void 0===p.encryptedContent.content){d=d||p.encryptedContent.algorithm,e=e||p.encryptedContent.key;var l,u,g;switch(d){case E.pki.oids["aes128-CBC"]:l=16,u=16,g=E.aes.createEncryptionCipher;break;case E.pki.oids["aes192-CBC"]:l=24,u=16,g=E.aes.createEncryptionCipher;break;case E.pki.oids["aes256-CBC"]:l=32,u=16,g=E.aes.createEncryptionCipher;break;case E.pki.oids["des-EDE3-CBC"]:l=24,u=8,g=E.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+d);}if(void 0===e)e=E.util.createBuffer(E.random.getBytes(l));else if(e.length()!=l)throw new Error("Symmetric key has wrong length; got "+e.length()+" bytes, expected "+l+".");p.encryptedContent.algorithm=d,p.encryptedContent.key=e,p.encryptedContent.parameter=E.util.createBuffer(E.random.getBytes(u));var y=g(e);if(y.start(p.encryptedContent.parameter.copy()),y.update(p.content),!y.finish())throw new Error("Symmetric encryption failed.");p.encryptedContent.content=y.output}for(var s,h=0;h<p.recipients.length;++h)if(s=p.recipients[h],void 0===s.encryptedContent.content)switch(s.encryptedContent.algorithm){case E.pki.oids.rsaEncryption:s.encryptedContent.content=s.encryptedContent.key.encrypt(p.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+s.encryptedContent.algorithm);}}}}},function(c,e,t){function T(n,e){var t=e.toString(16);"8"<=t[0]&&(t="00"+t);var s=I.util.hexToBytes(t);n.putInt32(s.length),n.putBytes(s)}function a(a,e){a.putInt32(e.length),a.putString(e)}function n(){for(var a=I.md.sha1.create(),e=arguments.length,t=0;t<e;++t)a.update(arguments[t]);return a.digest()}var I=t(0);t(5),t(8),t(14),t(9),t(1);var r=c.exports=I.ssh=I.ssh||{};r.privateKeyToPutty=function(s,e,i){i=i||"",e=e||"";var B=""===e?"none":"aes256-cbc",o="PuTTY-User-Key-File-2: ssh-rsa\r\n";o+="Encryption: "+B+"\r\n",o+="Comment: "+i+"\r\n";var A=I.util.createBuffer();a(A,"ssh-rsa"),T(A,s.e),T(A,s.n);var u=I.util.encode64(A.bytes(),64),l=Math.floor(u.length/66)+1;o+="Public-Lines: "+l+"\r\n",o+=u;var b=I.util.createBuffer();T(b,s.d),T(b,s.p),T(b,s.q),T(b,s.qInv);var f;if(e){var N=b.length()+16-1;N-=N%16;var R=n(b.bytes());R.truncate(R.length()-N+b.length()),b.putBuffer(R);var y=I.util.createBuffer();y.putBuffer(n("\0\0\0\0",e)),y.putBuffer(n("\0\0\0\x01",e));var g=I.aes.createEncryptionCipher(y.truncate(8),"CBC");g.start(I.util.createBuffer().fillWithByte(0,16)),g.update(b.copy()),g.finish();var v=g.output;v.truncate(16),f=I.util.encode64(v.bytes(),64)}else f=I.util.encode64(b.bytes(),64);l=Math.floor(f.length/66)+1,o+="\r\nPrivate-Lines: "+l+"\r\n",o+=f;var m=n("putty-private-key-file-mac-key",e),C=I.util.createBuffer();a(C,"ssh-rsa"),a(C,B),a(C,i),C.putInt32(A.length()),C.putBuffer(A),C.putInt32(b.length()),C.putBuffer(b);var E=I.hmac.create();return E.start("sha1",m),E.update(C.bytes()),o+="\r\nPrivate-MAC: "+E.digest().toHex()+"\r\n"},r.publicKeyToOpenSSH=function(n,e){e=e||"";var s=I.util.createBuffer();return a(s,"ssh-rsa"),T(s,n.e),T(s,n.n),"ssh-rsa "+I.util.encode64(s.bytes())+" "+e},r.privateKeyToOpenSSH=function(a,e){return e?I.pki.encryptRsaPrivateKey(a,e,{legacy:!0,algorithm:"aes128"}):I.pki.privateKeyToPem(a)},r.getPublicKeyFingerprint=function(n,e){e=e||{};var s=e.md||I.md.md5.create(),r=I.util.createBuffer();a(r,"ssh-rsa"),T(r,n.e),T(r,n.n),s.start(),s.update(r.getBytes());var i=s.digest();if("hex"===e.encoding){var o=i.toHex();return e.delimiter?o.match(/.{2}/g).join(e.delimiter):o}if("binary"===e.encoding)return i.getBytes();if(e.encoding)throw new Error("Unknown encoding \""+e.encoding+"\".");return i}},function(n,e,t){var c=t(0);t(31),t(33),t(1);var a={},r=0;c.debug.set("forge.task","tasks",a);var i={};c.debug.set("forge.task","queues",i);var o={};o.ready={},o.ready.stop="ready",o.ready.start="running",o.ready.cancel="done",o.ready.fail="error",o.running={},o.running.stop="ready",o.running.start="running",o.running.block="blocked",o.running.unblock="running",o.running.sleep="sleeping",o.running.wakeup="running",o.running.cancel="done",o.running.fail="error",o.blocked={},o.blocked.stop="blocked",o.blocked.start="blocked",o.blocked.block="blocked",o.blocked.unblock="blocked",o.blocked.sleep="blocked",o.blocked.wakeup="blocked",o.blocked.cancel="done",o.blocked.fail="error",o.sleeping={},o.sleeping.stop="sleeping",o.sleeping.start="sleeping",o.sleeping.block="sleeping",o.sleeping.unblock="sleeping",o.sleeping.sleep="sleeping",o.sleeping.wakeup="sleeping",o.sleeping.cancel="done",o.sleeping.fail="error",o.done={},o.done.stop="done",o.done.start="done",o.done.block="done",o.done.unblock="done",o.done.sleep="done",o.done.wakeup="done",o.done.cancel="done",o.done.fail="error",o.error={},o.error.stop="error",o.error.start="error",o.error.block="error",o.error.unblock="error",o.error.sleep="error",o.error.wakeup="error",o.error.cancel="error",o.error.fail="error";var d=function(t){this.id=-1,this.name=t.name||"?",this.parent=t.parent||null,this.run=t.run,this.subtasks=[],this.error=!1,this.state="ready",this.blocks=0,this.timeoutId=null,this.swapTime=null,this.userData=null,this.id=r++,a[this.id]=this};d.prototype.debug=function(t){t=t||"",c.log.debug("forge.task",t,"[%s][%s] task:",this.id,this.name,this,"subtasks:",this.subtasks.length,"queue:",i)},d.prototype.next=function(a,n){"function"==typeof a&&(n=a,a=this.name);var s=new d({run:n,name:a,parent:this});return s.state="running",s.type=this.type,s.successCallback=this.successCallback||null,s.failureCallback=this.failureCallback||null,this.subtasks.push(s),this},d.prototype.parallel=function(a,d){return c.util.isArray(a)&&(d=a,a=this.name),this.next(a,function(e){var t=e;t.block(d.length);for(var r=0;r<d.length;r++){var n=a+"__parallel-"+e.id+"-"+r,s=r;!function(a,n){c.task.start({type:a,run:function(t){d[n](t)},success:function(){t.unblock()},failure:function(){t.unblock()}})}(n,s)}})},d.prototype.stop=function(){this.state=o[this.state].stop},d.prototype.start=function(){this.error=!1,this.state=o[this.state].start,this.state==="running"&&(this.start=new Date,this.run(this),p(this,0))},d.prototype.block=function(t){t=void 0===t?1:t,this.blocks+=t,0<this.blocks&&(this.state=o[this.state].block)},d.prototype.unblock=function(t){return t=void 0===t?1:t,this.blocks-=t,0===this.blocks&&this.state!=="done"&&(this.state="running",p(this,0)),this.blocks},d.prototype.sleep=function(a){a=void 0===a?0:a,this.state=o[this.state].sleep;var r=this;this.timeoutId=setTimeout(function(){r.timeoutId=null,r.state="running",p(r,0)},a)},d.prototype.wait=function(t){t.wait(this)},d.prototype.wakeup=function(){this.state==="sleeping"&&(cancelTimeout(this.timeoutId),this.timeoutId=null,this.state="running",p(this,0))},d.prototype.cancel=function(){this.state=o[this.state].cancel,this.permitsNeeded=0,null!==this.timeoutId&&(cancelTimeout(this.timeoutId),this.timeoutId=null),this.subtasks=[]},d.prototype.fail=function(a){if(this.error=!0,u(this,!0),a)a.error=this.error,a.swapTime=this.swapTime,a.userData=this.userData,p(a,0);else{if(null!==this.parent){for(var e=this.parent;null!==e.parent;)e.error=this.error,e.swapTime=this.swapTime,e.userData=this.userData,e=e.parent;u(e,!0)}this.failureCallback&&this.failureCallback(this)}};var l=function(t){t.error=!1,t.state=o[t.state].start,setTimeout(function(){t.state==="running"&&(t.swapTime=+new Date,t.run(t),p(t,0))},0)},p=function(n,e){var s=30<e||20<+new Date-n.swapTime,t=function(e){if(e++,n.state==="running")if(s&&(n.swapTime=+new Date),0<n.subtasks.length){var r=n.subtasks.shift();r.error=n.error,r.swapTime=n.swapTime,r.userData=n.userData,r.run(r),r.error||p(r,e)}else u(n),n.error||null!==n.parent&&(n.parent.error=n.error,n.parent.swapTime=n.swapTime,n.parent.userData=n.userData,p(n.parent,e))};s?setTimeout(t,0):t(e)},u=function(r,e){r.state="done",delete a[r.id],null===r.parent&&(r.type in i?0===i[r.type].length?c.log.error("forge.task","[%s][%s] task queue empty [%s]",r.id,r.name,r.type):i[r.type][0]===r?(i[r.type].shift(),0===i[r.type].length?delete i[r.type]:i[r.type][0].start()):c.log.error("forge.task","[%s][%s] task not first in queue [%s]",r.id,r.name,r.type):c.log.error("forge.task","[%s][%s] task queue missing [%s]",r.id,r.name,r.type),e||(r.error&&r.failureCallback?r.failureCallback(r):!r.error&&r.successCallback&&r.successCallback(r)))};n.exports=c.task=c.task||{},c.task.start=function(a){var e=new d({run:a.run,name:a.name||"?"});e.type=a.type,e.successCallback=a.success||null,e.failureCallback=a.failure||null,e.type in i?i[a.type].push(e):(i[e.type]=[e],l(e))},c.task.cancel=function(t){t in i&&(i[t]=[i[t][0]])},c.task.createCondition=function(){var a={tasks:{}};return a.wait=function(e){e.id in a.tasks||(e.block(),a.tasks[e.id]=e)},a.notify=function(){var e=a.tasks;for(var t in a.tasks={},e)e[t].unblock()},a}}])});
