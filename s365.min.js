//v1.2.1
const $s365=function(){function g(a,e){return fetch(a,e).then(a=>a.text().then(e=>a.ok?e:Promise.reject("fetch error ("+a.status+")")))}function u(e,t){return g(e,t).then(t=>new DOMParser().parseFromString(t,"text/html"))}function t(r,o,e){const t=function(r){let e=[];for(let t=0;t<r.length-1;t+=2)e.push(parseInt(r.substr(t,2),16));return String.fromCharCode.apply(String,e)},a=new forge.util.ByteBuffer(t(e?function(t){let e="";for(let a=0,r=t.length;a<r;a++)z=o.xset.indexOf(t[a]),e+=-1===z?t[a]:o.hset[z];return e}(r):r),"raw");let n=forge.cipher.createDecipher(o.cipher,o.k);return n.start({iv:o.iv}),n.update(a),n.finish(),t(n.output.data.trim())}const c=["monchengladbach",null,"dortmund","bayern","fortuna","schalke","fckoln","paderborn","leverkusen","leipzig","frankfurt","freiburg","bremen","hertha","union","hoffenheim","wolfsburg","mainz","augsburg",null,null,"hamburg","stuttgart","stpauli","hannover","bochum","bielefeld","nurnberg","karlsruhe","erzgebirge","darmstadt","dresden","greuther","heidenheim","holstein","osnabruck","regensburg","sandhausen","wiesbaden",null,null,null,null,null,"liverpool","barcelona","saintgermain","realmadrid","manchestercity","juventus"],a=function(){let l=null,c=null;return{get:function(e){const a=c=Date.now();return new Promise(function(h,i){!0!==e&&null!==l?h(l):(console.log("Laden","http://www.sport365.live/de/home"),u("http://www.sport365.live/de/home").then(e=>{if(a===c){const r=[].map.call(e.querySelectorAll("script[src]"),t=>t.src).filter(t=>/sport365\.cloud\/js\/[a-f0-9]{32}\.js/.test(t)),o=e.querySelector("#captcha img");if(o&&30<o.src.length){let f={};const t=function(r){const a=((r.match(/}\(_0x[a-z0-9]+,\s*(0x[a-f0-9]+)\)\);/)||[])[1]||"x")-0;if(!isNaN(a)){const t=r.match(/var\s+_0x[a-z0-9]+\s*=\s*\[\s*["']([^\]]+)["']/);if(t){const n=t[1].split(/['",\s]+/),e=n.length;if(1<e)return function(t,r){const i=r.length;let o=[...Array(256).keys()],c="",d=n[(t+a)%e];try{d=atob(d);for(var y=0,t=d.length;y<t;y++)c+="%"+("00"+d.charCodeAt(y).toString(16)).slice(-2);d=decodeURIComponent(c);for(var m,y=0,C=0;256>y;y++)C=(C+o[y]+r.charCodeAt(y%i))%256,m=o[y],o[y]=o[C],o[C]=m;c="";for(var m,C=0,y=0,E=0,t=d.length;y<t;y++)C=(C+1)%256,E=(E+o[C])%256,m=o[C],o[C]=o[E],o[E]=m,c+=String.fromCharCode(d.charCodeAt(y)^o[(o[C]+o[E])%256])}catch(e){c=null}return c}}}return null};(function m(p){-1===p?i("Key nicht gefunden! [E13]"):(console.log("Laden",r[p]),g(r[p]).then(d=>{if(a!==c)i(null);else if(-1!==d.indexOf("'iv'")){const a=function(){let e,i=-1;for(;null!==(e=/function\s+[a-z0-9]{43}\(_0x[a-f0-9]+\)\s*\{(?=.+'iv')/g.exec(d));)i=e.index+e[0].length;if(-1!==i)for(let e,t=i,a=0,r=!1;e=d[t];t++)if(r)"'"===e&&(r=!1);else if("{"===e)a++;else if("}"===e){if(0===a)return d.substring(i,t);a--}else"'"===e&&(r=!0);return null}();if(a){const c=(a.match(/'iv'\s*(:|\]\s*=)\s*(_0x[a-f0-9]+)/)||[])[2]||null;if(c){const r=t(d);if(r){const t=function(){let n,s=[];for(;null!==(n=/=\s*_0x[a-z0-9]+\(\s*["'](0x[a-f0-9]+)["']\s*,\s*["'](.{4})["']\s*\)/g.exec(a));)s.push(r(n[1]-0,n[2]));return s}(),u=t.find(t=>/^(A|3?D)ES-/.test(t));if(u){const n=(t.find(t=>/^(\d+\|)+\d+$/.test(t))||"").split("|").map(t=>parseInt(t));if(!isNaN(n[0])){const d=a.split("case").slice(1);if(d.length===n.length){let C=[];if(n.forEach(e=>{const t=d[e];let a=t.match(/(_0x[a-f0-9]+)\s*=.+?(\s*0x[a-f0-9]+)\s*,\s*(0x[a-f0-9]+)\s*,\s*0x1\s*,\s*0x1\s*\).+?\[0x(1|2)\]/);a&&C.push([c===a[1],a[2]-0,a[3]-0,a[4]-0])}),0<C.length){let a,e="",r="",n=document.createElement("canvas"),t=n.getContext("2d"),s=new Image;s.onload=function(){try{n.width=this.naturalWidth,n.height=this.naturalHeight,t.drawImage(s,0,0),a=t.getImageData(0,0,n.width,n.height).data,C.forEach(s=>{s[0]?r+=String.fromCharCode(a[4*(n.width*s[2]+s[1])+s[3]]):e+=String.fromCharCode(a[4*(n.width*s[2]+s[1])+s[3]])})}catch(a){e="",r=""}""===e?i("Key nicht gefunden! [E22]"):(console.log("K",e,"iv",r,"cipher",u),Object.assign(f,{k:e,iv:r,cipher:u}),f.xset?h(l=f):m(--p))},s.src=o.src}else i("Key nicht gefunden! [E21]")}else i("Key nicht gefunden! [E20]")}else i("Key nicht gefunden! [E19]")}else i("Key nicht gefunden! [E18]")}else i("Key nicht gefunden! [E17]")}else i("Key nicht gefunden! [E16]")}else i("Key nicht gefunden! [E15]")}else if(-1!==d.indexOf("xset=")&&-1!==d.indexOf("hset=")){let e=d.match(/xset=[^;]+\('(.+?)','(.+?)'\)\);/),a=d.match(/hset=[^;]+\('(.+?)','(.+?)'\)\);/);if(e&&a){const r=t(d);e=r(e[1]-0,e[2]),a=r(a[1]-0,a[2]),"string"==typeof e&&0<e.length&&"string"==typeof a&&0<a.length?(console.log("hset",a,"xset",e),Object.assign(f,{hset:Array.from(a),xset:Array.from(e)}),f.h?h(l=f):m(--p)):i("Key nicht gefunden! [E001]")}else i("Key nicht gefunden! [E002]")}else m(--p)}).catch(e=>{a===c?(console.warn("[208]",e),m(--p)):i(null)}))})(r.length-1)}else i("Key nicht gefunden! [E14]")}else i(null)}).catch(e=>{console.warn("[209]",e),i(a===c?"Fehler beim Laden des Schl\xFCssels [209]":null)}))})},clear:()=>l=null}}(),e=function(){let r=null;return function(n,m,e,s){const y=r=Date.now(),o=function(e,s){a.get().then(i=>{if(y===r){const o="http://www.sport365.live/de/events/-/-/"+(n?"10":"-")+"/"+(m?"7":"-")+"/"+-1*new Date().getTimezoneOffset();console.log("Laden",o),u(o).then(o=>{if(y===r){const d=o.querySelectorAll("tr[onclick]"),C=function(r){let t;if(!!n)r.sport="Fu\xDFball",r.cat=5,t=r.sub.match(/([^-]+?)\s?-\s?(.+)/i);else if(t=r.sub.match(/([^\/]+?)\s?\/\s?(.+)/i),t)r.sport=t[1],n=/^(fu(ÃŸ|ss)ball|soccer)$/i.test(r.sport),r.cat=n?5:7,t=t[2].match(/([^-]+?)\s?-\s?(.+)/i);else return r.cat=9,r;if(t&&(r.region=t[1],r.league=t[2],r.nat=/germany|deutschland/i.test(r.region),n))if(t=r.league.toLowerCase(),r.nat){const e=t.indexOf("bundesliga");-1===e?-1!==t.indexOf("dfb pokal")&&(r.cat=2):0===e||-1!==t.indexOf("1.")?r.cat=0:-1!==t.indexOf("2.")&&(r.cat=1)}else-1===t.indexOf("uefa champions league")?-1!==t.indexOf("uefa europa league")&&(r.cat=4):r.cat=3;if(n){const t=r.title.toLowerCase().split(" - "),e=t.length;if(r.home=null,r.away=null,2===e){const e=c.length;for(let a=0,n=t[0].replace(/\s|-/g,"");a<e;a++)if(-1!==n.indexOf(c[a])){r.home=a;break}for(let a=0,n=t[1].replace(/\s|-/g,"");a<e;a++)if(-1!==n.indexOf(c[a])){r.away=a;break}null===r.home?r.home=[19,39,41,50,51,null][r.cat]:null===r.away&&(r.away=[19,39,50,50,51,null][r.cat])}else r.home=1===e&&(-1!==t[0].indexOf("konferenz")||-1!==t[0].indexOf("simulcast"))?[1,20,40,42,43,null][r.cat]:[19,39,41,50,51,null][r.cat]}return r};let u=[];for(let e,g,r,n=0,E=[];e=d[n],g=d[n+1];n+=2){const n=e.getAttribute("onclick").match(/['"][^"']+["']/g);if(r=null,3===n.length)try{r=t(n[1].slice(1,-1),i)}catch(e){return console.log("Fehler Decrypt",e),a.clear(),void s("Fehler bei Entschl\xFCsselung der URLs")}if(r){const t=e.getElementsByTagName("td"),a=t.length,s=3<a?t[3].firstChild.textContent.trim():"";if(""!==s){let e="?",n="?";g=g.getElementsByTagName("tr")[0],g&&(e=(g.children[1]||{}).innerText||"?",n=((g.children[0]||{}).innerText||"?").trim());const i=function(){const r=2<a?t[2].innerText:"";return /^\d\d:\d\d$/.test(r)?r:"??:??"}(),o=function(){const r=1<a?t[1].querySelector("img"):null;return r?r.src.includes("dot-green"):null}(),c=m||/deutsch|german/i.test(e),d=!m&&/englisc?h/i.test(e),l=(i+s+n).replace(/\s/g,""),p=E.indexOf(l);-1===p?(E.push(l),u.push(C({time:i,title:s,sub:n,i:u.length,online:o,de:c,en:d,id:l,langs:[{lang:e,online:o,url:r,de:c,en:d,id:0}]}))):(u[p].online=u[p].online||o,u[p].de=u[p].de||c,u[p].en=u[p].en||d,u[p].langs.push({lang:e,online:o,url:r,de:c,en:d,id:u[p].langs.length}))}}}u.forEach(e=>e.langs.sort((n,e)=>{const t=4*n.online+2*n.de+n.en,a=4*e.online+2*e.de+e.en;return t===a?0:t>a?-1:1})),y===r?(console.log("Gefundene Events",u),e(u)):s(null)}else s(null)}).catch(e=>s(y===r?e:null))}else s(null)}).catch(e=>s(y===r?e:null))};return"function"==typeof e?void o(e,s):new Promise(o)}}(),r=function(){let c=null;return function(r,e,n){const d=c=Date.now();if("undefined"!=typeof r&&null!==r){const s=function(l,s){console.log("Aufrufen [3]",r),a.get().then(a=>{c===d?u(r,{credentials:"include"}).then(r=>{if(c===d){const e=(r.querySelector("#area-middle iframe")||{}).src||null;e?(console.log("Aufrufen [5]",e),u(e).then(r=>{if(c===d){const e=[].map.call(r.querySelectorAll("input[type=\"hidden\"]"),t=>t.name+"="+t.value).join("&"),n=[].filter.call(r.querySelectorAll("script:not([src])"),t=>t.textContent.includes("action")).map(a=>{const e=a.textContent.match(/["']action["']\s*,\s*["']([^"']+)["']/i);return e?e[1]:null}).filter(t=>null!==t)[0]||null;""!==e&&n?(console.log("Aufrufen [6]",n,e),u(n,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e}).then(n=>{if(c===d){console.log(n);debugger;const i=[].filter.call(n.querySelectorAll("script:not([src])"),t=>t.textContent.includes("vjs_options")).map(t=>t.textContent.match(/["']([^"']+)["']/g)).reduce((a,e)=>a.concat(e),[]).sort((a,e)=>a.length<e.length),e=([].filter.call(n.querySelectorAll("script[src]"),t=>t.src.includes("clk.sportstream.live/p"))[0]||{}).src||null;let r=null;for(let n,e=0;n=i[e];e++){try{r=t(n.slice(1,-1),a,!0)}catch(e){r=null}if(null!==r&&/\/(i$|index\.m3u8?)/.test(r))break}console.log("URL",r),r?l({url:r,banner:e}):s("Nichts gefunden [E5]")}else s(null)}).catch(e=>s(c===d?e:null))):s("Nichts gefunden [E7]")}else s(null)}).catch(e=>s(c===d?e:null))):s("Nichts gefunden [E81]")}else s(null)}).catch(e=>s(c===d?e:null)):s(null)}).catch(e=>s(c===d?e:null))};return"function"==typeof e?void s(e,n):new Promise(s)}}}(),n=function(){let o=null,c=0;const d=function(n,s){console.log("Lade adshell (1)",n),g(n).then(r=>{const n=r.match(/url\s*:\s*["']([^"']+)/i);n?(console.log("Lade adshell (2)",n[1]),u(n[1]).then(()=>s(e())).catch(()=>s(t(3)))):s(t(2))}).catch(()=>s(t(1)))},t=function(t){return c++,console.log("Banner-Error: "+t+" ("+c+")"),4<c&&null!==o&&(console.log("==> Remove Adshell"),clearTimeout(o),o=null),t},e=function(){return console.log("Banner OK"),c=0,0};return{remove:function(){null!==o&&(console.log("Remove Adshell"),clearTimeout(o),o=null)},attach:function(a,e){const t=function(e){console.log("Attach Adshell",a),null!==o&&clearTimeout(o),c=0,"string"==typeof a?(o=setInterval(d,9e5,a,()=>{}),d(a,e)):(o=null,e(-1))};return"function"==typeof e?void t(e):new Promise(t)}}}();return{resetKey:a.clear,getEvents:e,getLinks:function(n,e,r){const s=(o,r)=>{a.get().then(e=>{console.log("Aufrufen [2]","http://www.sport365.live"+n),u("http://www.sport365.live"+n).then(n=>{Z=[];for(let s,i,d=0,o=n.querySelectorAll("span#span_link_links");s=o[d];d++){i=s.getAttribute("onclick").match(/['"][^"']+["']/);try{Z.push(t(i[0].slice(1,-1),e,!0))}catch(e){return console.log("Fehler Decrypt",e),a.clear(),void r("Fehler beim Entschl\xFCsseln der URLs")}}console.log("OK",Z),0<Z.length?o(Z):r("Nichts gefunden!")}).catch(e=>r(e))}).catch(e=>r(e))};return"function"==typeof e?void s(e,r):new Promise(s)},getStream:r,adshell:{remove:n.remove,attach:n.attach}}}();!function(t,a){"object"==typeof exports&&"object"==typeof module?module.exports=a():"function"==typeof define&&define.amd?define([],a):"object"==typeof exports?exports.forge=a():t.forge=a()}("undefined"==typeof self?this:self,function(){return function(r){function n(e){if(s[e])return s[e].exports;var t=s[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,n),t.l=!0,t.exports}var s={};return n.m=r,n.c=s,n.d=function(a,t,e){n.o(a,t)||Object.defineProperty(a,t,{configurable:!1,enumerable:!0,get:e})},n.n=function(a){var t=a&&a.__esModule?function(){return a.default}:function(){return a};return n.d(t,"a",t),t},n.o=function(t,a){return Object.prototype.hasOwnProperty.call(t,a)},n.p="",n(n.s=34)}([function(e){e.exports={options:{usePureJavaScript:!1}}},function(f,t,p){(function(u){function m(e){if(8!==e&&16!==e&&24!==e&&32!==e)throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}function C(a){if(this.data="",this.read=0,"string"==typeof a)this.data=a;else if(!(E.isArrayBuffer(a)||E.isArrayBufferView(a)))(a instanceof C||"object"==typeof a&&"string"==typeof a.data&&"number"==typeof a.read)&&(this.data=a.data,this.read=a.read);else if("undefined"!=typeof Buffer&&a instanceof Buffer)this.data=a.toString("binary");else{var r=new Uint8Array(a);try{this.data=String.fromCharCode.apply(null,r)}catch(t){for(var e=0;e<r.length;++e)this.putByte(r[e])}}this._constructedStringLength=0}function e(t,a){a=a||{},this.read=a.readOffset||0,this.growSize=a.growSize||1024;var n=E.isArrayBuffer(t),s=E.isArrayBufferView(t);return n||s?(this.data=n?new DataView(t):new DataView(t.buffer,t.byteOffset,t.byteLength),void(this.write="writeOffset"in a?a.writeOffset:this.data.byteLength)):void(this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!==t&&void 0!==t&&this.putBytes(t),"writeOffset"in a&&(this.write=a.writeOffset))}var t=p(0),a=p(37),E=f.exports=t.util=t.util||{};!function(){function e(t){if(t.source===window&&t.data===a){t.stopPropagation();var r=n.slice();n.length=0,r.forEach(function(e){e()})}}if("undefined"!=typeof process&&process.nextTick&&!process.browser)return E.nextTick=process.nextTick,void("function"==typeof setImmediate?E.setImmediate=setImmediate:E.setImmediate=E.nextTick);if("function"==typeof setImmediate)return E.setImmediate=function(){return setImmediate.apply(void 0,arguments)},void(E.nextTick=function(e){return setImmediate(e)});if(E.setImmediate=function(e){setTimeout(e,0)},"undefined"!=typeof window&&"function"==typeof window.postMessage){var a="forge.setImmediate",n=[];E.setImmediate=function(e){n.push(e),1===n.length&&window.postMessage("forge.setImmediate","*")},window.addEventListener("message",e,!0)}if("undefined"!=typeof MutationObserver){var r=Date.now(),s=!0,o=document.createElement("div"),n=[];new MutationObserver(function(){var e=n.slice();n.length=0,e.forEach(function(e){e()})}).observe(o,{attributes:!0});var c=E.setImmediate;E.setImmediate=function(e){15<Date.now()-r?(r=Date.now(),c(e)):(n.push(e),1===n.length&&o.setAttribute("a",s=!s))}}E.nextTick=E.setImmediate}(),E.isNodejs="undefined"!=typeof process&&process.versions&&process.versions.node,E.globalScope=function(){return E.isNodejs?u:"undefined"==typeof self?window:self}(),E.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},E.isArrayBuffer=function(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer},E.isArrayBufferView=function(e){return e&&E.isArrayBuffer(e.buffer)&&void 0!==e.byteLength},E.ByteBuffer=C,E.ByteStringBuffer=C,E.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,4096<this._constructedStringLength&&(this.data.substr(0,1),this._constructedStringLength=0)},E.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},E.ByteStringBuffer.prototype.isEmpty=function(){return 0>=this.length()},E.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))},E.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;0<t;)1&t&&(r+=e),0<(t>>>=1)&&(e+=e);return this.data=r,this._optimizeConstructedString(t),this},E.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this},E.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(E.encodeUtf8(e))},E.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(255&e>>8)+String.fromCharCode(255&e))},E.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(255&e>>16)+String.fromCharCode(255&e>>8)+String.fromCharCode(255&e))},E.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(255&e>>24)+String.fromCharCode(255&e>>16)+String.fromCharCode(255&e>>8)+String.fromCharCode(255&e))},E.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(255&e>>8))},E.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(255&e>>8)+String.fromCharCode(255&e>>16))},E.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(255&e>>8)+String.fromCharCode(255&e>>16)+String.fromCharCode(255&e>>24))},E.ByteStringBuffer.prototype.putInt=function(t,a){m(a);var r="";do a-=8,r+=String.fromCharCode(255&t>>a);while(0<a);return this.putBytes(r)},E.ByteStringBuffer.prototype.putSignedInt=function(e,t){return 0>e&&(e+=2<<t-1),this.putInt(e,t)},E.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())},E.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},E.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e},E.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e},E.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e},E.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e},E.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e},E.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e},E.ByteStringBuffer.prototype.getInt=function(e){m(e);var t=0;do t=(t<<8)+this.data.charCodeAt(this.read++),e-=8;while(0<e);return t},E.ByteStringBuffer.prototype.getSignedInt=function(t){var a=this.getInt(t),r=2<<t-2;return a>=r&&(a-=r<<1),a},E.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},E.ByteStringBuffer.prototype.bytes=function(e){return void 0===e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},E.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)},E.ByteStringBuffer.prototype.setAt=function(t,a){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(a)+this.data.substr(this.read+t+1),this},E.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},E.ByteStringBuffer.prototype.copy=function(){var e=E.createBuffer(this.data);return e.read=this.read,e},E.ByteStringBuffer.prototype.compact=function(){return 0<this.read&&(this.data=this.data.slice(this.read),this.read=0),this},E.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},E.ByteStringBuffer.prototype.truncate=function(t){var a=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,a),this.read=0,this},E.ByteStringBuffer.prototype.toHex=function(){for(var e,t="",r=this.read;r<this.data.length;++r)e=this.data.charCodeAt(r),16>e&&(t+="0"),t+=e.toString(16);return t},E.ByteStringBuffer.prototype.toString=function(){return E.decodeUtf8(this.bytes())},E.DataBuffer=e,E.DataBuffer.prototype.length=function(){return this.write-this.read},E.DataBuffer.prototype.isEmpty=function(){return 0>=this.length()},E.DataBuffer.prototype.accommodate=function(t,a){if(this.length()>=t)return this;a=Math.max(a||this.growSize,t);var n=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),s=new Uint8Array(this.length()+a);return s.set(n),this.data=new DataView(s.buffer),this},E.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this},E.DataBuffer.prototype.fillWithByte=function(r,a){this.accommodate(a);for(var e=0;e<a;++e)this.data.setUint8(r);return this},E.DataBuffer.prototype.putBytes=function(e,t){if(E.isArrayBufferView(e)){var r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(E.isArrayBuffer(e)){var r=new Uint8Array(e);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(e instanceof E.DataBuffer||"object"==typeof e&&"number"==typeof e.read&&"number"==typeof e.write&&E.isArrayBufferView(e.data)){var r=new Uint8Array(e.data.byteLength,e.read,e.length());this.accommodate(r.byteLength);var i=new Uint8Array(e.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(e instanceof E.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary","string"==typeof e){var o;if("hex"===t)return this.accommodate(Math.ceil(e.length/2)),o=new Uint8Array(this.data.buffer,this.write),this.write+=E.binary.hex.decode(e,o,this.write),this;if("base64"===t)return this.accommodate(3*Math.ceil(e.length/4)),o=new Uint8Array(this.data.buffer,this.write),this.write+=E.binary.base64.decode(e,o,this.write),this;if("utf8"===t&&(e=E.encodeUtf8(e),t="binary"),"binary"===t||"raw"===t)return this.accommodate(e.length),o=new Uint8Array(this.data.buffer,this.write),this.write+=E.binary.raw.decode(o),this;if("utf16"===t)return this.accommodate(2*e.length),o=new Uint16Array(this.data.buffer,this.write),this.write+=E.text.utf16.encode(o),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)},E.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this},E.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")},E.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this},E.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,65535&e>>8),this.data.setInt8(this.write,255&e>>16),this.write+=3,this},E.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this},E.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this},E.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,255&e>>16),this.data.setInt16(this.write,65535&e>>8,!0),this.write+=3,this},E.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this},E.DataBuffer.prototype.putInt=function(t,a){m(a),this.accommodate(a/8);do a-=8,this.data.setInt8(this.write++,255&t>>a);while(0<a);return this},E.DataBuffer.prototype.putSignedInt=function(e,t){return m(t),this.accommodate(t/8),0>e&&(e+=2<<t-1),this.putInt(e,t)},E.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},E.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e},E.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e},E.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e},E.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e},E.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e},E.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e},E.DataBuffer.prototype.getInt=function(e){m(e);var t=0;do t=(t<<8)+this.data.getInt8(this.read++),e-=8;while(0<e);return t},E.DataBuffer.prototype.getSignedInt=function(t){var a=this.getInt(t),r=2<<t-2;return a>=r&&(a-=r<<1),a},E.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},E.DataBuffer.prototype.bytes=function(e){return void 0===e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},E.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)},E.DataBuffer.prototype.setAt=function(t,a){return this.data.setUint8(t,a),this},E.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},E.DataBuffer.prototype.copy=function(){return new E.DataBuffer(this)},E.DataBuffer.prototype.compact=function(){if(0<this.read){var t=new Uint8Array(this.data.buffer,this.read),a=new Uint8Array(t.byteLength);a.set(t),this.data=new DataView(a),this.write-=this.read,this.read=0}return this},E.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},E.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this},E.DataBuffer.prototype.toHex=function(){for(var e,t="",r=this.read;r<this.data.byteLength;++r)e=this.data.getUint8(r),16>e&&(t+="0"),t+=e.toString(16);return t},E.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if("binary"===(e=e||"utf8")||"raw"===e)return E.binary.raw.encode(t);if("hex"===e)return E.binary.hex.encode(t);if("base64"===e)return E.binary.base64.encode(t);if("utf8"===e)return E.text.utf8.decode(t);if("utf16"===e)return E.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)},E.createBuffer=function(e,t){return t=t||"raw",void 0!==e&&"utf8"===t&&(e=E.encodeUtf8(e)),new E.ByteBuffer(e)},E.fillString=function(e,t){for(var r="";0<t;)1&t&&(r+=e),0<(t>>>=1)&&(e+=e);return r},E.xorBytes=function(a,r,e){for(var n="",s="",i="",o=0,c=0;0<e;--e,++o)s=a.charCodeAt(o)^r.charCodeAt(o),10<=c&&(n+=i,i="",c=0),i+=String.fromCharCode(s),++c;return n+=i},E.hexToBytes=function(t){var a="",r=0;for(!0&t.length&&(r=1,a+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)a+=String.fromCharCode(parseInt(t.substr(r,2),16));return a},E.bytesToHex=function(e){return E.createBuffer(e).toHex()},E.int32ToBytes=function(e){return String.fromCharCode(255&e>>24)+String.fromCharCode(255&e>>16)+String.fromCharCode(255&e>>8)+String.fromCharCode(255&e)};var r=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];E.encode64=function(a,r){for(var e,n,s,i="",o="",c=0;c<a.length;)e=a.charCodeAt(c++),n=a.charCodeAt(c++),s=a.charCodeAt(c++),i+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e>>2),i+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt((3&e)<<4|n>>4),isNaN(n)?i+="==":(i+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt((15&n)<<2|s>>6),i+=isNaN(s)?"=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(63&s)),r&&i.length>r&&(o+=i.substr(0,r)+"\r\n",i=i.substr(r));return o+=i},E.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t,a,n,s,i="",y=0;y<e.length;)t=r[e.charCodeAt(y++)-43],a=r[e.charCodeAt(y++)-43],n=r[e.charCodeAt(y++)-43],s=r[e.charCodeAt(y++)-43],i+=String.fromCharCode(t<<2|a>>4),64!==n&&(i+=String.fromCharCode((15&a)<<4|n>>2),64!==s&&(i+=String.fromCharCode((3&n)<<6|s)));return i},E.encodeUtf8=function(e){return unescape(encodeURIComponent(e))},E.decodeUtf8=function(e){return decodeURIComponent(escape(e))},E.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:a.encode,decode:a.decode}},E.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)},E.binary.raw.decode=function(a,r,e){var n=r;n||(n=new Uint8Array(a.length)),e=e||0;for(var s=e,i=0;i<a.length;++i)n[s++]=a.charCodeAt(i);return r?s-e:n},E.binary.hex.encode=E.bytesToHex,E.binary.hex.decode=function(a,r,e){var n=r;n||(n=new Uint8Array(Math.ceil(a.length/2))),e=e||0;var s=0,i=e;for(1&a.length&&(s=1,n[i++]=parseInt(a[0],16));s<a.length;s+=2)n[i++]=parseInt(a.substr(s,2),16);return r?i-e:n},E.binary.base64.encode=function(a,r){for(var e,n,s,i="",o="",c=0;c<a.byteLength;)e=a[c++],n=a[c++],s=a[c++],i+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e>>2),i+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt((3&e)<<4|n>>4),isNaN(n)?i+="==":(i+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt((15&n)<<2|s>>6),i+=isNaN(s)?"=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(63&s)),r&&i.length>r&&(o+=i.substr(0,r)+"\r\n",i=i.substr(r));return o+=i},E.binary.base64.decode=function(e,a,n){var s=a;s||(s=new Uint8Array(3*Math.ceil(e.length/4))),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),n=n||0;for(var i,o,c,l,u=0,E=n;u<e.length;)i=r[e.charCodeAt(u++)-43],o=r[e.charCodeAt(u++)-43],c=r[e.charCodeAt(u++)-43],l=r[e.charCodeAt(u++)-43],s[E++]=i<<2|o>>4,64!==c&&(s[E++]=(15&o)<<4|c>>2,64!==l&&(s[E++]=(3&c)<<6|l));return a?E-n:s.subarray(0,E)},E.binary.base58.encode=function(t,a){return E.binary.baseN.encode(t,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",a)},E.binary.base58.decode=function(t,a){return E.binary.baseN.decode(t,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",a)},E.text={utf8:{},utf16:{}},E.text.utf8.encode=function(e,a,r){e=E.encodeUtf8(e);var n=a;n||(n=new Uint8Array(e.length)),r=r||0;for(var i=r,o=0;o<e.length;++o)n[i++]=e.charCodeAt(o);return a?i-r:n},E.text.utf8.decode=function(e){return E.decodeUtf8(String.fromCharCode.apply(null,e))},E.text.utf16.encode=function(a,r,e){var s=r;s||(s=new Uint8Array(2*a.length));var i=new Uint16Array(s.buffer);e=e||0;for(var o=e,c=e,l=0;l<a.length;++l)i[c++]=a.charCodeAt(l),o+=2;return r?o-e:s},E.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))},E.deflate=function(t,a,n){if(a=E.decode64(t.deflate(E.encode64(a)).rval),n){var s=2;32&a.charCodeAt(1)&&(s=6),a=a.substring(s,a.length-4)}return a},E.inflate=function(a,r){var e=a.inflate(E.encode64(r)).rval;return null===e?null:E.decode64(e)};var n=function(a,r,e){if(!a)throw new Error("WebStorage not available.");var n;if(null===e?n=a.removeItem(r):(e=E.encode64(JSON.stringify(e)),n=a.setItem(r,e)),void 0!==n&&!0!==n.rval){var s=new Error(n.error.message);throw s.id=n.error.id,s.name=n.error.name,s}},s=function(a,r){if(!a)throw new Error("WebStorage not available.");var e=a.getItem(r);if(a.init)if(null===e.rval){if(e.error){var n=new Error(e.error.message);throw n.id=e.error.id,n.name=e.error.name,n}e=null}else e=e.rval;return null!==e&&(e=JSON.parse(E.decode64(e))),e},o=function(o,i,e,t){var r=s(o,i);null===r&&(r={}),r[e]=t,n(o,i,r)},i=function(a,n,e){var t=s(a,n);return null!==t&&(t=e in t?t[e]:null),t},c=function(a,i,e){var t=s(a,i);if(null!==t&&e in t){delete t[e];var o=!0;for(var c in t){o=!1;break}o&&(t=null),n(a,i,t)}},d=function(t,a){n(t,a,null)},l=function(a,r,e){var n=null;void 0===e&&(e=["web","flash"]);var s,i=!1,o=null;for(var c in e){s=e[c];try{if("flash"===s||"both"===s){if(null===r[0])throw new Error("Flash local storage not available.");n=a.apply(this,r),i="flash"===s}"web"!==s&&"both"!==s||(r[0]=localStorage,n=a.apply(this,r),i=!0)}catch(e){o=e}if(i)break}if(!i)throw o;return n};E.setItem=function(n,s,e,t,r){l(o,arguments,r)},E.getItem=function(a,n,e,t){return l(i,arguments,t)},E.removeItem=function(a,n,e,t){l(c,arguments,t)},E.clearItems=function(r,a,e){l(d,arguments,e)},E.parseUrl=function(a){var n=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;n.lastIndex=0;var e=n.exec(a),t=null===e?null:{full:a,scheme:e[1],host:e[2],port:e[3],path:e[4]};return t&&(t.fullHost=t.host,t.port?80!==t.port&&"http"===t.scheme?t.fullHost+=":"+t.port:443!==t.port&&"https"===t.scheme&&(t.fullHost+=":"+t.port):"http"===t.scheme?t.port=80:"https"===t.scheme&&(t.port=443),t.full=t.scheme+"://"+t.fullHost),t};var g=null;E.getQueryVariables=function(t){var a,r=function(a){for(var n={},e=a.split("&"),t=0;t<e.length;t++){var s,i,o=e[t].indexOf("=");0<o?(s=e[t].substring(0,o),i=e[t].substring(o+1)):(s=e[t],i=null),s in n||(n[s]=[]),s in Object.prototype||null===i||n[s].push(unescape(i))}return n};return void 0===t?(null===g&&(g="undefined"!=typeof window&&window.location&&window.location.search?r(window.location.search.substring(1)):{}),a=g):a=r(t),a},E.parseFragment=function(t){var r=t,n="",s=t.indexOf("?");0<s&&(r=t.substring(0,s),n=t.substring(s+1));var o=r.split("/");return 0<o.length&&""===o[0]&&o.shift(),{pathString:r,queryString:n,path:o,query:""===n?{}:E.getQueryVariables(n)}},E.makeRequest=function(e){var a=E.parseFragment(e),n={path:a.pathString,query:a.queryString,getPath:function(e){return void 0===e?a.path:a.path[e]},getQuery:function(n,t){var e;return void 0===n?e=a.query:(e=a.query[n])&&void 0!==t&&(e=e[t]),e},getQueryLast:function(a,r){var e=n.getQuery(a);return e?e[e.length-1]:r}};return n},E.makeLink=function(e,a,r){e=jQuery.isArray(e)?e.join("/"):e;var s=jQuery.param(a||{});return r=r||"",e+(0<s.length?"?"+s:"")+(0<r.length?"#"+r:"")},E.setPath=function(e,a,s){if("object"==typeof e&&null!==e)for(var t,i=0,c=a.length;i<c;)if(t=a[i++],i==c)e[t]=s;else{var l=(t in e);(!l||l&&"object"!=typeof e[t]||l&&null===e[t])&&(e[t]={}),e=e[t]}},E.getPath=function(e,a,s){for(var t,i=0,c=a.length,l=!0;l&&i<c&&"object"==typeof e&&null!==e;)t=a[i++],l=t in e,l&&(e=e[t]);return l?e:s},E.deletePath=function(e,a){if("object"==typeof e&&null!==e)for(var r,n=0,i=a.length;n<i;)if(r=a[n++],n==i)delete e[r];else{if(!(r in e)||"object"!=typeof e[r]||null===e[r])break;e=e[r]}},E.isEmpty=function(t){for(var a in t)if(t.hasOwnProperty(a))return!1;return!0},E.format=function(t){for(var r,n,s=/%./g,o=0,c=[],l=0;r=s.exec(t);){n=t.substring(l,s.lastIndex-2),0<n.length&&c.push(n),l=s.lastIndex;var p=r[0][1];"s"===p||"o"===p?o<arguments.length?c.push(arguments[1+o++]):c.push("<?>"):"%"===p?c.push("%"):c.push("<%"+p+"?>")}return c.push(t.substring(l)),c.join("")},E.formatNumber=function(t,n,d,l){var r=t,p=isNaN(n=Math.abs(n))?2:n,g=void 0===d?",":d,i=void 0===l?".":l,s=0>r?"-":"",o=parseInt(r=Math.abs(+r||0).toFixed(p),10)+"",c=3<o.length?o.length%3:0;return s+(c?o.substr(0,c)+i:"")+o.substr(c).replace(/(\d{3})(?=\d)/g,"$1"+i)+(p?g+Math.abs(r-o).toFixed(p).slice(2):"")},E.formatSize=function(e){return e=1073741824<=e?E.formatNumber(e/1073741824,2,".","")+" GiB":1048576<=e?E.formatNumber(e/1048576,2,".","")+" MiB":1024<=e?E.formatNumber(e/1024,0)+" KiB":E.formatNumber(e,0)+" bytes"},E.bytesFromIP=function(e){return-1===e.indexOf(".")?-1===e.indexOf(":")?null:E.bytesFromIPv6(e):E.bytesFromIPv4(e)},E.bytesFromIPv4=function(e){if(e=e.split("."),4!==e.length)return null;for(var a,r=E.createBuffer(),i=0;i<e.length;++i){if(a=parseInt(e[i],10),isNaN(a))return null;r.putByte(a)}return r.getBytes()},E.bytesFromIPv6=function(e){var r=0;e=e.split(":").filter(function(e){return 0===e.length&&++r,!0});for(var t=2*(8-e.length+r),n=E.createBuffer(),i=0;8>i;++i)if(e[i]&&0!==e[i].length){var o=E.hexToBytes(e[i]);2>o.length&&n.putByte(0),n.putBytes(o)}else n.fillWithByte(0,t),t=0;return n.getBytes()},E.bytesToIP=function(e){return 4===e.length?E.bytesToIPv4(e):16===e.length?E.bytesToIPv6(e):null},E.bytesToIPv4=function(r){if(4!==r.length)return null;for(var a=[],e=0;e<r.length;++e)a.push(r.charCodeAt(e));return a.join(".")},E.bytesToIPv6=function(a){if(16!==a.length)return null;for(var n=[],e=[],t=0,i=0;i<a.length;i+=2){for(var o=E.bytesToHex(a[i]+a[i+1]);"0"===o[0]&&"0"!==o;)o=o.substr(1);if("0"===o){var c=e[e.length-1],p=n.length;c&&p===c.end+1?(c.end=p,c.end-c.start>e[t].end-e[t].start&&(t=e.length-1)):e.push({start:p,end:p})}n.push(o)}if(0<e.length){var s=e[t];0<s.end-s.start&&(n.splice(s.start,s.end-s.start+1,""),0===s.start&&n.unshift(""),7===s.end&&n.push(""))}return n.join(":")},E.estimateCores=function(e,a){function i(c,n,e){if(0===n){var r=Math.floor(c.reduce(function(t,a){return t+a},0)/c.length);return E.cores=Math.max(1,r),URL.revokeObjectURL(l),a(null,E.cores)}o(e,function(a,r){c.push(d(e,r)),i(c,n-1,e)})}function o(n,s){for(var e,i=[],o=[],r=0;r<n;++r)e=new Worker(l),e.addEventListener("message",function(e){if(o.push(e.data),o.length===n){for(var t=0;t<n;++t)i[t].terminate();s(null,o)}}),i.push(e);for(var r=0;r<n;++r)i[r].postMessage(r)}function d(a,s){for(var e=[],t=0;t<a;++t)for(var o=s[t],c=e[t]=[],n=0;n<a;++n)if(t!==n){var d=s[n];(o.st>d.st&&o.st<d.et||d.st>o.st&&d.st<o.et)&&c.push(n)}return e.reduce(function(t,a){return Math.max(t,a.length)},0)}if("function"==typeof e&&(a=e,e={}),e=e||{},"cores"in E&&!e.update)return a(null,E.cores);if("undefined"!=typeof navigator&&"hardwareConcurrency"in navigator&&0<navigator.hardwareConcurrency)return E.cores=navigator.hardwareConcurrency,a(null,E.cores);if("undefined"==typeof Worker)return E.cores=1,a(null,E.cores);if("undefined"==typeof Blob)return E.cores=2,a(null,E.cores);var l=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(){for(var a=Date.now(),e=a+4;Date.now()<e;);self.postMessage({st:a,et:e})})}.toString(),")()"],{type:"application/javascript"}));i([],5,16)}}).call(t,p(36))},function(c,a,e){var d=e(0);e(5),e(23),e(24),e(1),function(){return d.random&&d.random.getBytes?void(c.exports=d.random):void!function(p){function e(){var a=d.prng.create(t);return a.getBytes=function(r,e){return a.generate(r,e)},a.getBytesSync=function(t){return a.generate(t)},a}var t={},g=[,,,,],r=d.util.createBuffer();t.formatKey=function(e){var t=d.util.createBuffer(e);return e=[,,,,],e[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),d.aes._expandKey(e,!1)},t.formatSeed=function(e){var t=d.util.createBuffer(e);return e=[,,,,],e[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),e},t.cipher=function(t,a){return d.aes._updateBlock(t,a,g,!1),r.putInt32(g[0]),r.putInt32(g[1]),r.putInt32(g[2]),r.putInt32(g[3]),r.getBytes()},t.increment=function(e){return++e[3],e},t.md=d.md.sha256;var a=e(),n=null,s=d.util.globalScope,o=s.crypto||s.msCrypto;if(o&&o.getRandomValues&&(n=function(e){return o.getRandomValues(e)}),d.options.usePureJavaScript||!d.util.isNodejs&&!n){if("undefined"==typeof window||window.document,a.collectInt(+new Date,32),"undefined"!=typeof navigator){var u="";for(var h in navigator)try{"string"==typeof navigator[h]&&(u+=navigator[h])}catch(e){}a.collect(u),u=null}p&&(p().mousemove(function(e){a.collectInt(e.clientX,16),a.collectInt(e.clientY,16)}),p().keypress(function(e){a.collectInt(e.charCode,8)}))}if(d.random)for(var h in a)d.random[h]=a[h];else d.random=a;d.random.createInstance=e,c.exports=d.random}("undefined"==typeof jQuery?null:jQuery)}()},function(s,i,e){function t(a,n,e){if(e>n){var t=new Error("Too few bytes to parse DER.");throw t.available=a.length(),t.remaining=n,t.requested=e,t}}function c(n,s,d,o){var r;t(n,s,2);var y=n.getByte();s--;var C=192&y,u=31&y;r=n.length();var l=a(n,s);if(s-=r-n.length(),void 0!==l&&l>s){if(o.strict){var T=new Error("Too few bytes to read ASN.1 value.");throw T.available=n.length(),T.remaining=s,T.requested=l,T}l=s}var B,A,b=32==(32&y);if(b)if(B=[],void 0===l)for(;;){if(t(n,s,2),n.bytes(2)===String.fromCharCode(0,0)){n.getBytes(2),s-=2;break}r=n.length(),B.push(c(n,s,d+1,o)),s-=r-n.length()}else for(;0<l;)r=n.length(),B.push(c(n,l,d+1,o)),s-=r-n.length(),l-=r-n.length();if(void 0===B&&C===f.Class.UNIVERSAL&&u===f.Type.BITSTRING&&(A=n.bytes(l)),void 0===B&&o.decodeBitStrings&&C===f.Class.UNIVERSAL&&u===f.Type.BITSTRING&&1<l){var N=n.read,g=s,v=0;if(u===f.Type.BITSTRING&&(t(n,s,1),v=n.getByte(),s--),0===v)try{r=n.length();var R={verbose:o.verbose,strict:!0,decodeBitStrings:!0},_=c(n,s,d+1,R),E=r-n.length();s-=E,u==f.Type.BITSTRING&&E++;var k=_.tagClass;E!==l||k!==f.Class.UNIVERSAL&&k!==f.Class.CONTEXT_SPECIFIC||(B=[_])}catch(e){}void 0===B&&(n.read=N,s=g)}if(void 0===B){if(void 0===l){if(o.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");l=s}if(u===f.Type.BMPSTRING)for(B="";0<l;l-=2)t(n,s,2),B+=String.fromCharCode(n.getInt16()),s-=2;else B=n.getBytes(l)}var U=void 0===A?null:{bitStringContents:A};return f.create(C,u,b,B,U)}var u=e(0);e(1),e(6);var f=s.exports=u.asn1=u.asn1||{};f.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},f.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},f.create=function(a,s,e,t,c){if(u.util.isArray(t)){for(var i=[],n=0;n<t.length;++n)void 0!==t[n]&&i.push(t[n]);t=i}var l={tagClass:a,type:s,constructed:e,composed:e||u.util.isArray(t),value:t};return c&&"bitStringContents"in c&&(l.bitStringContents=c.bitStringContents,l.original=f.copy(l)),l},f.copy=function(a,r){var e;if(u.util.isArray(a)){e=[];for(var n=0;n<a.length;++n)e.push(f.copy(a[n],r));return e}return"string"==typeof a?a:(e={tagClass:a.tagClass,type:a.type,constructed:a.constructed,composed:a.composed,value:f.copy(a.value,r)},r&&!r.excludeBitStringContents&&(e.bitStringContents=a.bitStringContents),e)},f.equals=function(a,n,e){if(u.util.isArray(a)){if(!u.util.isArray(n))return!1;if(a.length!==n.length)return!1;for(var t=0;t<a.length;++t)if(!f.equals(a[t],n[t]))return!1;return!0}if(typeof a!=typeof n)return!1;if("string"==typeof a)return a===n;var s=a.tagClass===n.tagClass&&a.type===n.type&&a.constructed===n.constructed&&a.composed===n.composed&&f.equals(a.value,n.value);return e&&e.includeBitStringContents&&(s=s&&a.bitStringContents===n.bitStringContents),s},f.getBerValueLength=function(t){var a=t.getByte();if(128!==a)return 128&a?t.getInt((127&a)<<3):a};var a=function(n,a){var i=n.getByte();if(a--,128!==i){var s;if(128&i){var c=127&i;t(n,a,c),s=n.getInt(c<<3)}else s=i;if(0>s)throw new Error("Negative length: "+s);return s}};f.fromDer=function(e,t){return void 0===t&&(t={strict:!0,decodeBitStrings:!0}),"boolean"==typeof t&&(t={strict:t,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),"string"==typeof e&&(e=u.util.createBuffer(e)),c(e,e.length(),0,t)},f.toDer=function(r){var n=u.util.createBuffer(),e=r.tagClass|r.type,s=u.util.createBuffer(),i=!1;if("bitStringContents"in r&&(i=!0,r.original&&(i=f.equals(r,r.original))),i)s.putBytes(r.bitStringContents);else if(r.composed){r.constructed?e|=32:s.putByte(0);for(var o=0;o<r.value.length;++o)void 0!==r.value[o]&&s.putBuffer(f.toDer(r.value[o]))}else if(r.type===f.Type.BMPSTRING)for(var o=0;o<r.value.length;++o)s.putInt16(r.value.charCodeAt(o));else r.type===f.Type.INTEGER&&1<r.value.length&&(0===r.value.charCodeAt(0)&&0==(128&r.value.charCodeAt(1))||255===r.value.charCodeAt(0)&&128==(128&r.value.charCodeAt(1)))?s.putBytes(r.value.substr(1)):s.putBytes(r.value);if(n.putByte(e),127>=s.length())n.putByte(127&s.length());else{var c=s.length(),l="";do l+=String.fromCharCode(255&c),c>>>=8;while(0<c);n.putByte(128|l.length);for(var o=l.length-1;0<=o;--o)n.putByte(l.charCodeAt(o))}return n.putBuffer(s),n},f.oidToDer=function(a){var n=a.split("."),e=u.util.createBuffer();e.putByte(40*parseInt(n[0],10)+parseInt(n[1],10));for(var t,s,i,o,c=2;c<n.length;++c){t=!0,s=[],i=parseInt(n[c],10);do o=127&i,i>>>=7,t||(o|=128),s.push(o),t=!1;while(0<i);for(var l=s.length-1;0<=l;--l)e.putByte(s[l])}return e},f.derToOid=function(e){var t;"string"==typeof e&&(e=u.util.createBuffer(e));var a=e.getByte();t=Math.floor(a/40)+"."+a%40;for(var r=0;0<e.length();)a=e.getByte(),r<<=7,128&a?r+=127&a:(t+="."+(r+a),r=0);return t},f.utcTimeToDate=function(r){var o=new Date,e=parseInt(r.substr(0,2),10);e=50<=e?1900+e:2e3+e;var c=parseInt(r.substr(2,2),10)-1,d=parseInt(r.substr(4,2),10),a=parseInt(r.substr(6,2),10),n=parseInt(r.substr(8,2),10),i=0;if(11<r.length){var u=r.charAt(10),g=10;"+"!==u&&"-"!==u&&(i=parseInt(r.substr(10,2),10),g+=2)}if(o.setUTCFullYear(e,c,d),o.setUTCHours(a,n,i,0),g&&("+"===(u=r.charAt(g))||"-"===u)){var f=parseInt(r.substr(g+1,2),10),m=parseInt(r.substr(g+4,2),10),l=60*f+m;l*=6e4,"+"===u?o.setTime(+o-l):o.setTime(+o+l)}return o},f.generalizedTimeToDate=function(c){var d=new Date,e=parseInt(c.substr(0,4),10),t=parseInt(c.substr(4,2),10)-1,r=parseInt(c.substr(6,2),10),a=parseInt(c.substr(8,2),10),n=parseInt(c.substr(10,2),10),i=parseInt(c.substr(12,2),10),s=0,l=0,u=!1;"Z"===c.charAt(c.length-1)&&(u=!0);var f=c.length-5,h=c.charAt(f);return("+"===h||"-"===h)&&(l=60*parseInt(c.substr(f+1,2),10)+parseInt(c.substr(f+4,2),10),l*=6e4,"+"===h&&(l*=-1),u=!0),"."===c.charAt(14)&&(s=1e3*parseFloat(c.substr(14),10)),u?(d.setUTCFullYear(e,t,r),d.setUTCHours(a,n,i,s),d.setTime(+d+l)):(d.setFullYear(e,t,r),d.setHours(a,n,i,s)),d},f.dateToUtcTime=function(t){if("string"==typeof t)return t;var a="",n=[];n.push((""+t.getUTCFullYear()).substr(2)),n.push(""+(t.getUTCMonth()+1)),n.push(""+t.getUTCDate()),n.push(""+t.getUTCHours()),n.push(""+t.getUTCMinutes()),n.push(""+t.getUTCSeconds());for(var s=0;s<n.length;++s)2>n[s].length&&(a+="0"),a+=n[s];return a+="Z"},f.dateToGeneralizedTime=function(t){if("string"==typeof t)return t;var a="",n=[];n.push(""+t.getUTCFullYear()),n.push(""+(t.getUTCMonth()+1)),n.push(""+t.getUTCDate()),n.push(""+t.getUTCHours()),n.push(""+t.getUTCMinutes()),n.push(""+t.getUTCSeconds());for(var s=0;s<n.length;++s)2>n[s].length&&(a+="0"),a+=n[s];return a+="Z"},f.integerToDer=function(r){var a=u.util.createBuffer();if(-128<=r&&128>r)return a.putSignedInt(r,8);if(-32768<=r&&32768>r)return a.putSignedInt(r,16);if(-8388608<=r&&8388608>r)return a.putSignedInt(r,24);if(-2147483648<=r&&2147483648>r)return a.putSignedInt(r,32);var e=new Error("Integer too large; max is 32-bits.");throw e.integer=r,e},f.derToInteger=function(e){"string"==typeof e&&(e=u.util.createBuffer(e));var t=8*e.length();if(32<t)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)},f.validate=function(n,s,e,t){var r=!1;if(n.tagClass!==s.tagClass&&void 0!==s.tagClass||n.type!==s.type&&void 0!==s.type)t&&(n.tagClass!==s.tagClass&&t.push("["+s.name+"] Expected tag class \""+s.tagClass+"\", got \""+n.tagClass+"\""),n.type!==s.type&&t.push("["+s.name+"] Expected type \""+s.type+"\", got \""+n.type+"\""));else if(n.constructed===s.constructed||void 0===s.constructed){if(r=!0,s.value&&u.util.isArray(s.value))for(var o=0,c=0;r&&c<s.value.length;++c)r=s.value[c].optional||!1,n.value[o]&&(r=f.validate(n.value[o],s.value[c],e,t),r?++o:s.value[c].optional&&(r=!0)),!r&&t&&t.push("["+s.name+"] Tag class \""+s.tagClass+"\", type \""+s.type+"\" expected value length \""+s.value.length+"\", got \""+n.value.length+"\"");if(r&&e&&(s.capture&&(e[s.capture]=n.value),s.captureAsn1&&(e[s.captureAsn1]=n),s.captureBitStringContents&&"bitStringContents"in n&&(e[s.captureBitStringContents]=n.bitStringContents),s.captureBitStringValue&&"bitStringContents"in n))if(2>n.bitStringContents.length)e[s.captureBitStringValue]="";else{var l=n.bitStringContents.charCodeAt(0);if(0!==l)throw new Error("captureBitStringValue only supported for zero unused bits");e[s.captureBitStringValue]=n.bitStringContents.slice(1)}}else t&&t.push("["+s.name+"] Expected constructed \""+s.constructed+"\", got \""+n.constructed+"\"");return r};var n=/[^\\u0000-\\u00ff]/;f.prettyPrint=function(t,a,r){var s="";a=a||0,r=r||2,0<a&&(s+="\n");for(var o="",l=0;l<a*r;++l)o+=" ";switch(s+=o+"Tag: ",t.tagClass){case f.Class.UNIVERSAL:s+="Universal:";break;case f.Class.APPLICATION:s+="Application:";break;case f.Class.CONTEXT_SPECIFIC:s+="Context-Specific:";break;case f.Class.PRIVATE:s+="Private:";}if(t.tagClass===f.Class.UNIVERSAL)switch(s+=t.type,t.type){case f.Type.NONE:s+=" (None)";break;case f.Type.BOOLEAN:s+=" (Boolean)";break;case f.Type.INTEGER:s+=" (Integer)";break;case f.Type.BITSTRING:s+=" (Bit string)";break;case f.Type.OCTETSTRING:s+=" (Octet string)";break;case f.Type.NULL:s+=" (Null)";break;case f.Type.OID:s+=" (Object Identifier)";break;case f.Type.ODESC:s+=" (Object Descriptor)";break;case f.Type.EXTERNAL:s+=" (External or Instance of)";break;case f.Type.REAL:s+=" (Real)";break;case f.Type.ENUMERATED:s+=" (Enumerated)";break;case f.Type.EMBEDDED:s+=" (Embedded PDV)";break;case f.Type.UTF8:s+=" (UTF8)";break;case f.Type.ROID:s+=" (Relative Object Identifier)";break;case f.Type.SEQUENCE:s+=" (Sequence)";break;case f.Type.SET:s+=" (Set)";break;case f.Type.PRINTABLESTRING:s+=" (Printable String)";break;case f.Type.IA5String:s+=" (IA5String (ASCII))";break;case f.Type.UTCTIME:s+=" (UTC time)";break;case f.Type.GENERALIZEDTIME:s+=" (Generalized time)";break;case f.Type.BMPSTRING:s+=" (BMP String)";}else s+=t.type;if(s+="\n",s+=o+"Constructed: "+t.constructed+"\n",t.composed){for(var C=0,E="",l=0;l<t.value.length;++l)void 0!==t.value[l]&&(C+=1,E+=f.prettyPrint(t.value[l],a+1,r),l+1<t.value.length&&(E+=","));s+=o+"Sub values: "+C+E}else{if(s+=o+"Value: ",t.type===f.Type.OID){var S=f.derToOid(t.value);s+=S,u.pki&&u.pki.oids&&S in u.pki.oids&&(s+=" ("+u.pki.oids[S]+") ")}if(t.type===f.Type.INTEGER)try{s+=f.derToInteger(t.value)}catch(a){s+="0x"+u.util.bytesToHex(t.value)}else if(t.type!==f.Type.BITSTRING)t.type===f.Type.OCTETSTRING?(n.test(t.value)||(s+="("+t.value+") "),s+="0x"+u.util.bytesToHex(t.value)):t.type===f.Type.UTF8?s+=u.util.decodeUtf8(t.value):t.type===f.Type.PRINTABLESTRING||t.type===f.Type.IA5String?s+=t.value:n.test(t.value)?s+="0x"+u.util.bytesToHex(t.value):0===t.value.length?s+="[null]":s+=t.value;else if(s+=1<t.value.length?"0x"+u.util.bytesToHex(t.value.slice(1)):"(none)",0<t.value.length){var m=t.value.charCodeAt(0);1==m?s+=" (1 unused bit shown)":1<m&&(s+=" ("+m+" unused bits shown)")}}return s}},function(a,n,e){var t=e(0);a.exports=t.md=t.md||{},t.md.algorithms=t.md.algorithms||{}},function(o,c,e){function t(t,a){g.cipher.registerAlgorithm(t,function(){return new g.aes.Algorithm(t,a)})}function d(){L=!0,v=[0,1,2,4,8,16,32,64,128,27,54];for(var t=Array(256),a=0;128>a;++a)t[a]=a<<1,t[a+128]=283^a+128<<1;K=Array(256),s=Array(256),i=[,,,,],y=[,,,,];for(var a=0;4>a;++a)i[a]=Array(256),y[a]=Array(256);for(var r,n,o,c,d,g,C,E=0,I=0,a=0;256>a;++a){c=I^I<<1^I<<2^I<<3^I<<4,c=99^(c>>8^255&c),K[E]=c,s[c]=E,d=t[c],r=t[E],n=t[r],o=t[n],g=d<<24^c<<16^c<<8^c^d,C=(r^n^o)<<24^(E^o)<<16^(E^n^o)<<8^E^r^o;for(var B=0;4>B;++B)i[B][E]=g,y[B][c]=C,g=g<<24|g>>>8,C=C<<24|C>>>8;0==E?E=I=1:(E=r^t[t[t[r^o]]],I^=t[t[I]])}}function a(a,r){for(var e,n=a.slice(0),s=1,o=n.length,c=l*(o+6+1),C=o;C<c;++C)e=n[C-1],0==C%o?(e=K[255&e>>>16]<<24^K[255&e>>>8]<<16^K[255&e]<<8^K[e>>>24]^v[s]<<24,s++):6<o&&4==C%o&&(e=K[e>>>24]<<24^K[255&e>>>16]<<16^K[255&e>>>8]<<8^K[255&e]),n[C]=n[C-o]^e;if(r){var E,S=y[0],I=y[1],f=y[2],d=y[3],g=n.slice(0);c=n.length;for(var C=0,B=c-l;C<c;C+=l,B-=l)if(0===C||C===c-l)g[C]=n[B],g[C+1]=n[B+3],g[C+2]=n[B+2],g[C+3]=n[B+1];else for(var A=0;A<l;++A)E=n[B+A],g[C+(3&-A)]=S[K[E>>>24]]^I[K[255&E>>>16]]^f[K[255&E>>>8]]^d[K[255&E]];n=g}return n}function r(n,o,e,t){var r,c,d,l,g,m=n.length/4-1;t?(r=y[0],c=y[1],d=y[2],l=y[3],g=s):(r=i[0],c=i[1],d=i[2],l=i[3],g=K);var C,E,S,T,I,B,A;C=o[0]^n[0],E=o[t?3:1]^n[1],S=o[2]^n[2],T=o[t?1:3]^n[3];for(var b=3,v=1;v<m;++v)I=r[C>>>24]^c[255&E>>>16]^d[255&S>>>8]^l[255&T]^n[++b],B=r[E>>>24]^c[255&S>>>16]^d[255&T>>>8]^l[255&C]^n[++b],A=r[S>>>24]^c[255&T>>>16]^d[255&C>>>8]^l[255&E]^n[++b],T=r[T>>>24]^c[255&C>>>16]^d[255&E>>>8]^l[255&S]^n[++b],C=I,E=B,S=A;e[0]=g[C>>>24]<<24^g[255&E>>>16]<<16^g[255&S>>>8]<<8^g[255&T]^n[++b],e[t?3:1]=g[E>>>24]<<24^g[255&S>>>16]<<16^g[255&T>>>8]<<8^g[255&C]^n[++b],e[2]=g[S>>>24]<<24^g[255&T>>>16]<<16^g[255&C>>>8]<<8^g[255&E]^n[++b],e[t?1:3]=g[T>>>24]<<24^g[255&C>>>16]<<16^g[255&E>>>8]<<8^g[255&S]^n[++b]}function n(e){e=e||{};var a,t=(e.mode||"CBC").toUpperCase(),n="AES-"+t;a=e.decrypt?g.cipher.createDecipher(n,e.key):g.cipher.createCipher(n,e.key);var r=a.start;return a.start=function(s,t){var i=null;t instanceof g.util.ByteBuffer&&(i=t,t={}),t=t||{},t.output=i,t.iv=s,r.call(a,t)},a}var g=e(0);e(13),e(19),e(1),o.exports=g.aes=g.aes||{},g.aes.startEncrypting=function(s,i,e,t){var r=n({key:s,output:e,decrypt:!1,mode:t});return r.start(i),r},g.aes.createEncryptionCipher=function(t,a){return n({key:t,output:null,decrypt:!1,mode:a})},g.aes.startDecrypting=function(s,i,e,t){var r=n({key:s,output:e,decrypt:!0,mode:t});return r.start(i),r},g.aes.createDecryptionCipher=function(t,a){return n({key:t,output:null,decrypt:!0,mode:a})},g.aes.Algorithm=function(t,a){L||d();var n=this;n.name=t,n.mode=new a({blockSize:16,cipher:{encrypt:function(t,a){return r(n._w,t,a,!1)},decrypt:function(t,a){return r(n._w,t,a,!0)}}}),n._init=!1},g.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var r,n=t.key;if("string"==typeof n&&(16===n.length||24===n.length||32===n.length))n=g.util.createBuffer(n);else if(g.util.isArray(n)&&(16===n.length||24===n.length||32===n.length)){r=n,n=g.util.createBuffer();for(var i=0;i<r.length;++i)n.putByte(r[i])}if(!g.util.isArray(n)){r=n,n=[];var o=r.length();if(16===o||24===o||32===o){o>>>=2;for(var i=0;i<o;++i)n.push(r.getInt32())}}if(!g.util.isArray(n)||4!==n.length&&6!==n.length&&8!==n.length)throw new Error("Invalid key parameter.");var c=this.mode.name,u=-1!==["CFB","OFB","CTR","GCM"].indexOf(c);this._w=a(n,t.decrypt&&!u),this._init=!0}},g.aes._expandKey=function(t,r){return L||d(),a(t,r)},g.aes._updateBlock=r,t("AES-ECB",g.cipher.modes.ecb),t("AES-CBC",g.cipher.modes.cbc),t("AES-CFB",g.cipher.modes.cfb),t("AES-OFB",g.cipher.modes.ofb),t("AES-CTR",g.cipher.modes.ctr),t("AES-GCM",g.cipher.modes.gcm);var K,s,v,i,y,L=!1,l=4},function(s,o,e){function t(t,a){n[t]=a,n[a]=t}function r(t,a){n[t]=a}var a=e(0);a.pki=a.pki||{};var n=s.exports=a.pki.oids=a.oids=a.oids||{};t("1.2.840.113549.1.1.1","rsaEncryption"),t("1.2.840.113549.1.1.4","md5WithRSAEncryption"),t("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),t("1.2.840.113549.1.1.7","RSAES-OAEP"),t("1.2.840.113549.1.1.8","mgf1"),t("1.2.840.113549.1.1.9","pSpecified"),t("1.2.840.113549.1.1.10","RSASSA-PSS"),t("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),t("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),t("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),t("1.3.101.112","EdDSA25519"),t("1.2.840.10040.4.3","dsa-with-sha1"),t("1.3.14.3.2.7","desCBC"),t("1.3.14.3.2.26","sha1"),t("2.16.840.1.101.3.4.2.1","sha256"),t("2.16.840.1.101.3.4.2.2","sha384"),t("2.16.840.1.101.3.4.2.3","sha512"),t("1.2.840.113549.2.5","md5"),t("1.2.840.113549.1.7.1","data"),t("1.2.840.113549.1.7.2","signedData"),t("1.2.840.113549.1.7.3","envelopedData"),t("1.2.840.113549.1.7.4","signedAndEnvelopedData"),t("1.2.840.113549.1.7.5","digestedData"),t("1.2.840.113549.1.7.6","encryptedData"),t("1.2.840.113549.1.9.1","emailAddress"),t("1.2.840.113549.1.9.2","unstructuredName"),t("1.2.840.113549.1.9.3","contentType"),t("1.2.840.113549.1.9.4","messageDigest"),t("1.2.840.113549.1.9.5","signingTime"),t("1.2.840.113549.1.9.6","counterSignature"),t("1.2.840.113549.1.9.7","challengePassword"),t("1.2.840.113549.1.9.8","unstructuredAddress"),t("1.2.840.113549.1.9.14","extensionRequest"),t("1.2.840.113549.1.9.20","friendlyName"),t("1.2.840.113549.1.9.21","localKeyId"),t("1.2.840.113549.1.9.22.1","x509Certificate"),t("1.2.840.113549.1.12.10.1.1","keyBag"),t("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),t("1.2.840.113549.1.12.10.1.3","certBag"),t("1.2.840.113549.1.12.10.1.4","crlBag"),t("1.2.840.113549.1.12.10.1.5","secretBag"),t("1.2.840.113549.1.12.10.1.6","safeContentsBag"),t("1.2.840.113549.1.5.13","pkcs5PBES2"),t("1.2.840.113549.1.5.12","pkcs5PBKDF2"),t("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),t("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),t("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),t("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),t("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),t("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),t("1.2.840.113549.2.7","hmacWithSHA1"),t("1.2.840.113549.2.8","hmacWithSHA224"),t("1.2.840.113549.2.9","hmacWithSHA256"),t("1.2.840.113549.2.10","hmacWithSHA384"),t("1.2.840.113549.2.11","hmacWithSHA512"),t("1.2.840.113549.3.7","des-EDE3-CBC"),t("2.16.840.1.101.3.4.1.2","aes128-CBC"),t("2.16.840.1.101.3.4.1.22","aes192-CBC"),t("2.16.840.1.101.3.4.1.42","aes256-CBC"),t("2.5.4.3","commonName"),t("2.5.4.5","serialName"),t("2.5.4.6","countryName"),t("2.5.4.7","localityName"),t("2.5.4.8","stateOrProvinceName"),t("2.5.4.9","streetAddress"),t("2.5.4.10","organizationName"),t("2.5.4.11","organizationalUnitName"),t("2.5.4.13","description"),t("2.5.4.15","businessCategory"),t("2.5.4.17","postalCode"),t("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),t("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),t("2.16.840.1.113730.1.1","nsCertType"),t("2.16.840.1.113730.1.13","nsComment"),r("2.5.29.1","authorityKeyIdentifier"),r("2.5.29.2","keyAttributes"),r("2.5.29.3","certificatePolicies"),r("2.5.29.4","keyUsageRestriction"),r("2.5.29.5","policyMapping"),r("2.5.29.6","subtreesConstraint"),r("2.5.29.7","subjectAltName"),r("2.5.29.8","issuerAltName"),r("2.5.29.9","subjectDirectoryAttributes"),r("2.5.29.10","basicConstraints"),r("2.5.29.11","nameConstraints"),r("2.5.29.12","policyConstraints"),r("2.5.29.13","basicConstraints"),t("2.5.29.14","subjectKeyIdentifier"),t("2.5.29.15","keyUsage"),r("2.5.29.16","privateKeyUsagePeriod"),t("2.5.29.17","subjectAltName"),t("2.5.29.18","issuerAltName"),t("2.5.29.19","basicConstraints"),r("2.5.29.20","cRLNumber"),r("2.5.29.21","cRLReason"),r("2.5.29.22","expirationDate"),r("2.5.29.23","instructionCode"),r("2.5.29.24","invalidityDate"),r("2.5.29.25","cRLDistributionPoints"),r("2.5.29.26","issuingDistributionPoint"),r("2.5.29.27","deltaCRLIndicator"),r("2.5.29.28","issuingDistributionPoint"),r("2.5.29.29","certificateIssuer"),r("2.5.29.30","nameConstraints"),t("2.5.29.31","cRLDistributionPoints"),t("2.5.29.32","certificatePolicies"),r("2.5.29.33","policyMappings"),r("2.5.29.34","policyConstraints"),t("2.5.29.35","authorityKeyIdentifier"),r("2.5.29.36","policyConstraints"),t("2.5.29.37","extKeyUsage"),r("2.5.29.46","freshestCRL"),r("2.5.29.54","inhibitAnyPolicy"),t("1.3.6.1.4.1.11129.2.4.2","timestampList"),t("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),t("1.3.6.1.5.5.7.3.1","serverAuth"),t("1.3.6.1.5.5.7.3.2","clientAuth"),t("1.3.6.1.5.5.7.3.3","codeSigning"),t("1.3.6.1.5.5.7.3.4","emailProtection"),t("1.3.6.1.5.5.7.3.8","timeStamping")},function(n,s,e){function t(t){for(var n=t.name+": ",s=[],i=function(t,a){return" "+a},r=0;r<t.values.length;++r)s.push(t.values[r].replace(/^(\S+\r\n)/,i));n+=s.join(",")+"\r\n";for(var o=0,c=-1,r=0;r<n.length;++r,++o)if(65<o&&-1!==c){var d=n[c];","===d?(++c,n=n.substr(0,c)+"\r\n "+n.substr(c)):n=n.substr(0,c)+"\r\n"+d+n.substr(c+1),o=r-c-1,c=-1,++r}else" "!==n[r]&&"\t"!==n[r]&&","!==n[r]||(c=r);return n}function i(e){return e.replace(/^\s+/,"")}var l=e(0);e(1);var a=n.exports=l.pem=l.pem||{};a.encode=function(r,a){a=a||{};var n,s="-----BEGIN "+r.type+"-----\r\n";if(r.procType&&(n={name:"Proc-Type",values:[r.procType.version+"",r.procType.type]},s+=t(n)),r.contentDomain&&(n={name:"Content-Domain",values:[r.contentDomain]},s+=t(n)),r.dekInfo&&(n={name:"DEK-Info",values:[r.dekInfo.algorithm]},r.dekInfo.parameters&&n.values.push(r.dekInfo.parameters),s+=t(n)),r.headers)for(var c=0;c<r.headers.length;++c)s+=t(r.headers[c]);return r.procType&&(s+="\r\n"),s+=l.util.encode64(r.body,a.maxline||64)+"\r\n",s+="-----END "+r.type+"-----\r\n"},a.decode=function(t){for(var a,n=[];;){if(!(a=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g.exec(t)))break;var s={type:a[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:l.util.decode64(a[3])};if(n.push(s),a[2]){for(var r=a[2].split(/\r?\n/),p=0;a&&p<r.length;){for(var g,h=r[p].replace(/\s+$/,""),f=p+1;f<r.length&&(g=r[f],!!/\s/.test(g[0]));++f)h+=g,p=f;if(a=h.match(/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/)){for(var m={name:a[1],values:[]},E=a[2].split(","),d=0;d<E.length;++d)m.values.push(i(E[d]));if(!s.procType){if("Proc-Type"!==m.name)throw new Error("Invalid PEM formatted message. The first encapsulated header must be \"Proc-Type\".");if(2!==m.values.length)throw new Error("Invalid PEM formatted message. The \"Proc-Type\" header must have two subfields.");s.procType={version:E[0],type:E[1]}}else if(!(s.contentDomain||"Content-Domain"!==m.name))s.contentDomain=E[0]||"";else if(s.dekInfo||"DEK-Info"!==m.name)s.headers.push(m);else{if(0===m.values.length)throw new Error("Invalid PEM formatted message. The \"DEK-Info\" header must have at least one subfield.");s.dekInfo={algorithm:E[0],parameters:E[1]||null}}}++p}if("ENCRYPTED"===s.procType&&!s.dekInfo)throw new Error("Invalid PEM formatted message. The \"DEK-Info\" header must be present if \"Proc-Type\" is \"ENCRYPTED\".")}}if(0===n.length)throw new Error("Invalid PEM formatted message.");return n}},function(a,r,e){var s=e(0);e(4),e(1),(a.exports=s.hmac=s.hmac||{}).create=function(){var i=null,o=null,c=null,e=null,t={};return t.start=function(a,d){if(null!==a)if("string"==typeof a){if(!((a=a.toLowerCase())in s.md.algorithms))throw new Error("Unknown hash algorithm \""+a+"\"");o=s.md.algorithms[a].create()}else o=a;if(null===d)d=i;else{if("string"==typeof d)d=s.util.createBuffer(d);else if(s.util.isArray(d)){var l=d;d=s.util.createBuffer();for(var p=0;p<l.length;++p)d.putByte(l[p])}var u=d.length();u>o.blockLength&&(o.start(),o.update(d.bytes()),d=o.digest()),c=s.util.createBuffer(),e=s.util.createBuffer(),u=d.length();for(var l,p=0;p<u;++p)l=d.at(p),c.putByte(54^l),e.putByte(92^l);if(u<o.blockLength)for(var l=o.blockLength-u,p=0;p<l;++p)c.putByte(54),e.putByte(92);i=d,c=c.bytes(),e=e.bytes()}o.start(),o.update(c)},t.update=function(e){o.update(e)},t.getMac=function(){var a=o.digest().bytes();return o.start(),o.update(e),o.update(a),o.digest()},t.digest=t.getMac,t}},function(r,s,e){function t(){y=String.fromCharCode(128),y+=g.util.fillString(String.fromCharCode(0),64),a=!0}function l(a,n,e){for(var t,s,i,o,c,d,l,p,u=e.length();64<=u;){for(s=a.h0,i=a.h1,o=a.h2,c=a.h3,d=a.h4,p=0;16>p;++p)t=e.getInt32(),n[p]=t,l=c^i&(o^c),t=(s<<5|s>>>27)+l+d+1518500249+t,d=c,c=o,o=(i<<30|i>>>2)>>>0,i=s,s=t;for(;20>p;++p)t=n[p-3]^n[p-8]^n[p-14]^n[p-16],t=t<<1|t>>>31,n[p]=t,l=c^i&(o^c),t=(s<<5|s>>>27)+l+d+1518500249+t,d=c,c=o,o=(i<<30|i>>>2)>>>0,i=s,s=t;for(;32>p;++p)t=n[p-3]^n[p-8]^n[p-14]^n[p-16],t=t<<1|t>>>31,n[p]=t,l=i^o^c,t=(s<<5|s>>>27)+l+d+1859775393+t,d=c,c=o,o=(i<<30|i>>>2)>>>0,i=s,s=t;for(;40>p;++p)t=n[p-6]^n[p-16]^n[p-28]^n[p-32],t=t<<2|t>>>30,n[p]=t,l=i^o^c,t=(s<<5|s>>>27)+l+d+1859775393+t,d=c,c=o,o=(i<<30|i>>>2)>>>0,i=s,s=t;for(;60>p;++p)t=n[p-6]^n[p-16]^n[p-28]^n[p-32],t=t<<2|t>>>30,n[p]=t,l=i&o|c&(i^o),t=(s<<5|s>>>27)+l+d+2400959708+t,d=c,c=o,o=(i<<30|i>>>2)>>>0,i=s,s=t;for(;80>p;++p)t=n[p-6]^n[p-16]^n[p-28]^n[p-32],t=t<<2|t>>>30,n[p]=t,l=i^o^c,t=(s<<5|s>>>27)+l+d+3395469782+t,d=c,c=o,o=(i<<30|i>>>2)>>>0,i=s,s=t;a.h0=0|a.h0+s,a.h1=0|a.h1+i,a.h2=0|a.h2+o,a.h3=0|a.h3+c,a.h4=0|a.h4+d,u-=64}}var g=e(0);e(4),e(1);var n=r.exports=g.sha1=g.sha1||{};g.md.sha1=g.md.algorithms.sha1=n,n.create=function(){a||t();var n=null,i=g.util.createBuffer(),p=Array(80),h={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return h.start=function(){h.messageLength=0,h.fullMessageLength=h.messageLength64=[];for(var a=h.messageLengthSize/4,e=0;e<a;++e)h.fullMessageLength.push(0);return i=g.util.createBuffer(),n={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},h},h.start(),h.update=function(a,o){"utf8"===o&&(a=g.util.encodeUtf8(a));var t=a.length;h.messageLength+=t,t=[t/4294967296>>>0,t>>>0];for(var c=h.fullMessageLength.length-1;0<=c;--c)h.fullMessageLength[c]+=t[1],t[1]=t[0]+(h.fullMessageLength[c]/4294967296>>>0),h.fullMessageLength[c]>>>=0,t[0]=t[1]/4294967296>>>0;return i.putBytes(a),l(n,p,i),(2048<i.read||0===i.length())&&i.compact(),h},h.digest=function(){var f=g.util.createBuffer();f.putBytes(i.bytes());var e=h.fullMessageLength[h.fullMessageLength.length-1]+h.messageLengthSize,t=e&h.blockLength-1;f.putBytes(y.substr(0,h.blockLength-t));for(var a,m,C=8*h.fullMessageLength[0],E=0;E<h.fullMessageLength.length-1;++E)a=8*h.fullMessageLength[E+1],m=a/4294967296>>>0,C+=m,f.putInt32(C>>>0),C=a>>>0;f.putInt32(C);var S={h0:n.h0,h1:n.h1,h2:n.h2,h3:n.h3,h4:n.h4};l(S,p,f);var u=g.util.createBuffer();return u.putInt32(S.h0),u.putInt32(S.h1),u.putInt32(S.h2),u.putInt32(S.h3),u.putInt32(S.h4),u},h};var y=null,a=!1},function(o,g,e){function t(t,a){C.cipher.registerAlgorithm(t,function(){return new C.des.Algorithm(t,a)})}function y(t){for(var C,E=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],S=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],r=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],a=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],n=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],i=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],s=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],o=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],l=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],p=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],f=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],h=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],d=8<t.length()?3:1,y=[],g=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],T=0,I=0;I<d;I++){var B=t.getInt32(),A=t.getInt32();C=252645135&(B>>>4^A),A^=C,B^=C<<4,C=65535&(A>>>-16^B),B^=C,A^=C<<-16,C=858993459&(B>>>2^A),A^=C,B^=C<<2,C=65535&(A>>>-16^B),B^=C,A^=C<<-16,C=1431655765&(B>>>1^A),A^=C,B^=C<<1,C=16711935&(A>>>8^B),B^=C,A^=C<<8,C=1431655765&(B>>>1^A),A^=C,B^=C<<1,C=B<<8|240&A>>>20,B=A<<24|16711680&A<<8|65280&A>>>8|240&A>>>24,A=C;for(var v=0;v<g.length;++v){g[v]?(B=B<<2|B>>>26,A=A<<2|A>>>26):(B=B<<1|B>>>27,A=A<<1|A>>>27),B&=-15,A&=-15;var N=E[B>>>28]|S[15&B>>>24]|r[15&B>>>20]|a[15&B>>>16]|n[15&B>>>12]|i[15&B>>>8]|s[15&B>>>4],U=o[A>>>28]|c[15&A>>>24]|u[15&A>>>20]|l[15&A>>>16]|p[15&A>>>12]|f[15&A>>>8]|h[15&A>>>4];C=65535&(U>>>16^N),y[T++]=N^C,y[T++]=U^C<<16}}return y}function r(n,o,e,t){var r,d=32===n.length?3:9;r=3==d?t?[30,-2,-2]:[0,32,2]:t?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var g,y=o[0],m=o[1];g=252645135&(y>>>4^m),m^=g,y^=g<<4,g=65535&(y>>>16^m),m^=g,y^=g<<16,g=858993459&(m>>>2^y),y^=g,m^=g<<2,g=16711935&(m>>>8^y),y^=g,m^=g<<8,g=1431655765&(y>>>1^m),m^=g,y^=g<<1,y=y<<1|y>>>31,m=m<<1|m>>>31;for(var E=0;E<d;E+=3){for(var T=r[E+1],I=r[E+2],v=r[E];v!=T;v+=I){var N=m^n[v],R=(m>>>4|m<<28)^n[v+1];g=y,y=m,m=g^(s[63&N>>>24]|u[63&N>>>16]|p[63&N>>>8]|h[63&N]|a[63&R>>>24]|c[63&R>>>16]|l[63&R>>>8]|f[63&R])}g=y,y=m,m=g}y=y>>>1|y<<31,m=m>>>1|m<<31,g=1431655765&(y>>>1^m),m^=g,y^=g<<1,g=16711935&(m>>>8^y),y^=g,m^=g<<8,g=858993459&(m>>>2^y),y^=g,m^=g<<2,g=65535&(y>>>16^m),m^=g,y^=g<<16,g=252645135&(y>>>4^m),m^=g,y^=g<<4,e[0]=y,e[1]=m}function n(e){e=e||{};var a,t=(e.mode||"CBC").toUpperCase(),n="DES-"+t;a=e.decrypt?C.cipher.createDecipher(n,e.key):C.cipher.createCipher(n,e.key);var r=a.start;return a.start=function(s,t){var i=null;t instanceof C.util.ByteBuffer&&(i=t,t={}),t=t||{},t.output=i,t.iv=s,r.call(a,t)},a}var C=e(0);e(13),e(19),e(1),o.exports=C.des=C.des||{},C.des.startEncrypting=function(i,s,e,t){var r=n({key:i,output:e,decrypt:!1,mode:t||(null===s?"ECB":"CBC")});return r.start(s),r},C.des.createEncryptionCipher=function(t,a){return n({key:t,output:null,decrypt:!1,mode:a})},C.des.startDecrypting=function(i,s,e,t){var r=n({key:i,output:e,decrypt:!0,mode:t||(null===s?"ECB":"CBC")});return r.start(s),r},C.des.createDecryptionCipher=function(t,a){return n({key:t,output:null,decrypt:!0,mode:a})},C.des.Algorithm=function(t,a){var n=this;n.name=t,n.mode=new a({blockSize:8,cipher:{encrypt:function(t,a){return r(n._keys,t,a,!1)},decrypt:function(t,a){return r(n._keys,t,a,!0)}}}),n._init=!1},C.des.Algorithm.prototype.initialize=function(t){if(!this._init){var a=C.util.createBuffer(t.key);if(0===this.name.indexOf("3DES")&&24!==a.length())throw new Error("Invalid Triple-DES key size: "+8*a.length());this._keys=y(a),this._init=!0}},t("DES-ECB",C.cipher.modes.ecb),t("DES-CBC",C.cipher.modes.cbc),t("DES-CFB",C.cipher.modes.cfb),t("DES-OFB",C.cipher.modes.ofb),t("DES-CTR",C.cipher.modes.ctr),t("3DES-ECB",C.cipher.modes.ecb),t("3DES-CBC",C.cipher.modes.cbc),t("3DES-CFB",C.cipher.modes.cfb),t("3DES-OFB",C.cipher.modes.ofb),t("3DES-CTR",C.cipher.modes.ctr);var a=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],s=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],c=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],u=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],l=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],p=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],f=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],h=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696]},function(S,T,e){function I(s,o,e){var t=R.util.createBuffer(),r=Math.ceil(o.n.bitLength()/8);if(s.length>r-11){var a=new Error("Message is too long for PKCS#1 v1.5 padding.");throw a.length=s.length,a.max=r-11,a}t.putByte(0),t.putByte(e);var n,c=r-3-s.length;if(0===e||1===e){n=0===e?0:255;for(var d=0;d<c;++d)t.putByte(n)}else for(;0<c;){for(var l=0,u=R.random.getBytes(c),d=0;d<c;++d)n=u.charCodeAt(d),0===n?++l:t.putByte(n);c=l}return t.putByte(0),t.putBytes(s),t}function B(c,d,e,t){var r=Math.ceil(d.n.bitLength()/8),a=R.util.createBuffer(c),n=a.getByte(),i=a.getByte();if(0!==n||e&&0!==i&&1!==i||!e&&2!=i||e&&0===i&&void 0===t)throw new Error("Encryption block is invalid.");var s=0;if(0===i){s=r-3-t;for(var p=0;p<s;++p)if(0!==a.getByte())throw new Error("Encryption block is invalid.")}else if(1===i)for(s=0;1<a.length();){if(255!==a.getByte()){--a.read;break}++s}else if(2===i)for(s=0;1<a.length();){if(0===a.getByte()){--a.read;break}++s}if(0!==a.getByte()||s!==r-3-a.length())throw new Error("Encryption block is invalid.");return a.getBytes()}function t(s,t,i){function o(){c(s.pBits,function(a,e){return a?i(a):(s.p=e,null===s.q?void c(s.qBits,d):d(a,s.q))})}function c(t,a){R.prime.generateProbablePrime(t,n,a)}function d(n,e){if(n)return i(n);if(s.q=e,0>s.p.compareTo(s.q)){var t=s.p;s.p=s.q,s.q=t}if(0!==s.p.subtract(L.ONE).gcd(s.e).compareTo(L.ONE))return s.p=null,void o();if(0!==s.q.subtract(L.ONE).gcd(s.e).compareTo(L.ONE))return s.q=null,void c(s.qBits,d);if(s.p1=s.p.subtract(L.ONE),s.q1=s.q.subtract(L.ONE),s.phi=s.p1.multiply(s.q1),0!==s.phi.gcd(s.e).compareTo(L.ONE))return s.p=s.q=null,void o();if(s.n=s.p.multiply(s.q),s.n.bitLength()!==s.bits)return s.q=null,void c(s.qBits,d);var a=s.e.modInverse(s.phi);s.keys={privateKey:k.rsa.setPrivateKey(s.n,s.e,a,s.p,s.q,a.mod(s.p1),a.mod(s.q1),s.q.modInverse(s.p)),publicKey:k.rsa.setPublicKey(s.n,s.e)},i(null,s.keys)}"function"==typeof t&&(i=t,t={}),t=t||{};var n={algorithm:{name:t.algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};"prng"in t&&(n.prng=t.prng),o()}function A(t){var a=t.toString(16);"8"<=a[0]&&(a="00"+a);var r=R.util.hexToBytes(a);return 1<r.length&&(0===r.charCodeAt(0)&&0==(128&r.charCodeAt(1))||255===r.charCodeAt(0)&&128==(128&r.charCodeAt(1)))?r.substr(1):r}function a(e){return 100>=e?27:150>=e?18:200>=e?15:250>=e?12:300>=e?9:350>=e?8:400>=e?7:500>=e?6:600>=e?5:800>=e?4:1250>=e?3:2}function b(e){return R.util.isNodejs&&"function"==typeof o[e]}function s(e){return void 0!==c.globalScope&&"object"==typeof c.globalScope.crypto&&"object"==typeof c.globalScope.crypto.subtle&&"function"==typeof c.globalScope.crypto.subtle[e]}function r(e){return void 0!==c.globalScope&&"object"==typeof c.globalScope.msCrypto&&"object"==typeof c.globalScope.msCrypto.subtle&&"function"==typeof c.globalScope.msCrypto.subtle[e]}function i(a){for(var n=R.util.hexToBytes(a.toString(16)),e=new Uint8Array(n.length),t=0;t<n.length;++t)e[t]=n.charCodeAt(t);return e}var R=e(0);if(e(3),e(12),e(6),e(26),e(27),e(2),e(1),void 0===L)var L=R.jsbn.BigInteger;var o=R.util.isNodejs?e(16):null,_=R.asn1,c=R.util;R.pki=R.pki||{},S.exports=R.pki.rsa=R.rsa=R.rsa||{};var k=R.pki,l=[6,4,2,4,2,4,6,2],d={name:"PrivateKeyInfo",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:_.Class.UNIVERSAL,type:_.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:_.Class.UNIVERSAL,type:_.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:_.Class.UNIVERSAL,type:_.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},p={name:"RSAPrivateKey",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:_.Class.UNIVERSAL,type:_.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:_.Class.UNIVERSAL,type:_.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:_.Class.UNIVERSAL,type:_.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:_.Class.UNIVERSAL,type:_.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:_.Class.UNIVERSAL,type:_.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:_.Class.UNIVERSAL,type:_.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:_.Class.UNIVERSAL,type:_.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:_.Class.UNIVERSAL,type:_.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:_.Class.UNIVERSAL,type:_.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},g={name:"RSAPublicKey",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:_.Class.UNIVERSAL,type:_.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:_.Class.UNIVERSAL,type:_.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},u=R.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:_.Class.UNIVERSAL,type:_.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:_.Class.UNIVERSAL,type:_.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},y=function(t){var s;if(!(t.algorithm in k.oids)){var o=new Error("Unknown message digest algorithm.");throw o.algorithm=t.algorithm,o}s=k.oids[t.algorithm];var c=_.oidToDer(s).getBytes(),r=_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[]),a=_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[]);a.value.push(_.create(_.Class.UNIVERSAL,_.Type.OID,!1,c)),a.value.push(_.create(_.Class.UNIVERSAL,_.Type.NULL,!1,""));var n=_.create(_.Class.UNIVERSAL,_.Type.OCTETSTRING,!1,t.digest().getBytes());return r.value.push(a),r.value.push(n),_.toDer(r).getBytes()},n=function(e,a,n){if(n)return e.modPow(a.e,a.n);if(!a.p||!a.q)return e.modPow(a.d,a.n);a.dP||(a.dP=a.d.mod(a.p.subtract(L.ONE))),a.dQ||(a.dQ=a.d.mod(a.q.subtract(L.ONE))),a.qInv||(a.qInv=a.q.modInverse(a.p));var t;do t=new L(R.util.bytesToHex(R.random.getBytes(a.n.bitLength()/8)),16);while(0<=t.compareTo(a.n)||!t.gcd(a.n).equals(L.ONE));e=e.multiply(t.modPow(a.e,a.n)).mod(a.n);for(var s=e.mod(a.p).modPow(a.dP,a.p),c=e.mod(a.q).modPow(a.dQ,a.q);0>s.compareTo(c);)s=s.add(a.p);var l=s.subtract(c).multiply(a.qInv).mod(a.p).multiply(a.q).add(c);return l=l.multiply(t.modInverse(a.n)).mod(a.n)};k.rsa.encrypt=function(i,a,e){var t,p=e,y=Math.ceil(a.n.bitLength()/8);!1!==e&&!0!==e?(p=2===e,t=I(i,a,e)):(t=R.util.createBuffer(),t.putBytes(i));for(var g=new L(t.toHex(),16),s=n(g,a,p),o=s.toString(16),c=R.util.createBuffer(),u=y-Math.ceil(o.length/2);0<u;)c.putByte(0),--u;return c.putBytes(R.util.hexToBytes(o)),c.getBytes()},k.rsa.decrypt=function(p,u,e,t){var r=Math.ceil(u.n.bitLength()/8);if(p.length!==r){var a=new Error("Encrypted message length is invalid.");throw a.length=p.length,a.expected=r,a}var i=new L(R.util.createBuffer(p).toHex(),16);if(0<=i.compareTo(u.n))throw new Error("Encrypted message is invalid.");for(var s=n(i,u,e),o=s.toString(16),c=R.util.createBuffer(),d=r-Math.ceil(o.length/2);0<d;)c.putByte(0),--d;return c.putBytes(R.util.hexToBytes(o)),!1===t?c.getBytes():B(c.getBytes(),u,e)},k.rsa.createKeyPairGenerationState=function(e,a,r){"string"==typeof e&&(e=parseInt(e,10)),e=e||2048,r=r||{};var s,o=r.prng||R.random,d=r.algorithm||"PRIMEINC";if("PRIMEINC"!==d)throw new Error("Invalid key generation algorithm: "+d);return s={algorithm:d,state:0,bits:e,rng:{nextBytes:function(r){for(var a=o.getBytesSync(r.length),e=0;e<r.length;++e)r[e]=a.charCodeAt(e)}},eInt:a||65537,e:new L(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null},s.e.fromInt(s.eInt),s},k.rsa.stepKeyPairGenerationState=function(n,s){"algorithm"in n||(n.algorithm="PRIMEINC");var e=new L(null);e.fromInt(30);for(var t,o=0,c=function(t,a){return t|a},p=+new Date,g=0;null===n.keys&&(0>=s||g<s);){if(0===n.state){var y=null===n.p?n.pBits:n.qBits,h=y-1;0===n.pqState?(n.num=new L(y,n.rng),n.num.testBit(h)||n.num.bitwiseTo(L.ONE.shiftLeft(h),c,n.num),n.num.dAddOffset(31-n.num.mod(e).byteValue(),0),o=0,++n.pqState):1===n.pqState?n.num.bitLength()>y?n.pqState=0:n.num.isProbablePrime(a(n.num.bitLength()))?++n.pqState:n.num.dAddOffset(l[o++%8],0):2===n.pqState?n.pqState=0===n.num.subtract(L.ONE).gcd(n.e).compareTo(L.ONE)?3:0:3===n.pqState&&(n.pqState=0,null===n.p?n.p=n.num:n.q=n.num,null!==n.p&&null!==n.q&&++n.state,n.num=null)}else if(1===n.state)0>n.p.compareTo(n.q)&&(n.num=n.p,n.p=n.q,n.q=n.num),++n.state;else if(2===n.state)n.p1=n.p.subtract(L.ONE),n.q1=n.q.subtract(L.ONE),n.phi=n.p1.multiply(n.q1),++n.state;else if(3===n.state)0===n.phi.gcd(n.e).compareTo(L.ONE)?++n.state:(n.p=null,n.q=null,n.state=0);else if(4===n.state)n.n=n.p.multiply(n.q),n.n.bitLength()===n.bits?++n.state:(n.q=null,n.state=0);else if(5===n.state){var u=n.e.modInverse(n.phi);n.keys={privateKey:k.rsa.setPrivateKey(n.n,n.e,u,n.p,n.q,u.mod(n.p1),u.mod(n.q1),n.q.modInverse(n.p)),publicKey:k.rsa.setPublicKey(n.n,n.e)}}t=+new Date,g+=t-p,p=t}return null!==n.keys},k.rsa.generateKeyPair=function(e,a,d,l){if(1===arguments.length?"object"==typeof e?(d=e,e=void 0):"function"==typeof e&&(l=e,e=void 0):2===arguments.length?"number"==typeof e?"function"==typeof a?(l=a,a=void 0):"number"!=typeof a&&(d=a,a=void 0):(d=e,l=a,e=void 0,a=void 0):3===arguments.length&&("number"==typeof a?"function"==typeof d&&(l=d,d=void 0):(l=d,d=a,a=void 0)),d=d||{},void 0===e&&(e=d.bits||2048),void 0===a&&(a=d.e||65537),!R.options.usePureJavaScript&&!d.prng&&256<=e&&16384>=e&&(65537===a||3===a))if(l){if(b("generateKeyPair"))return o.generateKeyPair("rsa",{modulusLength:e,publicExponent:a,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(r,a,e){return r?l(r):void l(null,{privateKey:k.privateKeyFromPem(e),publicKey:k.publicKeyFromPem(a)})});if(s("generateKey")&&s("exportKey"))return c.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:i(a),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(e){return c.globalScope.crypto.subtle.exportKey("pkcs8",e.privateKey)}).then(void 0,function(e){l(e)}).then(function(t){if(t){var a=k.privateKeyFromAsn1(_.fromDer(R.util.createBuffer(t)));l(null,{privateKey:a,publicKey:k.setRsaPublicKey(a.n,a.e)})}});if(r("generateKey")&&r("exportKey")){var p=c.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:i(a),hash:{name:"SHA-256"}},!0,["sign","verify"]);return p.oncomplete=function(r){var a=r.target.result,e=c.globalScope.msCrypto.subtle.exportKey("pkcs8",a.privateKey);e.oncomplete=function(r){var a=r.target.result,e=k.privateKeyFromAsn1(_.fromDer(R.util.createBuffer(a)));l(null,{privateKey:e,publicKey:k.setRsaPublicKey(e.n,e.e)})},e.onerror=function(e){l(e)}},void(p.onerror=function(e){l(e)})}}else if(b("generateKeyPairSync")){var g=o.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:a,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:k.privateKeyFromPem(g.privateKey),publicKey:k.publicKeyFromPem(g.publicKey)}}var n=k.rsa.createKeyPairGenerationState(e,a,d);return l?void t(n,d,l):(k.rsa.stepKeyPairGenerationState(n,0),n.keys)},k.setRsaPublicKey=k.rsa.setPublicKey=function(t,a){var i={n:t,e:a};return i.encrypt=function(t,a,s){if("string"==typeof a?a=a.toUpperCase():void 0===a&&(a="RSAES-PKCS1-V1_5"),"RSAES-PKCS1-V1_5"===a)a={encode:function(t,a){return I(t,a,2).getBytes()}};else if("RSA-OAEP"===a||"RSAES-OAEP"===a)a={encode:function(t,a){return R.pkcs1.encode_rsa_oaep(a,t,s)}};else if(-1!==["RAW","NONE","NULL",null].indexOf(a))a={encode:function(e){return e}};else if("string"==typeof a)throw new Error("Unsupported encryption scheme: \""+a+"\".");var r=a.encode(t,i,!0);return k.rsa.encrypt(r,i,!0)},i.verify=function(a,r,e){"string"==typeof e?e=e.toUpperCase():void 0===e&&(e="RSASSA-PKCS1-V1_5"),"RSASSA-PKCS1-V1_5"===e?e={verify:function(t,a){return a=B(a,i,!0),t===_.fromDer(a).value[1].value}}:"NONE"!==e&&"NULL"!==e&&null!==e||(e={verify:function(t,a){return a=B(a,i,!0),t===a}});var s=k.rsa.decrypt(r,i,!0,!1);return e.verify(a,s,i.n.bitLength())},i},k.setRsaPrivateKey=k.rsa.setPrivateKey=function(n,d,e,t,r,a,i,s){var l={n:n,e:d,d:e,p:t,q:r,dP:a,dQ:i,qInv:s};return l.decrypt=function(t,a,n){"string"==typeof a?a=a.toUpperCase():void 0===a&&(a="RSAES-PKCS1-V1_5");var s=k.rsa.decrypt(t,l,!1,!1);if("RSAES-PKCS1-V1_5"===a)a={decode:B};else if("RSA-OAEP"===a||"RSAES-OAEP"===a)a={decode:function(t,a){return R.pkcs1.decode_rsa_oaep(a,t,n)}};else{if(-1===["RAW","NONE","NULL",null].indexOf(a))throw new Error("Unsupported encryption scheme: \""+a+"\".");a={decode:function(e){return e}}}return a.decode(s,l,!1)},l.sign=function(t,a){var r=!1;"string"==typeof a&&(a=a.toUpperCase()),void 0===a||"RSASSA-PKCS1-V1_5"===a?(a={encode:y},r=1):"NONE"!==a&&"NULL"!==a&&null!==a||(a={encode:function(){return t}},r=1);var n=a.encode(t,l.n.bitLength());return k.rsa.encrypt(n,l,r)},l},k.wrapRsaPrivateKey=function(e){return _.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.INTEGER,!1,_.integerToDer(0).getBytes()),_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OID,!1,_.oidToDer(k.oids.rsaEncryption).getBytes()),_.create(_.Class.UNIVERSAL,_.Type.NULL,!1,"")]),_.create(_.Class.UNIVERSAL,_.Type.OCTETSTRING,!1,_.toDer(e).getBytes())])},k.privateKeyFromAsn1=function(e){var t={},r=[];if(_.validate(e,d,t,r)&&(e=_.fromDer(R.util.createBuffer(t.privateKey))),t={},r=[],!_.validate(e,p,t,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var s,i,o,c,l,u,g,h;return s=R.util.createBuffer(t.privateKeyModulus).toHex(),i=R.util.createBuffer(t.privateKeyPublicExponent).toHex(),o=R.util.createBuffer(t.privateKeyPrivateExponent).toHex(),c=R.util.createBuffer(t.privateKeyPrime1).toHex(),l=R.util.createBuffer(t.privateKeyPrime2).toHex(),u=R.util.createBuffer(t.privateKeyExponent1).toHex(),g=R.util.createBuffer(t.privateKeyExponent2).toHex(),h=R.util.createBuffer(t.privateKeyCoefficient).toHex(),k.setRsaPrivateKey(new L(s,16),new L(i,16),new L(o,16),new L(c,16),new L(l,16),new L(u,16),new L(g,16),new L(h,16))},k.privateKeyToAsn1=k.privateKeyToRSAPrivateKey=function(e){return _.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.INTEGER,!1,_.integerToDer(0).getBytes()),_.create(_.Class.UNIVERSAL,_.Type.INTEGER,!1,A(e.n)),_.create(_.Class.UNIVERSAL,_.Type.INTEGER,!1,A(e.e)),_.create(_.Class.UNIVERSAL,_.Type.INTEGER,!1,A(e.d)),_.create(_.Class.UNIVERSAL,_.Type.INTEGER,!1,A(e.p)),_.create(_.Class.UNIVERSAL,_.Type.INTEGER,!1,A(e.q)),_.create(_.Class.UNIVERSAL,_.Type.INTEGER,!1,A(e.dP)),_.create(_.Class.UNIVERSAL,_.Type.INTEGER,!1,A(e.dQ)),_.create(_.Class.UNIVERSAL,_.Type.INTEGER,!1,A(e.qInv))])},k.publicKeyFromAsn1=function(e){var r={},n=[];if(_.validate(e,u,r,n)){var s=_.derToOid(r.publicKeyOid);if(s!==k.oids.rsaEncryption){var c=new Error("Cannot read public key. Unknown OID.");throw c.oid=s,c}e=r.rsaPublicKey}if(n=[],!_.validate(e,g,r,n)){var c=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw c.errors=n,c}var d=R.util.createBuffer(r.publicKeyModulus).toHex(),l=R.util.createBuffer(r.publicKeyExponent).toHex();return k.setRsaPublicKey(new L(d,16),new L(l,16))},k.publicKeyToAsn1=k.publicKeyToSubjectPublicKeyInfo=function(e){return _.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OID,!1,_.oidToDer(k.oids.rsaEncryption).getBytes()),_.create(_.Class.UNIVERSAL,_.Type.NULL,!1,"")]),_.create(_.Class.UNIVERSAL,_.Type.BITSTRING,!1,[k.publicKeyToRSAPublicKey(e)])])},k.publicKeyToRSAPublicKey=function(e){return _.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.INTEGER,!1,A(e.n)),_.create(_.Class.UNIVERSAL,_.Type.INTEGER,!1,A(e.e))])}},function(a,d,e){function U(r,a,e){this.data=[],null!=r&&("number"==typeof r?this.fromNumber(r,a,e):null==a&&"string"!=typeof r?this.fromString(r,256):this.fromString(r,a))}function D(){return new U(null)}function t(e,a,n,t,i,c){for(var l=32767&a,p=a>>15;0<=--c;){var s=32767&this.data[e],h=this.data[e++]>>15,f=p*s+h*l;s=l*s+((32767&f)<<15)+n.data[t]+(1073741823&i),i=(s>>>30)+(f>>>15)+p*h+(i>>>30),n.data[t++]=1073741823&s}return i}function r(e,a,n,t,i,c){for(var l=16383&a,p=a>>14;0<=--c;){var s=16383&this.data[e],h=this.data[e++]>>14,f=p*s+h*l;s=l*s+((16383&f)<<14)+n.data[t]+i,i=(s>>28)+(f>>14)+p*h,n.data[t++]=268435455&s}return i}function n(e){return P.charAt(e)}function i(r,a){var e=R[r.charCodeAt(a)];return null==e?-1:e}function I(t){var a=D();return a.fromInt(t),a}function m(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function B(e){this.m=e}function f(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function p(t,a){return t&a}function s(t,a){return t|a}function o(t,a){return t^a}function c(t,a){return t&~a}function l(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function u(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function g(){}function y(e){return e}function h(e){this.r2=D(),this.q3=D(),U.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function C(){return{nextBytes:function(t){for(var a=0;a<t.length;++a)t[a]=Math.floor(256*Math.random())}}}var E=e(0);a.exports=E.jsbn=E.jsbn||{};var S;E.jsbn.BigInteger=U,"undefined"==typeof navigator?(U.prototype.am=r,S=28):"Microsoft Internet Explorer"==navigator.appName?(U.prototype.am=t,S=30):"Netscape"==navigator.appName?(U.prototype.am=r,S=28):(U.prototype.am=function(e,a,n,t,s,i){for(;0<=--i;){var c=a*this.data[e++]+n.data[t]+s;s=Math.floor(c/67108864),n.data[t++]=67108863&c}return s},S=26),U.prototype.DB=S,U.prototype.DM=(1<<S)-1,U.prototype.DV=1<<S,U.prototype.FV=Math.pow(2,52),U.prototype.F1=52-S,U.prototype.F2=2*S-52;var T,A,P="0123456789abcdefghijklmnopqrstuvwxyz",R=[];for(T=48,A=0;9>=A;++A)R[T++]=A;for(T=97,A=10;36>A;++A)R[T++]=A;for(T=65,A=10;36>A;++A)R[T++]=A;B.prototype.convert=function(e){return 0>e.s||0<=e.compareTo(this.m)?e.mod(this.m):e},B.prototype.revert=function(e){return e},B.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},B.prototype.mulTo=function(r,a,e){r.multiplyTo(a,e),this.reduce(e)},B.prototype.sqrTo=function(t,a){t.squareTo(a),this.reduce(a)},f.prototype.convert=function(t){var a=D();return t.abs().dlShiftTo(this.m.t,a),a.divRemTo(this.m,null,a),0>t.s&&0<a.compareTo(U.ZERO)&&this.m.subTo(a,a),a},f.prototype.revert=function(t){var a=D();return t.copyTo(a),this.reduce(a),a},f.prototype.reduce=function(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var a=0;a<this.m.t;++a){var r=32767&t.data[a],n=r*this.mpl+((r*this.mph+(t.data[a]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=a+this.m.t,t.data[r]+=this.m.am(0,n,t,a,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),0<=t.compareTo(this.m)&&t.subTo(this.m,t)},f.prototype.mulTo=function(r,a,e){r.multiplyTo(a,e),this.reduce(e)},f.prototype.sqrTo=function(t,a){t.squareTo(a),this.reduce(a)},U.prototype.copyTo=function(t){for(var a=this.t-1;0<=a;--a)t.data[a]=this.data[a];t.t=this.t,t.s=this.s},U.prototype.fromInt=function(e){this.t=1,this.s=0>e?-1:0,0<e?this.data[0]=e:-1>e?this.data[0]=e+this.DV:this.t=0},U.prototype.fromString=function(r,a){var e;if(16==a)e=4;else if(8==a)e=3;else if(256==a)e=8;else if(2==a)e=1;else if(32==a)e=5;else{if(4!=a)return void this.fromRadix(r,a);e=2}this.t=0,this.s=0;for(var n,s=r.length,o=!1,p=0;0<=--s;)n=8==e?255&r[s]:i(r,s),0>n?"-"==r.charAt(s)&&(o=!0):(o=!1,0==p?this.data[this.t++]=n:p+e>this.DB?(this.data[this.t-1]|=(n&(1<<this.DB-p)-1)<<p,this.data[this.t++]=n>>this.DB-p):this.data[this.t-1]|=n<<p,(p+=e)>=this.DB&&(p-=this.DB));8==e&&0!=(128&r[0])&&(this.s=-1,0<p&&(this.data[this.t-1]|=(1<<this.DB-p)-1<<p)),this.clamp(),o&&U.ZERO.subTo(this,this)},U.prototype.clamp=function(){for(var e=this.s&this.DM;0<this.t&&this.data[this.t-1]==e;)--this.t},U.prototype.dlShiftTo=function(r,a){var e;for(e=this.t-1;0<=e;--e)a.data[e+r]=this.data[e];for(e=r-1;0<=e;--e)a.data[e]=0;a.t=this.t+r,a.s=this.s},U.prototype.drShiftTo=function(r,a){for(var e=r;e<this.t;++e)a.data[e-r]=this.data[e];a.t=Math.max(this.t-r,0),a.s=this.s},U.prototype.lShiftTo=function(r,i){var e,o=r%this.DB,c=this.DB-o,a=Math.floor(r/this.DB),n=this.s<<o&this.DM;for(e=this.t-1;0<=e;--e)i.data[e+a+1]=this.data[e]>>c|n,n=(this.data[e]&(1<<c)-1)<<o;for(e=a-1;0<=e;--e)i.data[e]=0;i.data[a]=n,i.t=this.t+a+1,i.s=this.s,i.clamp()},U.prototype.rShiftTo=function(s,o){o.s=this.s;var e=Math.floor(s/this.DB);if(e>=this.t)return void(o.t=0);var t=s%this.DB,r=this.DB-t,a=(1<<t)-1;o.data[0]=this.data[e]>>t;for(var n=e+1;n<this.t;++n)o.data[n-e-1]|=(this.data[n]&a)<<r,o.data[n-e]=this.data[n]>>t;0<t&&(o.data[this.t-e-1]|=(this.s&a)<<r),o.t=this.t-e,o.clamp()},U.prototype.subTo=function(a,r){for(var e=0,n=0,s=Math.min(a.t,this.t);e<s;)n+=this.data[e]-a.data[e],r.data[e++]=n&this.DM,n>>=this.DB;if(a.t<this.t){for(n-=a.s;e<this.t;)n+=this.data[e],r.data[e++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;e<a.t;)n-=a.data[e],r.data[e++]=n&this.DM,n>>=this.DB;n-=a.s}r.s=0>n?-1:0,-1>n?r.data[e++]=this.DV+n:0<n&&(r.data[e++]=n),r.t=e,r.clamp()},U.prototype.multiplyTo=function(s,a){var e=this.abs(),t=s.abs(),r=e.t;for(a.t=r+t.t;0<=--r;)a.data[r]=0;for(r=0;r<t.t;++r)a.data[r+e.t]=e.am(0,t.data[r],a,r,0,e.t);a.s=0,a.clamp(),this.s!=s.s&&U.ZERO.subTo(a,a)},U.prototype.squareTo=function(a){for(var r=this.abs(),e=a.t=2*r.t;0<=--e;)a.data[e]=0;for(e=0;e<r.t-1;++e){var n=r.am(e,r.data[e],a,2*e,0,1);(a.data[e+r.t]+=r.am(e+1,2*r.data[e],a,2*e+1,n,r.t-e-1))>=r.DV&&(a.data[e+r.t]-=r.DV,a.data[e+r.t+1]=1)}0<a.t&&(a.data[a.t-1]+=r.am(e,r.data[e],a,2*e,0,1)),a.s=0,a.clamp()},U.prototype.divRemTo=function(r,a,e){var S=r.abs();if(!(0>=S.t)){var n=this.abs();if(n.t<S.t)return null!=a&&a.fromInt(0),void(null!=e&&this.copyTo(e));null==e&&(e=D());var i=D(),s=this.s,o=r.s,c=this.DB-m(S.data[S.t-1]);0<c?(S.lShiftTo(c,i),n.lShiftTo(c,e)):(S.copyTo(i),n.copyTo(e));var u=i.t,l=i.data[u-1];if(0!=l){var p=l*(1<<this.F1)+(1<u?i.data[u-2]>>this.F2:0),f=this.FV/p,h=(1<<this.F1)/p,d=1<<this.F2,y=e.t,T=y-u,I=null==a?D():a;for(i.dlShiftTo(T,I),0<=e.compareTo(I)&&(e.data[e.t++]=1,e.subTo(I,e)),U.ONE.dlShiftTo(u,I),I.subTo(i,i);i.t<u;)i.data[i.t++]=0;for(;0<=--T;){var B=e.data[--y]==l?this.DM:Math.floor(e.data[y]*f+(e.data[y-1]+d)*h);if((e.data[y]+=i.am(0,B,e,T,0,u))<B)for(i.dlShiftTo(T,I),e.subTo(I,e);e.data[y]<--B;)e.subTo(I,e)}null!=a&&(e.drShiftTo(u,a),s!=o&&U.ZERO.subTo(a,a)),e.t=u,e.clamp(),0<c&&e.rShiftTo(c,e),0>s&&U.ZERO.subTo(e,e)}}},U.prototype.invDigit=function(){if(1>this.t)return 0;var t=this.data[0];if(0==(1&t))return 0;var a=3&t;return a=15&a*(2-(15&t)*a),a=255&a*(2-(255&t)*a),a=65535&a*(2-(65535&(65535&t)*a)),a=a*(2-t*a%this.DV)%this.DV,0<a?this.DV-a:-a},U.prototype.isEven=function(){return 0==(0<this.t?1&this.data[0]:this.s)},U.prototype.exp=function(r,a){if(4294967295<r||1>r)return U.ONE;var e=D(),i=D(),o=a.convert(this),c=m(r)-1;for(o.copyTo(e);0<=--c;)if(a.sqrTo(e,i),0<(r&1<<c))a.mulTo(i,o,e);else{var d=e;e=i,i=d}return a.revert(e)},U.prototype.toString=function(t){if(0>this.s)return"-"+this.negate().toString(t);var r;if(16==t)r=4;else if(8==t)r=3;else if(2==t)r=1;else if(32==t)r=5;else{if(4!=t)return this.toRadix(t);r=2}var s,i=(1<<r)-1,o=!1,c="",l=this.t,y=this.DB-l*this.DB%r;if(0<l--)for(y<this.DB&&0<(s=this.data[l]>>y)&&(o=!0,c=n(s));0<=l;)y<r?(s=(this.data[l]&(1<<y)-1)<<r-y,s|=this.data[--l]>>(y+=this.DB-r)):(s=this.data[l]>>(y-=r)&i,0>=y&&(y+=this.DB,--l)),0<s&&(o=!0),o&&(c+=n(s));return o?c:"0"},U.prototype.negate=function(){var e=D();return U.ZERO.subTo(this,e),e},U.prototype.abs=function(){return 0>this.s?this.negate():this},U.prototype.compareTo=function(t){var a=this.s-t.s;if(0!=a)return a;var r=this.t;if(0!=(a=r-t.t))return 0>this.s?-a:a;for(;0<=--r;)if(0!=(a=this.data[r]-t.data[r]))return a;return 0},U.prototype.bitLength=function(){return 0>=this.t?0:this.DB*(this.t-1)+m(this.data[this.t-1]^this.s&this.DM)},U.prototype.mod=function(t){var a=D();return this.abs().divRemTo(t,null,a),0>this.s&&0<a.compareTo(U.ZERO)&&t.subTo(a,a),a},U.prototype.modPowInt=function(r,a){var e;return e=256>r||a.isEven()?new B(a):new f(a),this.exp(r,e)},U.ZERO=I(0),U.ONE=I(1),g.prototype.convert=y,g.prototype.revert=y,g.prototype.mulTo=function(r,a,e){r.multiplyTo(a,e)},g.prototype.sqrTo=function(t,a){t.squareTo(a)},h.prototype.convert=function(t){if(0>t.s||t.t>2*this.m.t)return t.mod(this.m);if(0>t.compareTo(this.m))return t;var a=D();return t.copyTo(a),this.reduce(a),a},h.prototype.revert=function(e){return e},h.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>e.compareTo(this.r2);)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);0<=e.compareTo(this.m);)e.subTo(this.m,e)},h.prototype.mulTo=function(r,a,e){r.multiplyTo(a,e),this.reduce(e)},h.prototype.sqrTo=function(t,a){t.squareTo(a),this.reduce(a)};var L=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],_=67108864/L[L.length-1];U.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},U.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||2>e||36<e)return"0";var o=this.chunkSize(e),c=Math.pow(e,o),t=I(c),r=D(),a=D(),i="";for(this.divRemTo(t,r,a);0<r.signum();)i=(c+a.intValue()).toString(e).substr(1)+i,r.divRemTo(t,r,a);return a.intValue().toString(e)+i},U.prototype.fromRadix=function(t,a){this.fromInt(0),null==a&&(a=10);for(var s,o=this.chunkSize(a),c=Math.pow(a,o),r=!1,l=0,p=0,u=0;u<t.length;++u)s=i(t,u),0>s?"-"==t.charAt(u)&&0==this.signum()&&(r=!0):(p=a*p+s,++l>=o&&(this.dMultiply(c),this.dAddOffset(p,0),l=0,p=0));0<l&&(this.dMultiply(Math.pow(a,l)),this.dAddOffset(p,0)),r&&U.ZERO.subTo(this,this)},U.prototype.fromNumber=function(i,a,e){if("number"!=typeof a){var t=[],r=7&i;t.length=1+(i>>3),a.nextBytes(t),0<r?t[0]&=(1<<r)-1:t[0]=0,this.fromString(t,256)}else if(2>i)this.fromInt(1);else for(this.fromNumber(i,e),this.testBit(i-1)||this.bitwiseTo(U.ONE.shiftLeft(i-1),s,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(a);)this.dAddOffset(2,0),this.bitLength()>i&&this.subTo(U.ONE.shiftLeft(i-1),this)},U.prototype.bitwiseTo=function(a,n,e){var t,s,i=Math.min(a.t,this.t);for(t=0;t<i;++t)e.data[t]=n(this.data[t],a.data[t]);if(a.t<this.t){for(s=a.s&this.DM,t=i;t<this.t;++t)e.data[t]=n(this.data[t],s);e.t=this.t}else{for(s=this.s&this.DM,t=i;t<a.t;++t)e.data[t]=n(s,a.data[t]);e.t=a.t}e.s=n(this.s,a.s),e.clamp()},U.prototype.changeBit=function(r,a){var e=U.ONE.shiftLeft(r);return this.bitwiseTo(e,a,e),e},U.prototype.addTo=function(a,r){for(var e=0,n=0,s=Math.min(a.t,this.t);e<s;)n+=this.data[e]+a.data[e],r.data[e++]=n&this.DM,n>>=this.DB;if(a.t<this.t){for(n+=a.s;e<this.t;)n+=this.data[e],r.data[e++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;e<a.t;)n+=a.data[e],r.data[e++]=n&this.DM,n>>=this.DB;n+=a.s}r.s=0>n?-1:0,0<n?r.data[e++]=n:-1>n&&(r.data[e++]=this.DV+n),r.t=e,r.clamp()},U.prototype.dMultiply=function(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},U.prototype.dAddOffset=function(t,a){if(0!=t){for(;this.t<=a;)this.data[this.t++]=0;for(this.data[a]+=t;this.data[a]>=this.DV;)this.data[a]-=this.DV,++a>=this.t&&(this.data[this.t++]=0),++this.data[a]}},U.prototype.multiplyLowerTo=function(a,n,e){var t=Math.min(this.t+a.t,n);for(e.s=0,e.t=t;0<t;)e.data[--t]=0;var s;for(s=e.t-this.t;t<s;++t)e.data[t+this.t]=this.am(0,a.data[t],e,t,0,this.t);for(s=Math.min(a.t,n);t<s;++t)this.am(0,a.data[t],e,t,0,n-t);e.clamp()},U.prototype.multiplyUpperTo=function(t,a,n){--a;var s=n.t=this.t+t.t-a;for(n.s=0;0<=--s;)n.data[s]=0;for(s=Math.max(a-this.t,0);s<t.t;++s)n.data[this.t+s-a]=this.am(a-s,t.data[s],n,0,0,this.t+s-a);n.clamp(),n.drShiftTo(1,n)},U.prototype.modInt=function(a){if(0>=a)return 0;var r=this.DV%a,e=0>this.s?a-1:0;if(0<this.t)if(0==r)e=this.data[0]%a;else for(var n=this.t-1;0<=n;--n)e=(r*e+this.data[n])%a;return e},U.prototype.millerRabin=function(n){var a=this.subtract(U.ONE),e=a.getLowestSetBit();if(0>=e)return!1;for(var t,o=a.shiftRight(e),c=C(),i=0;i<n;++i){do t=new U(this.bitLength(),c);while(0>=t.compareTo(U.ONE)||0<=t.compareTo(a));var d=t.modPow(o,this);if(0!=d.compareTo(U.ONE)&&0!=d.compareTo(a)){for(var u=1;u++<e&&0!=d.compareTo(a);)if(d=d.modPowInt(2,this),0==d.compareTo(U.ONE))return!1;if(0!=d.compareTo(a))return!1}}return!0},U.prototype.clone=function(){var e=D();return this.copyTo(e),e},U.prototype.intValue=function(){if(0>this.s){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]},U.prototype.byteValue=function(){return 0==this.t?this.s:this.data[0]<<24>>24},U.prototype.shortValue=function(){return 0==this.t?this.s:this.data[0]<<16>>16},U.prototype.signum=function(){return 0>this.s?-1:0>=this.t||1==this.t&&0>=this.data[0]?0:1},U.prototype.toByteArray=function(){var e=this.t,a=[];a[0]=this.s;var r,n=this.DB-e*this.DB%8,i=0;if(0<e--)for(n<this.DB&&(r=this.data[e]>>n)!=(this.s&this.DM)>>n&&(a[i++]=r|this.s<<this.DB-n);0<=e;)8>n?(r=(this.data[e]&(1<<n)-1)<<8-n,r|=this.data[--e]>>(n+=this.DB-8)):(r=255&this.data[e]>>(n-=8),0>=n&&(n+=this.DB,--e)),0!=(128&r)&&(r|=-256),0==i&&(128&this.s)!=(128&r)&&++i,(0<i||r!=this.s)&&(a[i++]=r);return a},U.prototype.equals=function(e){return 0==this.compareTo(e)},U.prototype.min=function(e){return 0>this.compareTo(e)?this:e},U.prototype.max=function(e){return 0<this.compareTo(e)?this:e},U.prototype.and=function(t){var a=D();return this.bitwiseTo(t,p,a),a},U.prototype.or=function(t){var a=D();return this.bitwiseTo(t,s,a),a},U.prototype.xor=function(t){var a=D();return this.bitwiseTo(t,o,a),a},U.prototype.andNot=function(t){var a=D();return this.bitwiseTo(t,c,a),a},U.prototype.not=function(){for(var t=D(),a=0;a<this.t;++a)t.data[a]=this.DM&~this.data[a];return t.t=this.t,t.s=~this.s,t},U.prototype.shiftLeft=function(t){var a=D();return 0>t?this.rShiftTo(-t,a):this.lShiftTo(t,a),a},U.prototype.shiftRight=function(t){var a=D();return 0>t?this.lShiftTo(-t,a):this.rShiftTo(t,a),a},U.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this.data[e])return e*this.DB+l(this.data[e]);return 0>this.s?this.t*this.DB:-1},U.prototype.bitCount=function(){for(var e=0,r=this.s&this.DM,n=0;n<this.t;++n)e+=u(this.data[n]^r);return e},U.prototype.testBit=function(t){var a=Math.floor(t/this.DB);return a>=this.t?0!=this.s:0!=(this.data[a]&1<<t%this.DB)},U.prototype.setBit=function(e){return this.changeBit(e,s)},U.prototype.clearBit=function(e){return this.changeBit(e,c)},U.prototype.flipBit=function(e){return this.changeBit(e,o)},U.prototype.add=function(t){var a=D();return this.addTo(t,a),a},U.prototype.subtract=function(t){var a=D();return this.subTo(t,a),a},U.prototype.multiply=function(t){var a=D();return this.multiplyTo(t,a),a},U.prototype.divide=function(t){var a=D();return this.divRemTo(t,a,null),a},U.prototype.remainder=function(t){var a=D();return this.divRemTo(t,null,a),a},U.prototype.divideAndRemainder=function(r){var a=D(),e=D();return this.divRemTo(r,a,e),[a,e]},U.prototype.modPow=function(a,r){var e,n,s=a.bitLength(),i=I(1);if(0>=s)return i;e=18>s?1:48>s?3:144>s?4:768>s?5:6,n=8>s?new B(r):r.isEven()?new h(r):new f(r);var c=[],d=3,g=e-1,y=(1<<e)-1;if(c[1]=n.convert(this),1<e){var u=D();for(n.sqrTo(c[1],u);d<=y;)c[d]=D(),n.mulTo(u,c[d-2],c[d]),d+=2}var l,C,E=a.t-1,b=!0,v=D();for(s=m(a.data[E])-1;0<=E;){for(s>=g?l=a.data[E]>>s-g&y:(l=(a.data[E]&(1<<s+1)-1)<<g-s,0<E&&(l|=a.data[E-1]>>this.DB+s-g)),d=e;0==(1&l);)l>>=1,--d;if(0>(s-=d)&&(s+=this.DB,--E),b)c[l].copyTo(i),b=!1;else{for(;1<d;)n.sqrTo(i,v),n.sqrTo(v,i),d-=2;0<d?n.sqrTo(i,v):(C=i,i=v,v=C),n.mulTo(v,c[l],i)}for(;0<=E&&0==(a.data[E]&1<<s);)n.sqrTo(i,v),C=i,i=v,v=C,0>--s&&(s=this.DB-1,--E)}return n.revert(i)},U.prototype.modInverse=function(c){var a=c.isEven();if(this.isEven()&&a||0==c.signum())return U.ZERO;for(var e=c.clone(),t=this.clone(),r=I(1),n=I(0),i=I(0),s=I(1);0!=e.signum();){for(;e.isEven();)e.rShiftTo(1,e),a?(r.isEven()&&n.isEven()||(r.addTo(this,r),n.subTo(c,n)),r.rShiftTo(1,r)):n.isEven()||n.subTo(c,n),n.rShiftTo(1,n);for(;t.isEven();)t.rShiftTo(1,t),a?(i.isEven()&&s.isEven()||(i.addTo(this,i),s.subTo(c,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(c,s),s.rShiftTo(1,s);0<=e.compareTo(t)?(e.subTo(t,e),a&&r.subTo(i,r),n.subTo(s,n)):(t.subTo(e,t),a&&i.subTo(r,i),s.subTo(n,s))}return 0==t.compareTo(U.ONE)?0<=s.compareTo(c)?s.subtract(c):0>s.signum()?(s.addTo(c,s),0>s.signum()?s.add(c):s):s:U.ZERO},U.prototype.pow=function(e){return this.exp(e,new g)},U.prototype.gcd=function(t){var r=0>this.s?this.negate():this.clone(),n=0>t.s?t.negate():t.clone();if(0>r.compareTo(n)){var s=r;r=n,n=s}var i=r.getLowestSetBit(),c=n.getLowestSetBit();if(0>c)return r;for(i<c&&(c=i),0<c&&(r.rShiftTo(c,r),n.rShiftTo(c,n));0<r.signum();)0<(i=r.getLowestSetBit())&&r.rShiftTo(i,r),0<(i=n.getLowestSetBit())&&n.rShiftTo(i,n),0<=r.compareTo(n)?(r.subTo(n,r),r.rShiftTo(1,r)):(n.subTo(r,n),n.rShiftTo(1,n));return 0<c&&n.lShiftTo(c,n),n},U.prototype.isProbablePrime=function(t){var a,n=this.abs();if(1==n.t&&n.data[0]<=L[L.length-1]){for(a=0;a<L.length;++a)if(n.data[0]==L[a])return!0;return!1}if(n.isEven())return!1;for(a=1;a<L.length;){for(var s=L[a],i=a+1;i<L.length&&s<_;)s*=L[i++];for(s=n.modInt(s);a<i;)if(0==s%L[a++])return!1}return n.millerRabin(t)}},function(r,n,e){var s=e(0);e(1),r.exports=s.cipher=s.cipher||{},s.cipher.algorithms=s.cipher.algorithms||{},s.cipher.createCipher=function(r,a){var e=r;if("string"==typeof e&&(e=s.cipher.getAlgorithm(e))&&(e=e()),!e)throw new Error("Unsupported algorithm: "+r);return new s.cipher.BlockCipher({algorithm:e,key:a,decrypt:!1})},s.cipher.createDecipher=function(r,a){var e=r;if("string"==typeof e&&(e=s.cipher.getAlgorithm(e))&&(e=e()),!e)throw new Error("Unsupported algorithm: "+r);return new s.cipher.BlockCipher({algorithm:e,key:a,decrypt:!0})},s.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),s.cipher.algorithms[e]=t},s.cipher.getAlgorithm=function(e){return e=e.toUpperCase(),e in s.cipher.algorithms?s.cipher.algorithms[e]:null};var t=s.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};t.prototype.start=function(e){e=e||{};var r={};for(var n in e)r[n]=e[n];r.decrypt=this._decrypt,this._finish=!1,this._input=s.util.createBuffer(),this.output=e.output||s.util.createBuffer(),this.mode.start(r)},t.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},t.prototype.finish=function(t){t&&("ECB"===this.mode.name||"CBC"===this.mode.name)&&(this.mode.pad=function(a){return t(this.blockSize,a,!1)},this.mode.unpad=function(a){return t(this.blockSize,a,!0)});var a={};return a.decrypt=this._decrypt,a.overflow=this._input.length()%this.blockSize,(this._decrypt||!this.mode.pad||this.mode.pad(this._input,a))&&(this._finish=!0,this.update(),!(this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,a))&&(!this.mode.afterFinish||this.mode.afterFinish(this.output,a)))}},function(s,o,e){function t(){p=String.fromCharCode(128),p+=l.util.fillString(String.fromCharCode(0),64),a=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],f=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],B=Array(64);for(var e=0;64>e;++e)B[e]=Math.floor(4294967296*Math.abs(Math.sin(e+1)));c=!0}function d(r,n,e){for(var t,s,i,o,c,d,p,h,m=e.length();64<=m;){for(s=r.h0,i=r.h1,o=r.h2,c=r.h3,h=0;16>h;++h)n[h]=e.getInt32Le(),d=c^i&(o^c),t=s+d+B[h]+n[h],p=f[h],s=c,c=o,o=i,i+=t<<p|t>>>32-p;for(;32>h;++h)d=o^c&(i^o),t=s+d+B[h]+n[a[h]],p=f[h],s=c,c=o,o=i,i+=t<<p|t>>>32-p;for(;48>h;++h)d=i^o^c,t=s+d+B[h]+n[a[h]],p=f[h],s=c,c=o,o=i,i+=t<<p|t>>>32-p;for(;64>h;++h)d=o^(i|~c),t=s+d+B[h]+n[a[h]],p=f[h],s=c,c=o,o=i,i+=t<<p|t>>>32-p;r.h0=0|r.h0+s,r.h1=0|r.h1+i,r.h2=0|r.h2+o,r.h3=0|r.h3+c,m-=64}}var l=e(0);e(4),e(1);var n=s.exports=l.md5=l.md5||{};l.md.md5=l.md.algorithms.md5=n,n.create=function(){c||t();var n=null,i=l.util.createBuffer(),g=Array(16),y={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return y.start=function(){y.messageLength=0,y.fullMessageLength=y.messageLength64=[];for(var a=y.messageLengthSize/4,e=0;e<a;++e)y.fullMessageLength.push(0);return i=l.util.createBuffer(),n={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},y},y.start(),y.update=function(a,o){"utf8"===o&&(a=l.util.encodeUtf8(a));var t=a.length;y.messageLength+=t,t=[t/4294967296>>>0,t>>>0];for(var c=y.fullMessageLength.length-1;0<=c;--c)y.fullMessageLength[c]+=t[1],t[1]=t[0]+(y.fullMessageLength[c]/4294967296>>>0),y.fullMessageLength[c]>>>=0,t[0]=t[1]/4294967296>>>0;return i.putBytes(a),d(n,g,i),(2048<i.read||0===i.length())&&i.compact(),y},y.digest=function(){var h=l.util.createBuffer();h.putBytes(i.bytes());var e=y.fullMessageLength[y.fullMessageLength.length-1]+y.messageLengthSize,t=e&y.blockLength-1;h.putBytes(p.substr(0,y.blockLength-t));for(var a,f=0,m=y.fullMessageLength.length-1;0<=m;--m)a=8*y.fullMessageLength[m]+f,f=a/4294967296>>>0,h.putInt32Le(a>>>0);var C={h0:n.h0,h1:n.h1,h2:n.h2,h3:n.h3};d(C,g,h);var c=l.util.createBuffer();return c.putInt32Le(C.h0),c.putInt32Le(C.h1),c.putInt32Le(C.h2),c.putInt32Le(C.h3),c},y};var p=null,a=null,f=null,B=null,c=!1},function(n,s,e){var t=e(0);e(8),e(4),e(1);var o,i=t.pkcs5=t.pkcs5||{};t.util.isNodejs&&!t.options.usePureJavaScript&&(o=e(16)),n.exports=t.pbkdf2=i.pbkdf2=function(e,a,s,g,r,y){function m(){return A>l?y(null,I):void(f.start(null,null),f.update(a),f.update(t.util.int32ToBytes(A)),h=S=f.digest().getBytes(),v=2,C())}function C(){return v<=s?(f.start(null,null),f.update(S),E=f.digest().getBytes(),h=t.util.xorBytes(h,E,c),S=E,++v,t.util.setImmediate(C)):void(I+=A<l?h:h.substr(0,p),++A,m())}if("function"==typeof r&&(y=r,r=null),t.util.isNodejs&&!t.options.usePureJavaScript&&o.pbkdf2&&(null===r||"object"!=typeof r)&&(4<o.pbkdf2Sync.length||!r||"sha1"===r))return"string"!=typeof r&&(r="sha1"),e=Buffer.from(e,"binary"),a=Buffer.from(a,"binary"),y?4===o.pbkdf2Sync.length?o.pbkdf2(e,a,s,g,function(t,a){return t?y(t):void y(null,a.toString("binary"))}):o.pbkdf2(e,a,s,g,r,function(t,a){return t?y(t):void y(null,a.toString("binary"))}):4===o.pbkdf2Sync.length?o.pbkdf2Sync(e,a,s,g).toString("binary"):o.pbkdf2Sync(e,a,s,g,r).toString("binary");if(void 0!==r&&null!==r||(r="sha1"),"string"==typeof r){if(!(r in t.md.algorithms))throw new Error("Unknown hash algorithm: "+r);r=t.md[r].create()}var c=r.digestLength;if(g>4294967295*c){var u=new Error("Derived key is too long.");if(y)return y(u);throw u}var l=Math.ceil(g/c),p=g-(l-1)*c,f=t.hmac.create();f.start(r,e);var h,E,S,I="";if(!y){for(var A=1;A<=l;++A){f.start(null,null),f.update(a),f.update(t.util.int32ToBytes(A)),h=S=f.digest().getBytes();for(var v=2;v<=s;++v)f.start(null,null),f.update(S),E=f.digest().getBytes(),h=t.util.xorBytes(h,E,c),S=E;I+=A<l?h:h.substr(0,p)}return I}var v,A=1;m()}},function(){},function(E,S,e){function T(t,a){"string"==typeof a&&(a={shortName:a});for(var r,n=null,s=0;null===n&&s<t.attributes.length;++s)r=t.attributes[s],a.type&&a.type===r.type?n=r:a.name&&a.name===r.name?n=r:a.shortName&&a.shortName===r.shortName&&(n=r);return n}function I(t){for(var r,s,i=A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[]),o=t.attributes,a=0;a<o.length;++a){r=o[a];var c=r.value,l=A.Type.PRINTABLESTRING;"valueTagClass"in r&&(l=r.valueTagClass)===A.Type.UTF8&&(c=v.util.encodeUtf8(c)),s=A.create(A.Class.UNIVERSAL,A.Type.SET,!0,[A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(r.type).getBytes()),A.create(A.Class.UNIVERSAL,l,!1,c)])]),i.value.push(s)}return i}function r(t){for(var r,n=0;n<t.length;++n){if(r=t[n],void 0===r.name&&(r.type&&r.type in V.oids?r.name=V.oids[r.type]:r.shortName&&r.shortName in p&&(r.name=V.oids[p[r.shortName]])),void 0===r.type){if(!(r.name&&r.name in V.oids)){var s=new Error("Attribute type not specified.");throw s.attribute=r,s}r.type=V.oids[r.name]}if(void 0===r.shortName&&r.name&&r.name in p&&(r.shortName=p[r.name]),r.type===l.extensionRequest&&(r.valueConstructed=!0,r.valueTagClass=A.Type.SEQUENCE,!r.value&&r.extensions)){r.value=[];for(var i=0;i<r.extensions.length;++i)r.value.push(V.certificateExtensionToAsn1(a(r.extensions[i])))}if(void 0===r.value){var s=new Error("Attribute value not specified.");throw s.attribute=r,s}}}function a(t,a){if(a=a||{},void 0===t.name&&t.id&&t.id in V.oids&&(t.name=V.oids[t.id]),void 0===t.id){if(!(t.name&&t.name in V.oids)){var r=new Error("Extension ID not specified.");throw r.extension=t,r}t.id=V.oids[t.name]}if(void 0!==t.value)return t;if("keyUsage"===t.name){var n=0,s=0,i=0;t.digitalSignature&&(s|=128,n=7),t.nonRepudiation&&(s|=64,n=6),t.keyEncipherment&&(s|=32,n=5),t.dataEncipherment&&(s|=16,n=4),t.keyAgreement&&(s|=8,n=3),t.keyCertSign&&(s|=4,n=2),t.cRLSign&&(s|=2,n=1),t.encipherOnly&&(s|=1,n=0),t.decipherOnly&&(i|=128,n=7);var o=String.fromCharCode(n);0==i?0!==s&&(o+=String.fromCharCode(s)):o+=String.fromCharCode(s)+String.fromCharCode(i),t.value=A.create(A.Class.UNIVERSAL,A.Type.BITSTRING,!1,o)}else if("basicConstraints"===t.name)t.value=A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[]),t.cA&&t.value.value.push(A.create(A.Class.UNIVERSAL,A.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in t&&t.value.value.push(A.create(A.Class.UNIVERSAL,A.Type.INTEGER,!1,A.integerToDer(t.pathLenConstraint).getBytes()));else if("extKeyUsage"===t.name){t.value=A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[]);var c=t.value.value;for(var d in t)!0===t[d]&&(d in l?c.push(A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(l[d]).getBytes())):-1!==d.indexOf(".")&&c.push(A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(d).getBytes())))}else if("nsCertType"===t.name){var n=0,s=0;t.client&&(s|=128,n=7),t.server&&(s|=64,n=6),t.email&&(s|=32,n=5),t.objsign&&(s|=16,n=4),t.reserved&&(s|=8,n=3),t.sslCA&&(s|=4,n=2),t.emailCA&&(s|=2,n=1),t.objCA&&(s|=1,n=0);var o=String.fromCharCode(n);0!=s&&(o+=String.fromCharCode(s)),t.value=A.create(A.Class.UNIVERSAL,A.Type.BITSTRING,!1,o)}else if("subjectAltName"===t.name||"issuerAltName"===t.name){t.value=A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[]);for(var p,y=0;y<t.altNames.length;++y){p=t.altNames[y];var o=p.value;if(!(7===p.type&&p.ip))8===p.type&&(o=p.oid?A.oidToDer(A.oidToDer(p.oid)):A.oidToDer(o));else if(null===(o=v.util.bytesFromIP(p.ip))){var r=new Error("Extension \"ip\" value is not a valid IPv4 or IPv6 address.");throw r.extension=t,r}t.value.value.push(A.create(A.Class.CONTEXT_SPECIFIC,p.type,!1,o))}}else if("nsComment"===t.name&&a.cert){if(!/^[\x00-\x7F]*$/.test(t.comment)||1>t.comment.length||128<t.comment.length)throw new Error("Invalid \"nsComment\" content.");t.value=A.create(A.Class.UNIVERSAL,A.Type.IA5STRING,!1,t.comment)}else if("subjectKeyIdentifier"===t.name&&a.cert){var S=a.cert.generateSubjectKeyIdentifier();t.subjectKeyIdentifier=S.toHex(),t.value=A.create(A.Class.UNIVERSAL,A.Type.OCTETSTRING,!1,S.getBytes())}else if("authorityKeyIdentifier"===t.name&&a.cert){t.value=A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[]);var c=t.value.value;if(t.keyIdentifier){var B=!0===t.keyIdentifier?a.cert.generateSubjectKeyIdentifier().getBytes():t.keyIdentifier;c.push(A.create(A.Class.CONTEXT_SPECIFIC,0,!1,B))}if(t.authorityCertIssuer){var g=[A.create(A.Class.CONTEXT_SPECIFIC,4,!0,[I(!0===t.authorityCertIssuer?a.cert.issuer:t.authorityCertIssuer)])];c.push(A.create(A.Class.CONTEXT_SPECIFIC,1,!0,g))}if(t.serialNumber){var b=v.util.hexToBytes(!0===t.serialNumber?a.cert.serialNumber:t.serialNumber);c.push(A.create(A.Class.CONTEXT_SPECIFIC,2,!1,b))}}else if("cRLDistributionPoints"===t.name){t.value=A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[]);for(var p,c=t.value.value,m=A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[]),C=A.create(A.Class.CONTEXT_SPECIFIC,0,!0,[]),y=0;y<t.altNames.length;++y){p=t.altNames[y];var o=p.value;if(!(7===p.type&&p.ip))8===p.type&&(o=p.oid?A.oidToDer(A.oidToDer(p.oid)):A.oidToDer(o));else if(null===(o=v.util.bytesFromIP(p.ip))){var r=new Error("Extension \"ip\" value is not a valid IPv4 or IPv6 address.");throw r.extension=t,r}C.value.push(A.create(A.Class.CONTEXT_SPECIFIC,p.type,!1,o))}m.value.push(A.create(A.Class.CONTEXT_SPECIFIC,0,!0,[C])),c.push(m)}if(void 0===t.value){var r=new Error("Extension value not specified.");throw r.extension=t,r}return t}function i(r,a){switch(r){case l["RSASSA-PSS"]:var e=[];return void 0!==a.hash.algorithmOid&&e.push(A.create(A.Class.CONTEXT_SPECIFIC,0,!0,[A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(a.hash.algorithmOid).getBytes()),A.create(A.Class.UNIVERSAL,A.Type.NULL,!1,"")])])),void 0!==a.mgf.algorithmOid&&e.push(A.create(A.Class.CONTEXT_SPECIFIC,1,!0,[A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(a.mgf.algorithmOid).getBytes()),A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(a.mgf.hash.algorithmOid).getBytes()),A.create(A.Class.UNIVERSAL,A.Type.NULL,!1,"")])])])),void 0!==a.saltLength&&e.push(A.create(A.Class.CONTEXT_SPECIFIC,2,!0,[A.create(A.Class.UNIVERSAL,A.Type.INTEGER,!1,A.integerToDer(a.saltLength).getBytes())])),A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,e);default:return A.create(A.Class.UNIVERSAL,A.Type.NULL,!1,"");}}function n(a){var s=A.create(A.Class.CONTEXT_SPECIFIC,0,!0,[]);if(0===a.attributes.length)return s;for(var e=a.attributes,t=0;t<e.length;++t){var i=e[t],o=i.value,c=A.Type.UTF8;"valueTagClass"in i&&(c=i.valueTagClass),c===A.Type.UTF8&&(o=v.util.encodeUtf8(o));var d=!1;"valueConstructed"in i&&(d=i.valueConstructed);var l=A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(i.type).getBytes()),A.create(A.Class.UNIVERSAL,A.Type.SET,!0,[A.create(A.Class.UNIVERSAL,c,d,o)])]);s.value.push(l)}return s}function B(e){return e>=c&&e<g?A.create(A.Class.UNIVERSAL,A.Type.UTCTIME,!1,A.dateToUtcTime(e)):A.create(A.Class.UNIVERSAL,A.Type.GENERALIZEDTIME,!1,A.dateToGeneralizedTime(e))}var v=e(0);e(5),e(3),e(10),e(4),e(39),e(6),e(7),e(18),e(11),e(1);var A=v.asn1,V=E.exports=v.pki=v.pki||{},l=V.oids,p={};p.CN=l.commonName,p.commonName="CN",p.C=l.countryName,p.countryName="C",p.L=l.localityName,p.localityName="L",p.ST=l.stateOrProvinceName,p.stateOrProvinceName="ST",p.O=l.organizationName,p.organizationName="O",p.OU=l.organizationalUnitName,p.organizationalUnitName="OU",p.E=l.emailAddress,p.emailAddress="E";var t=v.pki.rsa.publicKeyValidator,s={name:"Certificate",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:A.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:A.Class.UNIVERSAL,type:A.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:A.Class.UNIVERSAL,type:A.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:A.Class.UNIVERSAL,type:A.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:A.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:A.Class.UNIVERSAL,type:A.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:A.Class.UNIVERSAL,type:A.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:A.Class.UNIVERSAL,type:A.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:A.Class.UNIVERSAL,type:A.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},t,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:A.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:A.Class.UNIVERSAL,type:A.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:A.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:A.Class.UNIVERSAL,type:A.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:A.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:A.Class.UNIVERSAL,type:A.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:A.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:A.Class.UNIVERSAL,type:A.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},u={name:"rsapss",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:A.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:A.Class.UNIVERSAL,type:A.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:A.Class.UNIVERSAL,type:A.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:A.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:A.Class.UNIVERSAL,type:A.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:A.Class.UNIVERSAL,type:A.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:A.Class.UNIVERSAL,type:A.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:A.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:A.Class.UNIVERSAL,type:A.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:A.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:A.Class.UNIVERSAL,type:A.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},o={name:"CertificationRequestInfo",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:A.Class.UNIVERSAL,type:A.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},t,{name:"CertificationRequestInfo.attributes",tagClass:A.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:A.Class.UNIVERSAL,type:A.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:A.Class.UNIVERSAL,type:A.Type.SET,constructed:!0}]}]}]},d={name:"CertificationRequest",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[o,{name:"CertificationRequest.signatureAlgorithm",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:A.Class.UNIVERSAL,type:A.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:A.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:A.Class.UNIVERSAL,type:A.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};V.RDNAttributesAsArray=function(a,r){for(var e,n,s,o=[],c=0;c<a.value.length;++c){e=a.value[c];for(var u=0;u<e.value.length;++u)s={},n=e.value[u],s.type=A.derToOid(n.value[0].value),s.value=n.value[1].value,s.valueTagClass=n.value[1].type,s.type in l&&(s.name=l[s.type],s.name in p&&(s.shortName=p[s.name])),r&&(r.update(s.type),r.update(s.value)),o.push(s)}return o},V.CRIAttributesAsArray=function(r){for(var s=[],e=0;e<r.length;++e)for(var o,c=r[e],d=A.derToOid(c.value[0].value),a=c.value[1].value,n=0;n<a.length;++n){if(o={},o.type=d,o.value=a[n].value,o.valueTagClass=a[n].type,o.type in l&&(o.name=l[o.type],o.name in p&&(o.shortName=p[o.name])),o.type===l.extensionRequest){o.extensions=[];for(var u=0;u<o.value.length;++u)o.extensions.push(V.certificateExtensionFromAsn1(o.value[u]))}s.push(o)}return s};var b=function(a,s,e){var t={};if(a!==l["RSASSA-PSS"])return t;e&&(t={hash:{algorithmOid:l.sha1},mgf:{algorithmOid:l.mgf1,hash:{algorithmOid:l.sha1}},saltLength:20});var o={},c=[];if(!A.validate(s,u,o,c)){var n=new Error("Cannot read RSASSA-PSS parameter block.");throw n.errors=c,n}return void 0!==o.hashOid&&(t.hash=t.hash||{},t.hash.algorithmOid=A.derToOid(o.hashOid)),void 0!==o.maskGenOid&&(t.mgf=t.mgf||{},t.mgf.algorithmOid=A.derToOid(o.maskGenOid),t.mgf.hash=t.mgf.hash||{},t.mgf.hash.algorithmOid=A.derToOid(o.maskGenHashOid)),void 0!==o.saltLength&&(t.saltLength=o.saltLength.charCodeAt(0)),t};V.certificateFromPem=function(i,s,e){var t=v.pem.decode(i)[0];if("CERTIFICATE"!==t.type&&"X509 CERTIFICATE"!==t.type&&"TRUSTED CERTIFICATE"!==t.type){var r=new Error("Could not convert certificate from PEM; PEM header type is not \"CERTIFICATE\", \"X509 CERTIFICATE\", or \"TRUSTED CERTIFICATE\".");throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var a=A.fromDer(t.body,e);return V.certificateFromAsn1(a,s)},V.certificateToPem=function(r,a){var e={type:"CERTIFICATE",body:A.toDer(V.certificateToAsn1(r)).getBytes()};return v.pem.encode(e,{maxline:a})},V.publicKeyFromPem=function(a){var n=v.pem.decode(a)[0];if("PUBLIC KEY"!==n.type&&"RSA PUBLIC KEY"!==n.type){var e=new Error("Could not convert public key from PEM; PEM header type is not \"PUBLIC KEY\" or \"RSA PUBLIC KEY\".");throw e.headerType=n.type,e}if(n.procType&&"ENCRYPTED"===n.procType.type)throw new Error("Could not convert public key from PEM; PEM is encrypted.");var t=A.fromDer(n.body);return V.publicKeyFromAsn1(t)},V.publicKeyToPem=function(r,a){var e={type:"PUBLIC KEY",body:A.toDer(V.publicKeyToAsn1(r)).getBytes()};return v.pem.encode(e,{maxline:a})},V.publicKeyToRSAPublicKeyPem=function(r,a){var e={type:"RSA PUBLIC KEY",body:A.toDer(V.publicKeyToRSAPublicKey(r)).getBytes()};return v.pem.encode(e,{maxline:a})},V.getPublicKeyFingerprint=function(t,r){r=r||{};var s,o=r.md||v.md.sha1.create(),d=r.type||"RSAPublicKey";switch(d){case"RSAPublicKey":s=A.toDer(V.publicKeyToRSAPublicKey(t)).getBytes();break;case"SubjectPublicKeyInfo":s=A.toDer(V.publicKeyToAsn1(t)).getBytes();break;default:throw new Error("Unknown fingerprint type \""+r.type+"\".");}o.start(),o.update(s);var a=o.digest();if("hex"===r.encoding){var n=a.toHex();return r.delimiter?n.match(/.{2}/g).join(r.delimiter):n}if("binary"===r.encoding)return a.getBytes();if(r.encoding)throw new Error("Unknown encoding \""+r.encoding+"\".");return a},V.certificationRequestFromPem=function(i,s,e){var t=v.pem.decode(i)[0];if("CERTIFICATE REQUEST"!==t.type){var r=new Error("Could not convert certification request from PEM; PEM header type is not \"CERTIFICATE REQUEST\".");throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var a=A.fromDer(t.body,e);return V.certificationRequestFromAsn1(a,s)},V.certificationRequestToPem=function(r,a){var e={type:"CERTIFICATE REQUEST",body:A.toDer(V.certificationRequestToAsn1(r)).getBytes()};return v.pem.encode(e,{maxline:a})},V.createCertificate=function(){var p={};return p.version=2,p.serialNumber="00",p.signatureOid=null,p.signature=null,p.siginfo={},p.siginfo.algorithmOid=null,p.validity={},p.validity.notBefore=new Date,p.validity.notAfter=new Date,p.issuer={},p.issuer.getField=function(t){return T(p.issuer,t)},p.issuer.addField=function(t){r([t]),p.issuer.attributes.push(t)},p.issuer.attributes=[],p.issuer.hash=null,p.subject={},p.subject.getField=function(t){return T(p.subject,t)},p.subject.addField=function(t){r([t]),p.subject.attributes.push(t)},p.subject.attributes=[],p.subject.hash=null,p.extensions=[],p.publicKey=null,p.md=null,p.setSubject=function(a,e){r(a),p.subject.attributes=a,delete p.subject.uniqueId,e&&(p.subject.uniqueId=e),p.subject.hash=null},p.setIssuer=function(a,e){r(a),p.issuer.attributes=a,delete p.issuer.uniqueId,e&&(p.issuer.uniqueId=e),p.issuer.hash=null},p.setExtensions=function(r){for(var e=0;e<r.length;++e)a(r[e],{cert:p});p.extensions=r},p.getExtension=function(t){"string"==typeof t&&(t={name:t});for(var a,r=null,n=0;null===r&&n<p.extensions.length;++n)a=p.extensions[n],t.id&&a.id===t.id?r=a:t.name&&a.name===t.name&&(r=a);return r},p.sign=function(s,e){p.md=e||v.md.sha1.create();var t=l[p.md.algorithm+"WithRSAEncryption"];if(!t){var r=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw r.algorithm=p.md.algorithm,r}p.signatureOid=p.siginfo.algorithmOid=t,p.tbsCertificate=V.getTBSCertificate(p);var a=A.toDer(p.tbsCertificate);p.md.update(a.getBytes()),p.signature=s.sign(p.md)},p.verify=function(r){var e=!1;if(!p.issued(r)){var s=r.issuer,i=p.subject,a=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw a.expectedIssuer=s.attributes,a.actualIssuer=i.attributes,a}var d=r.md;if(null===d){if(r.signatureOid in l)switch(l[r.signatureOid]){case"sha1WithRSAEncryption":d=v.md.sha1.create();break;case"md5WithRSAEncryption":d=v.md.md5.create();break;case"sha256WithRSAEncryption":d=v.md.sha256.create();break;case"sha384WithRSAEncryption":d=v.md.sha384.create();break;case"sha512WithRSAEncryption":d=v.md.sha512.create();break;case"RSASSA-PSS":d=v.md.sha256.create();}if(null===d){var a=new Error("Could not compute certificate digest. Unknown signature OID.");throw a.signatureOid=r.signatureOid,a}var u=r.tbsCertificate||V.getTBSCertificate(r),g=A.toDer(u);d.update(g.getBytes())}if(null!==d){var o;switch(r.signatureOid){case l.sha1WithRSAEncryption:o=void 0;break;case l["RSASSA-PSS"]:var y,h;if(void 0===(y=l[r.signatureParameters.mgf.hash.algorithmOid])||void 0===v.md[y]){var a=new Error("Unsupported MGF hash function.");throw a.oid=r.signatureParameters.mgf.hash.algorithmOid,a.name=y,a}if(void 0===(h=l[r.signatureParameters.mgf.algorithmOid])||void 0===v.mgf[h]){var a=new Error("Unsupported MGF function.");throw a.oid=r.signatureParameters.mgf.algorithmOid,a.name=h,a}if(h=v.mgf[h].create(v.md[y].create()),void 0===(y=l[r.signatureParameters.hash.algorithmOid])||void 0===v.md[y])throw{message:"Unsupported RSASSA-PSS hash function.",oid:r.signatureParameters.hash.algorithmOid,name:y};o=v.pss.create(v.md[y].create(),h,r.signatureParameters.saltLength);}e=p.publicKey.verify(d.digest().getBytes(),r.signature,o)}return e},p.isIssuer=function(r){var e=!1,s=p.issuer,i=r.subject;if(s.hash&&i.hash)e=s.hash===i.hash;else if(s.attributes.length===i.attributes.length){e=!0;for(var a,o,c=0;e&&c<s.attributes.length;++c)a=s.attributes[c],o=i.attributes[c],a.type===o.type&&a.value===o.value||(e=!1)}return e},p.issued=function(t){return t.isIssuer(p)},p.generateSubjectKeyIdentifier=function(){return V.getPublicKeyFingerprint(p.publicKey,{type:"RSAPublicKey"})},p.verifySubjectKeyIdentifier=function(){for(var a,r=l.subjectKeyIdentifier,n=0;n<p.extensions.length;++n)if(a=p.extensions[n],a.id===r){var s=p.generateSubjectKeyIdentifier().getBytes();return v.util.hexToBytes(a.subjectKeyIdentifier)===s}return!1},p},V.certificateFromAsn1=function(a,i){var e={},t=[];if(!A.validate(a,s,e,t)){var o=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw o.errors=t,o}var p=A.derToOid(e.publicKeyOid);if(p!==V.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var g=V.createCertificate();g.version=e.certVersion?e.certVersion.charCodeAt(0):0;var h=v.util.createBuffer(e.certSerialNumber);g.serialNumber=h.toHex(),g.signatureOid=v.asn1.derToOid(e.certSignatureOid),g.signatureParameters=b(g.signatureOid,e.certSignatureParams,!0),g.siginfo.algorithmOid=v.asn1.derToOid(e.certinfoSignatureOid),g.siginfo.parameters=b(g.siginfo.algorithmOid,e.certinfoSignatureParams,!1),g.signature=e.certSignature;var c=[];if(void 0!==e.certValidity1UTCTime&&c.push(A.utcTimeToDate(e.certValidity1UTCTime)),void 0!==e.certValidity2GeneralizedTime&&c.push(A.generalizedTimeToDate(e.certValidity2GeneralizedTime)),void 0!==e.certValidity3UTCTime&&c.push(A.utcTimeToDate(e.certValidity3UTCTime)),void 0!==e.certValidity4GeneralizedTime&&c.push(A.generalizedTimeToDate(e.certValidity4GeneralizedTime)),2<c.length)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(2>c.length)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(g.validity.notBefore=c[0],g.validity.notAfter=c[1],g.tbsCertificate=e.tbsCertificate,i){if(g.md=null,g.signatureOid in l){var p=l[g.signatureOid];"sha1WithRSAEncryption"===p?g.md=v.md.sha1.create():"md5WithRSAEncryption"===p?g.md=v.md.md5.create():"sha256WithRSAEncryption"===p?g.md=v.md.sha256.create():"sha384WithRSAEncryption"===p?g.md=v.md.sha384.create():"sha512WithRSAEncryption"===p?g.md=v.md.sha512.create():"RSASSA-PSS"===p?g.md=v.md.sha256.create():void 0}if(null===g.md){var o=new Error("Could not compute certificate digest. Unknown signature OID.");throw o.signatureOid=g.signatureOid,o}var u=A.toDer(g.tbsCertificate);g.md.update(u.getBytes())}var d=v.md.sha1.create();g.issuer.getField=function(e){return T(g.issuer,e)},g.issuer.addField=function(e){r([e]),g.issuer.attributes.push(e)},g.issuer.attributes=V.RDNAttributesAsArray(e.certIssuer,d),e.certIssuerUniqueId&&(g.issuer.uniqueId=e.certIssuerUniqueId),g.issuer.hash=d.digest().toHex();var y=v.md.sha1.create();return g.subject.getField=function(e){return T(g.subject,e)},g.subject.addField=function(e){r([e]),g.subject.attributes.push(e)},g.subject.attributes=V.RDNAttributesAsArray(e.certSubject,y),e.certSubjectUniqueId&&(g.subject.uniqueId=e.certSubjectUniqueId),g.subject.hash=y.digest().toHex(),g.extensions=e.certExtensions?V.certificateExtensionsFromAsn1(e.certExtensions):[],g.publicKey=V.publicKeyFromAsn1(e.subjectPublicKeyInfo),g},V.certificateExtensionsFromAsn1=function(r){for(var n=[],e=0;e<r.value.length;++e)for(var s=r.value[e],i=0;i<s.value.length;++i)n.push(V.certificateExtensionFromAsn1(s.value[i]));return n},V.certificateExtensionFromAsn1=function(a){var r={};if(r.id=A.derToOid(a.value[0].value),r.critical=!1,a.value[1].type===A.Type.BOOLEAN?(r.critical=0!==a.value[1].value.charCodeAt(0),r.value=a.value[2].value):r.value=a.value[1].value,r.id in l)if(r.name=l[r.id],"keyUsage"===r.name){var e=A.fromDer(r.value),n=0,s=0;1<e.value.length&&(n=e.value.charCodeAt(1),s=2<e.value.length?e.value.charCodeAt(2):0),r.digitalSignature=128==(128&n),r.nonRepudiation=64==(64&n),r.keyEncipherment=32==(32&n),r.dataEncipherment=16==(16&n),r.keyAgreement=8==(8&n),r.keyCertSign=4==(4&n),r.cRLSign=2==(2&n),r.encipherOnly=1==(1&n),r.decipherOnly=128==(128&s)}else if("basicConstraints"===r.name){var e=A.fromDer(r.value);r.cA=!!(0<e.value.length&&e.value[0].type===A.Type.BOOLEAN)&&0!==e.value[0].value.charCodeAt(0);var i=null;0<e.value.length&&e.value[0].type===A.Type.INTEGER?i=e.value[0].value:1<e.value.length&&(i=e.value[1].value),null!==i&&(r.pathLenConstraint=A.derToInteger(i))}else if("extKeyUsage"===r.name)for(var o,e=A.fromDer(r.value),c=0;c<e.value.length;++c)o=A.derToOid(e.value[c].value),o in l?r[l[o]]=!0:r[o]=!0;else if("nsCertType"===r.name){var e=A.fromDer(r.value),n=0;1<e.value.length&&(n=e.value.charCodeAt(1)),r.client=128==(128&n),r.server=64==(64&n),r.email=32==(32&n),r.objsign=16==(16&n),r.reserved=8==(8&n),r.sslCA=4==(4&n),r.emailCA=2==(2&n),r.objCA=1==(1&n)}else if("subjectAltName"===r.name||"issuerAltName"===r.name){r.altNames=[];for(var d,e=A.fromDer(r.value),p=0;p<e.value.length;++p){d=e.value[p];var u={type:d.type,value:d.value};switch(r.altNames.push(u),d.type){case 1:case 2:case 6:break;case 7:u.ip=v.util.bytesToIP(d.value);break;case 8:u.oid=A.derToOid(d.value);}}}else if("subjectKeyIdentifier"===r.name){var e=A.fromDer(r.value);r.subjectKeyIdentifier=v.util.bytesToHex(e.value)}return r},V.certificationRequestFromAsn1=function(a,s){var e={},t=[];if(!A.validate(a,d,e,t)){var i=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw i.errors=t,i}var o=A.derToOid(e.publicKeyOid);if(o!==V.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var p=V.createCertificationRequest();if(p.version=e.csrVersion?e.csrVersion.charCodeAt(0):0,p.signatureOid=v.asn1.derToOid(e.csrSignatureOid),p.signatureParameters=b(p.signatureOid,e.csrSignatureParams,!0),p.siginfo.algorithmOid=v.asn1.derToOid(e.csrSignatureOid),p.siginfo.parameters=b(p.siginfo.algorithmOid,e.csrSignatureParams,!1),p.signature=e.csrSignature,p.certificationRequestInfo=e.certificationRequestInfo,s){if(p.md=null,p.signatureOid in l){var o=l[p.signatureOid];"sha1WithRSAEncryption"===o?p.md=v.md.sha1.create():"md5WithRSAEncryption"===o?p.md=v.md.md5.create():"sha256WithRSAEncryption"===o?p.md=v.md.sha256.create():"sha384WithRSAEncryption"===o?p.md=v.md.sha384.create():"sha512WithRSAEncryption"===o?p.md=v.md.sha512.create():"RSASSA-PSS"===o?p.md=v.md.sha256.create():void 0}if(null===p.md){var i=new Error("Could not compute certification request digest. Unknown signature OID.");throw i.signatureOid=p.signatureOid,i}var g=A.toDer(p.certificationRequestInfo);p.md.update(g.getBytes())}var c=v.md.sha1.create();return p.subject.getField=function(e){return T(p.subject,e)},p.subject.addField=function(e){r([e]),p.subject.attributes.push(e)},p.subject.attributes=V.RDNAttributesAsArray(e.certificationRequestInfoSubject,c),p.subject.hash=c.digest().toHex(),p.publicKey=V.publicKeyFromAsn1(e.subjectPublicKeyInfo),p.getAttribute=function(e){return T(p,e)},p.addAttribute=function(e){r([e]),p.attributes.push(e)},p.attributes=V.CRIAttributesAsArray(e.certificationRequestInfoAttributes||[]),p},V.createCertificationRequest=function(){var s={};return s.version=0,s.signatureOid=null,s.signature=null,s.siginfo={},s.siginfo.algorithmOid=null,s.subject={},s.subject.getField=function(t){return T(s.subject,t)},s.subject.addField=function(t){r([t]),s.subject.attributes.push(t)},s.subject.attributes=[],s.subject.hash=null,s.publicKey=null,s.attributes=[],s.getAttribute=function(t){return T(s,t)},s.addAttribute=function(t){r([t]),s.attributes.push(t)},s.md=null,s.setSubject=function(t){r(t),s.subject.attributes=t,s.subject.hash=null},s.setAttributes=function(t){r(t),s.attributes=t},s.sign=function(i,e){s.md=e||v.md.sha1.create();var t=l[s.md.algorithm+"WithRSAEncryption"];if(!t){var r=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw r.algorithm=s.md.algorithm,r}s.signatureOid=s.siginfo.algorithmOid=t,s.certificationRequestInfo=V.getCertificationRequestInfo(s);var a=A.toDer(s.certificationRequestInfo);s.md.update(a.getBytes()),s.signature=i.sign(s.md)},s.verify=function(){var t=!1,a=s.md;if(null===a){if(s.signatureOid in l)switch(l[s.signatureOid]){case"sha1WithRSAEncryption":a=v.md.sha1.create();break;case"md5WithRSAEncryption":a=v.md.md5.create();break;case"sha256WithRSAEncryption":a=v.md.sha256.create();break;case"sha384WithRSAEncryption":a=v.md.sha384.create();break;case"sha512WithRSAEncryption":a=v.md.sha512.create();break;case"RSASSA-PSS":a=v.md.sha256.create();}if(null===a){var r=new Error("Could not compute certification request digest. Unknown signature OID.");throw r.signatureOid=s.signatureOid,r}var o=s.certificationRequestInfo||V.getCertificationRequestInfo(s),c=A.toDer(o);a.update(c.getBytes())}if(null!==a){var n;switch(s.signatureOid){case l.sha1WithRSAEncryption:break;case l["RSASSA-PSS"]:var d,p;if(void 0===(d=l[s.signatureParameters.mgf.hash.algorithmOid])||void 0===v.md[d]){var r=new Error("Unsupported MGF hash function.");throw r.oid=s.signatureParameters.mgf.hash.algorithmOid,r.name=d,r}if(void 0===(p=l[s.signatureParameters.mgf.algorithmOid])||void 0===v.mgf[p]){var r=new Error("Unsupported MGF function.");throw r.oid=s.signatureParameters.mgf.algorithmOid,r.name=p,r}if(p=v.mgf[p].create(v.md[d].create()),void 0===(d=l[s.signatureParameters.hash.algorithmOid])||void 0===v.md[d]){var r=new Error("Unsupported RSASSA-PSS hash function.");throw r.oid=s.signatureParameters.hash.algorithmOid,r.name=d,r}n=v.pss.create(v.md[d].create(),p,s.signatureParameters.saltLength);}t=s.publicKey.verify(a.digest().getBytes(),s.signature,n)}return t},s};var c=new Date("1950-01-01T00:00:00Z"),g=new Date("2050-01-01T00:00:00Z");V.getTBSCertificate=function(a){var n=B(a.validity.notBefore),e=B(a.validity.notAfter),t=A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.CONTEXT_SPECIFIC,0,!0,[A.create(A.Class.UNIVERSAL,A.Type.INTEGER,!1,A.integerToDer(a.version).getBytes())]),A.create(A.Class.UNIVERSAL,A.Type.INTEGER,!1,v.util.hexToBytes(a.serialNumber)),A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(a.siginfo.algorithmOid).getBytes()),i(a.siginfo.algorithmOid,a.siginfo.parameters)]),I(a.issuer),A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[n,e]),I(a.subject),V.publicKeyToAsn1(a.publicKey)]);return a.issuer.uniqueId&&t.value.push(A.create(A.Class.CONTEXT_SPECIFIC,1,!0,[A.create(A.Class.UNIVERSAL,A.Type.BITSTRING,!1,String.fromCharCode(0)+a.issuer.uniqueId)])),a.subject.uniqueId&&t.value.push(A.create(A.Class.CONTEXT_SPECIFIC,2,!0,[A.create(A.Class.UNIVERSAL,A.Type.BITSTRING,!1,String.fromCharCode(0)+a.subject.uniqueId)])),0<a.extensions.length&&t.value.push(V.certificateExtensionsToAsn1(a.extensions)),t},V.getCertificationRequestInfo=function(e){return A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.INTEGER,!1,A.integerToDer(e.version).getBytes()),I(e.subject),V.publicKeyToAsn1(e.publicKey),n(e)])},V.distinguishedNameToAsn1=function(e){return I(e)},V.certificateToAsn1=function(t){var a=t.tbsCertificate||V.getTBSCertificate(t);return A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[a,A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(t.signatureOid).getBytes()),i(t.signatureOid,t.signatureParameters)]),A.create(A.Class.UNIVERSAL,A.Type.BITSTRING,!1,String.fromCharCode(0)+t.signature)])},V.certificateExtensionsToAsn1=function(a){var n=A.create(A.Class.CONTEXT_SPECIFIC,3,!0,[]),e=A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[]);n.value.push(e);for(var t=0;t<a.length;++t)e.value.push(V.certificateExtensionToAsn1(a[t]));return n},V.certificateExtensionToAsn1=function(r){var a=A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[]);a.value.push(A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(r.id).getBytes())),r.critical&&a.value.push(A.create(A.Class.UNIVERSAL,A.Type.BOOLEAN,!1,String.fromCharCode(255)));var e=r.value;return"string"!=typeof r.value&&(e=A.toDer(e).getBytes()),a.value.push(A.create(A.Class.UNIVERSAL,A.Type.OCTETSTRING,!1,e)),a},V.certificationRequestToAsn1=function(t){var a=t.certificationRequestInfo||V.getCertificationRequestInfo(t);return A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[a,A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(t.signatureOid).getBytes()),i(t.signatureOid,t.signatureParameters)]),A.create(A.Class.UNIVERSAL,A.Type.BITSTRING,!1,String.fromCharCode(0)+t.signature)])},V.createCaStore=function(a){function n(e){return o(e),c.certs[e.hash]||null}function o(t){if(!t.hash){var a=v.md.sha1.create();t.attributes=V.RDNAttributesAsArray(I(t),a),t.hash=a.digest().toHex()}}var c={certs:{}};if(c.getIssuer=function(e){return n(e.issuer)},c.addCertificate=function(e){if("string"==typeof e&&(e=v.pki.certificateFromPem(e)),o(e.subject),!c.hasCertificate(e))if(e.subject.hash in c.certs){var t=c.certs[e.subject.hash];v.util.isArray(t)||(t=[t]),t.push(e),c.certs[e.subject.hash]=t}else c.certs[e.subject.hash]=e},c.hasCertificate=function(e){"string"==typeof e&&(e=v.pki.certificateFromPem(e));var r=n(e.subject);if(!r)return!1;v.util.isArray(r)||(r=[r]);for(var o=A.toDer(V.certificateToAsn1(e)).getBytes(),i=0;i<r.length;++i)if(o===A.toDer(V.certificateToAsn1(r[i])).getBytes())return!0;return!1},c.listAllCertificates=function(){var n=[];for(var a in c.certs)if(c.certs.hasOwnProperty(a)){var e=c.certs[a];if(v.util.isArray(e))for(var t=0;t<e.length;++t)n.push(e[t]);else n.push(e)}return n},c.removeCertificate=function(e){var d;if("string"==typeof e&&(e=v.pki.certificateFromPem(e)),o(e.subject),!c.hasCertificate(e))return null;var l=n(e.subject);if(!v.util.isArray(l))return d=c.certs[e.subject.hash],delete c.certs[e.subject.hash],d;for(var r=A.toDer(V.certificateToAsn1(e)).getBytes(),i=0;i<l.length;++i)r===A.toDer(V.certificateToAsn1(l[i])).getBytes()&&(d=l[i],l.splice(i,1));return 0===l.length&&delete c.certs[e.subject.hash],d},a)for(var r,s=0;s<a.length;++s)r=a[s],c.addCertificate(r);return c},V.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},V.verifyCertificateChain=function(t,r,n){"function"==typeof n&&(n={verify:n}),n=n||{},r=r.slice(0);var s=r.slice(0),i=n.validityCheckDate;void 0===i&&(i=new Date);var o=!0,d=null,l=0;do{var p=r.shift(),u=null,g=!1;if(i&&(i<p.validity.notBefore||i>p.validity.notAfter)&&(d={message:"Certificate is not valid yet or has expired.",error:V.certificateError.certificate_expired,notBefore:p.validity.notBefore,notAfter:p.validity.notAfter,now:i}),null===d){if(u=r[0]||t.getIssuer(p),null===u&&p.isIssuer(p)&&(g=!0,u=p),u){var h=u;v.util.isArray(h)||(h=[h]);for(var S=!1;!S&&0<h.length;){u=h.shift();try{S=u.verify(p)}catch(e){}}S||(d={message:"Certificate signature is invalid.",error:V.certificateError.bad_certificate})}null!==d||u&&!g||t.hasCertificate(p)||(d={message:"Certificate is not trusted.",error:V.certificateError.unknown_ca})}if(null===d&&u&&!p.isIssuer(u)&&(d={message:"Certificate issuer is invalid.",error:V.certificateError.bad_certificate}),null===d)for(var T,A={keyUsage:!0,basicConstraints:!0},b=0;null===d&&b<p.extensions.length;++b)T=p.extensions[b],!T.critical||T.name in A||(d={message:"Certificate has an unsupported critical extension.",error:V.certificateError.unsupported_certificate});if(null===d&&(!o||0===r.length&&(!u||g))){var R=p.getExtension("basicConstraints"),D=p.getExtension("keyUsage");(null!==D&&(D.keyCertSign&&null!==R||(d={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:V.certificateError.bad_certificate})),null!=d||null===R||R.cA||(d={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:V.certificateError.bad_certificate}),null==d&&null!==D&&"pathLenConstraint"in R)&&l-1>R.pathLenConstraint&&(d={message:"Certificate basicConstraints pathLenConstraint violated.",error:V.certificateError.bad_certificate})}var m=null===d||d.error,C=n.verify?n.verify(m,l,s):m;if(!0!==C)throw!0===m&&(d={message:"The application rejected the certificate.",error:V.certificateError.bad_certificate}),(C||0===C)&&("object"!=typeof C||v.util.isArray(C)?"string"==typeof C&&(d.error=C):(C.message&&(d.message=C.message),C.error&&(d.error=C.error))),d;d=null,o=!1,++l}while(0<r.length);return!0}},function(a,r,e){var C=e(0);e(2),e(1),(a.exports=C.pss=C.pss||{}).create=function(e){3===arguments.length&&(e={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var S=e.md,T=e.mgf,t=S.digestLength,r=e.salt||null;"string"==typeof r&&(r=C.util.createBuffer(r));var A;if("saltLength"in e)A=e.saltLength;else{if(null===r)throw new Error("Salt length not specified or specific salt not given.");A=r.length()}if(null!==r&&r.length()!==A)throw new Error("Given salt length does not match length of given salt.");var u=e.prng||C.random,s={};return s.encode=function(n,a){var e,E=a-1,i=Math.ceil(E/8),o=n.digest().getBytes();if(i<t+A+2)throw new Error("Message is too long to encrypt.");var c=null===r?u.getBytesSync(A):r.bytes(),l=new C.util.ByteBuffer;l.fillWithByte(0,8),l.putBytes(o),l.putBytes(c),S.start(),S.update(l.getBytes());var p=S.digest().getBytes(),d=new C.util.ByteBuffer;d.fillWithByte(0,i-A-t-2),d.putByte(1),d.putBytes(c);var y=d.getBytes(),g=i-t-1,h=T.generate(p,g),f="";for(e=0;e<g;e++)f+=String.fromCharCode(y.charCodeAt(e)^h.charCodeAt(e));return(f=String.fromCharCode(f.charCodeAt(0)&~(255&65280>>8*i-E))+f.substr(1))+p+String.fromCharCode(188)},s.verify=function(r,a,i){var n,c=i-1,o=Math.ceil(c/8);if(a=a.substr(-o),o<t+A+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(188!==a.charCodeAt(o-1))throw new Error("Encoded message does not end in 0xBC.");var u=o-t-1,l=a.substr(0,u),p=a.substr(u,t),g=255&65280>>8*o-c;if(0!=(l.charCodeAt(0)&g))throw new Error("Bits beyond keysize not zero as expected.");var h=T.generate(p,u),d="";for(n=0;n<u;n++)d+=String.fromCharCode(l.charCodeAt(n)^h.charCodeAt(n));d=String.fromCharCode(d.charCodeAt(0)&~g)+d.substr(1);var f=o-t-A-2;for(n=0;n<f;n++)if(0!==d.charCodeAt(n))throw new Error("Leftmost octets not zero as expected");if(1!==d.charCodeAt(f))throw new Error("Inconsistent PSS signature, 0x01 marker not found");var E=d.substr(-A),I=new C.util.ByteBuffer;return I.fillWithByte(0,8),I.putBytes(r),I.putBytes(E),S.start(),S.update(I.getBytes()),p===S.digest().getBytes()},s}},function(n,s,e){function o(e,a){if("string"==typeof e&&(e=d.util.createBuffer(e)),d.util.isArray(e)&&4<e.length){var n=e;e=d.util.createBuffer();for(var t=0;t<n.length;++t)e.putByte(n[t])}if(e.length()<a)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+a+" bytes.");if(!d.util.isArray(e)){for(var i=[],t=0;t<a/4;++t)i.push(e.getInt32());e=i}return e}function p(e){e[e.length-1]=4294967295&e[e.length-1]+1}function r(e){return[0|e/4294967296,4294967295&e]}var d=e(0);e(1),d.cipher=d.cipher||{};var t=n.exports=d.cipher.modes=d.cipher.modes||{};t.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=Array(this._ints),this._outBlock=Array(this._ints)},t.ecb.prototype.start=function(){},t.ecb.prototype.encrypt=function(a,n,e){if(a.length()<this.blockSize&&!(e&&0<a.length()))return!0;for(var t=0;t<this._ints;++t)this._inBlock[t]=a.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var t=0;t<this._ints;++t)n.putInt32(this._outBlock[t])},t.ecb.prototype.decrypt=function(a,n,e){if(a.length()<this.blockSize&&!(e&&0<a.length()))return!0;for(var t=0;t<this._ints;++t)this._inBlock[t]=a.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var t=0;t<this._ints;++t)n.putInt32(this._outBlock[t])},t.ecb.prototype.pad=function(a){var t=a.length()===this.blockSize?this.blockSize:this.blockSize-a.length();return a.fillWithByte(t,t),!0},t.ecb.prototype.unpad=function(a,n){if(0<n.overflow)return!1;var e=a.length(),t=a.at(e-1);return!(t>this.blockSize<<2)&&(a.truncate(t),!0)},t.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=Array(this._ints),this._outBlock=Array(this._ints)},t.cbc.prototype.start=function(e){if(null===e.iv){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else{if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=o(e.iv,this.blockSize),this._prev=this._iv.slice(0)}},t.cbc.prototype.encrypt=function(a,n,e){if(a.length()<this.blockSize&&!(e&&0<a.length()))return!0;for(var t=0;t<this._ints;++t)this._inBlock[t]=this._prev[t]^a.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var t=0;t<this._ints;++t)n.putInt32(this._outBlock[t]);this._prev=this._outBlock},t.cbc.prototype.decrypt=function(a,n,e){if(a.length()<this.blockSize&&!(e&&0<a.length()))return!0;for(var t=0;t<this._ints;++t)this._inBlock[t]=a.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var t=0;t<this._ints;++t)n.putInt32(this._prev[t]^this._outBlock[t]);this._prev=this._inBlock.slice(0)},t.cbc.prototype.pad=function(a){var t=a.length()===this.blockSize?this.blockSize:this.blockSize-a.length();return a.fillWithByte(t,t),!0},t.cbc.prototype.unpad=function(a,n){if(0<n.overflow)return!1;var e=a.length(),t=a.at(e-1);return!(t>this.blockSize<<2)&&(a.truncate(t),!0)},t.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=Array(this._ints),this._partialBlock=Array(this._ints),this._partialOutput=d.util.createBuffer(),this._partialBytes=0},t.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=o(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},t.cfb.prototype.encrypt=function(n,s,e){var t=n.length();if(0===t)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&t>=this.blockSize)for(var r=0;r<this._ints;++r)this._inBlock[r]=n.getInt32()^this._outBlock[r],s.putInt32(this._inBlock[r]);else{var i=(this.blockSize-t)%this.blockSize;0<i&&(i=this.blockSize-i),this._partialOutput.clear();for(var r=0;r<this._ints;++r)this._partialBlock[r]=n.getInt32()^this._outBlock[r],this._partialOutput.putInt32(this._partialBlock[r]);if(0<i)n.read-=this.blockSize;else for(var r=0;r<this._ints;++r)this._inBlock[r]=this._partialBlock[r];if(0<this._partialBytes&&this._partialOutput.getBytes(this._partialBytes),0<i&&!e)return s.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;s.putBytes(this._partialOutput.getBytes(t-this._partialBytes)),this._partialBytes=0}},t.cfb.prototype.decrypt=function(n,s,e){var t=n.length();if(0===t)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&t>=this.blockSize)for(var r=0;r<this._ints;++r)this._inBlock[r]=n.getInt32(),s.putInt32(this._inBlock[r]^this._outBlock[r]);else{var i=(this.blockSize-t)%this.blockSize;0<i&&(i=this.blockSize-i),this._partialOutput.clear();for(var r=0;r<this._ints;++r)this._partialBlock[r]=n.getInt32(),this._partialOutput.putInt32(this._partialBlock[r]^this._outBlock[r]);if(0<i)n.read-=this.blockSize;else for(var r=0;r<this._ints;++r)this._inBlock[r]=this._partialBlock[r];if(0<this._partialBytes&&this._partialOutput.getBytes(this._partialBytes),0<i&&!e)return s.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;s.putBytes(this._partialOutput.getBytes(t-this._partialBytes)),this._partialBytes=0}},t.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=Array(this._ints),this._partialOutput=d.util.createBuffer(),this._partialBytes=0},t.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=o(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},t.ofb.prototype.encrypt=function(n,s,e){var t=n.length();if(0===n.length())return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&t>=this.blockSize)for(var r=0;r<this._ints;++r)s.putInt32(n.getInt32()^this._outBlock[r]),this._inBlock[r]=this._outBlock[r];else{var i=(this.blockSize-t)%this.blockSize;0<i&&(i=this.blockSize-i),this._partialOutput.clear();for(var r=0;r<this._ints;++r)this._partialOutput.putInt32(n.getInt32()^this._outBlock[r]);if(0<i)n.read-=this.blockSize;else for(var r=0;r<this._ints;++r)this._inBlock[r]=this._outBlock[r];if(0<this._partialBytes&&this._partialOutput.getBytes(this._partialBytes),0<i&&!e)return s.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;s.putBytes(this._partialOutput.getBytes(t-this._partialBytes)),this._partialBytes=0}},t.ofb.prototype.decrypt=t.ofb.prototype.encrypt,t.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=Array(this._ints),this._partialOutput=d.util.createBuffer(),this._partialBytes=0},t.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=o(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},t.ctr.prototype.encrypt=function(s,n,e){var t=s.length();if(0===t)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&t>=this.blockSize)for(var r=0;r<this._ints;++r)n.putInt32(s.getInt32()^this._outBlock[r]);else{var i=(this.blockSize-t)%this.blockSize;0<i&&(i=this.blockSize-i),this._partialOutput.clear();for(var r=0;r<this._ints;++r)this._partialOutput.putInt32(s.getInt32()^this._outBlock[r]);if(0<i&&(s.read-=this.blockSize),0<this._partialBytes&&this._partialOutput.getBytes(this._partialBytes),0<i&&!e)return n.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;n.putBytes(this._partialOutput.getBytes(t-this._partialBytes)),this._partialBytes=0}p(this._inBlock)},t.ctr.prototype.decrypt=t.ctr.prototype.encrypt,t.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=Array(this._ints),this._outBlock=Array(this._ints),this._partialOutput=d.util.createBuffer(),this._partialBytes=0,this._R=3774873600},t.gcm.prototype.start=function(i){if(!("iv"in i))throw new Error("Invalid IV parameter.");var n=d.util.createBuffer(i.iv);this._cipherLength=0;var e;if(e="additionalData"in i?d.util.createBuffer(i.additionalData):d.util.createBuffer(),this._tagLength="tagLength"in i?i.tagLength:128,this._tag=null,i.decrypt&&(this._tag=d.util.createBuffer(i.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=Array(this._ints),this.tag=null,this._hashSubkey=Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var o=n.length();if(12===o)this._j0=[n.getInt32(),n.getInt32(),n.getInt32(),1];else{for(this._j0=[0,0,0,0];0<n.length();)this._j0=this.ghash(this._hashSubkey,this._j0,[n.getInt32(),n.getInt32(),n.getInt32(),n.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(r(8*o)))}this._inBlock=this._j0.slice(0),p(this._inBlock),this._partialBytes=0,e=d.util.createBuffer(e),this._aDataLength=r(8*e.length());var s=e.length()%this.blockSize;for(s&&e.fillWithByte(0,this.blockSize-s),this._s=[0,0,0,0];0<e.length();)this._s=this.ghash(this._hashSubkey,this._s,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()])},t.gcm.prototype.encrypt=function(s,n,e){var t=s.length();if(0===t)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&t>=this.blockSize){for(var r=0;r<this._ints;++r)n.putInt32(this._outBlock[r]^=s.getInt32());this._cipherLength+=this.blockSize}else{var i=(this.blockSize-t)%this.blockSize;0<i&&(i=this.blockSize-i),this._partialOutput.clear();for(var r=0;r<this._ints;++r)this._partialOutput.putInt32(s.getInt32()^this._outBlock[r]);if(0>=i||e){if(e){var o=t%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var r=0;r<this._ints;++r)this._outBlock[r]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(0<this._partialBytes&&this._partialOutput.getBytes(this._partialBytes),0<i&&!e)return s.read-=this.blockSize,n.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;n.putBytes(this._partialOutput.getBytes(t-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),p(this._inBlock)},t.gcm.prototype.decrypt=function(s,n,e){var t=s.length();if(t<this.blockSize&&!(e&&0<t))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),p(this._inBlock),this._hashBlock[0]=s.getInt32(),this._hashBlock[1]=s.getInt32(),this._hashBlock[2]=s.getInt32(),this._hashBlock[3]=s.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var r=0;r<this._ints;++r)n.putInt32(this._outBlock[r]^this._hashBlock[r]);this._cipherLength+=t<this.blockSize?t%this.blockSize:this.blockSize},t.gcm.prototype.afterFinish=function(i,s){var e=!0;s.decrypt&&s.overflow&&i.truncate(this.blockSize-s.overflow),this.tag=d.util.createBuffer();var o=this._aDataLength.concat(r(8*this._cipherLength));this._s=this.ghash(this._hashSubkey,this._s,o);var c=[];this.cipher.encrypt(this._j0,c);for(var a=0;a<this._ints;++a)this.tag.putInt32(this._s[a]^c[a]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),s.decrypt&&this.tag.bytes()!==this._tag&&(e=!1),e},t.gcm.prototype.multiply=function(n,s){for(var e=[0,0,0,0],t=s.slice(0),r=0;128>r;++r)n[0|r/32]&1<<31-r%32&&(e[0]^=t[0],e[1]^=t[1],e[2]^=t[2],e[3]^=t[3]),this.pow(t,t);return e},t.gcm.prototype.pow=function(a,n){for(var e=1&a[3],t=3;0<t;--t)n[t]=a[t]>>>1|(1&a[t-1])<<31;n[0]=a[0]>>>1,e&&(n[0]^=this._R)},t.gcm.prototype.tableMultiply=function(r){for(var s=[0,0,0,0],e=0;32>e;++e){var i=0|e/8,o=15&r[i]>>>4*(7-e%8),a=this._m[e][o];s[0]^=a[0],s[1]^=a[1],s[2]^=a[2],s[3]^=a[3]}return s},t.gcm.prototype.ghash=function(r,a,e){return a[0]^=e[0],a[1]^=e[1],a[2]^=e[2],a[3]^=e[3],this.tableMultiply(a)},t.gcm.prototype.generateHashTable=function(s,d){for(var e=8/d,t=4*e,r=16*e,a=Array(r),n=0;n<r;++n){var p=[0,0,0,0],l=0|n/t,o=(t-1-n%t)*d;p[l]=1<<d-1<<o,a[n]=this.generateSubHashTable(this.multiply(p,s),d)}return a},t.gcm.prototype.generateSubHashTable=function(s,i){var e=1<<i,t=e>>>1,r=Array(e);r[t]=s.slice(0);for(var a=t>>>1;0<a;)this.pow(r[2*a],r[a]=[]),a>>=1;for(a=2;a<t;){for(var d=1;d<a;++d){var u=r[a],p=r[d];r[a+d]=[u[0]^p[0],u[1]^p[1],u[2]^p[2],u[3]^p[3]]}a*=2}for(r[0]=[0,0,0,0],a=t+1;a<e;++a){var o=r[a^t];r[a]=[s[0]^o[0],s[1]^o[1],s[2]^o[2],s[3]^o[3]]}return r}},function(q,i,e){var j=e(0);e(3),e(8),e(14),e(7),e(21),e(2),e(9),e(1);var G=function(r,a,e,g){var y=j.util.createBuffer(),n=r.length>>1,i=n+(1&r.length),s=r.substr(0,i),o=r.substr(n,i),c=j.util.createBuffer(),u=j.hmac.create();e=a+e;var l=Math.ceil(g/16),p=Math.ceil(g/20);u.start("MD5",s);var f=j.util.createBuffer();c.putBytes(e);for(var h=0;h<l;++h)u.start(null,null),u.update(c.getBytes()),c.putBuffer(u.digest()),u.start(null,null),u.update(c.bytes()+e),f.putBuffer(u.digest());u.start("SHA1",o);var m=j.util.createBuffer();c.clear(),c.putBytes(e);for(var h=0;h<p;++h)u.start(null,null),u.update(c.getBytes()),c.putBuffer(u.digest()),u.start(null,null),u.update(c.bytes()+e),m.putBuffer(u.digest());return y.putBytes(j.util.xorBytes(f.getBytes(),m.getBytes(),g)),y},t=function(n,a){var e=!1;try{var s=n.deflate(a.fragment.getBytes());a.fragment=j.util.createBuffer(s),a.length=s.length,e=!0}catch(e){}return e},r=function(n,a){var e=!1;try{var s=n.inflate(a.fragment.getBytes());a.fragment=j.util.createBuffer(s),a.length=s.length,e=!0}catch(e){}return e},M=function(r,a){var e=0;return 1===a?e=r.getByte():2===a?e=r.getInt16():3===a?e=r.getInt24():4===a?e=r.getInt32():void 0,j.util.createBuffer(r.getBytes(e))},H=function(r,a,e){r.putInt(e.length(),a<<3),r.putBuffer(e)},Q={};Q.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}},Q.SupportedVersions=[Q.Versions.TLS_1_1,Q.Versions.TLS_1_0],Q.Version=Q.SupportedVersions[0],Q.MaxFragment=15360,Q.ConnectionEnd={server:0,client:1},Q.PRFAlgorithm={tls_prf_sha256:0},Q.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2},Q.CipherType={stream:0,block:1,aead:2},Q.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4},Q.CompressionMethod={none:0,deflate:1},Q.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24},Q.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20},Q.Alert={},Q.Alert.Level={warning:1,fatal:2},Q.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100},Q.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2},Q.CipherSuites={},Q.getCipherSuite=function(t){var a=null;for(var n in Q.CipherSuites){var s=Q.CipherSuites[n];if(s.id[0]===t.charCodeAt(0)&&s.id[1]===t.charCodeAt(1)){a=s;break}}return a},Q.handleUnexpected=function(e){(e.open||e.entity!==Q.ConnectionEnd.client)&&e.error(e,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:Q.Alert.Level.fatal,description:Q.Alert.Description.unexpected_message}})},Q.handleHelloRequest=function(e){!e.handshaking&&0<e.handshakes&&(Q.queue(e,Q.createAlert(e,{level:Q.Alert.Level.warning,description:Q.Alert.Description.no_renegotiation})),Q.flush(e)),e.process()},Q.parseHelloMessage=function(n,a,e){var t=null,o=n.entity===Q.ConnectionEnd.client;if(38>e)n.error(n,{message:o?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:Q.Alert.Level.fatal,description:Q.Alert.Description.illegal_parameter}});else{var c=a.fragment,i=c.length();if(t={version:{major:c.getByte(),minor:c.getByte()},random:j.util.createBuffer(c.getBytes(32)),session_id:M(c,1),extensions:[]},o?(t.cipher_suite=c.getBytes(2),t.compression_method=c.getByte()):(t.cipher_suites=M(c,2),t.compression_methods=M(c,1)),0<(i=e-(i-c.length()))){for(var d=M(c,2);0<d.length();)t.extensions.push({type:[d.getByte(),d.getByte()],data:M(d,2)});if(!o)for(var l,p=0;p<t.extensions.length;++p)if(l=t.extensions[p],0===l.type[0]&&0===l.type[1])for(var y,f=M(l.data,2);0<f.length()&&(y=f.getByte(),0===y);)n.session.extensions.server_name.serverNameList.push(M(f,2).getBytes())}if(n.session.version&&(t.version.major!==n.session.version.major||t.version.minor!==n.session.version.minor))return n.error(n,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:Q.Alert.Level.fatal,description:Q.Alert.Description.protocol_version}});if(o)n.session.cipherSuite=Q.getCipherSuite(t.cipher_suite);else for(var C=j.util.createBuffer(t.cipher_suites.bytes());0<C.length()&&(n.session.cipherSuite=Q.getCipherSuite(C.getBytes(2)),null===n.session.cipherSuite););if(null===n.session.cipherSuite)return n.error(n,{message:"No cipher suites in common.",send:!0,alert:{level:Q.Alert.Level.fatal,description:Q.Alert.Description.handshake_failure},cipherSuite:j.util.bytesToHex(t.cipher_suite)});n.session.compressionMethod=o?t.compression_method:Q.CompressionMethod.none}return t},Q.createSecurityParameters=function(i,s){var e=i.entity===Q.ConnectionEnd.client,t=s.random.bytes(),r=e?i.session.sp.client_random:t,a=e?t:Q.createRandom().getBytes();i.session.sp={entity:i.entity,prf_algorithm:Q.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:i.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:r,server_random:a}},Q.handleServerHello=function(n,s,e){var t=Q.parseHelloMessage(n,s,e);if(!n.fail){if(!(t.version.minor<=n.version.minor))return n.error(n,{message:"Incompatible TLS version.",send:!0,alert:{level:Q.Alert.Level.fatal,description:Q.Alert.Description.protocol_version}});n.version.minor=t.version.minor,n.session.version=n.version;var r=t.session_id.bytes();0<r.length&&r===n.session.id?(n.expect=o,n.session.resuming=!0,n.session.sp.server_random=t.random.bytes()):(n.expect=Y,n.session.resuming=!1,Q.createSecurityParameters(n,t)),n.session.id=r,n.process()}},Q.handleClientHello=function(s,a,e){var t=Q.parseHelloMessage(s,a,e);if(!s.fail){var r=t.session_id.bytes(),i=null;if(s.sessionCache&&(i=s.sessionCache.getSession(r),null===i?r="":(i.version.major!==t.version.major||i.version.minor>t.version.minor)&&(i=null,r="")),0===r.length&&(r=j.random.getBytes(32)),s.session.id=r,s.session.clientHelloVersion=t.version,s.session.sp={},i)s.version=s.session.version=i.version,s.session.sp=i.sp;else{for(var o,c=1;c<Q.SupportedVersions.length&&(o=Q.SupportedVersions[c],!(o.minor<=t.version.minor));++c);s.version={major:o.major,minor:o.minor},s.session.version=s.version}null===i?(s.expect=!1===s.verifyClient?g:u,s.session.resuming=!1,Q.createSecurityParameters(s,t)):(s.expect=y,s.session.resuming=!0,s.session.sp.client_random=t.random.bytes()),s.open=!0,Q.queue(s,Q.createRecord(s,{type:Q.ContentType.handshake,data:Q.createServerHello(s)})),s.session.resuming?(Q.queue(s,Q.createRecord(s,{type:Q.ContentType.change_cipher_spec,data:Q.createChangeCipherSpec()})),s.state.pending=Q.createConnectionState(s),s.state.current.write=s.state.pending.write,Q.queue(s,Q.createRecord(s,{type:Q.ContentType.handshake,data:Q.createFinished(s)}))):(Q.queue(s,Q.createRecord(s,{type:Q.ContentType.handshake,data:Q.createCertificate(s)})),s.fail||(Q.queue(s,Q.createRecord(s,{type:Q.ContentType.handshake,data:Q.createServerKeyExchange(s)})),!1!==s.verifyClient&&Q.queue(s,Q.createRecord(s,{type:Q.ContentType.handshake,data:Q.createCertificateRequest(s)})),Q.queue(s,Q.createRecord(s,{type:Q.ContentType.handshake,data:Q.createServerHelloDone(s)})))),Q.flush(s),s.process()}},Q.handleCertificate=function(n,a,e){if(3>e)return n.error(n,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:Q.Alert.Level.fatal,description:Q.Alert.Description.illegal_parameter}});var t,i,c=a.fragment,l={certificate_list:M(c,3)},s=[];try{for(;0<l.certificate_list.length();)t=M(l.certificate_list,3),i=j.asn1.fromDer(t),t=j.pki.certificateFromAsn1(i,!0),s.push(t)}catch(t){return n.error(n,{message:"Could not parse certificate list.",cause:t,send:!0,alert:{level:Q.Alert.Level.fatal,description:Q.Alert.Description.bad_certificate}})}var o=n.entity===Q.ConnectionEnd.client;(o||!0===n.verifyClient)&&0===s.length?n.error(n,{message:o?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:Q.Alert.Level.fatal,description:Q.Alert.Description.illegal_parameter}}):0===s.length?n.expect=o?W:g:(o?n.session.serverCertificate=s[0]:n.session.clientCertificate=s[0],Q.verifyCertificateChain(n,s)&&(n.expect=o?W:g)),n.process()},Q.handleServerKeyExchange=function(r,a,e){return 0<e?r.error(r,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:Q.Alert.Level.fatal,description:Q.Alert.Description.unsupported_certificate}}):void(r.expect=s,r.process())},Q.handleClientKeyExchange=function(s,a,e){if(48>e)return s.error(s,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:Q.Alert.Level.fatal,description:Q.Alert.Description.unsupported_certificate}});var t=a.fragment,r={enc_pre_master_secret:M(t,2).getBytes()},n=null;if(s.getPrivateKey)try{n=s.getPrivateKey(s,s.session.serverCertificate),n=j.pki.privateKeyFromPem(n)}catch(t){s.error(s,{message:"Could not get private key.",cause:t,send:!0,alert:{level:Q.Alert.Level.fatal,description:Q.Alert.Description.internal_error}})}if(null===n)return s.error(s,{message:"No private key set.",send:!0,alert:{level:Q.Alert.Level.fatal,description:Q.Alert.Description.internal_error}});try{var d=s.session.sp;d.pre_master_secret=n.decrypt(r.enc_pre_master_secret);var c=s.session.clientHelloVersion;if(c.major!==d.pre_master_secret.charCodeAt(0)||c.minor!==d.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch(e){d.pre_master_secret=j.random.getBytes(48)}s.expect=y,null!==s.session.clientCertificate&&(s.expect=p),s.process()},Q.handleCertificateRequest=function(i,s,e){if(3>e)return i.error(i,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:Q.Alert.Level.fatal,description:Q.Alert.Description.illegal_parameter}});var t=s.fragment,r={certificate_types:M(t,1),certificate_authorities:M(t,2)};i.session.certificateRequest=r,i.expect=n,i.process()},Q.handleCertificateVerify=function(o,a,e){if(2>e)return o.error(o,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:Q.Alert.Level.fatal,description:Q.Alert.Description.illegal_parameter}});var t=a.fragment;t.read-=4;var r=t.bytes();t.read+=4;var n={signature:M(t,2).getBytes()},i=j.util.createBuffer();i.putBuffer(o.session.md5.digest()),i.putBuffer(o.session.sha1.digest()),i=i.getBytes();try{if(!o.session.clientCertificate.publicKey.verify(i,n.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");o.session.md5.update(r),o.session.sha1.update(r)}catch(t){return o.error(o,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:Q.Alert.Level.fatal,description:Q.Alert.Description.handshake_failure}})}o.expect=y,o.process()},Q.handleServerHelloDone=function(t,a,s){if(0<s)return t.error(t,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:Q.Alert.Level.fatal,description:Q.Alert.Description.record_overflow}});if(null===t.serverCertificate){var c={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:Q.Alert.Level.fatal,description:Q.Alert.Description.insufficient_security}},r=t.verify(t,c.alert.description,0,[]);if(!0!==r)return(r||0===r)&&("object"!=typeof r||j.util.isArray(r)?"number"==typeof r&&(c.alert.description=r):(r.message&&(c.message=r.message),r.alert&&(c.alert.description=r.alert))),t.error(t,c)}null!==t.session.certificateRequest&&(a=Q.createRecord(t,{type:Q.ContentType.handshake,data:Q.createCertificate(t)}),Q.queue(t,a)),a=Q.createRecord(t,{type:Q.ContentType.handshake,data:Q.createClientKeyExchange(t)}),Q.queue(t,a),t.expect=l;var n=function(t,a){null!==t.session.certificateRequest&&null!==t.session.clientCertificate&&Q.queue(t,Q.createRecord(t,{type:Q.ContentType.handshake,data:Q.createCertificateVerify(t,a)})),Q.queue(t,Q.createRecord(t,{type:Q.ContentType.change_cipher_spec,data:Q.createChangeCipherSpec()})),t.state.pending=Q.createConnectionState(t),t.state.current.write=t.state.pending.write,Q.queue(t,Q.createRecord(t,{type:Q.ContentType.handshake,data:Q.createFinished(t)})),t.expect=o,Q.flush(t),t.process()};return null===t.session.certificateRequest||null===t.session.clientCertificate?n(t,null):void Q.getClientSignature(t,n)},Q.handleChangeCipherSpec=function(r,a){if(1!==a.fragment.getByte())return r.error(r,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:Q.Alert.Level.fatal,description:Q.Alert.Description.illegal_parameter}});var e=r.entity===Q.ConnectionEnd.client;(r.session.resuming&&e||!r.session.resuming&&!e)&&(r.state.pending=Q.createConnectionState(r)),r.state.current.read=r.state.pending.read,(!r.session.resuming&&e||r.session.resuming&&!e)&&(r.state.pending=null),r.expect=e?c:h,r.process()},Q.handleFinished=function(i,a){var e=a.fragment;e.read-=4;var l=e.bytes();e.read+=4;var r=a.fragment.getBytes();e=j.util.createBuffer(),e.putBuffer(i.session.md5.digest()),e.putBuffer(i.session.sha1.digest());var n=i.entity===Q.ConnectionEnd.client,s=n?"server finished":"client finished",o=i.session.sp;return(e=G(o.master_secret,s,e.getBytes(),12),e.getBytes()!==r)?i.error(i,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:Q.Alert.Level.fatal,description:Q.Alert.Description.decrypt_error}}):void(i.session.md5.update(l),i.session.sha1.update(l),(i.session.resuming&&n||!i.session.resuming&&!n)&&(Q.queue(i,Q.createRecord(i,{type:Q.ContentType.change_cipher_spec,data:Q.createChangeCipherSpec()})),i.state.current.write=i.state.pending.write,i.state.pending=null,Q.queue(i,Q.createRecord(i,{type:Q.ContentType.handshake,data:Q.createFinished(i)}))),i.expect=n?d:f,i.handshaking=!1,++i.handshakes,i.peerCertificate=n?i.session.serverCertificate:i.session.clientCertificate,Q.flush(i),i.isConnected=!0,i.connected(i),i.process())},Q.handleAlert=function(r,n){var e,s=n.fragment,i={level:s.getByte(),description:s.getByte()};switch(i.description){case Q.Alert.Description.close_notify:e="Connection closed.";break;case Q.Alert.Description.unexpected_message:e="Unexpected message.";break;case Q.Alert.Description.bad_record_mac:e="Bad record MAC.";break;case Q.Alert.Description.decryption_failed:e="Decryption failed.";break;case Q.Alert.Description.record_overflow:e="Record overflow.";break;case Q.Alert.Description.decompression_failure:e="Decompression failed.";break;case Q.Alert.Description.handshake_failure:e="Handshake failure.";break;case Q.Alert.Description.bad_certificate:e="Bad certificate.";break;case Q.Alert.Description.unsupported_certificate:e="Unsupported certificate.";break;case Q.Alert.Description.certificate_revoked:e="Certificate revoked.";break;case Q.Alert.Description.certificate_expired:e="Certificate expired.";break;case Q.Alert.Description.certificate_unknown:e="Certificate unknown.";break;case Q.Alert.Description.illegal_parameter:e="Illegal parameter.";break;case Q.Alert.Description.unknown_ca:e="Unknown certificate authority.";break;case Q.Alert.Description.access_denied:e="Access denied.";break;case Q.Alert.Description.decode_error:e="Decode error.";break;case Q.Alert.Description.decrypt_error:e="Decrypt error.";break;case Q.Alert.Description.export_restriction:e="Export restriction.";break;case Q.Alert.Description.protocol_version:e="Unsupported protocol version.";break;case Q.Alert.Description.insufficient_security:e="Insufficient security.";break;case Q.Alert.Description.internal_error:e="Internal error.";break;case Q.Alert.Description.user_canceled:e="User canceled.";break;case Q.Alert.Description.no_renegotiation:e="Renegotiation not supported.";break;default:e="Unknown error.";}return i.description===Q.Alert.Description.close_notify?r.close():void(r.error(r,{message:e,send:!1,origin:r.entity===Q.ConnectionEnd.client?"server":"client",alert:i}),r.process())},Q.handleHandshake=function(s,a){var e=a.fragment,t=e.getByte(),r=e.getInt24();if(r>e.length())return s.fragmented=a,a.fragment=j.util.createBuffer(),e.read-=4,s.process();s.fragmented=null,e.read-=4;var n=e.bytes(r+4);e.read+=4,t in _[s.entity][s.expect]?(s.entity!==Q.ConnectionEnd.server||s.open||s.fail||(s.handshaking=!0,s.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:j.md.md5.create(),sha1:j.md.sha1.create()}),t!==Q.HandshakeType.hello_request&&t!==Q.HandshakeType.certificate_verify&&t!==Q.HandshakeType.finished&&(s.session.md5.update(n),s.session.sha1.update(n)),_[s.entity][s.expect][t](s,a,r)):Q.handleUnexpected(s,a)},Q.handleApplicationData=function(t,a){t.data.putBuffer(a.fragment),t.dataReady(t),t.process()},Q.handleHeartbeat=function(s,a){var e=a.fragment,t=e.getByte(),r=e.getInt16(),n=e.getBytes(r);if(t===Q.HeartbeatMessageType.heartbeat_request){if(s.handshaking||r>n.length)return s.process();Q.queue(s,Q.createRecord(s,{type:Q.ContentType.heartbeat,data:Q.createHeartbeat(Q.HeartbeatMessageType.heartbeat_response,n)})),Q.flush(s)}else if(t===Q.HeartbeatMessageType.heartbeat_response){if(n!==s.expectedHeartbeatPayload)return s.process();s.heartbeatReceived&&s.heartbeatReceived(s,j.util.createBuffer(n))}s.process()};var Y=1,W=2,s=3,n=4,o=5,c=6,d=7,l=8,u=1,g=2,p=3,y=4,h=5,f=6,a=Q.handleUnexpected,m=Q.handleChangeCipherSpec,C=Q.handleAlert,E=Q.handleHandshake,S=Q.handleApplicationData,T=Q.handleHeartbeat,I=[];I[Q.ConnectionEnd.client]=[[a,C,E,a,T],[a,C,E,a,T],[a,C,E,a,T],[a,C,E,a,T],[a,C,E,a,T],[m,C,a,a,T],[a,C,E,a,T],[a,C,E,S,T],[a,C,E,a,T]],I[Q.ConnectionEnd.server]=[[a,C,E,a,T],[a,C,E,a,T],[a,C,E,a,T],[a,C,E,a,T],[m,C,a,a,T],[a,C,E,a,T],[a,C,E,S,T],[a,C,E,a,T]];var B=Q.handleHelloRequest,A=Q.handleServerHello,b=Q.handleCertificate,v=Q.handleServerKeyExchange,N=Q.handleCertificateRequest,R=Q.handleServerHelloDone,L=Q.handleFinished,_=[];_[Q.ConnectionEnd.client]=[[a,a,A,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a],[B,a,a,a,a,a,a,a,a,a,a,b,v,N,R,a,a,a,a,a,a],[B,a,a,a,a,a,a,a,a,a,a,a,v,N,R,a,a,a,a,a,a],[B,a,a,a,a,a,a,a,a,a,a,a,a,N,R,a,a,a,a,a,a],[B,a,a,a,a,a,a,a,a,a,a,a,a,a,R,a,a,a,a,a,a],[B,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a],[B,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,L],[B,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a],[B,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a]];var k=Q.handleClientHello,U=Q.handleClientKeyExchange,D=Q.handleCertificateVerify;_[Q.ConnectionEnd.server]=[[a,k,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a],[a,a,a,a,a,a,a,a,a,a,a,b,a,a,a,a,a,a,a,a,a],[a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,U,a,a,a,a],[a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,D,a,a,a,a,a],[a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a],[a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,L],[a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a],[a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a]],Q.generateKeys=function(a,n){var e=G,t=n.client_random+n.server_random;a.session.resuming||(n.master_secret=e(n.pre_master_secret,"master secret",t,48).bytes(),n.pre_master_secret=null),t=n.server_random+n.client_random;var i=2*n.mac_key_length+2*n.enc_key_length,c=a.version.major===Q.Versions.TLS_1_0.major&&a.version.minor===Q.Versions.TLS_1_0.minor;c&&(i+=2*n.fixed_iv_length);var l=e(n.master_secret,"key expansion",t,i),s={client_write_MAC_key:l.getBytes(n.mac_key_length),server_write_MAC_key:l.getBytes(n.mac_key_length),client_write_key:l.getBytes(n.enc_key_length),server_write_key:l.getBytes(n.enc_key_length)};return c&&(s.client_write_IV=l.getBytes(n.fixed_iv_length),s.server_write_IV=l.getBytes(n.fixed_iv_length)),s},Q.createConnectionState=function(n){var s=n.entity===Q.ConnectionEnd.client,e=function(){var e={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(){return!0},compressionState:null,compressFunction:function(){return!0},updateSequenceNumber:function(){4294967295===e.sequenceNumber[1]?(e.sequenceNumber[1]=0,++e.sequenceNumber[0]):++e.sequenceNumber[1]}};return e},i={read:e(),write:e()};if(i.read.update=function(t,a){return i.read.cipherFunction(a,i.read)?i.read.compressFunction(t,a,i.read)||t.error(t,{message:"Could not decompress record.",send:!0,alert:{level:Q.Alert.Level.fatal,description:Q.Alert.Description.decompression_failure}}):t.error(t,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:Q.Alert.Level.fatal,description:Q.Alert.Description.bad_record_mac}}),!t.fail},i.write.update=function(t,a){return i.write.compressFunction(t,a,i.write)?i.write.cipherFunction(a,i.write)||t.error(t,{message:"Could not encrypt record.",send:!1,alert:{level:Q.Alert.Level.fatal,description:Q.Alert.Description.internal_error}}):t.error(t,{message:"Could not compress record.",send:!1,alert:{level:Q.Alert.Level.fatal,description:Q.Alert.Description.internal_error}}),!t.fail},n.session){var o=n.session.sp;switch(n.session.cipherSuite.initSecurityParameters(o),o.keys=Q.generateKeys(n,o),i.read.macKey=s?o.keys.server_write_MAC_key:o.keys.client_write_MAC_key,i.write.macKey=s?o.keys.client_write_MAC_key:o.keys.server_write_MAC_key,n.session.cipherSuite.initConnectionState(i,n,o),o.compression_algorithm){case Q.CompressionMethod.none:break;case Q.CompressionMethod.deflate:i.read.compressFunction=r,i.write.compressFunction=t;break;default:throw new Error("Unsupported compression algorithm.");}}return i},Q.createRandom=function(){var r=new Date,a=+r+6e4*r.getTimezoneOffset(),e=j.util.createBuffer();return e.putInt32(a),e.putBytes(j.random.getBytes(28)),e},Q.createRecord=function(t,a){return a.data?{type:a.type,version:{major:t.version.major,minor:t.version.minor},length:a.data.length(),fragment:a.data}:null},Q.createAlert=function(r,a){var e=j.util.createBuffer();return e.putByte(a.level),e.putByte(a.description),Q.createRecord(r,{type:Q.ContentType.alert,data:e})},Q.createClientHello=function(a){a.session.clientHelloVersion={major:a.version.major,minor:a.version.minor};for(var r,n=j.util.createBuffer(),d=0;d<a.cipherSuites.length;++d)r=a.cipherSuites[d],n.putByte(r.id[0]),n.putByte(r.id[1]);var l=n.length(),u=j.util.createBuffer();u.putByte(Q.CompressionMethod.none);var i=u.length(),s=j.util.createBuffer();if(a.virtualHost){var o=j.util.createBuffer();o.putByte(0),o.putByte(0);var c=j.util.createBuffer();c.putByte(0),H(c,2,j.util.createBuffer(a.virtualHost));var p=j.util.createBuffer();H(p,2,c),H(o,2,p),s.putBuffer(o)}var f=s.length();0<f&&(f+=2);var m=a.session.id,C=m.length+1+2+4+28+2+l+1+i+f,y=j.util.createBuffer();return y.putByte(Q.HandshakeType.client_hello),y.putInt24(C),y.putByte(a.version.major),y.putByte(a.version.minor),y.putBytes(a.session.sp.client_random),H(y,1,j.util.createBuffer(m)),H(y,2,n),H(y,1,u),0<f&&H(y,2,s),y},Q.createServerHello=function(a){var n=a.session.id,e=n.length+1+2+4+28+2+1,t=j.util.createBuffer();return t.putByte(Q.HandshakeType.server_hello),t.putInt24(e),t.putByte(a.version.major),t.putByte(a.version.minor),t.putBytes(a.session.sp.server_random),H(t,1,j.util.createBuffer(n)),t.putByte(a.session.cipherSuite.id[0]),t.putByte(a.session.cipherSuite.id[1]),t.putByte(a.session.compressionMethod),t},Q.createCertificate=function(a){var r=a.entity===Q.ConnectionEnd.client,e=null;if(a.getCertificate){var n;n=r?a.session.certificateRequest:a.session.extensions.server_name.serverNameList,e=a.getCertificate(a,n)}var s=j.util.createBuffer();if(null!==e)try{j.util.isArray(e)||(e=[e]);for(var o,c=null,l=0;l<e.length;++l){if(o=j.pem.decode(e[l])[0],"CERTIFICATE"!==o.type&&"X509 CERTIFICATE"!==o.type&&"TRUSTED CERTIFICATE"!==o.type){var g=new Error("Could not convert certificate from PEM; PEM header type is not \"CERTIFICATE\", \"X509 CERTIFICATE\", or \"TRUSTED CERTIFICATE\".");throw g.headerType=o.type,g}if(o.procType&&"ENCRYPTED"===o.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var y=j.util.createBuffer(o.body);null===c&&(c=j.asn1.fromDer(y.bytes(),!1));var p=j.util.createBuffer();H(p,3,y),s.putBuffer(p)}e=j.pki.certificateFromAsn1(c),r?a.session.clientCertificate=e:a.session.serverCertificate=e}catch(t){return a.error(a,{message:"Could not send certificate list.",cause:t,send:!0,alert:{level:Q.Alert.Level.fatal,description:Q.Alert.Description.bad_certificate}})}var f=3+s.length(),h=j.util.createBuffer();return h.putByte(Q.HandshakeType.certificate),h.putInt24(f),H(h,3,s),h},Q.createClientKeyExchange=function(t){var a=j.util.createBuffer();a.putByte(t.session.clientHelloVersion.major),a.putByte(t.session.clientHelloVersion.minor),a.putBytes(j.random.getBytes(46));var i=t.session.sp;i.pre_master_secret=a.getBytes(),a=t.session.serverCertificate.publicKey.encrypt(i.pre_master_secret);var s=a.length+2,r=j.util.createBuffer();return r.putByte(Q.HandshakeType.client_key_exchange),r.putInt24(s),r.putInt16(a.length),r.putBytes(a),r},Q.createServerKeyExchange=function(){var t=j.util.createBuffer();return t},Q.getClientSignature=function(r,a){var e=j.util.createBuffer();e.putBuffer(r.session.md5.digest()),e.putBuffer(r.session.sha1.digest()),e=e.getBytes(),r.getSignature=r.getSignature||function(t,a,n){var s=null;if(t.getPrivateKey)try{s=t.getPrivateKey(t,t.session.clientCertificate),s=j.pki.privateKeyFromPem(s)}catch(a){t.error(t,{message:"Could not get private key.",cause:a,send:!0,alert:{level:Q.Alert.Level.fatal,description:Q.Alert.Description.internal_error}})}null===s?t.error(t,{message:"No private key set.",send:!0,alert:{level:Q.Alert.Level.fatal,description:Q.Alert.Description.internal_error}}):a=s.sign(a,null),n(t,a)},r.getSignature(r,e,a)},Q.createCertificateVerify=function(n,a){var e=a.length+2,t=j.util.createBuffer();return t.putByte(Q.HandshakeType.certificate_verify),t.putInt24(e),t.putInt16(a.length),t.putBytes(a),t},Q.createCertificateRequest=function(a){var d=j.util.createBuffer();d.putByte(1);var e=j.util.createBuffer();for(var t in a.caStore.certs){var r=a.caStore.certs[t],n=j.pki.distinguishedNameToAsn1(r.subject),i=j.asn1.toDer(n);e.putInt16(i.length()),e.putBuffer(i)}var s=1+d.length()+2+e.length(),o=j.util.createBuffer();return o.putByte(Q.HandshakeType.certificate_request),o.putInt24(s),H(o,1,d),H(o,2,e),o},Q.createServerHelloDone=function(){var t=j.util.createBuffer();return t.putByte(Q.HandshakeType.server_hello_done),t.putInt24(0),t},Q.createChangeCipherSpec=function(){var e=j.util.createBuffer();return e.putByte(1),e},Q.createFinished=function(t){var a=j.util.createBuffer();a.putBuffer(t.session.md5.digest()),a.putBuffer(t.session.sha1.digest());var o=t.entity===Q.ConnectionEnd.client,n=t.session.sp,r=o?"client finished":"server finished";a=G(n.master_secret,r,a.getBytes(),12);var s=j.util.createBuffer();return s.putByte(Q.HandshakeType.finished),s.putInt24(a.length()),s.putBuffer(a),s},Q.createHeartbeat=function(r,a,e){void 0===e&&(e=a.length);var s=j.util.createBuffer();s.putByte(r),s.putInt16(e),s.putBytes(a);var o=s.length(),n=Math.max(16,o-e-3);return s.putBytes(j.random.getBytes(n)),s},Q.queue=function(r,a){if(a&&(0!==a.fragment.length()||a.type!==Q.ContentType.handshake&&a.type!==Q.ContentType.alert&&a.type!==Q.ContentType.change_cipher_spec)){if(a.type===Q.ContentType.handshake){var e=a.fragment.bytes();r.session.md5.update(e),r.session.sha1.update(e),e=null}var n;if(a.fragment.length()<=Q.MaxFragment)n=[a];else{n=[];for(var s=a.fragment.bytes();s.length>Q.MaxFragment;)n.push(Q.createRecord(r,{type:a.type,data:j.util.createBuffer(s.slice(0,Q.MaxFragment))})),s=s.slice(Q.MaxFragment);0<s.length&&n.push(Q.createRecord(r,{type:a.type,data:j.util.createBuffer(s)}))}for(var i,o=0;o<n.length&&!r.fail;++o)i=n[o],r.state.current.write.update(r,i)&&r.records.push(i)}},Q.flush=function(t){for(var a,r=0;r<t.records.length;++r)a=t.records[r],t.tlsData.putByte(a.type),t.tlsData.putByte(a.version.major),t.tlsData.putByte(a.version.minor),t.tlsData.putInt16(a.fragment.length()),t.tlsData.putBuffer(t.records[r].fragment);return t.records=[],t.tlsDataReady(t)};var P=function(e){return!0===e||(e===j.pki.certificateError.bad_certificate?Q.Alert.Description.bad_certificate:e===j.pki.certificateError.unsupported_certificate?Q.Alert.Description.unsupported_certificate:e===j.pki.certificateError.certificate_revoked?Q.Alert.Description.certificate_revoked:e===j.pki.certificateError.certificate_expired?Q.Alert.Description.certificate_expired:e===j.pki.certificateError.certificate_unknown?Q.Alert.Description.certificate_unknown:e===j.pki.certificateError.unknown_ca?Q.Alert.Description.unknown_ca:Q.Alert.Description.bad_certificate)},V=function(e){return!0===e||(e===Q.Alert.Description.bad_certificate?j.pki.certificateError.bad_certificate:e===Q.Alert.Description.unsupported_certificate?j.pki.certificateError.unsupported_certificate:e===Q.Alert.Description.certificate_revoked?j.pki.certificateError.certificate_revoked:e===Q.Alert.Description.certificate_expired?j.pki.certificateError.certificate_expired:e===Q.Alert.Description.certificate_unknown?j.pki.certificateError.certificate_unknown:e===Q.Alert.Description.unknown_ca?j.pki.certificateError.unknown_ca:j.pki.certificateError.bad_certificate)};for(var O in Q.verifyCertificateChain=function(s,a){try{var e={};for(var t in s.verifyOptions)e[t]=s.verifyOptions[t];e.verify=function(a,e,t){var r=(P(a),s.verify(s,a,e,t));if(!0!==r){if("object"==typeof r&&!j.util.isArray(r)){var i=new Error("The application rejected the certificate.");throw i.send=!0,i.alert={level:Q.Alert.Level.fatal,description:Q.Alert.Description.bad_certificate},r.message&&(i.message=r.message),r.alert&&(i.alert.description=r.alert),i}r!==a&&(r=V(r))}return r},j.pki.verifyCertificateChain(s.caStore,a,e)}catch(t){var r=t;("object"!=typeof r||j.util.isArray(r))&&(r={send:!0,alert:{level:Q.Alert.Level.fatal,description:P(t)}}),"send"in r||(r.send=!0),"alert"in r||(r.alert={level:Q.Alert.Level.fatal,description:P(r.error)}),s.error(s,r)}return!s.fail},Q.createSessionCache=function(r,a){var n=null;if(r&&r.getSession&&r.setSession&&r.order)n=r;else{for(var e in n={},n.cache=r||{},n.capacity=Math.max(a||100,1),n.order=[],r)n.order.length<=a?n.order.push(e):delete r[e];n.getSession=function(t){var a=null,s=null;if(t?s=j.util.bytesToHex(t):0<n.order.length&&(s=n.order[0]),null!==s&&s in n.cache)for(var i in a=n.cache[s],delete n.cache[s],n.order)if(n.order[i]===s){n.order.splice(i,1);break}return a},n.setSession=function(r,a){if(n.order.length===n.capacity){var e=n.order.shift();delete n.cache[e]}var e=j.util.bytesToHex(r);n.order.push(e),n.cache[e]=a}}return n},Q.createConnection=function(p){var t=null;t=p.caStore?j.util.isArray(p.caStore)?j.pki.createCaStore(p.caStore):p.caStore:j.pki.createCaStore();var r=p.cipherSuites||null;if(null===r)for(var d in r=[],Q.CipherSuites)r.push(Q.CipherSuites[d]);var l=p.server?Q.ConnectionEnd.server:Q.ConnectionEnd.client,n=p.sessionCache?Q.createSessionCache(p.sessionCache):null,i={version:{major:Q.Version.major,minor:Q.Version.minor},entity:l,sessionId:p.sessionId,caStore:t,sessionCache:n,cipherSuites:r,connected:p.connected,virtualHost:p.virtualHost||null,verifyClient:p.verifyClient||!1,verify:p.verify||function(t,a){return a},verifyOptions:p.verifyOptions||{},getCertificate:p.getCertificate||null,getPrivateKey:p.getPrivateKey||null,getSignature:p.getSignature||null,input:j.util.createBuffer(),tlsData:j.util.createBuffer(),data:j.util.createBuffer(),tlsDataReady:p.tlsDataReady,dataReady:p.dataReady,heartbeatReceived:p.heartbeatReceived,closed:p.closed,error:function(a,e){e.origin=e.origin||(a.entity===Q.ConnectionEnd.client?"client":"server"),e.send&&(Q.queue(a,Q.createAlert(a,e.alert)),Q.flush(a));var t=!1!==e.fatal;t&&(a.fail=!0),p.error(a,e),t&&a.close(!1)},deflate:p.deflate||null,inflate:p.inflate||null};i.reset=function(e){i.version={major:Q.Version.major,minor:Q.Version.minor},i.record=null,i.session=null,i.peerCertificate=null,i.state={pending:null,current:null},i.expect=(i.entity,Q.ConnectionEnd.client,0),i.fragmented=null,i.records=[],i.open=!1,i.handshakes=0,i.handshaking=!1,i.isConnected=!1,i.fail=!(e||void 0===e),i.input.clear(),i.tlsData.clear(),i.data.clear(),i.state.current=Q.createConnectionState(i)},i.reset();var s=function(a,n){var e=n.type-Q.ContentType.change_cipher_spec,t=I[a.entity][a.expect];e in t?t[e](a,n):Q.handleUnexpected(a,n)},o=function(t){var a=0,i=t.input,s=i.length();if(5>s)a=5-s;else{t.record={type:i.getByte(),version:{major:i.getByte(),minor:i.getByte()},length:i.getInt16(),fragment:j.util.createBuffer(),ready:!1};var r=t.record.version.major===t.version.major;r&&t.session&&t.session.version&&(r=t.record.version.minor===t.version.minor),r||t.error(t,{message:"Incompatible TLS version.",send:!0,alert:{level:Q.Alert.Level.fatal,description:Q.Alert.Description.protocol_version}})}return a},c=function(t){var a=0,n=t.input,s=n.length();return s<t.record.length?a=t.record.length-s:(t.record.fragment.putBytes(n.getBytes(t.record.length)),n.compact(),t.state.current.read.update(t,t.record)&&(null!==t.fragmented&&(t.fragmented.type===t.record.type?(t.fragmented.fragment.putBuffer(t.record.fragment),t.record=t.fragmented):t.error(t,{message:"Invalid fragmented record.",send:!0,alert:{level:Q.Alert.Level.fatal,description:Q.Alert.Description.unexpected_message}})),t.record.ready=!0)),a};return i.handshake=function(e){if(i.entity!==Q.ConnectionEnd.client)i.error(i,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(i.handshaking)i.error(i,{message:"Handshake already in progress.",fatal:!1});else{i.fail&&!i.open&&0===i.handshakes&&(i.fail=!1),i.handshaking=!0,e=e||"";var t=null;0<e.length&&(i.sessionCache&&(t=i.sessionCache.getSession(e)),null===t&&(e="")),0===e.length&&i.sessionCache&&null!==(t=i.sessionCache.getSession())&&(e=t.id),i.session={id:e,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:j.md.md5.create(),sha1:j.md.sha1.create()},t&&(i.version=t.version,i.session.sp=t.sp),i.session.sp.client_random=Q.createRandom().getBytes(),i.open=!0,Q.queue(i,Q.createRecord(i,{type:Q.ContentType.handshake,data:Q.createClientHello(i)})),Q.flush(i)}},i.process=function(t){var a=0;return t&&i.input.putBytes(t),i.fail||(null!==i.record&&i.record.ready&&i.record.fragment.isEmpty()&&(i.record=null),null===i.record&&(a=o(i)),i.fail||null===i.record||i.record.ready||(a=c(i)),!i.fail&&null!==i.record&&i.record.ready&&s(i,i.record)),a},i.prepare=function(e){return Q.queue(i,Q.createRecord(i,{type:Q.ContentType.application_data,data:j.util.createBuffer(e)})),Q.flush(i)},i.prepareHeartbeatRequest=function(e,t){return e instanceof j.util.ByteBuffer&&(e=e.bytes()),void 0===t&&(t=e.length),i.expectedHeartbeatPayload=e,Q.queue(i,Q.createRecord(i,{type:Q.ContentType.heartbeat,data:Q.createHeartbeat(Q.HeartbeatMessageType.heartbeat_request,e,t)})),Q.flush(i)},i.close=function(t){if(!i.fail&&i.sessionCache&&i.session){var a={id:i.session.id,version:i.session.version,sp:i.session.sp};a.sp.keys=null,i.sessionCache.setSession(a.id,a)}i.open&&(i.open=!1,i.input.clear(),(i.isConnected||i.handshaking)&&(i.isConnected=i.handshaking=!1,Q.queue(i,Q.createAlert(i,{level:Q.Alert.Level.warning,description:Q.Alert.Description.close_notify})),Q.flush(i)),i.closed(i)),i.reset(t)},i},q.exports=j.tls=j.tls||{},Q)"function"!=typeof Q[O]&&(j.tls[O]=Q[O]);j.tls.prf_tls1=G,j.tls.hmac_sha1=function(s,a,e){var t=j.hmac.create();t.start("SHA1",s);var r=j.util.createBuffer();return r.putInt32(a[0]),r.putInt32(a[1]),r.putByte(e.type),r.putByte(e.version.major),r.putByte(e.version.minor),r.putInt16(e.length),r.putBytes(e.fragment.bytes()),t.update(r.getBytes()),t.digest().getBytes()},j.tls.createSessionCache=Q.createSessionCache,j.tls.createConnection=Q.createConnection},function(r,s,e){var c=e(0);e(3),e(6),e(22),e(7),e(15),e(28),e(18),e(11),e(1),e(17);var o=c.asn1,a=r.exports=c.pki=c.pki||{};a.pemToDer=function(t){var a=c.pem.decode(t)[0];if(a.procType&&"ENCRYPTED"===a.procType.type)throw new Error("Could not convert PEM to DER; PEM is encrypted.");return c.util.createBuffer(a.body)},a.privateKeyFromPem=function(n){var s=c.pem.decode(n)[0];if("PRIVATE KEY"!==s.type&&"RSA PRIVATE KEY"!==s.type){var e=new Error("Could not convert private key from PEM; PEM header type is not \"PRIVATE KEY\" or \"RSA PRIVATE KEY\".");throw e.headerType=s.type,e}if(s.procType&&"ENCRYPTED"===s.procType.type)throw new Error("Could not convert private key from PEM; PEM is encrypted.");var t=o.fromDer(s.body);return a.privateKeyFromAsn1(t)},a.privateKeyToPem=function(r,n){var e={type:"RSA PRIVATE KEY",body:o.toDer(a.privateKeyToAsn1(r)).getBytes()};return c.pem.encode(e,{maxline:n})},a.privateKeyInfoToPem=function(a,r){var e={type:"PRIVATE KEY",body:o.toDer(a).getBytes()};return c.pem.encode(e,{maxline:r})}},function(r,c,e){function t(t,a){return t.start().update(a).digest().getBytes()}function p(t){var a;if(!t)a="hmacWithSHA1";else if(!(a=o.oids[A.derToOid(t)])){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return g(a)}function g(e){var t=K.md;switch(e){case"hmacWithSHA224":t=K.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r;}if(!(t&&e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}function n(n,s,e,t){var r=A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OCTETSTRING,!1,n),A.create(A.Class.UNIVERSAL,A.Type.INTEGER,!1,s.getBytes())]);return"hmacWithSHA1"!==t&&r.value.push(A.create(A.Class.UNIVERSAL,A.Type.INTEGER,!1,K.util.hexToBytes(e.toString(16))),A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(o.oids[t]).getBytes()),A.create(A.Class.UNIVERSAL,A.Type.NULL,!1,"")])),r}var K=e(0);if(e(5),e(3),e(10),e(4),e(6),e(15),e(7),e(2),e(25),e(11),e(1),void 0===i)var i=K.jsbn.BigInteger;var A=K.asn1,o=K.pki=K.pki||{};r.exports=o.pbe=K.pbe=K.pbe||{};var a=o.oids,u={name:"EncryptedPrivateKeyInfo",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:A.Class.UNIVERSAL,type:A.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:A.Class.UNIVERSAL,type:A.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},s={name:"PBES2Algorithms",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:A.Class.UNIVERSAL,type:A.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:A.Class.UNIVERSAL,type:A.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:A.Class.UNIVERSAL,type:A.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:A.Class.UNIVERSAL,type:A.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:A.Class.UNIVERSAL,type:A.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:A.Class.UNIVERSAL,type:A.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:A.Class.UNIVERSAL,type:A.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},y={name:"pkcs-12PbeParams",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:A.Class.UNIVERSAL,type:A.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:A.Class.UNIVERSAL,type:A.Type.INTEGER,constructed:!1,capture:"iterations"}]};o.encryptPrivateKeyInfo=function(r,s,e){e=e||{},e.saltSize=e.saltSize||8,e.count=e.count||2048,e.algorithm=e.algorithm||"aes128",e.prfAlgorithm=e.prfAlgorithm||"sha1";var i,c,l,u=K.random.getBytesSync(e.saltSize),y=e.count,f=A.integerToDer(y);if(0===e.algorithm.indexOf("aes")||"des"===e.algorithm){var h,m,S;switch(e.algorithm){case"aes128":i=16,h=16,m=a["aes128-CBC"],S=K.aes.createEncryptionCipher;break;case"aes192":i=24,h=16,m=a["aes192-CBC"],S=K.aes.createEncryptionCipher;break;case"aes256":i=32,h=16,m=a["aes256-CBC"],S=K.aes.createEncryptionCipher;break;case"des":i=8,h=8,m=a.desCBC,S=K.des.createEncryptionCipher;break;default:var T=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw T.algorithm=e.algorithm,T;}var I="hmacWith"+e.prfAlgorithm.toUpperCase(),v=g(I),C=K.pkcs5.pbkdf2(s,u,y,i,v),R=K.random.getBytesSync(h),L=S(C);L.start(R),L.update(A.toDer(r)),L.finish(),l=L.output.getBytes();var D=n(u,f,i,I);c=A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(a.pkcs5PBES2).getBytes()),A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(a.pkcs5PBKDF2).getBytes()),D]),A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(m).getBytes()),A.create(A.Class.UNIVERSAL,A.Type.OCTETSTRING,!1,R)])])])}else{if("3des"!==e.algorithm){var T=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw T.algorithm=e.algorithm,T}i=24;var O=new K.util.ByteBuffer(u),C=o.pbe.generatePkcs12Key(s,O,1,y,i),R=o.pbe.generatePkcs12Key(s,O,2,y,i),L=K.des.createEncryptionCipher(C);L.start(R),L.update(A.toDer(r)),L.finish(),l=L.output.getBytes(),c=A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(a["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OCTETSTRING,!1,u),A.create(A.Class.UNIVERSAL,A.Type.INTEGER,!1,f.getBytes())])])}return A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[c,A.create(A.Class.UNIVERSAL,A.Type.OCTETSTRING,!1,l)])},o.decryptPrivateKeyInfo=function(r,d){var e=null,l={},p=[];if(!A.validate(r,u,l,p)){var a=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=p,a}var n=A.derToOid(l.encryptionOid),i=o.pbe.getCipher(n,l.encryptionParams,d),s=K.util.createBuffer(l.encryptedData);return i.update(s),i.finish()&&(e=A.fromDer(i.output)),e},o.encryptedPrivateKeyToPem=function(r,a){var e={type:"ENCRYPTED PRIVATE KEY",body:A.toDer(r).getBytes()};return K.pem.encode(e,{maxline:a})},o.encryptedPrivateKeyFromPem=function(r){var a=K.pem.decode(r)[0];if("ENCRYPTED PRIVATE KEY"!==a.type){var e=new Error("Could not convert encrypted private key from PEM; PEM header type is \"ENCRYPTED PRIVATE KEY\".");throw e.headerType=a.type,e}if(a.procType&&"ENCRYPTED"===a.procType.type)throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return A.fromDer(a.body)},o.encryptRsaPrivateKey=function(a,r,e){if(e=e||{},!e.legacy){var n=o.wrapRsaPrivateKey(o.privateKeyToAsn1(a));return n=o.encryptPrivateKeyInfo(n,r,e),o.encryptedPrivateKeyToPem(n)}var s,i,c,d;switch(e.algorithm){case"aes128":s="AES-128-CBC",c=16,i=K.random.getBytesSync(16),d=K.aes.createEncryptionCipher;break;case"aes192":s="AES-192-CBC",c=24,i=K.random.getBytesSync(16),d=K.aes.createEncryptionCipher;break;case"aes256":s="AES-256-CBC",c=32,i=K.random.getBytesSync(16),d=K.aes.createEncryptionCipher;break;case"3des":s="DES-EDE3-CBC",c=24,i=K.random.getBytesSync(8),d=K.des.createEncryptionCipher;break;case"des":s="DES-CBC",c=8,i=K.random.getBytesSync(8),d=K.des.createEncryptionCipher;break;default:var l=new Error("Could not encrypt RSA private key; unsupported encryption algorithm \""+e.algorithm+"\".");throw l.algorithm=e.algorithm,l;}var u=K.pbe.opensslDeriveBytes(r,i.substr(0,8),c),p=d(u);p.start(i),p.update(A.toDer(o.privateKeyToAsn1(a))),p.finish();var f={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:s,parameters:K.util.bytesToHex(i).toUpperCase()},body:p.output.getBytes()};return K.pem.encode(f)},o.decryptRsaPrivateKey=function(r,n){var e=null,s=K.pem.decode(r)[0];if("ENCRYPTED PRIVATE KEY"!==s.type&&"PRIVATE KEY"!==s.type&&"RSA PRIVATE KEY"!==s.type){var i=new Error("Could not convert private key from PEM; PEM header type is not \"ENCRYPTED PRIVATE KEY\", \"PRIVATE KEY\", or \"RSA PRIVATE KEY\".");throw i.headerType=i,i}if(s.procType&&"ENCRYPTED"===s.procType.type){var d,l;switch(s.dekInfo.algorithm){case"DES-CBC":d=8,l=K.des.createDecryptionCipher;break;case"DES-EDE3-CBC":d=24,l=K.des.createDecryptionCipher;break;case"AES-128-CBC":d=16,l=K.aes.createDecryptionCipher;break;case"AES-192-CBC":d=24,l=K.aes.createDecryptionCipher;break;case"AES-256-CBC":d=32,l=K.aes.createDecryptionCipher;break;case"RC2-40-CBC":d=5,l=function(e){return K.rc2.createDecryptionCipher(e,40)};break;case"RC2-64-CBC":d=8,l=function(e){return K.rc2.createDecryptionCipher(e,64)};break;case"RC2-128-CBC":d=16,l=function(e){return K.rc2.createDecryptionCipher(e,128)};break;default:var i=new Error("Could not decrypt private key; unsupported encryption algorithm \""+s.dekInfo.algorithm+"\".");throw i.algorithm=s.dekInfo.algorithm,i;}var u=K.util.hexToBytes(s.dekInfo.parameters),h=K.pbe.opensslDeriveBytes(n,u.substr(0,8),d),c=l(h);if(c.start(u),c.update(K.util.createBuffer(s.body)),!c.finish())return e;e=c.output.getBytes()}else e=s.body;return e="ENCRYPTED PRIVATE KEY"===s.type?o.decryptPrivateKeyInfo(A.fromDer(e),n):A.fromDer(e),null!==e&&(e=o.privateKeyFromAsn1(e)),e},o.pbe.generatePkcs12Key=function(s,i,e,t,r,a){var o,c;if(void 0===a||null===a){if(!("sha1"in K.md))throw new Error("\"sha1\" hash algorithm unavailable.");a=K.md.sha1.create()}var E=a.digestLength,T=a.blockLength,u=new K.util.ByteBuffer,l=new K.util.ByteBuffer;if(null!==s&&void 0!==s){for(c=0;c<s.length;c++)l.putInt16(s.charCodeAt(c));l.putInt16(0)}var p=l.length(),f=i.length(),h=new K.util.ByteBuffer;h.fillWithByte(e,T);var d=T*Math.ceil(f/T),y=new K.util.ByteBuffer;for(c=0;c<d;c++)y.putByte(i.at(c%f));var g=T*Math.ceil(p/T),I=new K.util.ByteBuffer;for(c=0;c<g;c++)I.putByte(l.at(c%p));var m=y;m.putBuffer(I);for(var b,v=Math.ceil(r/E),R=1;R<=v;R++){b=new K.util.ByteBuffer,b.putBytes(h.bytes()),b.putBytes(m.bytes());for(var U=0;U<t;U++)a.start(),a.update(b.getBytes()),b=a.digest();var P=new K.util.ByteBuffer;for(c=0;c<T;c++)P.putByte(b.at(c%E));var O=Math.ceil(f/T)+Math.ceil(p/T),A=new K.util.ByteBuffer;for(o=0;o<O;o++){var B=new K.util.ByteBuffer(m.getBytes(T)),N=511;for(c=P.length()-1;0<=c;c--)N>>=8,N+=P.at(c)+B.at(c),B.setAt(c,255&N);A.putBuffer(B)}m=A,u.putBuffer(b)}return u.truncate(u.length()-r),u},o.pbe.getCipher=function(a,n,e){switch(a){case o.oids.pkcs5PBES2:return o.pbe.getCipherForPBES2(a,n,e);case o.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case o.oids["pbewithSHAAnd40BitRC2-CBC"]:return o.pbe.getCipherForPKCS12PBE(a,n,e);default:var t=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw t.oid=a,t.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],t;}},o.pbe.getCipherForPBES2=function(e,d,l){var t={},r=[];if(!A.validate(d,s,t,r)){var a=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=r,a}if((e=A.derToOid(t.kdfOid))!==o.oids.pkcs5PBKDF2){var a=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw a.oid=e,a.supportedOids=["pkcs5PBKDF2"],a}if((e=A.derToOid(t.encOid))!==o.oids["aes128-CBC"]&&e!==o.oids["aes192-CBC"]&&e!==o.oids["aes256-CBC"]&&e!==o.oids["des-EDE3-CBC"]&&e!==o.oids.desCBC){var a=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw a.oid=e,a.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],a}var u=t.kdfSalt,h=K.util.createBuffer(t.kdfIterationCount);h=h.getInt(h.length()<<3);var f,m;switch(o.oids[e]){case"aes128-CBC":f=16,m=K.aes.createDecryptionCipher;break;case"aes192-CBC":f=24,m=K.aes.createDecryptionCipher;break;case"aes256-CBC":f=32,m=K.aes.createDecryptionCipher;break;case"des-EDE3-CBC":f=24,m=K.des.createDecryptionCipher;break;case"desCBC":f=8,m=K.des.createDecryptionCipher;}var C=p(t.prfOid),E=K.pkcs5.pbkdf2(l,u,h,f,C),y=t.encIv,g=m(E);return g.start(y),g},o.pbe.getCipherForPKCS12PBE=function(s,n,e){var t={},r=[];if(!A.validate(n,y,t,r)){var a=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=r,a}var u=K.util.createBuffer(t.salt),d=K.util.createBuffer(t.iterations);d=d.getInt(d.length()<<3);var h,f,m;switch(s){case o.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:h=24,f=8,m=K.des.startDecrypting;break;case o.oids["pbewithSHAAnd40BitRC2-CBC"]:h=5,f=8,m=function(r,a){var e=K.rc2.createDecryptionCipher(r,40);return e.start(a,null),e};break;default:var a=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw a.oid=s,a;}var C=p(t.prfOid),T=o.pbe.generatePkcs12Key(e,u,1,d,h,C);return C.start(),m(T,o.pbe.generatePkcs12Key(e,u,2,d,f,C))},o.pbe.opensslDeriveBytes=function(n,a,s,o){if(void 0===o||null===o){if(!("md5"in K.md))throw new Error("\"md5\" hash algorithm unavailable.");o=K.md.md5.create()}null===a&&(a="");for(var c=[t(o,n+a)],d=16,p=1;d<s;++p,d+=16)c.push(t(o,c[p-1]+n+a));return c.join("").substr(0,s)}},function(s,o,e){function t(){y=String.fromCharCode(128),y+=g.util.fillString(String.fromCharCode(0),64),c=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],a=!0}function l(a,r,e){for(var t,n,s,i,o,d,l,p,u,g,y,h,f,m,C,v=e.length();64<=v;){for(l=0;16>l;++l)r[l]=e.getInt32();for(;64>l;++l)t=r[l-2],t=(t>>>17|t<<15)^(t>>>19|t<<13)^t>>>10,n=r[l-15],n=(n>>>7|n<<25)^(n>>>18|n<<14)^n>>>3,r[l]=0|t+r[l-7]+n+r[l-16];for(p=a.h0,u=a.h1,g=a.h2,y=a.h3,h=a.h4,f=a.h5,m=a.h6,C=a.h7,l=0;64>l;++l)i=(h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7),o=m^h&(f^m),s=(p>>>2|p<<30)^(p>>>13|p<<19)^(p>>>22|p<<10),d=p&u|g&(p^u),t=C+i+o+c[l]+r[l],n=s+d,C=m,m=f,f=h,h=y+t>>>0,y=g,g=u,u=p,p=t+n>>>0;a.h0=0|a.h0+p,a.h1=0|a.h1+u,a.h2=0|a.h2+g,a.h3=0|a.h3+y,a.h4=0|a.h4+h,a.h5=0|a.h5+f,a.h6=0|a.h6+m,a.h7=0|a.h7+C,v-=64}}var g=e(0);e(4),e(1);var n=s.exports=g.sha256=g.sha256||{};g.md.sha256=g.md.algorithms.sha256=n,n.create=function(){a||t();var n=null,i=g.util.createBuffer(),p=Array(64),h={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return h.start=function(){h.messageLength=0,h.fullMessageLength=h.messageLength64=[];for(var a=h.messageLengthSize/4,e=0;e<a;++e)h.fullMessageLength.push(0);return i=g.util.createBuffer(),n={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},h},h.start(),h.update=function(a,o){"utf8"===o&&(a=g.util.encodeUtf8(a));var t=a.length;h.messageLength+=t,t=[t/4294967296>>>0,t>>>0];for(var c=h.fullMessageLength.length-1;0<=c;--c)h.fullMessageLength[c]+=t[1],t[1]=t[0]+(h.fullMessageLength[c]/4294967296>>>0),h.fullMessageLength[c]>>>=0,t[0]=t[1]/4294967296>>>0;return i.putBytes(a),l(n,p,i),(2048<i.read||0===i.length())&&i.compact(),h},h.digest=function(){var f=g.util.createBuffer();f.putBytes(i.bytes());var e=h.fullMessageLength[h.fullMessageLength.length-1]+h.messageLengthSize,t=e&h.blockLength-1;f.putBytes(y.substr(0,h.blockLength-t));for(var a,m,C=8*h.fullMessageLength[0],E=0;E<h.fullMessageLength.length-1;++E)a=8*h.fullMessageLength[E+1],m=a/4294967296>>>0,C+=m,f.putInt32(C>>>0),C=a>>>0;f.putInt32(C);var S={h0:n.h0,h1:n.h1,h2:n.h2,h3:n.h3,h4:n.h4,h5:n.h5,h6:n.h6,h7:n.h7};l(S,p,f);var u=g.util.createBuffer();return u.putInt32(S.h0),u.putInt32(S.h1),u.putInt32(S.h2),u.putInt32(S.h3),u.putInt32(S.h4),u.putInt32(S.h5),u.putInt32(S.h6),u.putInt32(S.h7),u},h};var y=null,a=!1,c=null},function(r,n,e){var u=e(0);e(1);var o=null;!u.util.isNodejs||u.options.usePureJavaScript||process.versions["node-webkit"]||(o=e(16)),(r.exports=u.prng=u.prng||{}).create=function(a){function n(r){if(32<=g.pools[0].messageLength)return d(),r();var t=32-g.pools[0].messageLength<<5;g.seedFile(t,function(a,e){return a?r(a):void(g.collect(e),d(),r())})}function c(){if(32<=g.pools[0].messageLength)return d();var e=32-g.pools[0].messageLength<<5;g.collect(g.seedFileSync(e)),d()}function d(){g.reseeds=4294967295===g.reseeds?0:g.reseeds+1;var t=g.plugin.md.create();t.update(g.keyBytes);for(var a=1,r=0;32>r;++r)0==g.reseeds%a&&(t.update(g.pools[r].digest().getBytes()),g.pools[r].start()),a<<=1;g.keyBytes=t.digest().getBytes(),t.start(),t.update(g.keyBytes);var n=t.digest().getBytes();g.key=g.plugin.formatKey(g.keyBytes),g.seed=g.plugin.formatSeed(n),g.generated=0}function e(t){var a=null,c=u.util.globalScope,d=c.crypto||c.msCrypto;d&&d.getRandomValues&&(a=function(e){return d.getRandomValues(e)});var r=u.util.createBuffer();if(a)for(;r.length()<t;){var n=Math.max(1,Math.min(t-r.length(),65536)/4),i=new Uint32Array(Math.floor(n));try{a(i);for(var s=0;s<i.length;++s)r.putInt32(i[s])}catch(e){if(!("undefined"!=typeof QuotaExceededError&&e instanceof QuotaExceededError))throw e}}if(r.length()<t)for(var l,p,g,f=Math.floor(65536*Math.random());r.length()<t;){p=16807*(65535&f),l=16807*(f>>16),p+=(32767&l)<<16,p+=l>>15,p=(2147483647&p)+(p>>31),f=4294967295&p;for(var s=0;3>s;++s)g=f>>>(s<<3),g^=Math.floor(256*Math.random()),r.putByte(String.fromCharCode(255&g))}return r.getBytes(t)}for(var g={plugin:a,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=a.md,t=Array(32),s=0;32>s;++s)t[s]=r.create();return g.pools=t,g.pool=0,g.generate=function(e,t){function a(c){if(c)return t(c);if(o.length()>=e)return t(null,o.getBytes(e));if(1048575<g.generated&&(g.key=null),null===g.key)return u.util.nextTick(function(){n(a)});var l=r(g.key,g.seed);g.generated+=l.length,o.putBytes(l),g.key=i(r(g.key,d(g.seed))),g.seed=s(r(g.key,g.seed)),u.util.setImmediate(a)}if(!t)return g.generateSync(e);var r=g.plugin.cipher,d=g.plugin.increment,i=g.plugin.formatKey,s=g.plugin.formatSeed,o=u.util.createBuffer();g.key=null,a()},g.generateSync=function(o){var a=g.plugin.cipher,e=g.plugin.increment,t=g.plugin.formatKey,r=g.plugin.formatSeed;g.key=null;for(var n=u.util.createBuffer();n.length()<o;){1048575<g.generated&&(g.key=null),null===g.key&&c();var s=a(g.key,g.seed);g.generated+=s.length,n.putBytes(s),g.key=t(a(g.key,e(g.seed))),g.seed=r(a(g.key,g.seed))}return n.getBytes(o)},o?(g.seedFile=function(e,a){o.randomBytes(e,function(r,t){return r?a(r):void a(null,t.toString())})},g.seedFileSync=function(e){return o.randomBytes(e).toString()}):(g.seedFile=function(t,a){try{a(null,e(t))}catch(e){a(e)}},g.seedFileSync=e),g.collect=function(r){for(var a=r.length,e=0;e<a;++e)g.pools[g.pool].update(r.substr(e,1)),g.pool=31===g.pool?0:g.pool+1},g.collectInt=function(a,r){for(var e="",n=0;n<r;n+=8)e+=String.fromCharCode(255&a>>n);g.collect(e)},g.registerWorker=function(r){if(r===self)g.seedFile=function(e,a){function n(t){var r=t.data;r.forge&&r.forge.prng&&(self.removeEventListener("message",n),a(r.forge.prng.err,r.forge.prng.bytes))}self.addEventListener("message",n),self.postMessage({forge:{prng:{needed:e}}})};else{var t=function(a){var e=a.data;e.forge&&e.forge.prng&&g.seedFile(e.forge.prng.needed,function(a,e){r.postMessage({forge:{prng:{err:a,bytes:e}}})})};r.addEventListener("message",t)}},g}},function(o,c,e){var y=e(0);e(1);var t=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],a=[1,2,3,5],r=function(t,a){return 65535&t<<a|(65535&t)>>16-a},n=function(t,a){return(65535&t)>>a|65535&t<<16-a};o.exports=y.rc2=y.rc2||{},y.rc2.expandKey=function(e,a){"string"==typeof e&&(e=y.util.createBuffer(e)),a=a||128;var r,c=e,l=e.length(),i=a,s=Math.ceil(i/8);for(r=l;128>r;r++)c.putByte(t[255&c.at(r-1)+c.at(r-l)]);for(c.setAt(128-s,t[c.at(128-s)&255>>(7&i)]),r=127-s;0<=r;r--)c.setAt(r,t[c.at(r+1)^c.at(r+s)]);return c};var s=function(e,s,i){var o,c,d,l,p=!1,u=null,h=null,f=null,b=[];for(e=y.rc2.expandKey(e,s),d=0;64>d;d++)b.push(e.getInt16Le());i?(o=function(e){for(d=0;4>d;d++)e[d]+=b[l]+(e[(d+3)%4]&e[(d+2)%4])+(~e[(d+3)%4]&e[(d+1)%4]),e[d]=r(e[d],a[d]),l++},c=function(e){for(d=0;4>d;d++)e[d]+=b[63&e[(d+3)%4]]}):(o=function(e){for(d=3;0<=d;d--)e[d]=n(e[d],a[d]),e[d]-=b[l]+(e[(d+3)%4]&e[(d+2)%4])+(~e[(d+3)%4]&e[(d+1)%4]),l--},c=function(e){for(d=3;0<=d;d--)e[d]-=b[63&e[(d+3)%4]]});var A=function(a){var r=[];for(d=0;4>d;d++){var e=u.getInt16Le();null!==f&&(i?e^=f.getInt16Le():f.putInt16Le(e)),r.push(65535&e)}l=i?0:63;for(var n=0;n<a.length;n++)for(var o=0;o<a[n][0];o++)a[n][1](r);for(d=0;4>d;d++)null!==f&&(i?f.putInt16Le(r[d]):r[d]^=f.getInt16Le()),h.putInt16Le(r[d])},v=null;return v={start:function(e,t){e&&"string"==typeof e&&(e=y.util.createBuffer(e)),p=!1,u=y.util.createBuffer(),h=t||new y.util.createBuffer,f=e,v.output=h},update:function(e){for(p||u.putBuffer(e);8<=u.length();)A([[5,o],[1,c],[6,o],[1,c],[5,o]])},finish:function(t){var r=!0;if(i)if(t)r=t(8,u,!i);else{var o=8===u.length()?8:8-u.length();u.fillWithByte(o,o)}if(r&&(p=!0,v.update()),!i&&(r=0===u.length()))if(t)r=t(8,h,!i);else{var s=h.length(),a=h.at(s-1);a>s?r=!1:h.truncate(a)}return r}}};y.rc2.startEncrypting=function(n,a,e){var t=y.rc2.createEncryptionCipher(n,128);return t.start(a,e),t},y.rc2.createEncryptionCipher=function(t,a){return s(t,a,!0)},y.rc2.startDecrypting=function(n,a,e){var t=y.rc2.createDecryptionCipher(n,128);return t.start(a,e),t},y.rc2.createDecryptionCipher=function(t,a){return s(t,a,!1)}},function(r,n,e){function s(a,r,e){e||(e=o.md.sha1.create());for(var n,s="",p=Math.ceil(r/e.digestLength),l=0;l<p;++l)n=String.fromCharCode(255&l>>24,255&l>>16,255&l>>8,255&l),e.start(),e.update(a+n),s+=e.digest().getBytes();return s.substring(0,r)}var o=e(0);e(1),e(2),e(9);var t=r.exports=o.pkcs1=o.pkcs1||{};t.encode_rsa_oaep=function(i,a,e){var t,c,p,y;"string"==typeof e?(t=e,c=arguments[3]||void 0,p=arguments[4]||void 0):e&&(t=e.label||void 0,c=e.seed||void 0,p=e.md||void 0,e.mgf1&&e.mgf1.md&&(y=e.mgf1.md)),p?p.start():p=o.md.sha1.create(),y||(y=p);var h=Math.ceil(i.n.bitLength()/8),C=h-2*p.digestLength-2;if(a.length>C){var u=new Error("RSAES-OAEP input message length is too long.");throw u.length=a.length,u.maxLength=C,u}t||(t=""),p.update(t,"raw");for(var E=p.digest(),I="",B=C-a.length,A=0;A<B;A++)I+="\0";var b=E.getBytes()+I+"\x01"+a;if(!c)c=o.random.getBytes(p.digestLength);else if(c.length!==p.digestLength){var u=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw u.seedLength=c.length,u.digestLength=p.digestLength,u}var N=s(c,h-p.digestLength-1,y),g=o.util.xorBytes(b,N,b.length),v=s(g,p.digestLength,y);return"\0"+o.util.xorBytes(c,v,c.length)+g},t.decode_rsa_oaep=function(i,a,e){var t,u,C;"string"==typeof e?(t=e,u=arguments[3]||void 0):e&&(t=e.label||void 0,u=e.md||void 0,e.mgf1&&e.mgf1.md&&(C=e.mgf1.md));var E=Math.ceil(i.n.bitLength()/8);if(a.length!==E){var S=new Error("RSAES-OAEP encoded message length is invalid.");throw S.length=a.length,S.expectedLength=E,S}if(void 0===u?u=o.md.sha1.create():u.start(),C||(C=u),E<2*u.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");t||(t=""),u.update(t,"raw");for(var T=u.digest().getBytes(),I=a.charAt(0),l=a.substring(1,u.digestLength+1),p=a.substring(1+u.digestLength),f=s(p,u.digestLength,C),h=o.util.xorBytes(l,f,l.length),d=s(h,E-u.digestLength-1,C),y=o.util.xorBytes(p,d,p.length),g=y.substring(0,u.digestLength),S="\0"!==I,B=0;B<u.digestLength;++B)S|=T.charAt(B)!==g.charAt(B);for(var b,v=1,N=u.digestLength,U=u.digestLength;U<y.length;U++)b=y.charCodeAt(U),S|=b&(v?65534:0),v&=1^1&b,N+=v;if(S||1!==y.charCodeAt(N))throw new Error("Invalid RSAES-OAEP padding.");return y.substring(N+1)}},function(l,a,e){var f=e(0);e(1),e(12),e(2),function(){function p(r,n,e,t){return"workers"in e?d(r,n,e,t):g(r,n,e,t)}function g(n,s,e,t){var r=y(n,s),a=h(r.bitLength());"millerRabinTests"in e&&(a=e.millerRabinTests);var c=10;"maxBlockTime"in e&&(c=e.maxBlockTime),u(r,n,s,0,a,c,t)}function u(i,c,n,t,p,s,o){var d=+new Date;do{if(i.bitLength()>c&&(i=y(c,n)),i.isProbablePrime(p))return o(null,i);i.dAddOffset(e[t++%8],0)}while(0>s||+new Date-d<s);f.util.setImmediate(function(){u(i,c,n,t,p,s,o)})}function d(s,d,e,t){function n(){function e(e){if(!u){--c;var l=e.data;if(l.found){for(var a=0;a<i.length;++a)i[a].terminate();return u=!0,t(null,new m(l.prime,16))}r.bitLength()>s&&(r=y(s,d));var p=r.toString(16);e.target.postMessage({hex:p,workLoad:h}),r.dAddOffset(C,0)}}l=Math.max(1,l);for(var i=[],n=0;n<l;++n)i[n]=new Worker(p);for(var c=l,n=0;n<l;++n)i[n].addEventListener("message",e);var u=!1}if("undefined"==typeof Worker)return g(s,d,e,t);var r=y(s,d),l=e.workers,h=e.workLoad||100,C=30*h/8,p=e.workerScript||"forge/prime.worker.js";return-1===l?f.util.estimateCores(function(t,a){t&&(a=2),l=a-1,n()}):void n()}function y(i,n){var e=new m(i,n),t=i-1;return e.testBit(t)||e.bitwiseTo(m.ONE.shiftLeft(t),s,e),e.dAddOffset(31-e.mod(a).byteValue(),0),e}function h(e){return 100>=e?27:150>=e?18:200>=e?15:250>=e?12:300>=e?9:350>=e?8:400>=e?7:500>=e?6:600>=e?5:800>=e?4:1250>=e?3:2}if(f.prime)return void(l.exports=f.prime);var t=l.exports=f.prime=f.prime||{},m=f.jsbn.BigInteger,e=[6,4,2,4,2,4,6,2],a=new m(null);a.fromInt(30);var s=function(t,a){return t|a};t.generateProbablePrime=function(a,t,r){"function"==typeof t&&(r=t,t={}),t=t||{};var n=t.algorithm||"PRIMEINC";"string"==typeof n&&(n={name:n}),n.options=n.options||{};var s=t.prng||f.random;if("PRIMEINC"===n.name)return p(a,{nextBytes:function(r){for(var a=s.getBytesSync(r.length),e=0;e<r.length;++e)r[e]=a.charCodeAt(e)}},n.options,r);throw new Error("Invalid prime generation algorithm: "+n.name)}}()},function(u,g,e){function t(s,i,e,t){for(var r=[],a=0;a<s.length;a++)for(var o,c=0;c<s[a].safeBags.length;c++)o=s[a].safeBags[c],void 0!==t&&o.type!==t||(null===i?r.push(o):void 0!==o.attributes[i]&&0<=o.attributes[i].indexOf(e)&&r.push(o));return r}function y(r){if(r.composed||r.constructed){for(var a=T.util.createBuffer(),e=0;e<r.value.length;++e)a.putBytes(r.value[e].value);r.composed=r.constructed=!1,r.value=a.getBytes()}return r}function C(t,n,s,o){if(n=L.fromDer(n,s),n.tagClass!==L.Class.UNIVERSAL||n.type!==L.Type.SEQUENCE||!0!==n.constructed)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var d=0;d<n.value.length;d++){var l=n.value[d],p={},c=[];if(!L.validate(l,i,p,c)){var u=new Error("Cannot read ContentInfo.");throw u.errors=c,u}var g={encrypted:!1},h=null,m=p.content.value[0];switch(L.derToOid(p.contentType)){case _.oids.data:if(m.tagClass!==L.Class.UNIVERSAL||m.type!==L.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");h=y(m).value;break;case _.oids.encryptedData:h=a(m,o),g.encrypted=!0;break;default:var u=new Error("Unsupported PKCS#12 contentType.");throw u.contentType=L.derToOid(p.contentType),u;}g.safeBags=r(h,s,o),t.safeContents.push(g)}}function a(s,n){var e={},t=[];if(!L.validate(s,T.pkcs7.asn1.encryptedDataValidator,e,t)){var r=new Error("Cannot read EncryptedContentInfo.");throw r.errors=t,r}var i=L.derToOid(e.contentType);if(i!==_.oids.data){var r=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw r.oid=i,r}i=L.derToOid(e.encAlgorithm);var l=_.pbe.getCipher(i,e.encParameter,n),p=y(e.encryptedContentAsn1),o=T.util.createBuffer(p.value);if(l.update(o),!l.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return l.output.getBytes()}function r(e,c,d){if(!c&&0===e.length)return[];if(e=L.fromDer(e,c),e.tagClass!==L.Class.UNIVERSAL||e.type!==L.Type.SEQUENCE||!0!==e.constructed)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var t=[],r=0;r<e.value.length;r++){var l=e.value[r],p={},i=[];if(!L.validate(l,h,p,i)){var u=new Error("Cannot read SafeBag.");throw u.errors=i,u}var g={type:L.derToOid(p.bagId),attributes:n(p.bagAttributes)};t.push(g);var m,C,E=p.bagValue.value[0];switch(g.type){case _.oids.pkcs8ShroudedKeyBag:if(null===(E=_.decryptPrivateKeyInfo(E,d)))throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case _.oids.keyBag:try{g.key=_.privateKeyFromAsn1(E)}catch(e){g.key=null,g.asn1=E}continue;case _.oids.certBag:m=s,C=function(){if(L.derToOid(p.certId)!==_.oids.x509Certificate){var e=new Error("Unsupported certificate type, only X.509 supported.");throw e.oid=L.derToOid(p.certId),e}var r=L.fromDer(p.cert,c);try{g.cert=_.certificateFromAsn1(r,!0)}catch(e){g.cert=null,g.asn1=r}};break;default:var u=new Error("Unsupported PKCS#12 SafeBag type.");throw u.oid=g.type,u;}if(void 0!==m&&!L.validate(E,m,p,i)){var u=new Error("Cannot read PKCS#12 "+m.name);throw u.errors=i,u}C()}return t}function n(r){var c={};if(void 0!==r)for(var e=0;e<r.length;++e){var d={},l=[];if(!L.validate(r[e],o,d,l)){var a=new Error("Cannot read PKCS#12 BagAttribute.");throw a.errors=l,a}var n=L.derToOid(d.oid);if(void 0!==_.oids[n]){c[_.oids[n]]=[];for(var i=0;i<d.values.length;++i)c[_.oids[n]].push(d.values[i].value)}}return c}var T=e(0);e(3),e(8),e(6),e(29),e(22),e(2),e(11),e(9),e(1),e(17);var L=T.asn1,_=T.pki,l=u.exports=T.pkcs12=T.pkcs12||{},i={name:"ContentInfo",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:L.Class.UNIVERSAL,type:L.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:L.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},I={name:"PFX",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"version"},i,{name:"PFX.macData",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:L.Class.UNIVERSAL,type:L.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:L.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:L.Class.UNIVERSAL,type:L.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:L.Class.UNIVERSAL,type:L.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},h={name:"SafeBag",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:L.Class.UNIVERSAL,type:L.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:L.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:L.Class.UNIVERSAL,type:L.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},o={name:"Attribute",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:L.Class.UNIVERSAL,type:L.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:L.Class.UNIVERSAL,type:L.Type.SET,constructed:!0,capture:"values"}]},s={name:"CertBag",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:L.Class.UNIVERSAL,type:L.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:L.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:L.Class.UNIVERSAL,type:L.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};l.pkcs12FromAsn1=function(a,r,n){"string"==typeof r?(n=r,r=!0):void 0===r&&(r=!0);var i={};if(!L.validate(a,I,i,[])){var o=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw o.errors=o,o}var c={version:i.version.charCodeAt(0),safeContents:[],getBags:function(r){var a,s={};return"localKeyId"in r?a=r.localKeyId:"localKeyIdHex"in r&&(a=T.util.hexToBytes(r.localKeyIdHex)),void 0===a&&!("friendlyName"in r)&&"bagType"in r&&(s[r.bagType]=t(c.safeContents,null,null,r.bagType)),void 0!==a&&(s.localKeyId=t(c.safeContents,"localKeyId",a,r.bagType)),"friendlyName"in r&&(s.friendlyName=t(c.safeContents,"friendlyName",r.friendlyName,r.bagType)),s},getBagsByFriendlyName:function(r,a){return t(c.safeContents,"friendlyName",r,a)},getBagsByLocalKeyId:function(r,a){return t(c.safeContents,"localKeyId",r,a)}};if(3!==i.version.charCodeAt(0)){var o=new Error("PKCS#12 PFX of version other than 3 not supported.");throw o.version=i.version.charCodeAt(0),o}if(L.derToOid(i.contentType)!==_.oids.data){var o=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw o.oid=L.derToOid(i.contentType),o}var p=i.content.value[0];if(p.tagClass!==L.Class.UNIVERSAL||p.type!==L.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(p=y(p),i.mac){var u=null,g=0,v=L.derToOid(i.macAlgorithm);if(v===_.oids.sha1?(u=T.md.sha1.create(),g=20):v===_.oids.sha256?(u=T.md.sha256.create(),g=32):v===_.oids.sha384?(u=T.md.sha384.create(),g=48):v===_.oids.sha512?(u=T.md.sha512.create(),g=64):v===_.oids.md5?(u=T.md.md5.create(),g=16):void 0,null===u)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+v);var A=new T.util.ByteBuffer(i.macSalt),m="macIterations"in i?parseInt(T.util.bytesToHex(i.macIterations),16):1,b=l.generateKey(n,A,3,m,g,u),E=T.hmac.create();if(E.start(u,b),E.update(p.value),E.getMac().getBytes()!==i.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return C(c,p.value,r,n),c},l.toPkcs12Asn1=function(e,t,a,n){n=n||{},n.saltSize=n.saltSize||8,n.count=n.count||2048,n.algorithm=n.algorithm||n.encAlgorithm||"aes128","useMac"in n||(n.useMac=!0),"localKeyId"in n||(n.localKeyId=null),"generateLocalKeyId"in n||(n.generateLocalKeyId=!0);var s,i=n.localKeyId;if(null!==i)i=T.util.hexToBytes(i);else if(n.generateLocalKeyId)if(t){var o=T.util.isArray(t)?t[0]:t;"string"==typeof o&&(o=_.certificateFromPem(o));var d=T.md.sha1.create();d.update(L.toDer(_.certificateToAsn1(o)).getBytes()),i=d.digest().getBytes()}else i=T.random.getBytes(20);var g=[];null!==i&&g.push(L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(_.oids.localKeyId).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.SET,!0,[L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,i)])])),"friendlyName"in n&&g.push(L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(_.oids.friendlyName).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.SET,!0,[L.create(L.Class.UNIVERSAL,L.Type.BMPSTRING,!1,n.friendlyName)])])),0<g.length&&(s=L.create(L.Class.UNIVERSAL,L.Type.SET,!0,g));var f=[],c=[];null!==t&&(c=T.util.isArray(t)?t:[t]);for(var B=[],U=0;U<c.length;++U){t=c[U],"string"==typeof t&&(t=_.certificateFromPem(t));var K=0==U?s:void 0,x=_.certificateToAsn1(t),v=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(_.oids.certBag).getBytes()),L.create(L.Class.CONTEXT_SPECIFIC,0,!0,[L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(_.oids.x509Certificate).getBytes()),L.create(L.Class.CONTEXT_SPECIFIC,0,!0,[L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,L.toDer(x).getBytes())])])]),K]);B.push(v)}if(0<B.length){var m=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,B),C=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(_.oids.data).getBytes()),L.create(L.Class.CONTEXT_SPECIFIC,0,!0,[L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,L.toDer(m).getBytes())])]);f.push(C)}var E=null;if(null!==e){var F=_.wrapRsaPrivateKey(_.privateKeyToAsn1(e));E=null===a?L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(_.oids.keyBag).getBytes()),L.create(L.Class.CONTEXT_SPECIFIC,0,!0,[F]),s]):L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(_.oids.pkcs8ShroudedKeyBag).getBytes()),L.create(L.Class.CONTEXT_SPECIFIC,0,!0,[_.encryptPrivateKeyInfo(F,a,n)]),s]);var q=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[E]),I=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(_.oids.data).getBytes()),L.create(L.Class.CONTEXT_SPECIFIC,0,!0,[L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,L.toDer(q).getBytes())])]);f.push(I)}var b,j=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,f);if(n.useMac){var d=T.md.sha1.create(),G=new T.util.ByteBuffer(T.random.getBytes(n.saltSize)),N=n.count,e=l.generateKey(a,G,3,N,20),k=T.hmac.create();k.start(d,e),k.update(L.toDer(j).getBytes());var w=k.getMac();b=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(_.oids.sha1).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.NULL,!1,"")]),L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,w.getBytes())]),L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,G.getBytes()),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,L.integerToDer(N).getBytes())])}return L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,L.integerToDer(3).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(_.oids.data).getBytes()),L.create(L.Class.CONTEXT_SPECIFIC,0,!0,[L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,L.toDer(j).getBytes())])]),b])},l.generateKey=T.pbe.generatePkcs12Key},function(c,d,e){var t=e(0);e(3),e(1);var r=t.asn1,a=c.exports=t.pkcs7asn1=t.pkcs7asn1||{};t.pkcs7=t.pkcs7||{},t.pkcs7.asn1=a;var n={name:"ContentInfo",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:r.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};a.contentInfoValidator=n;var i={name:"EncryptedContentInfo",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:r.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:r.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};a.envelopedDataValidator={name:"EnvelopedData",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:r.Class.UNIVERSAL,type:r.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(i)},a.encryptedDataValidator={name:"EncryptedData",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:!1,capture:"version"}].concat(i)};var s={name:"SignerInfo",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:r.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:r.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:r.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};a.signedDataValidator={name:"SignedData",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:r.Class.UNIVERSAL,type:r.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},n,{name:"SignedData.Certificates",tagClass:r.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:r.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:r.Class.UNIVERSAL,type:r.Type.SET,capture:"signerInfos",optional:!0,value:[s]}]},a.recipientInfoValidator={name:"RecipientInfo",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:r.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}},function(a,r,e){var s=e(0);e(1),s.mgf=s.mgf||{},(a.exports=s.mgf.mgf1=s.mgf1=s.mgf1||{}).create=function(o){return{generate:function(a,e){for(var t,c=new s.util.ByteBuffer,d=Math.ceil(e/o.digestLength),n=0;n<d;n++)t=new s.util.ByteBuffer,t.putInt32(n),o.start(),o.update(a+t.getBytes()),c.putBuffer(o.digest());return c.truncate(c.length()-e),c.getBytes()}}}},function(a,r,e){var n=e(0);a.exports=n.debug=n.debug||{},n.debug.storage={},n.debug.get=function(r,a){var e;return void 0===r?e=n.debug.storage:r in n.debug.storage&&(e=void 0===a?n.debug.storage[r]:n.debug.storage[r][a]),e},n.debug.set=function(r,a,e){r in n.debug.storage||(n.debug.storage[r]={}),n.debug.storage[r][a]=e},n.debug.clear=function(t,a){void 0===t?n.debug.storage={}:t in n.debug.storage&&(void 0===a?delete n.debug.storage[t]:delete n.debug.storage[t][a])}},function(s,o,e){function l(){n=String.fromCharCode(128),n+=g.util.fillString(String.fromCharCode(0),128),c=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],u={},u["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],u["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],u["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],u["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],r=!0}function d(a,n,e){for(var t,s,i,o,d,l,p,u,g,y,h,f,m,C,E,S,T,I,B,A,b,v,N,R,L,_,k,U,D,P,V,O,K,x,w,Be=e.length();128<=Be;){for(D=0;16>D;++D)n[D][0]=e.getInt32()>>>0,n[D][1]=e.getInt32()>>>0;for(;80>D;++D)O=n[D-2],P=O[0],V=O[1],t=((P>>>19|V<<13)^(V>>>29|P<<3)^P>>>6)>>>0,s=((P<<13|V>>>19)^(V<<3|P>>>29)^(P<<26|V>>>6))>>>0,x=n[D-15],P=x[0],V=x[1],i=((P>>>1|V<<31)^(P>>>8|V<<24)^P>>>7)>>>0,o=((P<<31|V>>>1)^(P<<24|V>>>8)^(P<<25|V>>>7))>>>0,K=n[D-7],w=n[D-16],V=s+K[1]+o+w[1],n[D][0]=t+K[0]+i+w[0]+(V/4294967296>>>0)>>>0,n[D][1]=V>>>0;for(m=a[0][0],C=a[0][1],E=a[1][0],S=a[1][1],T=a[2][0],I=a[2][1],B=a[3][0],A=a[3][1],b=a[4][0],v=a[4][1],N=a[5][0],R=a[5][1],L=a[6][0],_=a[6][1],k=a[7][0],U=a[7][1],D=0;80>D;++D)p=((b>>>14|v<<18)^(b>>>18|v<<14)^(v>>>9|b<<23))>>>0,u=((b<<18|v>>>14)^(b<<14|v>>>18)^(v<<23|b>>>9))>>>0,g=(L^b&(N^L))>>>0,y=(_^v&(R^_))>>>0,d=((m>>>28|C<<4)^(C>>>2|m<<30)^(C>>>7|m<<25))>>>0,l=((m<<4|C>>>28)^(C<<30|m>>>2)^(C<<25|m>>>7))>>>0,h=(m&E|T&(m^E))>>>0,f=(C&S|I&(C^S))>>>0,V=U+u+y+c[D][1]+n[D][1],t=k+p+g+c[D][0]+n[D][0]+(V/4294967296>>>0)>>>0,s=V>>>0,V=l+f,i=d+h+(V/4294967296>>>0)>>>0,o=V>>>0,k=L,U=_,L=N,_=R,N=b,R=v,V=A+s,b=B+t+(V/4294967296>>>0)>>>0,v=V>>>0,B=T,A=I,T=E,I=S,E=m,S=C,V=s+o,m=t+i+(V/4294967296>>>0)>>>0,C=V>>>0;V=a[0][1]+C,a[0][0]=a[0][0]+m+(V/4294967296>>>0)>>>0,a[0][1]=V>>>0,V=a[1][1]+S,a[1][0]=a[1][0]+E+(V/4294967296>>>0)>>>0,a[1][1]=V>>>0,V=a[2][1]+I,a[2][0]=a[2][0]+T+(V/4294967296>>>0)>>>0,a[2][1]=V>>>0,V=a[3][1]+A,a[3][0]=a[3][0]+B+(V/4294967296>>>0)>>>0,a[3][1]=V>>>0,V=a[4][1]+v,a[4][0]=a[4][0]+b+(V/4294967296>>>0)>>>0,a[4][1]=V>>>0,V=a[5][1]+R,a[5][0]=a[5][0]+N+(V/4294967296>>>0)>>>0,a[5][1]=V>>>0,V=a[6][1]+_,a[6][0]=a[6][0]+L+(V/4294967296>>>0)>>>0,a[6][1]=V>>>0,V=a[7][1]+U,a[7][0]=a[7][0]+k+(V/4294967296>>>0)>>>0,a[7][1]=V>>>0,Be-=128}}var g=e(0);e(4),e(1);var t=s.exports=g.sha512=g.sha512||{};g.md.sha512=g.md.algorithms.sha512=t;var a=g.sha384=g.sha512.sha384=g.sha512.sha384||{};a.create=function(){return t.create("SHA-384")},g.md.sha384=g.md.algorithms.sha384=a,g.sha512.sha256=g.sha512.sha256||{create:function(){return t.create("SHA-512/256")}},g.md["sha512/256"]=g.md.algorithms["sha512/256"]=g.sha512.sha256,g.sha512.sha224=g.sha512.sha224||{create:function(){return t.create("SHA-512/224")}},g.md["sha512/224"]=g.md.algorithms["sha512/224"]=g.sha512.sha224,t.create=function(i){if(r||l(),void 0===i&&(i="SHA-512"),!(i in u))throw new Error("Invalid SHA-512 algorithm: "+i);for(var s=u[i],y=null,f=g.util.createBuffer(),m=Array(80),e=0;80>e;++e)m[e]=[,,];var h=64;"SHA-384"===i?h=48:"SHA-512/256"===i?h=32:"SHA-512/224"===i?h=28:void 0;var S={algorithm:i.replace("-","").toLowerCase(),blockLength:128,digestLength:h,messageLength:0,fullMessageLength:null,messageLengthSize:16};return S.start=function(){S.messageLength=0,S.fullMessageLength=S.messageLength128=[];for(var a=S.messageLengthSize/4,t=0;t<a;++t)S.fullMessageLength.push(0);f=g.util.createBuffer(),y=Array(s.length);for(var t=0;t<s.length;++t)y[t]=s[t].slice(0);return S},S.start(),S.update=function(e,a){"utf8"===a&&(e=g.util.encodeUtf8(e));var n=e.length;S.messageLength+=n,n=[n/4294967296>>>0,n>>>0];for(var s=S.fullMessageLength.length-1;0<=s;--s)S.fullMessageLength[s]+=n[1],n[1]=n[0]+(S.fullMessageLength[s]/4294967296>>>0),S.fullMessageLength[s]>>>=0,n[0]=n[1]/4294967296>>>0;return f.putBytes(e),d(y,m,f),(2048<f.read||0===f.length())&&f.compact(),S},S.digest=function(){var o=g.util.createBuffer();o.putBytes(f.bytes());var e=S.fullMessageLength[S.fullMessageLength.length-1]+S.messageLengthSize,t=e&S.blockLength-1;o.putBytes(n.substr(0,S.blockLength-t));for(var a,c,l=8*S.fullMessageLength[0],p=0;p<S.fullMessageLength.length-1;++p)a=8*S.fullMessageLength[p+1],c=a/4294967296>>>0,l+=c,o.putInt32(l>>>0),l=a>>>0;o.putInt32(l);for(var E=Array(y.length),p=0;p<y.length;++p)E[p]=y[p].slice(0);d(E,m,o);var C,I=g.util.createBuffer();C="SHA-512"===i?E.length:"SHA-384"===i?E.length-2:E.length-4;for(var p=0;p<C;++p)I.putInt32(E[p][0]),p==C-1&&"SHA-512/224"===i||I.putInt32(E[p][1]);return I},S};var n=null,r=!1,c=null,u=null},function(s,o,e){var c=e(0);e(1),s.exports=c.log=c.log||{},c.log.levels=["none","error","warning","info","debug","verbose","max"];var d={},a=[],t=null;c.log.LEVEL_LOCKED=2,c.log.NO_LEVEL_CHECK=4,c.log.INTERPOLATE=8;for(var n,l=0;l<c.log.levels.length;++l)n=c.log.levels[l],d[n]={index:l,name:n.toUpperCase()};c.log.logMessage=function(r){for(var n,s=d[r.level].index,i=0;i<a.length;++i)n=a[i],n.flags&c.log.NO_LEVEL_CHECK?n.f(r):s<=d[n.level].index&&n.f(n,r)},c.log.prepareStandard=function(e){"standard"in e||(e.standard=d[e.level].name+" ["+e.category+"] "+e.message)},c.log.prepareFull=function(t){if(!("full"in t)){var a=[t.message];a=a.concat([]),t.full=c.util.format.apply(this,a)}},c.log.prepareStandardFull=function(e){"standardFull"in e||(c.log.prepareStandard(e),e.standardFull=e.standard)};for(var g=["error","warning","info","debug","verbose"],l=0;l<g.length;++l)!function(s){c.log[s]=function(a,e){var t=Array.prototype.slice.call(arguments).slice(2),r={timestamp:new Date,level:s,category:a,message:e,arguments:t};c.log.logMessage(r)}}(g[l]);if(c.log.makeLogger=function(t){var a={flags:0,f:t};return c.log.setLevel(a,"none"),a},c.log.setLevel=function(r,a){var e=!1;if(r&&!(r.flags&c.log.LEVEL_LOCKED))for(var n,i=0;i<c.log.levels.length;++i)if(n=c.log.levels[i],a==n){r.level=a,e=!0;break}return e},c.log.lock=function(t,a){void 0===a||a?t.flags|=c.log.LEVEL_LOCKED:t.flags&=~c.log.LEVEL_LOCKED},c.log.addLogger=function(e){a.push(e)},"undefined"!=typeof console&&"log"in console){var h;if(console.error&&console.warn&&console.info&&console.debug){var f={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},m=function(n,a){c.log.prepareStandard(a);var e=f[a.level],t=[a.standard];t=t.concat(a.arguments.slice()),e.apply(console,t)};h=c.log.makeLogger(m)}else{var m=function(t,a){c.log.prepareStandardFull(a),console.log(a.standardFull)};h=c.log.makeLogger(m)}c.log.setLevel(h,"debug"),c.log.addLogger(h),t=h}else console={log:function(){}};if(null!==t){var C=c.util.getQueryVariables();("console.level"in C&&c.log.setLevel(t,C["console.level"].slice(-1)[0]),"console.lock"in C)&&"true"==C["console.lock"].slice(-1)[0]&&c.log.lock(t)}c.log.consoleLogger=t},function(r,a,e){r.exports=e(35)},function(r,a,e){r.exports=e(0),e(5),e(38),e(3),e(13),e(31),e(10),e(40),e(8),e(42),e(33),e(43),e(30),e(15),e(7),e(26),e(28),e(44),e(21),e(27),e(24),e(18),e(2),e(25),e(45),e(46),e(20),e(1)},function(e){var r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(a){function n(r,s){var e=0,o=s.length,c=s.charAt(0),a=[0];for(e=0;e<r.length();++e){for(var n=0,d=r.at(e);n<a.length;++n)d+=a[n]<<8,a[n]=d%o,d=0|d/o;for(;0<d;)a.push(d%o),d=0|d/o}var l="";for(e=0;0===r.at(e)&&e<r.length()-1;++e)l+=c;for(e=a.length-1;0<=e;--e)l+=s[a[e]];return l}var t={};a.exports=t;var e={};t.encode=function(i,r,e){if("string"!=typeof r)throw new TypeError("\"alphabet\" must be a string.");if(void 0!==e&&"number"!=typeof e)throw new TypeError("\"maxline\" must be a number.");var t="";if(i instanceof Uint8Array){var d=0,l=r.length,p=r.charAt(0),s=[0];for(d=0;d<i.length;++d){for(var o=0,u=i[d];o<s.length;++o)u+=s[o]<<8,s[o]=u%l,u=0|u/l;for(;0<u;)s.push(u%l),u=0|u/l}for(d=0;0===i[d]&&d<i.length-1;++d)t+=p;for(d=s.length-1;0<=d;--d)t+=r[s[d]]}else t=n(i,r);if(e){var y=new RegExp(".{1,"+e+"}","g");t=t.match(y).join("\r\n")}return t},t.decode=function(a,r){if("string"!=typeof a)throw new TypeError("\"input\" must be a string.");if("string"!=typeof r)throw new TypeError("\"alphabet\" must be a string.");var c=e[r];if(!c){c=e[r]=[];for(var d=0;d<r.length;++d)c[r.charCodeAt(d)]=d}a=a.replace(/\s/g,"");for(var l,p=r.length,u=r.charAt(0),i=[0],d=0;d<a.length;d++){if(l=c[a.charCodeAt(d)],void 0===l)return;for(var s=0,g=l;s<i.length;++s)g+=i[s]*p,i[s]=255&g,g>>=8;for(;0<g;)i.push(255&g),g>>=8}for(var f=0;a[f]===u&&f<a.length-1;++f)i.push(0);return"undefined"==typeof Buffer?new Uint8Array(i.reverse()):Buffer.from(i.reverse())}},function(a,i,e){function t(a,n,e){var t=n.entity===m.tls.ConnectionEnd.client;a.read.cipherState={init:!1,cipher:m.cipher.createDecipher("AES-CBC",t?e.keys.server_write_key:e.keys.client_write_key),iv:t?e.keys.server_write_IV:e.keys.client_write_IV},a.write.cipherState={init:!1,cipher:m.cipher.createCipher("AES-CBC",t?e.keys.client_write_key:e.keys.server_write_key),iv:t?e.keys.client_write_IV:e.keys.server_write_IV},a.read.cipherFunction=d,a.write.cipherFunction=o,a.read.macLength=a.write.macLength=e.mac_length,a.read.macFunction=a.write.macFunction=c.hmac_sha1}function o(n,s){var e=!1,i=s.macFunction(s.macKey,s.sequenceNumber,n);n.fragment.putBytes(i),s.updateSequenceNumber();var o;o=n.version.minor===c.Versions.TLS_1_0.minor?s.cipherState.init?null:s.cipherState.iv:m.random.getBytesSync(16),s.cipherState.init=!0;var l=s.cipherState.cipher;return l.start({iv:o}),n.version.minor>=c.Versions.TLS_1_1.minor&&l.output.putBytes(o),l.update(n.fragment),l.finish(r)&&(n.fragment=l.output,n.length=n.fragment.length(),e=!0),e}function r(a,n,e){if(!e){var t=a-n.length()%a;n.fillWithByte(t-1,t)}return!0}function f(a,s,e){var t=!0;if(e){for(var o=s.length(),c=s.last(),n=o-1-c;n<o-1;++n)t=t&&s.at(n)==c;t&&s.truncate(c+1)}return t}function d(a,r){var e,s=!1;e=a.version.minor===c.Versions.TLS_1_0.minor?r.cipherState.init?null:r.cipherState.iv:a.fragment.getBytes(16),r.cipherState.init=!0;var o=r.cipherState.cipher;o.start({iv:e}),o.update(a.fragment),s=o.finish(f);var d=r.macLength,n=m.random.getBytesSync(d),u=o.output.length();u>=d?(a.fragment=o.output.getBytes(u-d),n=o.output.getBytes(d)):a.fragment=o.output.getBytes(),a.fragment=m.util.createBuffer(a.fragment),a.length=a.fragment.length();var g=r.macFunction(r.macKey,r.sequenceNumber,a);return r.updateSequenceNumber(),s=y(r.macKey,n,g)&&s}function y(t,a,r){var n=m.hmac.create();return n.start("SHA1",t),n.update(a),a=n.digest().getBytes(),n.start(null,null),n.update(r),r=n.digest().getBytes(),a===r}var m=e(0);e(5),e(20);var c=a.exports=m.tls;c.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(e){e.bulk_cipher_algorithm=c.BulkCipherAlgorithm.aes,e.cipher_type=c.CipherType.block,e.enc_key_length=16,e.block_length=16,e.fixed_iv_length=16,e.record_iv_length=16,e.mac_algorithm=c.MACAlgorithm.hmac_sha1,e.mac_length=20,e.mac_key_length=20},initConnectionState:t},c.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(e){e.bulk_cipher_algorithm=c.BulkCipherAlgorithm.aes,e.cipher_type=c.CipherType.block,e.enc_key_length=32,e.block_length=16,e.fixed_iv_length=16,e.record_iv_length=16,e.mac_algorithm=c.MACAlgorithm.hmac_sha1,e.mac_length=20,e.mac_key_length=20},initConnectionState:t}},function(a,n,e){var t=e(0);e(30),a.exports=t.mgf=t.mgf||{},t.mgf.mgf1=t.mgf1},function(q,j,e){function G(t){var r=t.message;if(r instanceof Uint8Array||r instanceof N)return r;var n=t.encoding;if(void 0===r){if(!t.md)throw new TypeError("\"options.message\" or \"options.md\" not specified.");r=t.md.digest().getBytes(),n="binary"}if("string"==typeof r&&!n)throw new TypeError("\"options.encoding\" must be \"binary\" or \"utf8\".");if("string"==typeof r){if("undefined"!=typeof Buffer)return Buffer.from(r,n);r=new v(r,n)}else if(!(r instanceof v))throw new TypeError("\"options.message\" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with \"options.encoding\" specifying its encoding.");for(var s=new N(r.length()),o=0;o<s.length;++o)s[o]=r.at(o);return s}function M(s,o){var e=I.md.sha512.create(),t=new v(s);e.update(t.getBytes(o),"binary");var r=e.digest().getBytes();if("undefined"!=typeof Buffer)return Buffer.from(r,"binary");for(var a=new N(R.constants.HASH_BYTE_LENGTH),n=0;64>n;++n)a[n]=r.charCodeAt(n);return a}function t(r,n){var e,i=[m(),m(),m(),m()],s=M(n,32);for(s[0]&=248,s[31]&=127,s[31]|=64,h(i,s),u(r,i),e=0;32>e;++e)n[e+32]=r[e];return 0}function H(n,s,e,t){var r,i,c=new Float64Array(64),g=[m(),m(),m(),m()],o=M(t,32);for(o[0]&=248,o[31]&=127,o[31]|=64,r=0;r<e;++r)n[64+r]=s[r];for(r=0;32>r;++r)n[32+r]=o[32+r];var l=M(n.subarray(32),e+32);for(W(l),h(g,l),u(n,g),r=32;64>r;++r)n[r]=t[r];var p=M(n,e+64);for(W(p),r=32;64>r;++r)c[r]=0;for(r=0;32>r;++r)c[r]=l[r];for(r=0;32>r;++r)for(i=0;32>i;i++)c[r+i]+=p[r]*o[i];return Y(n.subarray(32),c),e+64}function Q(r,n,e,p){var d,f=new N(32),g=[m(),m(),m(),m()],s=[m(),m(),m(),m()];if(-1,64>e)return-1;if(i(s,p))return-1;for(d=0;d<e;++d)r[d]=n[d];for(d=0;32>d;++d)r[d+32]=p[d];var o=M(r,e);if(W(o),y(g,s,o),h(s,n.subarray(32)),X(g,s),u(f,g),e-=64,l(n,0,f,0)){for(d=0;d<e;++d)r[d]=0;return-1}for(d=0;d<e;++d)r[d]=n[d+64];return e}function Y(a,r){var e,n,s,i;for(n=63;32<=n;--n){for(e=0,s=n-32,i=n-12;s<i;++s)r[s]+=e-16*r[n]*V[s-(n-32)],e=r[s]+128>>8,r[s]-=256*e;r[s]+=e,r[n]=0}for(e=0,s=0;32>s;++s)r[s]+=e-(r[31]>>4)*V[s],e=r[s]>>8,r[s]&=255;for(s=0;32>s;++s)r[s]-=e*V[s];for(n=0;32>n;++n)r[n+1]+=r[n]>>8,a[n]=255&r[n]}function W(r){for(var a=new Float64Array(64),e=0;64>e;++e)a[e]=r[e],r[e]=0;Y(r,a)}function X(l,d){var e=m(),t=m(),r=m(),a=m(),n=m(),i=m(),s=m(),o=m(),c=m();E(e,l[1],l[0]),E(c,d[1],d[0]),T(e,e,c),C(t,l[0],l[1]),C(c,d[0],d[1]),T(t,t,c),T(r,l[3],d[3]),T(r,r,U),T(a,l[2],d[2]),C(a,a,a),E(n,t,e),E(i,a,r),C(s,a,r),C(o,t,e),T(l[0],n,i),T(l[1],o,s),T(l[2],s,i),T(l[3],n,o)}function a(a,n,e){for(var t=0;4>t;++t)c(a[t],n[t],e)}function u(i,s){var e=m(),t=m(),r=m();n(r,s[2]),T(e,s[0],r),T(t,s[1],r),J(i,t),i[31]^=g(e)<<7}function J(a,r){var e,n,s,p=m(),l=m();for(e=0;16>e;++e)l[e]=r[e];for(o(l),o(l),o(l),n=0;2>n;++n){for(p[0]=l[0]-65517,e=1;15>e;++e)p[e]=l[e]-65535-(1&p[e-1]>>16),p[e-1]&=65535;p[15]=l[15]-32767-(1&p[14]>>16),s=1&p[15]>>16,p[14]&=65535,c(l,p,1-s)}for(e=0;16>e;e++)a[2*e]=255&l[e],a[2*e+1]=l[e]>>8}function i(c,l){var e=m(),t=m(),r=m(),a=m(),n=m(),i=m(),s=m();return f(c[2],_),$(c[1],l),S(r,c[1]),T(a,r,k),E(r,r,c[2]),C(a,c[2],a),S(n,a),S(i,n),T(s,i,n),T(e,s,r),T(e,e,a),d(e,e),T(e,e,r),T(e,e,a),T(e,e,a),T(c[0],e,a),S(t,c[0]),T(t,t,a),p(t,r)&&T(c[0],c[0],O),S(t,c[0]),T(t,t,a),p(t,r)?-1:(g(c[0])===l[31]>>7&&E(c[0],L,c[0]),T(c[3],c[0],c[1]),0)}function $(r,a){var e;for(e=0;16>e;++e)r[e]=a[2*e]+(a[2*e+1]<<8);r[15]&=32767}function d(a,r){var e,n=m();for(e=0;16>e;++e)n[e]=r[e];for(e=250;0<=e;--e)S(n,n),1!==e&&T(n,n,r);for(e=0;16>e;++e)a[e]=n[e]}function p(a,n){var e=new N(32),t=new N(32);return J(e,a),J(t,n),l(e,0,t,0)}function l(a,n,e,t){return s(a,n,e,t,32)}function s(s,i,e,t,r){var a,o=0;for(a=0;a<r;++a)o|=s[i+a]^e[t+a];return(1&o-1>>>8)-1}function g(t){var a=new N(32);return J(a,t),1&a[0]}function y(n,s,e){var t,i;for(f(n[0],L),f(n[1],_),f(n[2],_),f(n[3],L),i=255;0<=i;--i)t=1&e[0|i/8]>>(7&i),a(n,s,t),X(s,n),X(n,n),a(n,s,t)}function h(r,a){var e=[m(),m(),m(),m()];f(e[0],D),f(e[1],P),f(e[2],_),T(e[3],D,P),y(r,e,a)}function f(r,a){var e;for(e=0;16>e;e++)r[e]=0|a[e]}function n(a,r){var e,n=m();for(e=0;16>e;++e)n[e]=r[e];for(e=253;0<=e;--e)S(n,n),2!==e&&4!==e&&T(n,n,r);for(e=0;16>e;++e)a[e]=n[e]}function o(t){var a,r,n=1;for(a=0;16>a;++a)r=t[a]+n+65535,n=Math.floor(r/65536),t[a]=r-65536*n;t[0]+=n-1+37*(n-1)}function c(a,n,e){for(var t,i=0;16>i;++i)t=~(e-1)&(a[i]^n[i]),a[i]^=t,n[i]^=t}function m(t){var a,r=new Float64Array(16);if(t)for(a=0;a<t.length;++a)r[a]=t[a];return r}function C(a,n,e){for(var t=0;16>t;++t)a[t]=n[t]+e[t]}function E(a,n,e){for(var t=0;16>t;++t)a[t]=n[t]-e[t]}function S(t,a){T(t,a,a)}function T(a,n,e){var t,s,i=0,o=0,c=0,d=0,l=0,p=0,u=0,g=0,y=0,h=0,f=0,m=0,C=0,E=0,S=0,T=0,I=0,B=0,A=0,b=0,v=0,N=0,R=0,L=0,_=0,k=0,U=0,D=0,P=0,w=0,J=0,De=e[0],ke=e[1],V=e[2],O=e[3],K=e[4],x=e[5],M=e[6],F=e[7],j=e[8],q=e[9],G=e[10],H=e[11],Q=e[12],Ue=e[13],Y=e[14],W=e[15];t=n[0],i+=t*De,o+=t*ke,c+=t*V,d+=t*O,l+=t*K,p+=t*x,u+=t*M,g+=t*F,y+=t*j,h+=t*q,f+=t*G,m+=t*H,C+=t*Q,E+=t*Ue,S+=t*Y,T+=t*W,t=n[1],o+=t*De,c+=t*ke,d+=t*V,l+=t*O,p+=t*K,u+=t*x,g+=t*M,y+=t*F,h+=t*j,f+=t*q,m+=t*G,C+=t*H,E+=t*Q,S+=t*Ue,T+=t*Y,I+=t*W,t=n[2],c+=t*De,d+=t*ke,l+=t*V,p+=t*O,u+=t*K,g+=t*x,y+=t*M,h+=t*F,f+=t*j,m+=t*q,C+=t*G,E+=t*H,S+=t*Q,T+=t*Ue,I+=t*Y,B+=t*W,t=n[3],d+=t*De,l+=t*ke,p+=t*V,u+=t*O,g+=t*K,y+=t*x,h+=t*M,f+=t*F,m+=t*j,C+=t*q,E+=t*G,S+=t*H,T+=t*Q,I+=t*Ue,B+=t*Y,A+=t*W,t=n[4],l+=t*De,p+=t*ke,u+=t*V,g+=t*O,y+=t*K,h+=t*x,f+=t*M,m+=t*F,C+=t*j,E+=t*q,S+=t*G,T+=t*H,I+=t*Q,B+=t*Ue,A+=t*Y,b+=t*W,t=n[5],p+=t*De,u+=t*ke,g+=t*V,y+=t*O,h+=t*K,f+=t*x,m+=t*M,C+=t*F,E+=t*j,S+=t*q,T+=t*G,I+=t*H,B+=t*Q,A+=t*Ue,b+=t*Y,v+=t*W,t=n[6],u+=t*De,g+=t*ke,y+=t*V,h+=t*O,f+=t*K,m+=t*x,C+=t*M,E+=t*F,S+=t*j,T+=t*q,I+=t*G,B+=t*H,A+=t*Q,b+=t*Ue,v+=t*Y,N+=t*W,t=n[7],g+=t*De,y+=t*ke,h+=t*V,f+=t*O,m+=t*K,C+=t*x,E+=t*M,S+=t*F,T+=t*j,I+=t*q,B+=t*G,A+=t*H,b+=t*Q,v+=t*Ue,N+=t*Y,R+=t*W,t=n[8],y+=t*De,h+=t*ke,f+=t*V,m+=t*O,C+=t*K,E+=t*x,S+=t*M,T+=t*F,I+=t*j,B+=t*q,A+=t*G,b+=t*H,v+=t*Q,N+=t*Ue,R+=t*Y,L+=t*W,t=n[9],h+=t*De,f+=t*ke,m+=t*V,C+=t*O,E+=t*K,S+=t*x,T+=t*M,I+=t*F,B+=t*j,A+=t*q,b+=t*G,v+=t*H,N+=t*Q,R+=t*Ue,L+=t*Y,_+=t*W,t=n[10],f+=t*De,m+=t*ke,C+=t*V,E+=t*O,S+=t*K,T+=t*x,I+=t*M,B+=t*F,A+=t*j,b+=t*q,v+=t*G,N+=t*H,R+=t*Q,L+=t*Ue,_+=t*Y,k+=t*W,t=n[11],m+=t*De,C+=t*ke,E+=t*V,S+=t*O,T+=t*K,I+=t*x,B+=t*M,A+=t*F,b+=t*j,v+=t*q,N+=t*G,R+=t*H,L+=t*Q,_+=t*Ue,k+=t*Y,U+=t*W,t=n[12],C+=t*De,E+=t*ke,S+=t*V,T+=t*O,I+=t*K,B+=t*x,A+=t*M,b+=t*F,v+=t*j,N+=t*q,R+=t*G,L+=t*H,_+=t*Q,k+=t*Ue,U+=t*Y,D+=t*W,t=n[13],E+=t*De,S+=t*ke,T+=t*V,I+=t*O,B+=t*K,A+=t*x,b+=t*M,v+=t*F,N+=t*j,R+=t*q,L+=t*G,_+=t*H,k+=t*Q,U+=t*Ue,D+=t*Y,P+=t*W,t=n[14],S+=t*De,T+=t*ke,I+=t*V,B+=t*O,A+=t*K,b+=t*x,v+=t*M,N+=t*F,R+=t*j,L+=t*q,_+=t*G,k+=t*H,U+=t*Q,D+=t*Ue,P+=t*Y,w+=t*W,t=n[15],T+=t*De,I+=t*ke,B+=t*V,A+=t*O,b+=t*K,v+=t*x,N+=t*M,R+=t*F,L+=t*j,_+=t*q,k+=t*G,U+=t*H,D+=t*Q,P+=t*Ue,w+=t*Y,J+=t*W,i+=38*I,o+=38*B,c+=38*A,d+=38*b,l+=38*v,p+=38*N,u+=38*R,g+=38*L,y+=38*_,h+=38*k,f+=38*U,m+=38*D,C+=38*P,E+=38*w,S+=38*J,s=1,t=i+s+65535,s=Math.floor(t/65536),i=t-65536*s,t=o+s+65535,s=Math.floor(t/65536),o=t-65536*s,t=c+s+65535,s=Math.floor(t/65536),c=t-65536*s,t=d+s+65535,s=Math.floor(t/65536),d=t-65536*s,t=l+s+65535,s=Math.floor(t/65536),l=t-65536*s,t=p+s+65535,s=Math.floor(t/65536),p=t-65536*s,t=u+s+65535,s=Math.floor(t/65536),u=t-65536*s,t=g+s+65535,s=Math.floor(t/65536),g=t-65536*s,t=y+s+65535,s=Math.floor(t/65536),y=t-65536*s,t=h+s+65535,s=Math.floor(t/65536),h=t-65536*s,t=f+s+65535,s=Math.floor(t/65536),f=t-65536*s,t=m+s+65535,s=Math.floor(t/65536),m=t-65536*s,t=C+s+65535,s=Math.floor(t/65536),C=t-65536*s,t=E+s+65535,s=Math.floor(t/65536),E=t-65536*s,t=S+s+65535,s=Math.floor(t/65536),S=t-65536*s,t=T+s+65535,s=Math.floor(t/65536),T=t-65536*s,i+=s-1+37*(s-1),s=1,t=i+s+65535,s=Math.floor(t/65536),i=t-65536*s,t=o+s+65535,s=Math.floor(t/65536),o=t-65536*s,t=c+s+65535,s=Math.floor(t/65536),c=t-65536*s,t=d+s+65535,s=Math.floor(t/65536),d=t-65536*s,t=l+s+65535,s=Math.floor(t/65536),l=t-65536*s,t=p+s+65535,s=Math.floor(t/65536),p=t-65536*s,t=u+s+65535,s=Math.floor(t/65536),u=t-65536*s,t=g+s+65535,s=Math.floor(t/65536),g=t-65536*s,t=y+s+65535,s=Math.floor(t/65536),y=t-65536*s,t=h+s+65535,s=Math.floor(t/65536),h=t-65536*s,t=f+s+65535,s=Math.floor(t/65536),f=t-65536*s,t=m+s+65535,s=Math.floor(t/65536),m=t-65536*s,t=C+s+65535,s=Math.floor(t/65536),C=t-65536*s,t=E+s+65535,s=Math.floor(t/65536),E=t-65536*s,t=S+s+65535,s=Math.floor(t/65536),S=t-65536*s,t=T+s+65535,s=Math.floor(t/65536),T=t-65536*s,i+=s-1+37*(s-1),a[0]=i,a[1]=o,a[2]=c,a[3]=d,a[4]=l,a[5]=p,a[6]=u,a[7]=g,a[8]=y,a[9]=h,a[10]=f,a[11]=m,a[12]=C,a[13]=E,a[14]=S,a[15]=T}var I=e(0);e(12),e(2),e(32),e(1);var B=e(41),A=B.publicKeyValidator,b=B.privateKeyValidator;if(void 0===r)var r=I.jsbn.BigInteger;var v=I.util.ByteBuffer,N="undefined"==typeof Buffer?Uint8Array:Buffer;I.pki=I.pki||{},q.exports=I.pki.ed25519=I.ed25519=I.ed25519||{};var R=I.ed25519;R.constants={},R.constants.PUBLIC_KEY_BYTE_LENGTH=32,R.constants.PRIVATE_KEY_BYTE_LENGTH=64,R.constants.SEED_BYTE_LENGTH=32,R.constants.SIGN_BYTE_LENGTH=64,R.constants.HASH_BYTE_LENGTH=64,R.generateKeyPair=function(e){e=e||{};var a=e.seed;if(void 0===a)a=I.random.getBytesSync(R.constants.SEED_BYTE_LENGTH);else if("string"==typeof a){if(a.length!==R.constants.SEED_BYTE_LENGTH)throw new TypeError("\"seed\" must be "+R.constants.SEED_BYTE_LENGTH+" bytes in length.");}else if(!(a instanceof Uint8Array))throw new TypeError("\"seed\" must be a node.js Buffer, Uint8Array, or a binary string.");a=G({message:a,encoding:"binary"});for(var s=new N(R.constants.PUBLIC_KEY_BYTE_LENGTH),c=new N(R.constants.PRIVATE_KEY_BYTE_LENGTH),r=0;32>r;++r)c[r]=a[r];return t(s,c),{publicKey:s,privateKey:c}},R.privateKeyFromAsn1=function(o){var a={},e=[];if(!I.asn1.validate(o,b,a,e)){var t=new Error("Invalid Key.");throw t.errors=e,t}var r=I.asn1.derToOid(a.privateKeyOid),n=I.oids.EdDSA25519;if(r!==n)throw new Error("Invalid OID \""+r+"\"; OID must be \""+n+"\".");var i=a.privateKey;return{privateKeyBytes:G({message:I.asn1.fromDer(i).value,encoding:"binary"})}},R.publicKeyFromAsn1=function(o){var a={},e=[];if(!I.asn1.validate(o,A,a,e)){var t=new Error("Invalid Key.");throw t.errors=e,t}var r=I.asn1.derToOid(a.publicKeyOid),n=I.oids.EdDSA25519;if(r!==n)throw new Error("Invalid OID \""+r+"\"; OID must be \""+n+"\".");var i=a.ed25519PublicKey;if(i.length!==R.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return G({message:i,encoding:"binary"})},R.publicKeyFromPrivateKey=function(e){e=e||{};var n=G({message:e.privateKey,encoding:"binary"});if(n.length!==R.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError("\"options.privateKey\" must have a byte length of "+R.constants.PRIVATE_KEY_BYTE_LENGTH);for(var s=new N(R.constants.PUBLIC_KEY_BYTE_LENGTH),t=0;t<s.length;++t)s[t]=n[32+t];return s},R.sign=function(e){e=e||{};var r=G(e),s=G({message:e.privateKey,encoding:"binary"});if(s.length===R.constants.SEED_BYTE_LENGTH)s=R.generateKeyPair({seed:s}).privateKey;else if(s.length!==R.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError("\"options.privateKey\" must have a byte length of "+R.constants.SEED_BYTE_LENGTH+" or "+R.constants.PRIVATE_KEY_BYTE_LENGTH);var o=new N(R.constants.SIGN_BYTE_LENGTH+r.length);H(o,r,r.length,s);for(var c=new N(R.constants.SIGN_BYTE_LENGTH),n=0;n<c.length;++n)c[n]=o[n];return c},R.verify=function(e){e=e||{};var i=G(e);if(void 0===e.signature)throw new TypeError("\"options.signature\" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.");var o=G({message:e.signature,encoding:"binary"});if(o.length!==R.constants.SIGN_BYTE_LENGTH)throw new TypeError("\"options.signature\" must have a byte length of "+R.constants.SIGN_BYTE_LENGTH);var t=G({message:e.publicKey,encoding:"binary"});if(t.length!==R.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError("\"options.publicKey\" must have a byte length of "+R.constants.PUBLIC_KEY_BYTE_LENGTH);var r,c=new N(R.constants.SIGN_BYTE_LENGTH+i.length),d=new N(R.constants.SIGN_BYTE_LENGTH+i.length);for(r=0;r<R.constants.SIGN_BYTE_LENGTH;++r)c[r]=o[r];for(r=0;r<i.length;++r)c[r+R.constants.SIGN_BYTE_LENGTH]=i[r];return 0<=Q(d,c,c.length,t)};var L=m(),_=m([1]),k=m([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),U=m([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),D=m([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),P=m([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),V=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),O=m([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139])},function(n,s,e){var t=e(0);e(3);var r=t.asn1;s.privateKeyValidator={name:"PrivateKeyInfo",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},s.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:r.Class.UNIVERSAL,type:r.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]}},function(n,s,e){function t(e,s,i,t){e.generate=function(r,a){for(var e=new u.util.ByteBuffer,n=Math.ceil(a/t)+i,d=new u.util.ByteBuffer,o=i;o<n;++o){d.putInt32(o),s.start(),s.update(r+d.getBytes());var l=s.digest();e.putBytes(l.getBytes(t))}return e.truncate(e.length()-a),e.getBytes()}}var u=e(0);e(1),e(2),e(12),n.exports=u.kem=u.kem||{};var i=u.jsbn.BigInteger;u.kem.rsa={},u.kem.rsa.create=function(s,t){t=t||{};var a=t.prng||u.random,n={};return n.encrypt=function(n,e){var t,c=Math.ceil(n.n.bitLength()/8);do t=new i(u.util.bytesToHex(a.getBytesSync(c)),16).mod(n.n);while(0>=t.compareTo(i.ONE));t=u.util.hexToBytes(t.toString(16));var d=c-t.length;return 0<d&&(t=u.util.fillString(String.fromCharCode(0),d)+t),{encapsulation:n.encrypt(t,"NONE"),key:s.generate(t,e)}},n.decrypt=function(n,e,t){var r=n.decrypt(e,"NONE");return s.generate(r,t)},n},u.kem.kdf1=function(r,a){t(this,r,0,a||r.digestLength)},u.kem.kdf2=function(r,a){t(this,r,1,a||r.digestLength)}},function(r,a,e){r.exports=e(4),e(14),e(9),e(23),e(32)},function(p,g,e){function y(a){var n={},e=[];if(!l.validate(a,c.asn1.recipientInfoValidator,n,e)){var t=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw t.errors=e,t}return{version:n.version.charCodeAt(0),issuer:I.pki.RDNAttributesAsArray(n.issuer),serialNumber:I.util.createBuffer(n.serial).toHex(),encryptedContent:{algorithm:l.derToOid(n.encAlgorithm),parameter:n.encParameter.value,content:n.encKey}}}function h(e){return l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.INTEGER,!1,l.integerToDer(e.version).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[I.pki.distinguishedNameToAsn1({attributes:e.issuer}),l.create(l.Class.UNIVERSAL,l.Type.INTEGER,!1,I.util.hexToBytes(e.serialNumber))]),l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(e.encryptedContent.algorithm).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.NULL,!1,"")]),l.create(l.Class.UNIVERSAL,l.Type.OCTETSTRING,!1,e.encryptedContent.content)])}function a(r){for(var a=[],e=0;e<r.length;++e)a.push(y(r[e]));return a}function t(a){for(var r=[],e=0;e<a.length;++e)r.push(h(a[e]));return r}function r(a){var n=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.INTEGER,!1,l.integerToDer(a.version).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[I.pki.distinguishedNameToAsn1({attributes:a.issuer}),l.create(l.Class.UNIVERSAL,l.Type.INTEGER,!1,I.util.hexToBytes(a.serialNumber))]),l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(a.digestAlgorithm).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.NULL,!1,"")])]);if(a.authenticatedAttributesAsn1&&n.value.push(a.authenticatedAttributesAsn1),n.value.push(l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(a.signatureAlgorithm).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.NULL,!1,"")])),n.value.push(l.create(l.Class.UNIVERSAL,l.Type.OCTETSTRING,!1,a.signature)),0<a.unauthenticatedAttributes.length){for(var e,s=l.create(l.Class.CONTEXT_SPECIFIC,1,!0,[]),i=0;i<a.unauthenticatedAttributes.length;++i)e=a.unauthenticatedAttributes[i],s.values.push(f(e));n.value.push(s)}return n}function n(n){for(var a=[],e=0;e<n.length;++e)a.push(r(n[e]));return a}function f(t){var n;if(t.type===I.pki.oids.contentType)n=l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(t.value).getBytes());else if(t.type===I.pki.oids.messageDigest)n=l.create(l.Class.UNIVERSAL,l.Type.OCTETSTRING,!1,t.value.bytes());else if(t.type===I.pki.oids.signingTime){var s=new Date("1950-01-01T00:00:00Z"),i=new Date("2050-01-01T00:00:00Z"),r=t.value;if("string"==typeof r){var o=Date.parse(r);r=isNaN(o)?13===r.length?l.utcTimeToDate(r):l.generalizedTimeToDate(r):new Date(o)}n=r>=s&&r<i?l.create(l.Class.UNIVERSAL,l.Type.UTCTIME,!1,l.dateToUtcTime(r)):l.create(l.Class.UNIVERSAL,l.Type.GENERALIZEDTIME,!1,l.dateToGeneralizedTime(r))}return l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(t.type).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.SET,!0,[n])])}function s(e){return[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(I.pki.oids.data).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(e.algorithm).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.OCTETSTRING,!1,e.parameter.getBytes())]),l.create(l.Class.CONTEXT_SPECIFIC,0,!0,[l.create(l.Class.UNIVERSAL,l.Type.OCTETSTRING,!1,e.content.getBytes())])]}function i(s,n,e){var t={};if(!l.validate(n,e,t,[])){var r=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw r.errors=r,r}if(l.derToOid(t.contentType)!==I.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(t.encryptedContent){var a="";if(I.util.isArray(t.encryptedContent))for(var o=0;o<t.encryptedContent.length;++o){if(t.encryptedContent[o].type!==l.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");a+=t.encryptedContent[o].value}else a=t.encryptedContent;s.encryptedContent={algorithm:l.derToOid(t.encAlgorithm),parameter:I.util.createBuffer(t.encParameter.value),content:I.util.createBuffer(a)}}if(t.content){var a="";if(I.util.isArray(t.content))for(var o=0;o<t.content.length;++o){if(t.content[o].type!==l.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");a+=t.content[o].value}else a=t.content;s.content=I.util.createBuffer(a)}return s.version=t.version.charCodeAt(0),s.rawCapture=t,t}function o(t){if(void 0===t.encryptedContent.key)throw new Error("Symmetric key not available.");if(void 0===t.content){var a;switch(t.encryptedContent.algorithm){case I.pki.oids["aes128-CBC"]:case I.pki.oids["aes192-CBC"]:case I.pki.oids["aes256-CBC"]:a=I.aes.createDecryptionCipher(t.encryptedContent.key);break;case I.pki.oids.desCBC:case I.pki.oids["des-EDE3-CBC"]:a=I.des.createDecryptionCipher(t.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+t.encryptedContent.algorithm);}if(a.start(t.encryptedContent.parameter),a.update(t.encryptedContent.content),!a.finish())throw new Error("Symmetric decryption failed.");t.content=a.output}}var I=e(0);e(5),e(3),e(10),e(6),e(7),e(29),e(2),e(1),e(17);var l=I.asn1,c=p.exports=I.pkcs7=I.pkcs7||{};c.messageFromPem=function(a){var n=I.pem.decode(a)[0];if("PKCS7"!==n.type){var e=new Error("Could not convert PKCS#7 message from PEM; PEM header type is not \"PKCS#7\".");throw e.headerType=n.type,e}if(n.procType&&"ENCRYPTED"===n.procType.type)throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var t=l.fromDer(n.body);return c.messageFromAsn1(t)},c.messageToPem=function(r,a){var e={type:"PKCS7",body:l.toDer(r.toAsn1()).getBytes()};return I.pem.encode(e,{maxline:a})},c.messageFromAsn1=function(n){var s={},e=[];if(!l.validate(n,c.asn1.contentInfoValidator,s,e)){var t=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw t.errors=e,t}var r,i=l.derToOid(s.contentType);switch(i){case I.pki.oids.envelopedData:r=c.createEnvelopedData();break;case I.pki.oids.encryptedData:r=c.createEncryptedData();break;case I.pki.oids.signedData:r=c.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+i+" is not (yet) supported.");}return r.fromAsn1(s.content.value[0]),r},c.createSignedData=function(){function a(){for(var t={},r=0;r<u.signers.length;++r){var n=u.signers[r],s=n.digestAlgorithm;s in t||(t[s]=I.md[I.pki.oids[s]].create()),n.md=0===n.authenticatedAttributes.length?t[s]:I.md[I.pki.oids[s]].create()}for(var s in u.digestAlgorithmIdentifiers=[],t)u.digestAlgorithmIdentifiers.push(l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(s).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.NULL,!1,"")]));return t}function s(t){var r;if(u.detachedContent?r=u.detachedContent:(r=u.contentInfo.value[1],r=r.value[0]),!r)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var i=l.derToOid(u.contentInfo.value[0].value),o=l.toDer(r);for(var c in o.getByte(),l.getBerValueLength(o),o=o.getBytes(),t)t[c].start().update(o);for(var d,g=new Date,y=0;y<u.signers.length;++y){if(d=u.signers[y],0!==d.authenticatedAttributes.length){d.authenticatedAttributesAsn1=l.create(l.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var m,C=l.create(l.Class.UNIVERSAL,l.Type.SET,!0,[]),E=0;E<d.authenticatedAttributes.length;++E)m=d.authenticatedAttributes[E],m.type===I.pki.oids.messageDigest?m.value=t[d.digestAlgorithm].digest():m.type===I.pki.oids.signingTime&&(m.value||(m.value=g)),C.value.push(f(m)),d.authenticatedAttributesAsn1.value.push(f(m));o=l.toDer(C).getBytes(),d.md.start().update(o)}else if(i!==I.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.");d.signature=d.key.sign(d.md,"RSASSA-PKCS1-V1_5")}u.signerInfos=n(u.signers)}var u=null;return u={type:I.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(a){if(i(u,a,c.asn1.signedDataValidator),u.certificates=[],u.crls=[],u.digestAlgorithmIdentifiers=[],u.contentInfo=null,u.signerInfos=[],u.rawCapture.certificates)for(var r=u.rawCapture.certificates.value,e=0;e<r.length;++e)u.certificates.push(I.pki.certificateFromAsn1(r[e]))},toAsn1:function(){u.contentInfo||u.sign();for(var t=[],r=0;r<u.certificates.length;++r)t.push(I.pki.certificateToAsn1(u.certificates[r]));var n=[],s=l.create(l.Class.CONTEXT_SPECIFIC,0,!0,[l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.INTEGER,!1,l.integerToDer(u.version).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.SET,!0,u.digestAlgorithmIdentifiers),u.contentInfo])]);return 0<t.length&&s.value[0].value.push(l.create(l.Class.CONTEXT_SPECIFIC,0,!0,t)),0<n.length&&s.value[0].value.push(l.create(l.Class.CONTEXT_SPECIFIC,1,!0,n)),s.value[0].value.push(l.create(l.Class.UNIVERSAL,l.Type.SET,!0,u.signerInfos)),l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(u.type).getBytes()),s])},addSigner:function(t){var a=t.issuer,r=t.serialNumber;if(t.certificate){var n=t.certificate;"string"==typeof n&&(n=I.pki.certificateFromPem(n)),a=n.issuer.attributes,r=n.serialNumber}var i=t.key;if(!i)throw new Error("Could not add PKCS#7 signer; no private key specified.");"string"==typeof i&&(i=I.pki.privateKeyFromPem(i));var c=t.digestAlgorithm||I.pki.oids.sha1;switch(c){case I.pki.oids.sha1:case I.pki.oids.sha256:case I.pki.oids.sha384:case I.pki.oids.sha512:case I.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+c);}var l=t.authenticatedAttributes||[];if(0<l.length){for(var s,p=!1,g=!1,f=0;f<l.length;++f)if(s=l[f],p||s.type!==I.pki.oids.contentType){if(g||s.type!==I.pki.oids.messageDigest);else if(g=!0,p)break;}else if(p=!0,g)break;if(!p||!g)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}u.signers.push({key:i,version:1,issuer:a,serialNumber:r,digestAlgorithm:c,signatureAlgorithm:I.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:l,unauthenticatedAttributes:[]})},sign:function(e){if(e=e||{},("object"!=typeof u.content||null===u.contentInfo)&&(u.contentInfo=l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(I.pki.oids.data).getBytes())]),"content"in u)){var n;u.content instanceof I.util.ByteBuffer?n=u.content.bytes():"string"==typeof u.content&&(n=I.util.encodeUtf8(u.content)),e.detached?u.detachedContent=l.create(l.Class.UNIVERSAL,l.Type.OCTETSTRING,!1,n):u.contentInfo.value.push(l.create(l.Class.CONTEXT_SPECIFIC,0,!0,[l.create(l.Class.UNIVERSAL,l.Type.OCTETSTRING,!1,n)]))}0!==u.signers.length&&s(a())},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(e){"string"==typeof e&&(e=I.pki.certificateFromPem(e)),u.certificates.push(e)},addCertificateRevokationList:function(){throw new Error("PKCS#7 CRL support not yet implemented.")}}},c.createEncryptedData=function(){var t=null;return t={type:I.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:I.pki.oids["aes256-CBC"]},fromAsn1:function(a){i(t,a,c.asn1.encryptedDataValidator)},decrypt:function(a){void 0!==a&&(t.encryptedContent.key=a),o(t)}}},c.createEnvelopedData=function(){var f=null;return f={type:I.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:I.pki.oids["aes256-CBC"]},fromAsn1:function(r){var e=i(f,r,c.asn1.envelopedDataValidator);f.recipients=a(e.recipientInfos.value)},toAsn1:function(){return l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.OID,!1,l.oidToDer(f.type).getBytes()),l.create(l.Class.CONTEXT_SPECIFIC,0,!0,[l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,[l.create(l.Class.UNIVERSAL,l.Type.INTEGER,!1,l.integerToDer(f.version).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.SET,!0,t(f.recipients)),l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,!0,s(f.encryptedContent))])])])},findRecipient:function(a){for(var e=a.issuer.attributes,t=0;t<f.recipients.length;++t){var s=f.recipients[t],o=s.issuer;if(s.serialNumber===a.serialNumber&&o.length===e.length){for(var n=!0,c=0;c<e.length;++c)if(o[c].type!==e[c].type||o[c].value!==e[c].value){n=!1;break}if(n)return s}}return null},decrypt:function(a,e){if(void 0===f.encryptedContent.key&&void 0!==a&&void 0!==e)switch(a.encryptedContent.algorithm){case I.pki.oids.rsaEncryption:case I.pki.oids.desCBC:var t=e.decrypt(a.encryptedContent.content);f.encryptedContent.key=I.util.createBuffer(t);break;default:throw new Error("Unsupported asymmetric cipher, OID "+a.encryptedContent.algorithm);}o(f)},addRecipient:function(t){f.recipients.push({version:0,issuer:t.issuer.attributes,serialNumber:t.serialNumber,encryptedContent:{algorithm:I.pki.oids.rsaEncryption,key:t.publicKey}})},encrypt:function(t,a){if(void 0===f.encryptedContent.content){a=a||f.encryptedContent.algorithm,t=t||f.encryptedContent.key;var r,n,i;switch(a){case I.pki.oids["aes128-CBC"]:r=16,n=16,i=I.aes.createEncryptionCipher;break;case I.pki.oids["aes192-CBC"]:r=24,n=16,i=I.aes.createEncryptionCipher;break;case I.pki.oids["aes256-CBC"]:r=32,n=16,i=I.aes.createEncryptionCipher;break;case I.pki.oids["des-EDE3-CBC"]:r=24,n=8,i=I.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+a);}if(void 0===t)t=I.util.createBuffer(I.random.getBytes(r));else if(t.length()!=r)throw new Error("Symmetric key has wrong length; got "+t.length()+" bytes, expected "+r+".");f.encryptedContent.algorithm=a,f.encryptedContent.key=t,f.encryptedContent.parameter=I.util.createBuffer(I.random.getBytes(n));var o=i(t);if(o.start(f.encryptedContent.parameter.copy()),o.update(f.content),!o.finish())throw new Error("Symmetric encryption failed.");f.encryptedContent.content=o.output}for(var c,p=0;p<f.recipients.length;++p)if(c=f.recipients[p],void 0===c.encryptedContent.content)switch(c.encryptedContent.algorithm){case I.pki.oids.rsaEncryption:c.encryptedContent.content=c.encryptedContent.key.encrypt(f.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+c.encryptedContent.algorithm);}}}}},function(s,i,e){function t(a,r){var e=r.toString(16);"8"<=e[0]&&(e="00"+e);var n=d.util.hexToBytes(e);a.putInt32(n.length),a.putBytes(n)}function c(t,a){t.putInt32(a.length),t.putString(a)}function a(){for(var r=d.md.sha1.create(),a=arguments.length,e=0;e<a;++e)r.update(arguments[e]);return r.digest()}var d=e(0);e(5),e(8),e(14),e(9),e(1);var n=s.exports=d.ssh=d.ssh||{};n.privateKeyToPutty=function(r,n,s){s=s||"",n=n||"";var p=""===n?"none":"aes256-cbc",h="PuTTY-User-Key-File-2: ssh-rsa\r\n";h+="Encryption: "+p+"\r\n",h+="Comment: "+s+"\r\n";var S=d.util.createBuffer();c(S,"ssh-rsa"),t(S,r.e),t(S,r.n);var T=d.util.encode64(S.bytes(),64),u=Math.floor(T.length/66)+1;h+="Public-Lines: "+u+"\r\n",h+=T;var I=d.util.createBuffer();t(I,r.d),t(I,r.p),t(I,r.q),t(I,r.qInv);var B;if(n){var A=I.length()+16-1;A-=A%16;var b=a(I.bytes());b.truncate(b.length()-A+I.length()),I.putBuffer(b);var R=d.util.createBuffer();R.putBuffer(a("\0\0\0\0",n)),R.putBuffer(a("\0\0\0\x01",n));var y=d.aes.createEncryptionCipher(R.truncate(8),"CBC");y.start(d.util.createBuffer().fillWithByte(0,16)),y.update(I.copy()),y.finish();var g=y.output;g.truncate(16),B=d.util.encode64(g.bytes(),64)}else B=d.util.encode64(I.bytes(),64);u=Math.floor(B.length/66)+1,h+="\r\nPrivate-Lines: "+u+"\r\n",h+=B;var v=a("putty-private-key-file-mac-key",n),m=d.util.createBuffer();c(m,"ssh-rsa"),c(m,p),c(m,s),m.putInt32(S.length()),m.putBuffer(S),m.putInt32(I.length()),m.putBuffer(I);var C=d.hmac.create();return C.start("sha1",v),C.update(m.bytes()),h+="\r\nPrivate-MAC: "+C.digest().toHex()+"\r\n"},n.publicKeyToOpenSSH=function(a,r){r=r||"";var n=d.util.createBuffer();return c(n,"ssh-rsa"),t(n,a.e),t(n,a.n),"ssh-rsa "+d.util.encode64(n.bytes())+" "+r},n.privateKeyToOpenSSH=function(t,a){return a?d.pki.encryptRsaPrivateKey(t,a,{legacy:!0,algorithm:"aes128"}):d.pki.privateKeyToPem(t)},n.getPublicKeyFingerprint=function(a,n){n=n||{};var l=n.md||d.md.md5.create(),s=d.util.createBuffer();c(s,"ssh-rsa"),t(s,a.e),t(s,a.n),l.start(),l.update(s.getBytes());var r=l.digest();if("hex"===n.encoding){var i=r.toHex();return n.delimiter?i.match(/.{2}/g).join(n.delimiter):i}if("binary"===n.encoding)return r.getBytes();if(n.encoding)throw new Error("Unknown encoding \""+n.encoding+"\".");return r}},function(s,n,e){var g=e(0);e(31),e(33),e(1);var c={},a=0;g.debug.set("forge.task","tasks",c);var y={};g.debug.set("forge.task","queues",y);var i={};i.ready={},i.ready.stop="ready",i.ready.start="running",i.ready.cancel="done",i.ready.fail="error",i.running={},i.running.stop="ready",i.running.start="running",i.running.block="blocked",i.running.unblock="running",i.running.sleep="sleeping",i.running.wakeup="running",i.running.cancel="done",i.running.fail="error",i.blocked={},i.blocked.stop="blocked",i.blocked.start="blocked",i.blocked.block="blocked",i.blocked.unblock="blocked",i.blocked.sleep="blocked",i.blocked.wakeup="blocked",i.blocked.cancel="done",i.blocked.fail="error",i.sleeping={},i.sleeping.stop="sleeping",i.sleeping.start="sleeping",i.sleeping.block="sleeping",i.sleeping.unblock="sleeping",i.sleeping.sleep="sleeping",i.sleeping.wakeup="sleeping",i.sleeping.cancel="done",i.sleeping.fail="error",i.done={},i.done.stop="done",i.done.start="done",i.done.block="done",i.done.unblock="done",i.done.sleep="done",i.done.wakeup="done",i.done.cancel="done",i.done.fail="error",i.error={},i.error.stop="error",i.error.start="error",i.error.block="error",i.error.unblock="error",i.error.sleep="error",i.error.wakeup="error",i.error.cancel="error",i.error.fail="error";var t=function(e){this.id=-1,this.name=e.name||"?",this.parent=e.parent||null,this.run=e.run,this.subtasks=[],this.error=!1,this.state="ready",this.blocks=0,this.timeoutId=null,this.swapTime=null,this.userData=null,this.id=a++,c[this.id]=this};t.prototype.debug=function(e){e=e||"",g.log.debug("forge.task",e,"[%s][%s] task:",this.id,this.name,this,"subtasks:",this.subtasks.length,"queue:",y)},t.prototype.next=function(e,r){"function"==typeof e&&(r=e,e=this.name);var i=new t({run:r,name:e,parent:this});return i.state="running",i.type=this.type,i.successCallback=this.successCallback||null,i.failureCallback=this.failureCallback||null,this.subtasks.push(i),this},t.prototype.parallel=function(i,o){return g.util.isArray(i)&&(o=i,i=this.name),this.next(i,function(a){var e=a;e.block(o.length);for(var t=0;t<o.length;t++){var c=i+"__parallel-"+a.id+"-"+t,n=t;!function(t,a){g.task.start({type:t,run:function(e){o[a](e)},success:function(){e.unblock()},failure:function(){e.unblock()}})}(c,n)}})},t.prototype.stop=function(){this.state=i[this.state].stop},t.prototype.start=function(){this.error=!1,this.state=i[this.state].start,"running"===this.state&&(this.start=new Date,this.run(this),d(this,0))},t.prototype.block=function(e){e=void 0===e?1:e,this.blocks+=e,0<this.blocks&&(this.state=i[this.state].block)},t.prototype.unblock=function(e){return e=void 0===e?1:e,this.blocks-=e,0===this.blocks&&"done"!==this.state&&(this.state="running",d(this,0)),this.blocks},t.prototype.sleep=function(e){e=void 0===e?0:e,this.state=i[this.state].sleep;var t=this;this.timeoutId=setTimeout(function(){t.timeoutId=null,t.state="running",d(t,0)},e)},t.prototype.wait=function(e){e.wait(this)},t.prototype.wakeup=function(){"sleeping"===this.state&&(cancelTimeout(this.timeoutId),this.timeoutId=null,this.state="running",d(this,0))},t.prototype.cancel=function(){this.state=i[this.state].cancel,this.permitsNeeded=0,null!==this.timeoutId&&(cancelTimeout(this.timeoutId),this.timeoutId=null),this.subtasks=[]},t.prototype.fail=function(t){if(this.error=!0,l(this,!0),t)t.error=this.error,t.swapTime=this.swapTime,t.userData=this.userData,d(t,0);else{if(null!==this.parent){for(var a=this.parent;null!==a.parent;)a.error=this.error,a.swapTime=this.swapTime,a.userData=this.userData,a=a.parent;l(a,!0)}this.failureCallback&&this.failureCallback(this)}};var o=function(e){e.error=!1,e.state=i[e.state].start,setTimeout(function(){"running"===e.state&&(e.swapTime=+new Date,e.run(e),d(e,0))},0)},d=function(a,r){var n=30<r||20<+new Date-a.swapTime,e=function(t){if(t++,"running"===a.state)if(n&&(a.swapTime=+new Date),0<a.subtasks.length){var s=a.subtasks.shift();s.error=a.error,s.swapTime=a.swapTime,s.userData=a.userData,s.run(s),s.error||d(s,t)}else l(a),a.error||null!==a.parent&&(a.parent.error=a.error,a.parent.swapTime=a.swapTime,a.parent.userData=a.userData,d(a.parent,t))};n?setTimeout(e,0):e(r)},l=function(t,a){t.state="done",delete c[t.id],null===t.parent&&(t.type in y?0===y[t.type].length?g.log.error("forge.task","[%s][%s] task queue empty [%s]",t.id,t.name,t.type):y[t.type][0]===t?(y[t.type].shift(),0===y[t.type].length?delete y[t.type]:y[t.type][0].start()):g.log.error("forge.task","[%s][%s] task not first in queue [%s]",t.id,t.name,t.type):g.log.error("forge.task","[%s][%s] task queue missing [%s]",t.id,t.name,t.type),a||(t.error&&t.failureCallback?t.failureCallback(t):!t.error&&t.successCallback&&t.successCallback(t)))};s.exports=g.task=g.task||{},g.task.start=function(r){var a=new t({run:r.run,name:r.name||"?"});a.type=r.type,a.successCallback=r.success||null,a.failureCallback=r.failure||null,a.type in y?y[r.type].push(a):(y[a.type]=[a],o(a))},g.task.cancel=function(e){e in y&&(y[e]=[y[e][0]])},g.task.createCondition=function(){var r={tasks:{}};return r.wait=function(t){t.id in r.tasks||(t.block(),r.tasks[t.id]=t)},r.notify=function(){var a=r.tasks;for(var e in r.tasks={},a)a[e].unblock()},r}}])});
